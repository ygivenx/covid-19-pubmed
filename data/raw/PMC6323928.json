{"title": "IMG/VR v.2.0: an integrated data management and analysis system for cultivated and environmental viral genomes", "body": "Viruses are ubiquitous, extremely abundant and diverse across all ecological niches (1). Traditional cultivation approaches remain challenging and have resulted in genomic characterization of only a small fraction of the virosphere (2). Advances in sequencing technologies and approaches to reconstruct uncultivated viral genomes directly from the environment have provided new avenues to catalog and explore the vast viral sequence space (3,4).\n\nVarious resources have been developed that host viral genomic data (5\u20137) or provide bioinformatics tools for viral data mining (8,9), although in many cases the metadata associated with available viral genomes (e.g. association with host(s), sampling location or sampled habitat) remains sparse or difficult to find. To fill this gap, we developed the Integrated Microbial Genome/Virus (IMG/VR) system, a data management and visualization platform providing multi-level integration of viral genomes and genome fragments, genes and gene clusters, protein functions and associated host and habitat data with analytical tools for comparative analysis of the global virome (10).\n\nHere we present IMG/VR v.2.0 which now contains over 760,000 viral genomes and genome fragments from publicly available isolate genomes, curated prophages, and assembled metagenomes from the Integrated Microbial Genomes and Microbiomes (IMG/M) system (11). This update features refined viral operational taxonomic unit (vOTU) classification and genome quality scores based on estimated completeness that adhere to the recently proposed standards and best practices for describing uncultivated viral genomes (UViGs) (Roux et al., in press, Nature Biotech). IMG/VR v.2.0 hosts an expanded scope of host-virus predictions through incorporation of similarity to known prophage sequences and domain-level assignment of viruses, and features new analytical tools, visualization options, and downloading capabilities.\n\nThe 25,000 viral protein families (VPFs) used to identify UViGs were queried against the ViralZone database (12), where viral hosts were predicted at different taxonomic levels. 11 400 VPFs had at least one hit to the virus genomes and an average of 6.8 hits per model was calculated. For each VPF, a score value (between 0 and 1) was obtained dividing the total number of hits with a uniform distribution (only present in a single host domain) by the total number of VPF hits [i.e. score = (#uniform hits/#total hits)]. In the cases where the total number of hits was below the average number of hits, we corrected the score as follows: [(#uniform hits/#total hits) \u00d7 (#total hits/average #hits)].\n\n3788 VPFs were assigned with the maximum 1.0 score, representing those models found in at least seven known viral genomes and with a uniform domain distribution. The presence of these VPFs across the UViGs allowed us to separate 65% of the viral genomes into prokaryotic (bacteriophages and archaeal viruses), or eukaryotic viruses.\n\nThis approach has been benchmarked using the host assignment of the viral genomes containing pVOGs (13) with homology to our 1.0-score VPFs (2,037 pVOGs) with \u226595% homology based on hhsearch (14). Our classification was consistent with the classification in the pVOG database in all 98.6% of the cases. The remaining 1.4% resulted in viruses annotated as \u2018archaea-bacteria\u2019 viruses in the pVOG database that were identified as either bacteria or archaea using our approach. Thus, we can estimate that there was a 100% consistency of this method separating prokaryotic and eukaryotic viruses.\n\nFollowing the recently developed \u2018Minimum Information about an Uncultivated Virus Genome (MIUViG)\u2019 framework, we classified the IMG/VR scaffolds as \u2018genome fragment\u2019 or \u2018high-quality draft genome\u2019 based on estimated genome completeness. The estimation of genome completeness relied on a predicted genome size calculated as follows.\n\nFirst, circular contigs were identified based on identical sequences at 5\u2032 and 3\u2032 ends (\u226510 bp), or repeats (direct or inverted) of 20 bp of more within 50 bp of the contig ends. To identify putative false positives, i.e. circular contigs that do not represent complete genomes, these circular contigs were affiliated first to ICTV genera (or families for ssDNA and RNA viruses) based on the presence of taxonomic marker VOGs (http://vogdb.org/) (Roux et al., in press, Nature Biotech). VOG-based affiliations required \u22652 consistent VOG markers except for NCLDV where \u22655 markers were required, and for ssDNA and RNA viruses for which one marker was required. Alternatively, circular contigs were affiliated to genus-level groups including Viral RefSeq genomes using vContact2 (https://bitbucket.org/MAVERICLab/vcontact2) (15). For circular contigs grouped with isolated reference genomes, contigs with a length <80% of the minimum reference size of the group were considered as a false positive. For circular contigs in genus-level groups without any isolate, any circular contig with a length <80% of the maximum linear contig in the group was considered as a false positive. In addition, all circular contigs <10 kb and without any marker gene affiliation to a ssDNA or RNA virus genome were considered as false positives, as they likely originate from dsDNA virus genomes. Overall, 4166 circular contigs were considered as false-positive, and were analyzed as linear contigs for the purpose of completeness estimation (see below).\n\nLinear contigs were first affiliated to ICTV genera based on the presence of \u22652 taxonomic marker VOGs (\u22655 markers for NCLDV, \u22651 for ssDNA and RNA viruses), and their completeness estimated by comparison to the average genome length of isolates from the genus (or families for ssDNA and RNA viruses). Otherwise, linear contigs were affiliated to genus-level groups including Viral RefSeq genomes and circular contigs predicted as complete genomes (see above) using vContact2. For each genus-level group, an average genome length was first calculated based only on isolates and circular contigs. If the standard deviation of genome length in this group was \u226415% of the average genome length, this average was considered as the predicted genome size for all linear contigs in this group, as in (4). For linear contigs greater than the predicted genome size, the completeness was set at 99% as these are likely near-complete genomes.\n\nThe IMG/VR v.2.0 system contains 755 999 viral genomes and genome fragments from cultivated isolate virus genomes (iVGs) and uncultivated virus genomes (UViGs). This represents a 3-fold increase, as compared to the first public release in 2016 (3,10) (Figure 1) (3,16). The current 735 112 UViGs were identified from 7986 metagenomic samples integrated in the IMG/M system (11) from geographically and ecologically diverse habitats associated with the Genomes OnLine Database (GOLD) metadata and classification system (17). In addition, the data includes a total of 8389 reference viral genomes from the IMG/M database (11). These references represent high quality viral genomes with BioProject, BioSample and Assembly accession numbers from the NCBI virus database. Structural and functional annotation of all sequences is provided by the DOE Joint Genome Institute's annotation pipelines (18).\n\nUViGs were identified using the JGI\u2019s viral detection pipeline, as previously described (3,16). Briefly, a curated set of 25 000 viral protein families (VPFs) were used as bait to identify UViGs among assembled metagenomic sequences longer than 5kb followed by iterative filtering. The pipeline predictions are tuned to provide a highly specific detection of mostly lytic double-stranded DNA viruses and retroviruses (99.6% precision with a 37.5% recall rate) (16).\n\nTo complement iVGs and UViGs content, we incorporated a public set of 12 498 high-confidence viral genomes (prophages) detected in microbial host genomes (19). This dataset was used to create additional vOTUs (see below), and to enhance host-virus predictions helping to connect 3017 genome fragments with their specific hosts.\n\nAll 755,999 viral sequences in IMG/VR (iVGs, UViGs, and prophages) were clustered into viral Operational Taxon Units (vOTUs), according to the recommendations of the new standards and best practices for describing genome sequences from uncultivated viruses (Roux et al., in press, Nature Biotech). These vOTUs were generated via single linkage clustering of sequences with at least 95% average nucleotide identity (ANI; (20)) over at least 85% of the length of the shorter sequence.\n\nIn total, 442 675 sequences (representing 58% of the total) were clustered into 110,384 vOTUs (indicated with a \u2018vc_\u2019 prefix) ranging in size from 2 to 581 members per cluster. The majority of these vOTUs (51%) contain only two members, while \u223c6% have 10 or more members. The remaining 317 778 sequences (42% of the total) were singletons (indicated with a \u2018sg_\u2019 prefix). Together, IMG/VR contains 428,162 vOTUs (including clusters and singletons) (Figure 1). Notably, the total number of newly predicted viral sequences and the number of vOTUs have grown linearly with the number of samples screened, indicating that viral sequence diversity estimates are not approaching saturation, as previously observed (3).\n\nThe prediction of putative host(s) for the UViGs has been split into two categories: specific host prediction and domain-level taxonomic assignment (prokaryotic and eukaryotic viruses).\n\nSpecific viral hosts were predicted using the computational approaches previously described (3). First, we propagated host assignments from the viral clusters containing iVGs (updated June 2018) and from the previously published curated prophage database (19), resulting in host prediction for 4212 UViGs from 671 viral clusters. Second, we used matches between viral sequences and the microbial CRISPR-Cas adaptive immune system, which hijacks small (from 25 to 65 base pairs) viral sequences and stores them within the microbial CRISPR arrays as spacers (21). This approach led to host prediction for 37 656 UViGs (including 4707 vOTUsand 7456 singletons). In total, we connected 49 bacterial and archaeal phyla and candidate phyla to viral sequences (Table 1). These complementary methods allowed us to discover previously unknown host-virus connections, including the identification of viruses predicted to infect hosts from 12 phyla for which no virus-host connections hitherto existed (Thermodesulphobacteria, Thaumarchaeota, Lentisphaerae, ca. Bathyarchaeota, ca. Micrarchaeota, ca. Desantisbacteria, ca. Aminicenantes, as well as candidate phyla within the CRP: ca. Wildermuthbacteria, ca. Moranbacteria, ca. Daviesbacteria, ca. Microgenomates and ca. Gracilibacteria),.\n\nTo perform domain-level host assignment of viral contigs, a new approach was developed that employs phylogenetic signature protein families and the presence of VPFs that are uniquely present in prokaryotic or eukaryotic viruses. Using this approach, domain-level host assignment was possible for 65% of the viral genomes and genome fragments. The vast majority of the IMG/VR v.2.0 data content (92%) are classified as prokaryotic viruses and reflects that the JGI viral detection pipeline targets mainly double-stranded DNA viruses and retroviruses.\n\nAssembling viral genomes from metagenomes inevitably yields a heterogeneous mix of sequences ranging from short genome fragments to near-complete and even complete genomes. To help users separate complete and near-complete viral genomes from short fragments, we applied a genome completeness estimation method to classify viral sequences by genome quality according to community proposed standards (Roux et al., in press, Nature Biotech). Briefly, circular contigs are considered putative complete genomes, with spurious matches removed based on their comparison to the closest isolate reference genome. Linear contigs are first clustered along with circular contigs and isolate reference genomes into genus-level groups. If the sizes of complete genomes from a genus-level group are consistent, the average size of these complete genomes is used as a \u2018predicted genome size\u2019 for all linear contigs in this group. In total, IMG/VR contains 11 220 finished isolate virus genomes (iVGs), with an additional 14 644 circular UViG contigs identified as likely complete genomes. A total of 15 505 linear contigs were classified as \u2018high-quality draft genomes\u2019 based on their estimated completeness of \u226590%, while the remaining 719 084 linear contigs were classified as \u2018genome fragments\u2019 due to their low completeness (n = 188 377) or lack of predicted genome size (n = 522 731) (Figure 2). Although this classification is based entirely on in silico predictions and would require in vitro experiments and/or isolation of the virus to ascertain genome completeness, this information is still valuable for users who want to focus their research on complete or near-complete predicted viral genomes.\n\nThis tab in \u2018Scaffold Cart\u2019 allows users to query a selected list of \u2018Functions\u2019 including any that can be found under the \u2018Find Functions\u2019 menu added into the \u2018Function Cart\u2019 against UViGs of interest added to the \u2018Scaffold Cart\u2019. For example, a user can search all protein families associated with the function of \u2018terminase\u2019 to explore their presence and abundance across selected UViGs. Then, the genes encoding the selected function from the UViGs could be viewed by clicking on their counts.\n\nGenes from selected UViGs (e.g. those in the \u2018Scaffold Cart\u2019) can be added to the \u2018Gene Cart\u2019 (by using the \u2018Add Genes of Selected Scaffolds to Cart\u2019 button), and their association with predicted functions can be reviewed by using the \u2018Functions\u2019 button.\n\nFrom the \u2018Gene Cart\u2019, users can also visualize the genomic location of the selected genes by using the \u2018Chromosome Map\u2019 option.\n\nProtein or DNA sequence alignments (using Clustal Omega (22)) of genes selected from the \u2018Gene Cart\u2019 can be quickly performed and visualized as rectangular phylograms by clicking the \u2018Sequence Alignment\u2019 button.\n\nChromosomal (UViG) neighborhood of genes selected from the \u2018Gene Cart\u2019 can be visualized (using selected directionality of the strands) by clicking on this tab.\n\nAll information from \u2018Scaffolds\u2019, \u2018Genes\u2019, and \u2018Functions\u2019 tables can be independently accessed by clicking on their corresponding links or can be exported in a tab-delimited text format by using the \u2018Export\u2019 button. Phylogenetic trees can be exported in a Newick file format, and images as SVG or PNG files.\n\nA new IMG/VR-ER (expert review) system (https://img.jgi.doe.gov/vr-er/), which will require a login/password access, will allow users to perform computationally intensive workspace-based analyses, analogous to the IMG/M-ER system (11).\n\nUViGs of interest can be now selected into the \u2018Scaffold Cart\u2019 and visualized on a Google map. On the IMG/VR home page, a user can access this new functionality by selecting \u2019Scaffold Cart\" from the \u2018Ecosystem\u2019 drop down box above the map. The \u2018Scaffold Cart\u2019 menu item only appears in the drop down if there are UViGs selected in the cart (Figure 4).\n\nSequence similarity search options (bottom left of the home page under the \u2018Viral/Spacer Blast\u2019 button) have been extended in IMG/VR v.2.0 (Figure 5) to enable BLAST queries (23) of user-submitted sequences against the viral nucleotide or amino acid databases with customizable e-value cutoffs. Similarly, user-submitted nucleotide sequences can be queried using BLASTn against a database of predicted CRISPR spacer sequences derived from assembled metagenomes or isolate genomes in order to find matches to potential host(s) or habitat(s).\n\nIn addition to the web interface which enables users to query and analyze viral genomes and genome fragments, IMG/VR v.2.0 now provides the bulk download options for all viral sequences, viral protein families (VPFs), and associated metadata. This allows users to perform additional analyses and large-scale computations using their own tools and computational resources. The viral sequence data can be downloaded through either the Joint Genome Institute's Genome Portal (https://genome.jgi.doe.gov/portal/IMG_VR/IMG_VR.home.html) under the \u2018Download\u2019 tab, or from the \u2018Download IMG/VR database\u2018 button at the bottom left corner of the IMG/VR landing page (https://img.jgi.doe.gov/vr/) (Supplementary Figure S2). The files available to download include the nucleotide and amino acid sequences (in a FASTA format), as well as a table of extensive metadata including association of sequences with vOTUs, genome quality and completeness, predicted host specificity, as well as habitat information. Previous IMG/VR versions are also available for download on the same pages.\n\nThe IMG/VR system was released two years ago as the largest publicly available viral-focused genomic repository with associated metadata and has been widely used in the research community (for example, (24\u201328)). Since the initial release, the IMG/VR content has tripled in size with over 755 000 viral genomes and genome fragments. Considering the number of newly identified UViGs and the growth of vOTUs, we project that the number of viral sequences hosted in IMG/VR will continue to grow superlinearly. We anticipate that this increase over time, however, will not affect the database infrastructure nor the system capabilities, since it only represents a small fraction of the original IMG/M total data. In this release, we have updated and added a number of features that expand the functionality of the resource. First, IMG/VR v.2.0 now adheres to community-accepted standards and best practices to characterize genome sequences from uncultivated viruses, including terminology (e.g. UViGs, vOTUs) and genome clustering methodology. Second, we have improved the virus-host predictions through the addition of curated prophage sequences to the clustering step and expanded the microbial CRISPR spacer database by 35%. In addition, we have classified 65% of the sequences into prokaryotic or eukaryotic viruses. Third, we have estimated the quality of the UViGs based on their predicted genome completeness. Fourth, we provide visualization in Google Maps of the sample(s) location from which we select virus genomes or genome fragments. And fifth, we enhanced the blast capabilities to query external data (now able to query viral proteins and metagenomic spacers).\n\nFuture versions of IMG/VR will boost the data content by adding other predicted viral genomes and genome fragments not easily captured by our current detection pipeline. For example, viral contigs <5 kb are currently filtered out to minimize the rate of false positive predictions. However, this step may also remove many ssDNA viruses (29). Moreover, most NucleoCytoplasmic Large DNA Viruses (NCLDVs) are also filtered out by our current pipeline due to their high number of metabolic genes (30) and the lack of reference genomes when the VPFs were originated. Other virus groups such as virophages are also difficult to identify due to their clear underrepresentation in the databases (31). The development of methods specifically targeting the above viral types, as well as RNA viruses, which can be found in metatranscriptomic samples. We envision IMG/VR as a comprehensive, dynamic, and interactive platform eventually including all types of viruses. Additionally, we plan to improve and expand the host-virus assignments by using a combination of homology-based searches of specific genes and kmer-based machine learning approaches (32,33).\n\nIn summary, we anticipate that this improved and updated version of IMG/VR along with the capability of downloading its data content will serve as an essential resource for researchers studying viral ecology and genomics from specific targeted environments to global scales.\n\nIMG/VR v.2.0 can be accessed directly from its web link: (https://img.jgi.doe.gov/vr) or from the \u2018Data Marts\u2019 tab in the IMG landing page (https://img.jgi.doe.gov/). As explained under the \u2018Downloading\u2019 Results section, IMG/VR v.2.0 is downloadable from the JGI Genome Portals (https://genome.jgi.doe.gov/portal/pages/dynamicOrganismDownload.jsf?organism=IMG_VR) directly or via Globus Web Application."}