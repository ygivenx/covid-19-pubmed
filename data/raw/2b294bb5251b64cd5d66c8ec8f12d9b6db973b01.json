{"title": "A simulation framework to investigate in vitro viral infection dynamics", "body": "In the past ten years there has been a growing interest in modeling viral infections for the study and characterization of host infection dynamics. Early mathematical models were typically based on ordinary differential equations (ODEs) and focused on extracting key parameters of the infections dynamics [1, 2] . Later on, interest moved to investigating how spatial relations affected the system dynamics, thus moving to cellular automata (CA) models [3] [4] [5] .\n\nMore recently the attention has shifted to viral respiratory diseases due to the increasing danger of pandemics such as the \"Spanish flu\" that caused over 50 million deaths worldwide in 1918. Near pandemics such as severe acute respiratory syndrome (SARS), resulting in 8096 infected cases and a 9.6% death rate, have provided unfortunate reminders their continued health risk and significant economic impact [6] . New research projects are being funded to investigate the different scales of threat, from the epidemiological spread of a virus in a population to its early phases of the infection in a cell culture. Among the papers published on this topic, in particular on the influenza virus [7] [8] [9] , there are Bocharov's ODE model [10] and Beauchemin's CA model [3, 4, 11] . Both models described the dynamics of the influenza infection in the upper epithelial areas of the lungs and were validated by clinical data. Although they take into account the effect of the immune system on the dynamics of the disease, describing the infection until its final outcome (more than a week after the first infection), none of them analyzed which mechanisms where critical in the dynamics of the first and second round of infection. To understand the key mechanisms of viral respiratory diseases, we focus instead on early phases of viral infection by using in vitro experiments observing lung cells up to 24 h post infection (PI). The in vitro experiments provide measurements of virus titer, spatial characteristics of cell growth and, through green fluorescent protein (GFP) imaging, of the infection spread.\n\nOur computational model focuses on simulating the early stages of a viral infection in a population of cells plated on a culture well. The choice of a CA model was natural since the in vitro infections being studied use host lung cancer cell lines that form a fixed monolayer in which spatially dependent aspects of infection may be present [12, 13] . We developed this computational model using the Multi-Agent System Visualization (MASyV) platform [3] . In contrast to previous models, we explicitly focus on the dynamics of virus spread on a population of cells, supported by experimental data from an in vitro model system. We also explicitly model the infectious viral particles as discrete entities, whereas in previous models the infection of cells followed simple CA rules depending on the states of neighboring cells. These viral particles are released by infected cells according to a specific function based on time post infection, and move over the well with a random walk algorithm.\n\nThis representation allows us to model the mechanisms of virus spread in an environment where the virus is not confined and can also infect cells not adjacent to the infected ones.\n\nIn Section 2 we describe the model design and its main features. We also describe the SARS infection experimental data used to parameterize the model and how we optimized the free parameters using a simulated annealing algorithm. In Section 3 we present a sensitivity analysis that identifies the critical mechanisms characterizing the early phases of the infection. We also show that the model can explain the experimentally observed virus titer data and allows a deeper understanding of the infection dynamics in the in vitro experiments.\n\nThe computational model is built using Beauchemin's MASyV platform. The software consists of a server providing I/O and supervisory services to the various client modules where the simulation is actually coded. Our choice to use MASyV was partially driven by flexible and powerful graphical visualization routines that facilitate comparison to images provided by the experimental collaborators.\n\nMASyV has a C-based API and is open source allowing finalized custom models to be easily shared. We discuss novel contributions and differences from the previous modules. The original module details are presented in Beauchemin et al. [3] .\n\nOur model reproduces a viral infection on a population of cells plated on a culture well. In our client we consider, as the target of the viral infection, Calu-3 cells that are a human airway epithelial cell line derived from human lung cancer. We model these host cells using a 130 \u00d7 130-site CA model where each site represents either one calu-3 cell or an empty space. At the beginning of the simulation each lattice site is initialized and labelled with \"uninfected\" or \"empty\" states as described below in Section 2.2. Uninfected cells are initially stochastically infected with virus through a first round of infection at the beginning of the simulation, described in Section 2.3, and once infected progress through the following states:\n\n\u2022 Containing: initial infection state representing viral entry and hijacking of host cell mechanisms necessary for viral replication. \u2022 Expressing: cell is actively producing and assembling virus capsids and genomes internally, but has not begun releasing virion. \u2022 Infectious: assembled virion is being released from the host cell according to the release function (Section 2.4).\n\nBy examining the experimental viral titer data shown in Fig. 1 we derived temporal delay of the state transition between Containing and Infectious. The \u223clog 10 3 viral titer measurements at time points 0, 4 and 7 h post infection are residual virus left over from the initial infection after washing. We set the delay for release of new infectious viral particles to 7 h to represent the jump in observed virus titer between 7 and 12 h. Cells release virus particles according to a viral release function, described below. Virus particles are entities that diffuse from one lattice point to another according to a random walk algorithm (Section 2.4). These free-floating virus particles stochastically infect uninfected cells in a second round of infection. The CA lattice is therefore like a tissue of immobile cells with infective virions moving over it. We represent only infectious viral particles to relate their count in the model with the viral titer measured in terms of plaque forming unit per mL (PFU/mL). A PFU is a measure of the number of viral particles capable of forming plaques per unit of volume, thus only infectious particles are counted in the viral titer. The CA lattice is updated synchronously and the boundary conditions for both the epithelial and viral particles are periodic, i.e., epithelial cells and viral particles can grow or move outside the boundary of the virtual well. We use a Honeycomb neighborhood: each lattice site is considered adjacent to six sites and cells can replicate only if a neighboring site is empty or if it contains a dead cell. Only uninfected cells are allowed to replicate. When cells on the lattice are initialized all uninfected cells are stochastically assigned a TIME TO DEATH value between 1 and an arbitrary CELL LIFESPAN variable. CELL LIFESPAN was chosen to be large enough such that 5%, a minority of the cells, die naturally within the simulated 24 h. CELL LIFESPAN is not affected by infection as in vitro experimental observations showed no increase in cell death due to infection within 24 h.\n\nIn the laboratory before an in vitro infection is performed, 10 6 cells are first plated in each of the 6 culture wells present in a dish, and given time to settle down on the well surface to create a cell mono-layer, before the virus is applied to the cell culture. In the plating process, a suspension of cells is plated onto the surface of the well that adhere to the plastic in small clumps or as single cells forming \"islands\" that are homogeneously distributed throughout the well. Cells located on the inside of these islands (surrounded by other cells) do not replicate due to contact inhibition whereas cells on the outer edges of each island replicate until they are completely surrounded by other cells. As a result each island continues to grow until there is no adjacent empty space on the well surface.\n\nTo represent this behaviour we used a set of images ( Fig. 2 ) that shows how cells are distributed on the culture well just before the infection is performed. The number of cells forming each isolated island was counted for each image obtaining a distribution of island sizes with an average of 116 cells/island and a standard deviation of 74 cells/island. This data was used to generate randomly positioned clusters of cells on the grid, each with a size extracted from the measured distribution. Islands are placed iteratively until the simulated confluency matches the experimentally measured confluency. from well surface area, the total number of cells and the size of a single cell (\u223c20 m 2 see ATCC catalogue). This value was used for simulations performed in Section 3.\n\nA cell line doubling time is defined as the time required for the population of cells to double in number and we used a doubling time of 48 h for Calu-3 cells (Ardizzoni Lab, personal communication). Cell density directly affects local cell growth since cells completely surrounded by other cells are not able to replicate. For this reason in our model the initial spatial distribution of uninfected cells affects the overall cell growth on the virtual culture well. In order to obtain a correct cell growth in our model we included a parameter called DIVISION TIME that indicates the time necessary for a single uninfected cell to duplicate given an empty neighboring lattice site. We adjusted DIVISION TIME to match the simulated doubling time with the experimentally derived doubling time by analyzing cell growth of uninfected cells over 48 h as a function of time for different DIVISION TIME values (Fig. 4) . This led us to fix the value of DIVISION TIME to 10 h.\n\nDuring in vitro infection experiments, cells are initially infected using a multiplicity of infection (MOI) of 2 (see Section 2.6.2). The MOI is calculated as the ratio of infectious viral particles to the number of Calu-3 target cells. By definition the proportion of infected cells is given by the Poisson distribution that describes the infection process [14] . Using the experimental MOI would theoretically give us the exact percentage of infected cells at the beginning of the experiment but even though the number of particles can be measured with good accuracy not all the viral particles used in this first infection process are infectious and the MOI estimate is derived using VeroE6 cells. These two complications require us to define an effective MOI, that is the MOI given by the number of particles able to truly infect the Calu-3 host cells. Initially viral particles infect a proportion of the plated Calu-3 cells before being washed away. We use the resulting proportion of infected cells estimated through the standard MOI definition as a starting point of our simulation.\n\nAfter cells are initialized on the lattice, they are assigned an infected state according to Eq. (2), which describes the probability of at least one viral particle entering a cell. In the equations below, n represents the number of virus particles and MOI is the multiplicity of infection used in the experiment. Eq. (2), the probability of a cell being infected by 1 or more virus particles, is derived from Eq. (1), the probability of being infected by a single virus particle, commonly used to describe viral infection as a Poisson process [14] . Although the expected MOI is experimentally known, as mentioned in Section 2.6 it is often over-estimated. We add the free parameter INFECTIOUSNESS for two purposes: (1) to scale MOI over-estimation and (2) predict the number of initially infected cells when this data is not available. In the sensitivity analysis we discuss the importance of this parameter.\n\nDuring an in vitro infection experiment, individual cells release a given amount of virus per hour. Although we did not have estimates for the amount of SARS virus released per cell, we used an estimate of virus released from a paper by Ka-Wai et al. [15] . In our model, after cells transition to an infectious state virus particles are released with a probability described by a sigmoidal function shown in Fig. 5 . The probability that one or more infectious viral particles are released in each time step is given by V(t) (Eq.\n\n(3)). In this equation t represents time since the cell was infected and parameters A, B, and C are derived by fitting an experimentally derived viral release curve produced by Ka-Wai et al. [15] . The fitted sigmoidal function was rescaled with the free parameter VIR RELEASE so that the general function shape was maintained but the amount of virus released was adjusted to reflect our SARS infection experiments. When V(t) > 1 an infectious cell will release one or more virions with a probability of 1. Decimal digits less than one are treated as a probability for an additional virus particle to be released.\n\nOnce released, virions diffuse into the liquid cell culture media where they may go on to infect neighboring cells through additional rounds of infection (described in Section 2.5). This process is represented in our simulation by allowing infectious virions to diffuse in our virtual well according to a simple random walk: for each virion in the virtual well at each time step of the simulation we perform a number of Random Walk steps given by the free parameter NUM DIFF STEPS. Each viral particle has an equal chance to move to one of the six neighboring lattice sites and at each time step performs NUM DIFF STEPS movements on the lattice. Experimentally, this parameter is difficult to measure, especially for BioSafety Level 3 viruses like SARS, and so we included it as our third free parameter representing the virion diffusion coefficient in a well with specific conditions of the cell culture media.\n\nViral titer measures only infectious particles present in the media using plaque forming units (PFU) per mL. For this reason we model only infectious particles [14] . In addition it is more computationally efficient to release and diffuse only the infectious viral particles.\n\nOnce released, virus particles may infect cells with an uninfected state located at the same lattice site. We assume each viral particle independently infects a nearby cell with a probability following the binomial distribution. For each lattice site the probability P second round (Eq. (4)) is used to calculate whether or not a given uninfected cell is infected by n viral particles given N total local virus particles.\n\np BP represents the probability of a virus-receptor binding event leading to a cell's infection by a single viral particle during a given model time step. We refer to the free parameter, p BP , as BIND-ING PROB below. Once a cell is successfully infected, n viral particles are removed from the local virtual media located at the cell's lattice site.\n\n2.6. Experimental data 2.6.1. Viral stocks For these experiments we used a virus derived from our severe acute respiratory syndrome coronavirus (SARS-CoV) wild type infectious clone in which we engineered the green fluorescent protein (GFP) in place of open reading frame 7a/b. SARS-CoV GFP stock titers were calculated using standard plaque tittering methods. Briefly, confluent monolayers of VeroE6 cells in 6 well plates were infected with serial 1:10 dilutions (usually 10e\u22121 to 10e\u22126) of stock virus for 1 h at 37 \u2022 C. The monolayers were covered with a solution of 0.8% low melting point agarose (Seachem), 1\u00d7 minimal essential media high glucose (MEM, Invitrogen), 10% fetal clone II (Hyclone), and 1\u00d7 antibiotic/antimycotic (Invitrogen), which solidifies trapping the virus to allow cell to cell viral spread but not release of virions into the media. Plates were incubated at 37 \u2022 C for 36 h, stained with neutral red for 2-5 h, the stain removed and the plaques (holes in the monolayer generated when viruses kill the host cells) are visualized and counted on a light box. Stock titers were calculated as plaque forming units (pfu) per mL.\n\nCalu-3 cells were plated at a density of 1 \u00d7 10 6 /well in 6 well plates in MEM containing 10% fetal clone II and 1\u00d7 antibiotic/antimycotic. Cells were incubated at 37 \u2022 C at 5% CO 2 levels for 2 days prior to infection with a media change 24 h post plating. SARS-CoV GFP stocks (7.5 \u00d7 10 7 ) were used to infect each well at a multiplicity of infection of 2 or the addition of 2 infectious virions per cell in each well. At each time point, 100 L of media was harvested from each well to titer via plaque assay. (Number of cells per well assumed to be 2 \u00d7 10 6 at 2 days post plating.)\n\nImages shown in Fig. 2 were taken using phase contrast microscopy images were taken at standard exposure times at 10\u00d7 magnification. At the indicated times post infection, images of the infected and mock-infected Calu-3 cells were taken in living cells real time using a fluorescent light to excite GFP [16] . SARS-GFP infected cells were assessed using ImageJ (http://rsbweb.nih.gov/ij/). In ImageJ, we gated the light signal to generate spots in each cell and used the spot counting algorithm determine the total number of cells per field. GFP positive cells were then counted and averaged.\n\nFor each candidate parameter set, \u00c2, a simulation fitness (Eq. (5)) was calculated based on a comparison of two experimental measurements: virus titer and proportion infected cells. Both components of simulation fitness, F(\u00c2), are normalized by a maximum error (ME) term to balance their contribution.\n\nF titer = (log 10 (VT exp(t)) \u2212 log 10 (\u02db \u00d7 VTsim(t))) 2 (6)\n\nRandomized weight bootstrapping (1000 iterations) was used to determine ME titer and the derivation of ME GFP is described below.\n\nEq. (6) shows F titer is the sum of squares difference between experimentally derived virus titer, VT exp (Fig. 1) and scaled virus titer produced by the simulation, VT sim . Only the last three time points (7, 12, 24 h) are compared because earlier time point titer values were skewed by residual virus. Simulation output, VT sim , is scaled by \u02db to account for differences in the number of simulated cells versus the number of in vitro cells. Using a lattice size of 130 \u00d7 130 an average of 7636 total starting simulated cells were produced. The virus titer was scaled by a factor of 10 6 /7636 because the experimental virus titer was produced from a population of 10 6 in vitro cells.\n\nAs described in Section 2.7, in vitro GFP measurements were used to quantify the proportion of infected cells at 12 h post infection. This additional biological information was used to constrain our model's parameter space. The F GFP portion of simulation fitness (Eq. (7)) is the absolute value of the difference between simulated proportion of infected cells I sim to experimentally measured proportion infected, I exp . Since I exp was measured to be 0.11 (on average 11 of 100 cells are infected) at 12 h, a maximum error, ME GFP , of 0.89 was used to normalize F GFP between zero and one.\n\nA simulated annealing (SA) algorithm was implemented in R to fit the model to available experimental data (virus titer and GFP) SARS infection of Calu3 cells [17, 18] . All possible probability parameter values were considered for INFECTIOUSNESS AND BIND-ING PROB between 0 and 1. Maximum values for NUM DIFF STEPS and VIR RELEASE were arbitrarily chosen (12 and 30, respectively). Each parameter range explored at each temperature iteration was equal to the parameter range divided by the number of iterations, 20, per temperature.\n\nThe effect of simulation stochasticity was expected to have an effect on fitness variability for a given parameter set leading to errors in the solution space and sub-optimal simulated annealing results. We examined the relationship between simulation fitness variability and number of simulations used to estimate the average parameter set fitness. The average fitness variance from 1000 randomized parameter sets was evaluated for 2,3,4,5 and 6 simulations per parameter set. The median fitness variance increases from 0.002 to 0.003 for two and three simulations per parameter set, respectively. Increasing beyond 3 simulations per parameter set did not increase the fitness variance beyond 0.003. As a result, each parameter set simulation fitness value was based on the average fitness of 3 runs.\n\nOne hundred samplings of the parameter space were used to measure entropy of the solution space and derive a starting temperature based on a 0.9 probability of acceptance of the maximum entropy. A cooling schedule was found by repeatedly multiplying temperatures by a factor of 0.985. Fig. 6(A) shows the progression of the local best fitness of 5 different simulated annealing runs to identify parameter sets that minimize Eq. (5).\n\nIndividual simulated annealing runs identify parameter sets that show strong relative agreement: INFECTIOUSNESS is very small, corresponding to an initial number of infected cells between 1% and 3% of the available cells at time point zero. The optimized VIR RELEASE varies between 1.351 and 2.096 meaning that an infected cell releases at most about 2 infectious particles every hour. Optimized parameter values for INFECTIOUSNESS had the least variance (1.08 \u00d7 10 \u22125 ), followed by BINDING PROB (0.00809), VIR RELEASE (0.0821), and NUM DIFF STEPS (13.05). Simulated annealing allows us to describe the specific infection dynamics related to the optimized parameters, thus supporting the virologists in understanding the observed results of in vitro experiments.\n\nFor these SARS-CoV experiments, the model predicts that the initial number of infected cells is small. The contribution to the observed viral titer is mainly due to the production of viral particles released by cells infected in the second round, since the % of infected cells grows from about 2% at 0 h to about 11% after 12 h. This explains the exponential increase in the viral titer measured between 12 and 24 h, considering that the maximum rate of virions release is reached after about 12 h post infection. Fig. 6 (B) demonstrates agreement of solutions identified using simulated annealing and how these solutions compare to the original virus titer curve. Note that the 0 and 4 h time points do not match exactly because our simulation assumes no residual virus at the time of initial infection.\n\nTo assess the importance of model free parameters to simulation outcome, a Latin Hypercube sampling (LHS) sensitivity analysis was performed [19, 20] . This two-tiered sampling method was implemented by dividing each free parameter's range into 1000 intervals. Intervals for each parameter were shuffled without replacement and then randomly sampled using a uniform distribution resulting in 1000 samplings of the parameter space. All possible probability parameter values were considered for INFECTIOUSNESS AND BINDING PROB between 0 and 1. Maximum values for NUM DIFF STEPS and VIR RELEASE were arbitrarily chosen (12 and 30, respectively). A Spearman rank correlation was then used to measure statistical dependence, Rho, between free parameter and single run simulation fitness.\n\nThe following are free parameters (described above) contained in our model and assessed using LHS: We also examined how free parameters affect simulation output with time. Using LHS sampling, we tested relations between free parameters and two simulation outputs: virus titer and % of infected cells. Fig. 8(A) shows that INFECTIOUSNESS and VIR RELEASE are significant over 24 h of simulated infection and that their correlations start to diverge at \u223c12 h. Again, BINDING PROB and NUM DIFF STEPS do not show a significant correlation with virus titer. However, parameters necessary for the second round of infection do impact the proportion of infected cells shown in Fig. 8(B) where we see an increase in BINDING PROB and VIR RELEASE correlation between 7 and 12 h, corresponding to a decrease in the INFECTIOUSNESS correlation. This decrease can be attributed to the second round of infection in which a greater population of cells has been infected. The simultaneous increase in correlation of BINDING PROB and VIR RELEASE indicates that additional rounds of infection are playing a significant role in viral spread, confirming the results of our SA.\n\nAlthough simplistic compared to in vivo model systems, the interpretation of in vitro experiments is still confounded by biological complexity and disparate data types. Explanatory models are critical for understanding and hypothesis generation. This agentbased modeling framework may be used to investigate first and second round of infection mechanisms using free parameters able to be tuned to allow the model to incorporate disparate types of experimental data. We also take into account spatial aspects of infection, including biases in culture well cell growth and diffusion of infectious virions.\n\nVirus titer data and GFP infectivity data from a SARS infection of Calu-3 cells is used as an example to illustrate the model's capacity to interpret experimentally derived data. Model parameter fitting using simulated annealing and LHS sensitivity analysis indicates that a small population of cells is initially infected and that additional rounds of infection are responsible for virus titer measurements.\n\nWe show that we are able to identify free parameters that fit the model to the dynamics of the SARS infection using simulated annealing and that the model is useful in supporting the interpretation of in vitro experiments. LHS sensitivity analysis and SA optimization results indicate a significant relationship between INFECTIOUSNESS and both the simulation fitness and simulation outputs (virus titer and proportion infected cells) indicates the importance of this parameter on the resulting infection dynamics. This result also demonstrates the importance of the accurate cell and infectious virus particle counts for the MOI calculation. Finally our model highlights the importance of intracellular processes leading to virus release. One possible future step is to include additional detail regarding intracellular processes of virus replication and move to a multi-scale spatio-temporal model.\n\nFuture work is planned to incorporate microarray data and make predictions regarding host response and expression in order to examine connections between infection state and signaling in the immune response. Simulated annealing has been used to identify free parameters that fit the described model to virus titer data and may be used to predict the number of infected cells or other un-measured data types to support experimental modeling efforts. These off-line predictions could then be used to interpolate a single-cell function representing host response post-infection.\n\nWe also plan to train the model with data from multiple virus strains to investigate how virus population and host response dynamics differ. Finally, we also plan to investigate the effects of initial spatial distribution of infected cells on viral pathogenesis for multiple virus strains.\n\nAll authors must sign the Transfer of Copyright agreement before the article can be published. This transfer agreement enables Elsevier to protect the copyrighted material for the authors, but does not relinquish the authors' proprietary rights. The copyright transfer covers the exclusive rights to reproduce and distribute the article, including reprints, photographic reproductions, microfilm or any other reproductions of similar nature and translations. Authors are responsible for obtaining from the copyright holder permission to reproduce any figures for which copyright exists."}