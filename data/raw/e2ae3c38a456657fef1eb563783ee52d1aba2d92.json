{"title": "A Poisson model of sequence comparison and its application to coronavirus phylogeny", "body": "One of the fundamental tasks in bioinformatics is sequence comparison, which is used heavily in database searching, sequence classification, phylogenetic tree reconstruction and detection of regulatory sequences. In most cases, alignments are performed between the target sequences by dynamic programming techniques and the resulting alignment scores are used to calculate a measure of similarity. Meanwhile, especially in recent years, an increasing number of alignment-free methods have emerged [1] [2] [3] [4] . In contrast to traditional alignments, these alignment-free methods mostly (i) make few assumptions of the evolutionary model and (ii) present light computational load. With the first merit, alignment-free methods do not suffer greatly from some evolutionary events, e.g., large rearrangements and transposon activity. While the second merit enables broad contributions of alignment-free comparisons in pre-filtering relevant sequences, and then using alignment algorithms to refine the searches. This type of heuristic approach is already used in programs like BLAST [5] and FASTA [6] . Additionally, after the completion of many genome projects, alignment-free comparisons begin to find their use in whole genome phylogeny, which meets great computational and theoretical challenges using alignment-based methods.\n\nSequence comparison based on word statistics may be the most well-developed alignment-free method. Observing that relative abundances of all dinucleotides are remarkably constant across the genome, Karlin et al. [7] [8] [9] proposed the 'genome signature' to describe a genome. The 'signature' consists of the array of dinucleotide relative abundances q xy \u00bc f xy =f x f y extended over all dinucleotides, where f x is the frequency of nucleotide x and f xy is the frequency of dinucleotide xy. In the same manner, genome signature based on abundances of k-nucleotides can also be defined. Reinert et al. [10] studied the statistical and probabilistic properties of words in sequences, with emphasis on the deductions of exact distributions and evaluation of its asymptotic approximations. Word-based comparisons were recently reviewed by Vinga and Almeida [2] . According to their work, biological sequences are first represented as frequency vectors in Euclidean space, and then pairwise distances between these sequences can be defined as the standard Euclidean distance, Mahalanobis distance, linear correlation coefficient or Kullback-Leibler discrepancy between their corresponding vectors. As another powerful tool for sequence analysis, some graphical representations of DNA or protein sequences are also based on statistics of short words [11, 12] .\n\nIn this paper, we propose two distance measures for biological sequences on the basis of word statistics. Instead of comparing the frequencies or relative compositions of each word type in two sequences, we explore two measures in the probabilistic framework. Some basic concepts and our computational methods are introduced in the following section. To illustrate our method, in Section 3, similarity trees of 25 virus genomes are built by some classical distances and our methods.\n\nA sequence S, of length l, is defined as a linear succession of symbols from a finite alphabet A, of length n. A k-word (or kmer, k-tuple, etc.) x \u00bc a 1 a 2 \u00c1 \u00c1 \u00c1 a k is a subsequence of k adjacent letters, a i 2 A; i \u00bc 1; 2; . . . ; k. Obviously, there are a total of n k possible k-words for the alphabet A. The occurrence of x (denoted by N x ) is the number of times it is seen through sliding a window of width k once across the sequence, and frequency of this word f x is obtained by simply dividing the total number of words (i.e., f x \u00bc N x =\u00f0l \u00c0 k \u00fe 1\u00de). Given a symbol sequence, we can represent it as a point in the high dimensional Euclidean space by a mapping from S to the vector of its word counts, or frequencies:\n\n. . . ; f x n k \u00de: To evaluate the distance between two sequences, it is intuitive to compute the norm of the difference between their corresponding frequency (or occurrence) vectors,\n\nwhere f 1;x i and f 2;x i are frequencies of the word x i in sequences S 1 and S 2 , respectively. The norm gives mathematically well defined distance functions for all positive values of p. Here p \u00bc 1 gives the Manhattan distance, which was used in [7, 13] ; p \u00bc 2 gives the Euclidean distance [14] ; p \u00bc 1 gives the max-norm (where only the largest absolute value contributes). However, these simple distances are not satisfying for an accuracy phylogeny, because (i) they treat all word types equally, despite that they have different background frequencies, and (ii) contribution of a word may not merely be a polynomial function of the frequency difference. In order to overcome the above problems, the Mahalanobis and standard Euclidean distance, which take into account the data covariance structure, were proposed for sequence comparison relatively recently [15] . In this paper, we will propose two distance measurements free of such problems by using a probabilistic framework.\n\nThe most immediate model for word occurrences is the binomial distribution, i.e., each word x has the same probability p to appear at any word location. When p is very small, sequence length l is sufficiently large, and the value of lp is moderate, the occurrences of x in this sequence approximately follow the Poisson distribution with the parameter lp. In what follows we will explore two distance metrics on the basis of the Poisson distribution of word occurrences.\n\nFor simplicity, we assume that S 1 and S 2 have the same length l (or else we can normalize one of them). Occurrences of word x i in these two sequences are denoted by N 1;x i and N 2;x i , respectively. In the first step, we use S 1 to estimate the Poisson parameter.\n\nKnown that the parameter k of Poisson model is equal to the expectation of the variable (word occurrence, in our model), we\n\nwhere Poi\u00f0k; k\u00de is the Poisson probability with parameter k,\n\nActually, RP x i \u00f0S 1 ; S 2 \u00de measures a kind of 'similarity' between S 1 and S 2 in terms of the occurrences of x i (note that it is not a strict similarity measure as it is not symmetrical). Explicitly, low values of RP x i correspond to the relatively large discrepancies in occurrences of the word x i , and the maximum value is gotten when\n\nTaking all words into consideration, the final distance between S 1 and S 2 is defined\n\nHere the two terms RP x i \u00f0S 1 ; S 1 \u00de and RP x i \u00f0S 2 ; S 2 \u00de are introduced to guarantee the positivity of d RP \u00f0S 1 ; S 2 \u00de (note that\n\nSince RP x i \u00f0S 1 ; S 2 \u00de measures the probability to observe N 2;x i times of x i in sequence S 2 in the condition that the average occurrence is N 1;x i , we refer to d RP as the Relative Poisson distance between S 1 and S 2 .\n\nIn the above subsection, we consider only one Poisson modelparameter of this model is estimated by one sequence, and pairwise similarity is evaluated by the probability of generating the other sequence under this model. In this part, the occurrences of word x i in sequences S 1 and S 2 follow two different Poisson distributions (with parameters k 1;i and k 2;i , respectively). Define\n\nwhere N 1;x i is the occurrence of x i in S 1 . Exp 1;x i is the probability of observing 6 N 1;x i occurrences of x i in sequence S 1 . Note that a word is called highly expressed if its observed frequency is more than its expected frequency, and called low expressed otherwise. In this sense, the probability Exp 1;x i measures a level of expression -low value of Exp 1;x i corresponds to low expression of word x 1 , and large value of Exp 1;x i corresponds to high expression of the word x 1 in sequence S 1 . We define the final distance between S 1 and S 2 as\n\nNow, to compute d Exp \u00f0S 1 ; S 2 \u00de we need to determine k 1;i and k 2;i for each word in each sequence. Note that the Poisson parameter for a word is actually its expected occurrence, which can be obtained immediately by multiplying the expected frequency (or background frequency) by the total number of words. We now only need to determine the background frequency of each word. To achieve this aim, two approaches are tried. The first approach corresponds to independence of nucleotides in the sequence, i.e., background frequency of the word x is estimated by the product of the corresponding nucleotide frequencies in this sequence,\n\nwhere f a i \u00f0i \u00bc 1; 2; . . . ; k\u00de is the frequency of the letter a i in this se-\n\nquence. An alternative method for estimating the background frequency of a word was proposed by Qi et al. [16] , who applied a Markov model of DNA sequences of order k \u00c0 2. The expected frequency of a word is predicted from the probabilities of appropriate shorter subwords\n\nwhere f a 1 a 2 \u00c1\u00c1\u00c1a k\u00c01 is the frequency of the \u00f0k \u00c0 1\u00de-word a 1 a 2 \u00c1 \u00c1 \u00c1 a k\u00c01 in the corresponding sequence. Then for each background probability estimated by Eqs. (5) and (6), the corresponding Poisson parameter is\n\nThe distance d Exp has the following properties: (i) d Exp \u00f0S 1 ; S 2 \u00de P 0 and d Exp \u00f0S 1 ; S 1 \u00de \u00bc 0, for any sequences S 1 and S 2 ; (ii) background information (or frequencies of shorter words) is incorporated into the measurement; and (iii) words with identical frequency and occurrence in two sequences may contribute to d Exp , i.e., they may have different background frequencies and expression levels.\n\nWhen k is large \u00f0k > 50\u00de, however, it is difficult to obtain the accurate Poisson probability by Eq. (1) using personal computers.\n\nExplicitly, as e \u00c0k is very small and k k is very large in the numerator, mistakes may be made if they are multiplied directly. In order to overcome this difficulty, another two executive approximations of Poisson probability in the case of large k are tried: (i) Stirling for- \n\nCoronaviruses are the causative agents of a number of mammalian diseases which often have significant economic and health-related consequences [17, 18] . On the basis of antigenic cross-reactivity, coronaviruses were originally classified into three groups. Group I and group II contain mammalian viruses (while group II coronaviruses contain a hemagglutinin esterase gene homologous to that of Influenza C virus [19] ), and group III contains only avian viruses. After the outbreak of severe acute respiratory syndrome coronavirus (SARS-CoV) in 2003, many efforts have been made to identify the phylogenetic positions of SARS-CoVs in the coronavirus phylogeny. However, this is still a controversial topic -alignment-based methods showed that SARS-CoVs are not closely related to any previously isolated groups and form a new group [20, 21] ; maximum likelihood tree built from a fragment of the spike protein preferred SARS-CoVs clustering with group II coronaviruses (murine hepatitis virus and rat coronavirus) [22] ; while an information-based method, which made use of the whole genome sequences, indicated that the SARS-CoVs should not be classified as a new group but close to the group I coronaviruses [23] .\n\nIn this paper, we select 25 complete virus genomes: 12 coronaviruses from the three isolated typical groups, 12 SARS-CoV strains, and a torovirus, which serves as the outgroup for coronaviruses [24] (data are shown in Table 1 ). In order to validate our method, distance matrices for the same data set are also constructed using some classical dissimilarity measurements, e.g., the standard Euclidean distance [15, 25] , linear correlation coefficient [26] , Kullback-Leibler (KL) discrepancy [3] and the Composition Vector approach [16, 27] . Note that the Kullback-Leibler discrepancy between two frequency vectors is not symmetrical and will give degenerate results when some word types are absent, we use a re-vised version -the Weighted Sequence Entropy (WSE) [28] . This modification works equivalently with the KL discrepancy in the case of short words, and can effectively avoid the degeneracy for long words. The string Composition Vector (CV) approach proposed by Hao's group is a fast and efficient approach to whole genome comparison and phylogenetic analysis. For each k-string x, define\n\nwhere f x is the frequency of word x in a genomic sequence, and f x is its expect frequency under a certain background model (Markov model of k \u00c0 2 order). Then collect CV x for all possible x as components to form a composition vector. The final distance between two species is evaluated based on the cosine function between their corresponding composition vectors. After calculating the pairwise distance matrices, phylogenetic trees for the 25 viruses are built by the UPGMA and NJ programs in the PHYLIP package. Then, rooted phylogenetic trees are drawn by the TREEVIEW program [29] . The UPGMA tree built by the standard Euclidean distance is shown as Fig. 1(1) . This tree supports torovirus as the outgroup of all coronaviruses, but fails to cluster three group I coronaviruses -HCoV-229E and PEDV are grouped together, but TGEV is much closer to the SARS clade. Fig. 1 (2) is the NJ tree constructed by the Euclidean distance. Similar to the UPGMA tree, this tree also prefers SARS-CoVs clustering with TGEV. But an obvious defect is that it does not successfully cluster the eight group II coronaviruses. In Fig. 2 , we list the trees built by linear correlation coefficient between pairwise frequency vectors. Fig. 2(1) is the UPGMA tree. This tree perfectly clusters species within each typical group, and confirmed SARS-CoVs paraphyly. But it fails to identify the outgroup status of torovirus relative to coronaviruses. While the NJ tree ( Fig. 2(2) ), in which torovirus is selected as outgroup species, confirms the adjacent relationship of SARS-CoVs with group I viruses. In the tree built from our distance measure d Exp (Fig. 3) , all above defects are eliminated, i.e., species of each typical groups cluster, and torovirus stays outside of all coronaviruses including SARS-CoVs. Our tree shows that SARS-CoVs are not closely related to any previously isolated coronaviruses and form a new group, but do not support the outgroup status of SARS-CoVs relative to other coronaviruses, as proposed by Zheng et al. [30] . This result is mainly in accordance with the WSE tree at word order k \u00bc 6 ( Fig. 4 ) and the NJ tree constructed by the Composition Vector method (Fig. 5) . Moreover, it is also supported by the experimental evidence, which showed that group I coronaviruses specific antibodies are able to recognize antigens in SARS-CoV infected cultured cells [31] .\n\nIn order to further validate our algorithm, we use the complete mtDNA sequences of 20 Eutherian mammals selected by Otu and Sayood as our second dataset [32] . This dataset consists of seven Primates, eight Ferungulates, two Rodents and three non-placental mammals. Their corresponding GenBank Accession Codes are as follows:\n\nPrimates: Human (Homo sapiens, V00662), common chimpanzee (Pan troglodytes, D38116), pigmy chimpanzee (Pan paniscus, D38113), gorilla (Gorilla gorilla, D38114), orangutan (Pongo pygmaeus, D38115), gibbon (Hylobates lar, X99256) and baboon (Papio hamadryas, Y18001). Ferungulates: Horse (Equus caballus, X79547), white rhinoceros (Ceratotherium simum, Y07726), harbor seal (Phoca vitulina, X63726), gray seal (Halichoerus grypus, X72004), cat (Felis catus, U20753), fin whale (Balenoptera physalus, X61145), blue whale (Balenoptera musculus, X72204) and cow (Bos taurus, V00654).\n\nRodents: Rat (Rattus norvegicus, X14848) and mouse (Mus musculus, V00711). Non-placental mammals: Opossum (Didelphis virginiana, Z29573), wallaroo (Macropus robustus, Y10524) and platypus (Ornithorhyncus anatinus, X83427).\n\nWe applied the proposed distance measurements to the complete mitochondrial genomes listed above. In Fig. 6 , we list the UP-GMA tree constructed by the distance d Exp with background frequencies estimated by Eq. (6) . As is seen from this figure, three main groups of placental mammals, namely Primates, Ferungulates and Rodents, cluster accordingly, and three non-placental mammals stay outside of all other species. This topology is in perfect agreement with that given by Otu and Sayood except for the position of rodents (mouse and rat). However, the relationship among the three main groups of placental mammals is still a controversial Table 1 Coronaviruses and a torovirus used to constructed phylogenetic tree. topic in molecular genetics [33] . Different types of molecular data and analysis methods result in different trees. By the maximum likelihood method, some proteins support the Ferungulates (Pri-mates, Rodents) grouping while other proteins support the Rodents (Ferungulates, Primates) grouping [34] . Whereas our result suggests an alternative topology of Primates (Ferungulates, Ro- dents). In addition, we also applied some other word-based metrics mentioned above (the standard Euclidean distance, linear correlation coefficient and KL discrepancy) to the same dataset, but they did not give competitive results (not shown in this paper).\n\nWith the completion of many genome projects of Prokaryotes and Eukaryotes, genome level phylogeny constructions are available and expected to be more reliable compared to traditional experiments on only a single gene or a fragment of genome. However, multiple sequence alignment of genomic sequences is still a bottleneck, first due to the computational time, and second due to the inherent model assumptions. Therefore, there is a great need to develop new sequence comparisons free of these problems. In recent years, a quantity of alignment-free methods which are based on, e.g., k-words frequency [2] , graphical representations [35] [36] [37] [38] [39] [40] [41] [42] , and information contents [32, 43] , have been proposed. Nevertheless, compared to alignment methods, these methods are still in the premature stage.\n\nSequence comparison based on the genomic composition of short words may be the most widely studied alignment-free method. It has relatively low computational complexity, and does not suffer greatly from genetic rearrangements and transposon activity, which serve as common ways of genome evolution. In most cases, biological sequences are represented as occurrence or frequency vectors in a high dimensional Euclidean space, and then the standard Euclidean distance, linear correlation coefficient, Kullback-Leibler (KL) discrepancy or cosine function between these vectors are calculated as measures of dissimilarity. In this paper, we investigate two word-based distance measurements in a probabilistic framework. Our hypothesis is that occurrence of a given word in a random DNA sequence follows the Poisson distribution. Then distance between two sequences is evaluated by the probability of generating one sequence under the Poisson model estimated from the other, or their different expression levels of words. In contrast to the traditional word-based distances, which use only frequencies of fixedlength words, our distances take background information of words (estimated by frequencies of some shorter words or the corresponding nucleotide composition) into account. In other words, our method has a potential to adjust the background information for distance measurements using composition vector. Through constructing phylogenetic trees of 25 viruses including SARS-CoVs and 20 Eutherian mammals, we find that our method gives a more competitive result compared to the ongoing word-based methods.\n\nIt is detected that each component CV x of the string Composition Vector is also a measure of expression in terms of word x.\n\nIn Eq. (7), the numerator f x \u00c0 f x is the deviation of the observed frequency from the expected value, and denominator is introduced to eliminate the size effect. However, different from our measure (Eq. (3)), the value of CV x may be affected by those words with very low background frequency, i.e., when f x is very small, the corresponding CV x will be very large. While our measure is free of this problem as it ranges from 0 to 1. In other words, our method can avoid the noise accompanied by words with exceptional background frequencies.\n\nHowever, compared to those word-based measurements which consider only composition vectors, our distances have relatively high computational costs. For example, occurrences of many words are much higher than 60 in some bacterial genomes (when k \u00bc 10), which makes our Poisson-based distances computationally infeasible. So a reliable and efficient approximation of Poisson probability is critical to our method. In addition, the accuracy of our approach depends strongly on the Poisson model of word occurrences. This assumption is generally valid when the sequence length is suffi- Fig. 6 . The UPGMA tree built from the complete mtDNA sequences of 20 mammals. We use the distance metric dExp, and background frequencies of words are estimated by the Markov model of order k \u00c0 2. ciently large. But for words with overlapping structure, e.g., TATATA and CCGCCG, their occurrences in a random sequence may vary significantly from the Poisson distribution. While at the same time, experiments showed that these self-overlapping words are more prone to be functional patterns in regular regions of genomes. In the future study, we will explore some models to describe and compare these words."}