{"title": "Measurability of the epidemic reproduction number in data- driven contact networks SI Appendix", "body": "We developed a synthetic population of about 500,000 individuals resembling a subsample of the actual Italian population according to basic sociodemographic indicators (e.g., age structure, household size, employment rates, workplace size distribution, school attendance, school size distribution). We used the same algorithm we developed to infer contact patterns in the European populations [1] . As such, we refer the reader to Fumanelli et al. [1] for all technical details.\n\nBriefly, the obtained synthetic population allows us to define a multilayer network of contacts that can be used to model the infection of the influenza virus in the population. Each layer represents one of the main four settings where influenza transmission occurs, namely households, schools, workplaces, and the general community [2, 3, 4] . The household layer is composed by n h disconnected components, each one representing one household (i.e., the total number of households is n h ). Each household is composed by a certain amount of nodes, each one representing one single individual. The amount of nodes in each household is determined by sampling from the actual Italian household size distribution. An age is associated to each node by sampling from the actual Italian age distribution by household size using an algorithm tailored to match realistic age-gaps between household members (details in Fumanelli et al. [1] ). Each node lives also in the community layer, which is composed by one single giant fully connected component. By sampling from the multinomial distribution of schooling and employment rates by age, for each node is determined whether it also lives in the school or workplace layer. Analogously to what has been described for the household layer, the workplace layer is composed by n w disconnected components, each one representing one workplace. The number of nodes in each workplace is sampled from the actual Italian workplace size distribution. The school layer is composed by n s disconnected components, each one representing one school. The number of nodes in each school is sampled from the actual Italian school size distribution by school level (e.g., pre-school, primary school, middle school, high school). Details in Fumanelli et al. [1] .\n\nAnalogously, by using sociodemographic data specific for The Netherlands, we developed a multilayer network resembling a sample of about 500,000 individuals of the actual Dutch population.\n\nWe describe the influenza transmission process as a discrete-time Susceptible-Infectious-Removed (SIR) model with time-step t (corresponding to 1 day). Two types of transitions between states are possible: i) from susceptible (S) to infectious (I), and ii) from infectious (I) to removed (R).\n\nTransition from S to I. Given that at time-step t node j is infectious and its neighbor node i is susceptible, the probability that j infects i (i.e, i changes its status from S to I) is given by:\n\nwhere \u2022 p is the transmission probability per contact (day \u22121 ).\n\n\u2022 w l is the contact weight in layer l, l \u2208 L = {h, s, w, c}, where L is the set of layers; h, s, w, and c represent household, school, workplace, and general community layers, respectively. Note that w l embeds also the cluster size in that layers; for instance in the community w l can be interpreted as\u0175 l /(N \u2212 1) where N is the number of individuals in the community and\u0175 l is the specific wight of one contact in the community.\n\n\u2022 a i is the age of individual i.\n\n\u2022 \u03c1(a i ) is the age-dependent susceptibility to infection.\n\nNote that when node j infects node i at time-step t in layer l, we store all this information that will be useful for the computation of the reproduction number and the generation time.\n\nTransition from I to R. Given that at time-step t node i is in the infectious state, it has a probability \u03b3 to recover at time-step t + 1.\n\n2009 H1N1 influenza pandemic At the beginning of each simulation, for each node i of age a i , we determine whether it is initially susceptible or removed by sampling from a Bernoulli distribution with probability P (a i ), where P (a) is the fraction of seropositive individual of age a as observed before the 2009 H1N1 pandemic in Italy [5] . Simulations are initialized with one infectious individual and no further introductions of index cases is assumed. One of the most striking features of the 2009 H1N1 influenza pandemic, observed in several studies focusing on different countries around the globe, was the presence of an age-specific susceptibility to infection, which was remarkably higher for young individuals (mainly corresponding to school-age individuals) [4, 5, 6, 7, 8, 9, 10] . In our model we use the estimates of age-specific susceptibility rates specific for the Italian population [5] : As direct estimates of the layer-specific transmission rates, we estimated them on the basis of agespecific seroprevalence data collected in Italy after the end of the 2009 H1N1 influenza pandemic [5] . Since the per-contact transmission probability p and the four layer-specific transmission rates w l are multiplying factors in Equation (1) (and thus cannot be estimated simultaneously), we fixed p = 1 and estimated w h , w s , w w , and w c .\n\nThe calibration of layer-specific transmission rates is performed by using Markov chain Monte Carlo (MCMC) sampling applied to the binomial likelihoods (L) of the age-specific prevalence of H1N1 antibodies observed in the Italian population after the end of the 2009 H1N1 influenza pandemic [5] . We define \u0398 = (w h , w s , w w , w c ) to be the vector of parameters to be estimated by MCMC and the likelihood function as\n\n\u2022 M is the set of age groups considered in [5] , namely 0-4, 5-19, 20-64, and 65+ years old;\n\n\u2022 n m is the number of individuals in the m-th age group in the dataset;\n\n\u2022 r m is the number of seropositive individuals (haemagglutination inhibition titre 1:40 or more) in the m-th age group in the dataset of Ref. [5] ;\n\n\u2022 \u03b1 m (\u0398) is the fraction of removed individuals at the end of the pandemic in the m-th age group as resulting from model simulation performed by using parameter set \u0398.\n\nThe posterior distribution of \u0398 is determined using random-walk Metropolis-Hastings sampling [11] . We performed 50,000 simulations and considered a burn-in period of 2,000 iterations. We assume no a priori knowledge on model parameters (i.e., flat prior distributions). Convergence was checked by considering different starting points and by visual inspection (see Fig. S1A -E).\n\nThe estimated posterior distribution of \u0398 is reported in Fig. S1B -E.\n\n\"Uncharacterized\" future influenza pandemic. At the beginning of each simulation, we assume that the population is fully susceptible. Simulations are initialized with one infectious individual and no further introductions of index cases is assumed.\n\nIn the classic SIR model, the removal rate corresponds to the inverse of the generation time [12] . According to the literature, influenza generation time is about 3 days [8, 13, 14] . As such, we fix the removal rate \u03b3 to 1/3 days \u22121 , assuming that a future influenza pandemic will be characterized by a generation time similar to previous influenza pandemic and seasonal variants.\n\nPredicting the future values of the age-specific susceptibility rates during a future influenza pandemic event is not possible. As such, we decided to set \u03c1(a) = 1 for each age a, and thus \u03b2 i = \u03b2. An equally impossible task is to predict the values of the layer-specific contact rates. Therefore, we decided to fix these weights as proposed by Ferguson and colleagues by analyzing past influenza seasons [2, 3] . Following Ferguson and colleagues approach we set w l in such a way that, when simulating influenza pandemics with R index = 1.3 the fraction of the final infection attack rate related to contacts in households, schools, workplaces, and the general community is equal to 0.3, 0.18, 0.19, and 0.33. respectively. The value of R index (which is set to 1.3, in the ballpark for influenza [15] ) is obtained by empirically choosing the per-contact transmission probability p such that the average reproduction number of the index case, averaged over 10,000 simulations is equal to 1.3.\n\nNote that this scenario corresponds to the baseline scenario discussed in the main text.\n\nWe developed a configuration model with annealed order [16] . The degree distribution k characterizing this model is computed as follows. We consider the weighted number of contacts in each layer of the data-driven model describing the spread of an \"uncharacterized\" future influenza pandemic. Specifically, the weighted number of contacts of node i is l\u2208{h,s,w,c}\n\nwhere c l (i) is the number of edges node i has to other nodes in layer l. We set w l such that, when simulating influenza pandemics with R index = 1.3 with the above described data-driven model, the two following conditions hold: i) the fraction of the final infection attack rate related to contacts in households, schools, workplaces, and the general community is equal to 0.3, 0.18, 0.19, and 0.33, respectively; and ii) the average of the degree distribution k is\n\nwhere N is the total number of nodes, and 19.8 is the number of face-to-face contacts recorded in the POLYMOD survey for Italy [17] . The degree distribution of the resulting network is shown in Fig. S2 .\n\nAs for the data-driven model, we use the annealed configuration model to simulate influenza spread according to a discrete-time individual-based SIR model with time step t = 1 day.\n\nTransition from S to I. Given that at time-step t node j is infectious and its neighbor node i is susceptible, the probability that j infects i (i.e., i changes its status from S to I) is given by the transmission probability per contact p (expressed in day \u22121 ). As for the data-driven model, when node j infects node i at time-step t, we store this information useful for the computation of the reproduction number and the generation time.\n\nTransition from I to R. Given that at time-step t node i is in the infectious state, it has a probability \u03b3 to recover at time-step t + 1.\n\nAt the beginning of each simulations we assume that the population is fully susceptible. Simulations are initialized with one infectious individual and no further introductions of index cases is assumed. We fix the removal rate \u03b3 to 1/3 days \u22121 . We fix the per-contact transmission probability p such that R index = p k \u03b3 = 1.3\n\nWe developed a homogeneous mixing model [18] . Basically, all nodes are identical and the network is fully connected (i.e., each node has N \u2212 1 neighbors, where N is the size of the population).\n\nInfection transmission process, model calibration, and initialization are exactly the same for the annealed configuration model.\n\nThe structure is exactly the same of the one for the annealed configuration model; the only difference is that, instead of annealed, the network of contacts is quenched. In other words, the neighbors of all nodes remain unchanged for the entire duration of the simulation. This model misses the random component of the data-driven one, but preserve the degree and the topological correlation of the static realization of the configuration model.\n\nInfection transmission process, model calibration, and initialization are exactly the same for the annealed configuration model.\n\nLayer-shuffled data-driven model\n\nThe structure is exactly the same of the one for the data-driven model; the only difference is that, the edges connecting different layers are shuffled, thus destroying the multiplex structure of the network.\n\nInfection transmission process, model calibration, and initialization are exactly the same for the data-driven model.\n\nThe basic reproductive number (R 0 ) is the average number of secondary cases generated by a typical infectious individual over the entire course of the infection in a fully susceptible population [18] . Its counterpart over time, the effective reproduction number (R(t)), is the number of secondary cases generated by an infectious individual at time t (and it does not require the hypothesis of a fully susceptible population) [19] .\n\nWe define also the reproduction number in layer R l as the average number of secondary infections generated by a typical infectious individuals over the entire course of the infection in layer l. From model(s) simulations we can compute R l as\n\nwhere \u2022 I(t) represents the set of infectious nodes that acquired the infection at time t;\n\n\u2022 |I(t)| represents the number of elements of set I(t);\n\n\u2022 C l (i) represents the number of infections generated by infectious node i in layer l, l \u2208 L = {h, s, w, c}.\n\nTherefore, the overall reproduction number R(t) at time t is given by\n\nThe generation time T g is defined as the average time interval between the infection time of infectors and their infectees [12] . Analogously to what we did for the reproduction number, we also define the generation time in each layer T g l as the average time interval between the infectors and their infectees occurred in layer l. From model(s) simulations we can compute T g l as\n\nwhere \u2022 I(t) represents the set of infectious nodes that acquired the infection at time t;\n\n\u2022 C l (i) represents the number of infections generated by infectious node i in layer l, l \u2208 L;\n\n\u2022 I l (i) represents the set of nodes that individual i infects in layer l;\n\n\u2022 \u03c4 (j) is the time when node j acquires the infection.\n\nTherefore, the overall generation time T g(t) at time t is given by\n\nAs shown in the main text, we found that on average R increases over time in the early phase of the epidemic obtained by simulating the data-driven model. This is a common pattern to about 80% of all the performed simulations in the case of an \"uncharacterized\" future influenza pandemic in Italy (Fig. S3A ) and to about 50% of all simulations in the scenario concerning the 2009 H1N1 pandemic influenza in Italy (Fig. S3B) . \n\nWe checked the relation between the reproduction number and the average weighted degree of the infected nodes by simulating the data-driven model for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic in Italy. Results are shown in Fig.S4 . Figure S5 shows the dynamics of R(t) and T g(t) as obtained by simulating the data-driven model calibrated on the 2009 H1N1 influenza pandemic in Italy. Results are aligned at the epidemic peak, which corresponds to time t = 0. B As A, but R(t) is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t).\n\nCross-country comparison of the dynamics of R(t) and T g(t) as obtained by simulating an \"uncharacterized\" future influenza pandemic with the data-driven model assuming the synthetic population of Italy and of The Netherlands. For both countries we use the same parameters regulating the infection transmission process (e.g., the layer-specific transmission rates and the removal rate). Results are shown in Fig.S6 . Figure S6 : A Comparison between the mean R(t) of data-driven model by using the Italian and the Dutch populations for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic. B As A, but R(t) is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t).\n\nCross-country comparison of the dynamics of R(t) and T g(t) as obtained by using the datadriven model assuming the synthetic population of Italy and of The Netherlands. For both countries we use the same parameters regulating the infection transmission process (e.g., the layer-specific transmission rates and the removal rate) as obtained by calibrating the model for Italy to reproduce the spread of the 2009 H1N1 influenza pandemic in Italy. Results are shown in Fig.S7 . A B C D Figure S7 : A Comparison between the mean R(t) of data-driven model by using the Italian and the Dutch populations for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic. B As A, but R(t) is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t).\n\nWe checked the robustness of our findings with respect to changes in transmissibility of the infection, measure in terms of R index . Figure S8 shows the obtained results for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic in Italy as resulting from the simulation of the data-driven model. is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t).\n\nWe checked the robustness of our findings with respect to changes in the distribution of the removal time. Figure S9 shows the obtained results for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic in Italy as resulting from the simulation of the data-driven model. \n\nTg S (t) (days)\n\nTg C (t) (days) Figure S9 : A Mean R(t) of data-driven model by assuming two different distributions of the removal time (namely exponential and gamma) whose average is equal to 3 days in both cases. Note that the gamma distribution we used has shape parameter 2 and scale parameter 1.5. B As A, but R(t) is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t).\n\nTo understand the main determinants of the observed patterns of R(t) and T g as resulting from the simulations of the data-driven model, we compare the data-driven model outcomes with those obtained by simulating a fully homogeneous mixing model and three alternative null models preserving the nodes' degree distribution. Specifically, the proposed null models are:\n\n\u2022 Annealed configuration model: a model with annealed disorder and degree distribution derived from the data-driven model;\n\n\u2022 Quenched configuration model: a model having the same network of contacts as the annealed configuration model, but with completely static connections;\n\n\u2022 Layer shuffled data-driven model: a model having the same network of contacts on each layer but with reshuffled interlayer connections.\n\nDetails on the implementation of these models are reported in Sec. 1.2, 1.4, and 1.5 of this Supplementary Material file. Our analysis of R(t) reveals that the annealed configuration model and the layer-shuffled model exhibit behavior very close to the homogeneous mixing model (see Fig. S10A ). Indeed, the same temporal trend of R(t) can be observed in all layers, close to what happens for the data-driven model in the community layer (Fig. S10B) . It is worth recalling that, although those models keep the degree distribution statistically equivalent to that of the data-driven model, the stochastic rewiring destroys temporal and topological correlations. The quenched configuration model, freezes the topological correlations of the model in time, and shows some deviations from the homogeneous model in terms of R(t), although not as marked as in the data driven model. This suggests that the pattern observed in the data-driven model can be explained by the contact structure of the actual population.\n\nAlso, regarding T g evolution over time, the annealed configuration model and the annealed data-driven model show the same behavior as the homogeneous mixing model (see Fig. S10C ). The quenched configuration model shows a decrease of T g only immediately before the epidemic peak, when the number of individuals that are infectious at the same time is higher and thus the competition to find susceptible nodes to infect is also higher (Fig. S10C) . This is fairly different from the dynamics of the data-driven model that, mainly due to the consistently high competition in households, workplaces, and schools, shows a clear shortening of T g since the beginning of the epidemic (see Fig. S10C and D) . Similarly to what we saw for R(t), none of the T g(t) patterns observed for the data-driven model are present when the configuration is annealed (Fig. S10D) , although in the annealed data-driven model the contact structure is preserved. and of three null models for the scenario representing the spread of a \"uncharacterized\" future influenza pandemic in the Italian population. B As A, however R(t) is broken down in the four layers. C As A, but for T g(t). D As B, but for T g(t). Figure S11 shows the comparison between R(t) as inferred from the time-series of cases and as resulting from the microsimulation data of the transmission chain for two stochastic model realizations. Tg empirical distribution over time directly estimated from the transmission tree inferred from incidence data (mean, 95% CI) directly estimated from the transmission tree inferred from incidence data (mean, 95% CI) A B Figure S11 : A Daily R(t) as inferred from the daily incidence of new infections for one stochastic model realization. T g is assumed to be: exponentially distributed with average 3 days (top); the distribution of T g has been derived from the analysis of the transmission tree of the selected model simulation (middle); the distribution of T g over time as derived from the analysis of the transmission tree of the selected model simulation (bottom). B as A, but for another stochastic realization. The two stochastic realizations used to produce this figure as well as Fig. 5 of the main text are randomly selected among the simulations run for scenario \"Uncharacterized future influenza pandemic in Italy\"."}