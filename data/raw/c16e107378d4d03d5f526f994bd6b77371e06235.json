{"title": "Web-based electronic patient records for collaborative medical applications", "body": "During the past years, using PACS (picture archiving and communication system) diagnostic workstations and Web technologies as a means to access digital image data have been implemented with different architectures [1, 2] . Also, more and more multi-media medical documents or records are used in hospitals and medical community, and these documents usually are stored in different formats or systems. Most medical applications need to access these medical documents through intranet or internet. Also, there are a lot of collaborative medical applications needing to share or interactively exchange medical information through the networks [3, 4] .\n\nCollaborative medical applications are often happened in some medical practices, procedures and education encounters. For example, local and remote doctors collaboratively discuss cases in telemedicine procedures [5, 6] . Medical students or residents study or learn cases from medical experts through network [7] . For infection diseases, physicians and experts in different departments or areas of an infection control hospital can study patient records collaboratively through networks without the concern of being infected. They can concentrate in case discussion with patient medical records combining with image manipulation, and show results to remote participants through the network. 0895 For more difficult or complicated cases, the medical record usually contains medical images with other related records, which come from hospital information system (HIS) and other clinical information systems (CIS). For these reasons, the medical imaging informatics research and applications trends are to develop and build electronic patient record (EPR) with images for medical applications [8] , and this effort will benefit the hospitals and medical institutions on their collaborative healthcare activities.\n\nIn this paper, we first review our previously developed interactive teleradiology system architecture, and discussed its advantages and disadvantages in collaborative applications. Second, we present a new design of web-based interactive system architecture and its major components, which support EPR display and manipulation and operate in a central mode for collaborative applications. The new system can be integrated with PACS and other hospital clinical information systems, and provides a web interface to allow access to the EPR either through intranet or Internet for different applications. Third, we discuss the work and data flows of the web-based EPR system in collaborative applications. We also present the advantages of using the central operation mode for the collaboration comparing to the point-to-point mode. Finally, we give an example of the how the new web-based EPR system was used in collaborative application for SARS (Severe acute respiratory syndrome) diagnosis.\n\nSeveral years ago, we developed a cost-effective realtime teleconsultation system in a clinical DICOM PACS environment for collaborative health care application [5] . This system consisted of two sites: a referring physician site and an expert center, for point-to-point teleradiology service mode [5] . Both sites could display all the DICOM images and could remotely synchronize image manipulation during consultation using remote dual cursors. This system allowed real-time collaborative consultation of serious or difficult cases with high resolution and large volume medical images in a limited bandwidth network environment. The system relied both on standardized technologies, such as DICOM and TCP/IP network protocols, and on innovative techniques such the advanced message routing concept for remote control functionality. Also the dual cursors of the system could synchronize their operation and image processing results to make both participants feel no distance barrier and no misunderstanding between them during image study. Fig. 1 shows the basic architecture of this real-time interactive teleconsultation system.\n\nHowever, there are two drawbacks in this system. First, it only supported DICOM image consultation, and could not receive other medical records. Secondly, the consultation operation mode was point-to-point, it would make collaborative application more complicated if third party was interested in or invited into the collaborative applications. This was because the system had to re-send images to a third party. In order to overcome these drawbacks, we design and develop a new web-based system to provide electronic patient records (EPR) collaboration with several new functionalities including a central operation mode for intranet and internet healthcare providers. \n\nThere are three major components in the designed EPR collaborative system: EPR gateway (EPR-GW), EPR server (EPR-Server) including the EPR repository server and web server, and EPR Web viewer (EPR-Viewer). Currently, there are two typical application architectures used in networked information systems: two tiers client/server (C/S) architecture and three tiers browser/servers (B/S) architecture. In order to avoid the drawback of the point-topoint, we designed the EPR collaborative system by using the combination of the C/S and B/S architectures, as shown in Fig. 2 . The EPR data acquisition from the HIS/PACS/CIS to EPR gateway and the data transmission from the EPR gateway to EPR server adopt C/S architecture. The EPR data delivery from the EPR server to EPR Viewers uses the B/S architecture. The EPR data acquired from the HIS, PACS or CIS first have to pass to the EPR gateway to check their patient and study headers information to make sure the medical records of same patient linked together to provide patient-oriented applications. Then, the EPR data are sent to EPR server. Most medical records are in DICOM formats such as images, graphics, curves and RT records, but the text-based records are in XML (The Extensible Markup Language) format. The collaboration operation on the EPR data between any two web users is follows the central mode which means that all the consulted medical records would be sent to, managed and retrieved from the central EPR server. In Section 4, we will present the work and data flows of this web-based collaborative consultation system to explain how it works.\n\nThere are two parts in the EPR server: EPR repository server and web server. The EPR repository server uses Oracle object relational database (Enterprise Edition 9i) storing patient electronic medical records. It uses the general DICOM information object model as EPR information model to manage the medical records in the database. In order to manage other complex medical objects such as used in oncology treatment procedures, the information model also has the extension for radiation therapy (RT) objects defined by DICOM Standard. Fig. 3 shows the diagram of the data models used in our EPR database. The up-left part of the diagram relates to the general medical record management, e.g. DICOM images, reports, and other medical data, the down-right part covers the RT object management. We choose Microsoft Internet Information Server (IIS) as the web server, and the Internet Explore (5.0 or higher) as the default browser to be supported by our web-based EPR system. The web server provides http communication protocol interface to let users to access EPR by using Web browsers.\n\nWe use component software technology to develop a web-based image processing and display component to visualize and manipulate various DICOM images in a Web browser [9] . Since this component has an open and scalable architecture with multi-thread processing capability, we integrated multi-media display and manipulation modules and functions into this component to display the electronic patient records, as indicated in the Fig. 4 . We also introduced the remote control module, developed in our previous interactive teleradiology system [5] , into the display and processing component to enable this new component have collaborative operation functions with the EPR objects, such as using dual cursors to perform image manipulation and processing functions of window/level, zoom, overlay, orientation, and measurements. The remote control module sends and receives operation messages generated from local and remote sites, and dispatches the messages to multi-media display modules to synchronize their operations on the EPR objects. We integrate this new component into a Web browser to create web-based EPR Viewer, as we did it in our web-based PACS image distribution [9] . This allows users to use dual cursors, provided by the EPR viewer, to synchronize their operations to understand each other on studied cases. The communication relation between the web viewer and the web server is same with our web PACS [9] .\n\nThe data and work flows of the web-based EPR collaborative system presented in this paper are shown in Fig. 5 . There are three steps to view and play EPR objects for the collaborative applications. (1) The EPR data, retrieved from hospital PACS, HIS, and other clinical information systems, are sent to the EPR gateway for data formatting if they are not already in DICOM format or XML. (2) The image or DICOM based medical data are sent to the EPR Repository Server for archiving from EPR gateway. (3) . Any authorized Web user can access the EPR web server, by using the EPR Web viewer, to get the EPR data and to display them. Fig. 6 shows a GUI (graphic user interface) of the EPR Web viewer, which displays the ECG curve, DSA dynamic image, CT images, RT structure set of same patient.\n\nComparing to the point-to-point operation mode mentioned in Section 2 of this paper, the collaborative operation mode in this web-based EPR system can be considered as a central mode, since any user or a client gets the collaborative EPR data from the central EPR Server. Fig. 7 gives an example of how the system operates with three collaborative participants. First, the medical image, records or objects are sent to the EPR Repository Server from the client 1 through DICOM or TCP/IP protocol by using EPR gateway. Later on, client 2 or 3 can get the EPR data through http protocol from the web server and manipulate the data interactively with client 1, or between them by using the message routing and controlling function through the remote control module integrated in multimedia display and processing component. So, the collaborative operation procedures of the central mode are much simpler and easier comparing to the point-to-point mode. There is only one data authoring and sending operation before the data are ready to all potential participants.\n\nSevere acute respiratory syndrome (SARS) is a respiratory illness that has been reported in Asia, North America, and Europe. During the winter of 2002 through the spring of 2003, World Health Organization received reports of O8000 SARS cases and nearly 800 deaths. The main way that SARS seemed to spread is by close person-to-person contact. The virus that caused SARS was thought to be transmitted most readily by respiratory droplets (droplet spread) produced when an infected person coughed or sneezed. Most of the SARS cases in China occurred by infection in hospitals or among travelers. To protect the physicians, experts and nurses from the SARS during the diagnosis and treatment procedures, the infection control mechanisms were built in SARS hospitals in China, e.g. medical workers in SARS control area could not contact outside people and even medical records could not bring out the control area. Usually, there were three areas in the SARS hospital: the infection area, in which SRAS patients were stayed and taken cared by clinical SARS physicians; noninfection area, in which the radiologists and other experts of the hospital worked to support the SARS diagnosis and treatment happened in the infection area; and the data center where the HIS, PACS, CIS located. Also, there was an offsite SARS expert center out side the SARS hospital, where the other hospital experts can provide teleconsultation services to help the SARS hospital on SARS diagnosis and treatments. In order to make radiologists, physicians and experts both inside and out side control area collaborate efficiently on SARS image diagnosis without concerning the infection, we installed the web-based EPR system in a SARS hospital and an off-site expert center in Shanghai to provide tele-consultation for SARS diagnosis.\n\nThe web-based EPR collaborative system was implemented in Shanghai Infection Hospital and Shanghai Xinhua Hospital affiliated to the Second Shanghai Medical University in May 2003. The infection area and noninfection area were in Shanghai Infection Hospital, and the off-site expert center was in Xinhua Hospital, the distance of the two hospitals was about 10 km. There were three Web EPR viewers or clients installed in these two hospitals: two were located in the infection area and non-infection area of the Infection Hospital, and the third one was located in Xinhua Hospital, as shown in Fig. 8 . With the Web architecture and the intranet and Internet connections of the system to different clients located in side and out side hospitals, the real-time teleconsultation with interactive EPR manipulation could take place between any two sites of the infection area, non-infection areas, and off-site expert center.\n\nSince any medical record of SARS patients, such as paper record and films, was not allowed to bring out of infection area according to the infection control mechanism, the digital image acquisition and transmission were absolutely demanded in the diagnosis and consultation procedures. Although most images of SARS patients could be obtained directly from CT and CR modalities in situ, there were still a large quantity of film images, which were transferred from other hospitals accompanying with patients' arrival. We used a laser digitizer (Array, 2905, Japan) to digitize these film images and sent the digitized film images together with direct digital images to the webbased PACS for archiving. Fig. 9 shows the digitized film images of a SARS patient in the infection area of the Shanghai Infection Hospital. Most film sizes were 14! 17 in., and the image formats of digitized films were DICOM about 3560!4320!2 b (the grayscale was 12 bits). The size of one digitized film images was usually 29.3 Mb.\n\nImages transmitted inside SARS hospital were trivial with fast LAN (local area network) network connection for daily diagnosis and consultation between infection area physicians and non-infection area doctors. For the off-site consultation, all patient images had to be transmitted to the expert center through WAN (wide are network) before the consultation started. We used two WANs for image transmission, one was ATM network built by Shanghai local healthcare organization, and the other was ADSL owned by Shanghai Telecommunication Corp. The bandwidth of the ATM site to site was about 10 Mb/s. For the ADSL, the downloading bandwidth was 2 Mb, and uploading was 1 Mb/s. There were two consultation meetings held for SARS diagnosis between the Shanghai Infection Hospital and Xinhua Hospital during May 2003. The first consultation meeting was held using ADSL WAN, the image transmission time for one case took about one hour and more. The second consultation meeting was held using ATM WAN. The time required to transfer one case was less than 15 min. Tables 1 and 2 give the transmission results of the digitized film images from Shanghai Infection Hospital to Shanghai Xinhua Hospital by using ADSL and ATM, respectively. The other medical records of SARS patients acquired from the HIS were sent to the EPR repository before the image transmission. There were also ICU monitoring (intensive care unit) data used in the consultation, which were real-time transmitted from the infection area to the non-infection area and the off-site expert center through the LAN and WAN.\n\nSince the diagnosis and treatment procedures for SARS were complicated, the physicians, radiologists and experts usually had to review all the medical records of a patient to make final decisions. The web-based EPR system not only provided EPR navigation tool to the users, but also enable them interactively to study the medical records. For example, both local and remote users can interactively manipulate the images and medical records with dual Fig. 9 . The image acquisition used for SARS consultation with the webbased EPR system. cursors to understand each other on the cases. Fig. 10 shows the dual cursors pointing to a SARS chest image, which were controlled by local and remote users.\n\nThere were 8 SARS patients consulted from the remote expert center, and total 2.73 Gb image data were transmitted from the Infection Hospital to Xinhua Hospital in the consultation activities. During the consultation meeting, the web-based EPR system provided bi-directional remote control functionality to both sides on the EPR data processing and manipulation, and synchronized their operations on the patient medical records so that it is easy for them to do the case analysis and management. Fig. 11 shows an expert in the remote expert center, which was located in Xinhua Hospital, talking to the SARS physician about SARS patient images with the system.\n\nCollaborative medical applications need to share or interactively to exchange medical information through the networks and most medical documents or records stored in different formats or systems. This paper presented a novel approach to design and develop a web-based electronic patient record system for collaborative medical applications. The electronic patient records supported by this system cover most DICOM image-based objects and medical records. This system has three major components, use a C/S architecture for EPR data acquisition and authoring, and a Web B/S architecture for data delivery.\n\nThe web viewer of this system integrated multi-media display modules and remote control module together to provide interactive EPR display and manipulation functions for collaborative applications. The web-based architecture of the system makes the collaboration operation procedures much simpler and easier to the users. We have installed this system in Shanghai Infection Hospital and Shanghai Xinhua Hospital to provide teleconsultation services for SARS diagnosis between the SARS physicians and experts in May 2003. There were two consultation meetings held for SARS diagnosis between the Shanghai Infection Hospital and Xinhua Hospital during May 2003. The first consultation meeting was held using ADSL WAN, and the second consultation meeting was held using ATM WAN. There were 8 SARS patients consulted from the remote expert center, and total 2.73 Gb image data were transmitted from the Infection Hospital to Xinhua Hospital in the consultation activities. During the consultation meeting, the web-based EPR system provided bidirectional remote control functionality to both sides on the EPR data processing and manipulation, and synchronized their operations on the patient medical records so that it is easy for them to do the case analysis and management. The consultation results showed that this web-based EPR system could provide multi-sites interactive consultation services between SARS clinical physicians, so that radiologists and off-site experts did not have to be concerned with SARS infection. Also, the central collaborative operation mode simplified the consultation procedures in image and medical record delivery and display comparing to the point-to-point mode.\n\nThis paper also gives a new approach to create and manage image-based EPR from actual patient records, and also presents a novel method to use web technology and DICOM standard to build an open architecture for collaborative medical applications. The New web-based EPR system provides new method to enhance the value of interactive and collaborative studying of EPR for difficult cases, especially for SARS diagnosis. The on-time interactive communication features of the system can manipulate EPR objects which, in turn, can improve the efficiency and the quality of collaborative healthcare. The system can be used for both intranet and Internet medical applications such as tele-diagnosis, teleconsultation, and distant learning. "}