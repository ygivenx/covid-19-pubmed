{"title": "Short-term forecasts and long-term mitigation evaluations for the COVID-19 epidemic in Hubei Province, China", "body": "The 2019 novel coronavirus disease (COVID-19) emerged in Wuhan City, Hubei Province of China, in the late fall of 2019 (Chen et al., 2020) . The highly contagious virus outbreak during the Chinese Spring festival period made containment an unprecedented challenge. The risks of human-to-human transmission, long persistence on surfaces, and asymptomatic infections increased spread and made case detection difficult (Chan et al., 2020; Rothe et al., 2020) . Increasing case reports saturated hospitals in Hubei Province, overwhelming medical resources. Despite the high case reports, the true infection rate was likely underreported, as infected individuals with only mild symptoms might have recovered without being detected Sanche et al., 2020) .\n\nTo stop the viral spread, a series of strict control measures have been implemented in mainland China, including the enforcement of the tourism ban, suspension of the school, and extension of the Spring Festival holiday. From January 23 rd to April 8 th , 2020, the Chinese government implemented a metropolitan-wide quarantine of Wuhan and nearby cities, suspending all public transportation and advising residents to stay at home (Du et al., n.d.; J. T. Wu, Leung, & Leung, 2020) . Since February 8 th , a door-to-door check was started in Wuhan to take all confirmed and suspected people into medical care, which ended at around February 19 th (X. Li, Zhao, & Sun, 2020) .\n\nUnderstanding the impact of non-pharmaceutical interventions on the epidemic dynamics is crucial for decision-makers to take proper actions to contain the COVID-19. Since the beginning of the outbreak, scientists have been actively retrieving the epidemiological characteristics such as the time from infection to illness onset (incubation period) and the time from illness onset to hospital admission or isolation (infectious period) (Chen et al., 2020; Guan et al., 2020; Huang et al., 2020; Linton et al., 2020) . Researchers have used the reported cases during the early stage of the epidemic and predicted the epidemic trajectory, the basic reproductive number 0 from which ranges from 2.2 to 6.6 (Read, Bridgen, Cummings, Ho, & Jewell, 2020; Sanche et al., 2020; Zhao et al., 2020) . Several studies explored the effects of the quarantine of Wuhan (X. Shen, Peng, Guo, Xiao, & Zhang, 2020) , travel restrictions (Chinazzi et al., 2020) , and other non-pharmaceutical intervention strategies (Lai et al., 2020; Zhu et al., 2020) on the future transmission dynamics at different geographical scales.\n\nChina's aggressive and prompt measures have led to a dramatic decrease in the number of new cases. Those measures saved many lives, although at a high economic cost. As of March 18 th , 2020, the cumulative number of confirmed cases in China was 81,186. Compared to the previous day, the number of new cases was only 70, most of which were imported from outside the country (T. Wu, Ge, Yu, & Hu, 2020) . In the meantime, COVID-19 has further spread around the world, and countries like Italy, South Korea, the United States, and Iran are struggling to contain the epidemic.\n\nIn this work, we aim to assess the capability of the ensemble Kalman filter as a good short-term predictor, and test the effectiveness of non-pharmaceutical interventions on the epidemic spreading. First, we provide real-time assessments and forecasts of the case reported in Wuhan City based on the ensemble Kalman filter. Second, we build an individual-level based network model and perform stochastic simulations to reconstruct the epidemics in Hubei Province at its early stage and examine the epidemic dynamics under different scenarios. We consider four scenarios: keeping the early-stage trend without any mitigation, reducing the average node degree within a city through social distancing, reducing the infection rate by adopting protective measures, and decreasing the infection rate through both social distancing and protective measures. Third, we simulate the epidemic spreading in Wuhan City incorporating non-Markovian processes, i.e., non-exponential parameter distributions, and compare the predicted epidemic trajectories obtained from Markov processes.\n\nMathematical modeling can forecast the size and timing of epidemics, so resource allocations and decision-making can be optimized to maximize intervention strategies. Since most current network-based models are based on Markov processes, this work is probably one of the first to simulate the COVID-19 spreading based on non-Markovian processes. The findings of this work can be a reference for policy recommendations regarding COVID-19 in other countries.\n\nIn this section, we first introduce the ensemble Kalman filtering method used in the short-term analysis. Then we illustrate epidemic models based on Markov processes and non-Markovian processes built in the long-term analysis.\n\nWe aim to provide short-term prediction for the COVID-19 spreading in Wuhan city based on the Kalman filtering, which consists of model state estimation at each observation time based only on the observation up to the present. Considering that there is an unknown time-varying parameter \u03b2 in the SIR model which cannot be dealt with by widely used classic Kalman filter (Kalman, 1960) and extended . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 Kalman filter (Jazwinski, 2007) , a dual state-parameter estimation filtering method-ensemble Kalman filter (EnKF) is used for our study (Jensen, 2007; Moradkhani, Sorooshian, Gupta, & Houser, 2005) . EnKF is based on Monte Carlo where the approximation of forecast (a priori) state error covariance matrix is made by propagating an ensemble of model states using the updated states (ensemble members) from the previous time step.\n\nIt is quite difficult to have a real specific contact network between each person in Wuhan. Therefore, a generalized network is used, which means that every individual in this area is connected with a possibility. To describe the epidemiology of COVID-19 pneumonia, we used the discrete-time S-I-R model which categorizes the hosts within a population as susceptible (S), infectious (I) and removed (R) (Keeling & Rohani, 2011) . At any discrete time, every individual has to be in one of these 3 compartments. The susceptible are individuals unexposed to the pathogen but can be infected by contact with the infectious population. Infectious individuals can clear the infection by hospitalization, death and quarantine measures and become removed. The equations for the state transitions are shown as follows.\n\nWhere \u03b2 denotes the infection rate and \u03b3 denotes the removing rate. In the SIR model, we assume that the infection process of each infectious individual is Poisson and statistically independent and that the removing process for every infected individual is also Poisson. In this case, the infection rate \u03b2 quantifies the probability that each susceptible individual can be infected by each infectious individual in a time unit, and the recovering rate \u03b3 quantifies the average portion of the infectious population that will clear infection in a time unit. Considering that the population flow, prevention measures (like wearing N95 mask) and selfquarantine could affect the infection rate, we take the infection rate \u03b2 as a time-varying parameter. The removing rate is set as a constant 1/7 based on the estimation from Huang et al. (2020) .\n\nLet the state variables (SIR) defined as \u2208 3 , the time-varying parameter \u2208 . Consider the following problem\n\nwhere and are model and observation noise which are assumed to be normally distributed and with zero mean and the covariance known.\n\nBecause the true states are generally unknown, we can use the ensemble mean as the best estimate of the true state. The error covariance matrices for the predicted and filtered ensemble are given by\n\nwhere \u2212 is the error covariance matrix associated with the forecasted estimate (prior), is the one associated with the updated estimate (posterior), \u0302\u2212 is the ensemble vector of the forecasted estimate from model equations.\n\nIn the ensemble presentation, the model states and the time-varying parameter can be put together in a matrix \u2208 4\u00d7 , holding N ensemble member at time k.\n\nThe ensemble covariance then can be presented as\n\nThe measurement can also be formulated in an ensemble presentation\n\nwhere 1 = + 1 , is the true measurement and is the perturbation term. The measurement covariance matrix can be estimated as\n\nSpecify to the situation we are dealing with,\n\nand it is the same with , , and . The measurement is the total number of confirmed infected cases reported by the National Health Commission of China, which can be taken as the sum of the infectious and removed. Therefore,\n\nIn the long-term analysis, several epidemic models are built based on the Susceptible-Exposed-Infectious-Removed (SEIR) compartmental model, which has been frequently used in the study of the COVID-19 (X. Read et al., 2020; J. T. Wu et al., 2020; Zhou et al., 2020) . Each node is either in one of the compartments susceptible, exposed, infectious, or removed. Susceptible nodes refer to people free of the virus and can become infected due to contact with infectious nodes. Exposed nodes have been infected by the disease, but have not yet shown symptoms or become infectious. Removed nodes represent those individuals who are recovered, isolated, hospitalized, or dead due to the disease.\n\nIn this section, we apply the generalized modeling framework (GEMF) proposed by Sahneh, Scoglio, & Van Mieghem (2013) to build an individual-level network model. In GEMF, each node stays in a different state, and the joint state of all nodes follow a Markov process. The node-level description of this Markov process can be expressed as follows:\n\n[ ( + \u0394 ) = 3| ( ) = 2, ( )] = \u0394 + (\u0394 )\n\nWhere ( ) is the joint state of all individual nodes at time ; ( ) = 0, 1, 2,3 means that the state of node at time is in susceptible, exposed, infectious and removed compartment, respectively; is the number . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 of infectious neighbors of node ; \u2032 ( ) is the rate for one node transitions from susceptible state to the exposed state; is the rate from the exposed state to the infectious state, and is the removal rate from infectious state to the removed state, which is the inverse of the infectious period.\n\nRight after the COVID-19 outbreak in China, many studies have estimated the epidemiological parameters, which are essential to calibrate the epidemic models. However, we noticed that there exists a variety regarding the epidemiological parameters. Based on 1099 patients in 31 provincial municipalities through January 29 th , 2020, Guan et al. (2020) estimated that the median incubation period was 3.0 days, ranging between 0 to 24.0 days. This median incubation period was shorter than the previous studies based on smaller sample sizes, in which the estimated time from infection to illness onset was 5-5.2 days (Gardner, 2020; Q. Li et al., 2020) . Du et al. (2020) considered the delay from symptom onset to case detection as 4-5 days. Considering the possibility of asymptomatic infections, we adopt a relatively short mean incubation period as 3 days and mean infectious period as 4 days .\n\nHubei Province has 17 prefecture-level cities, and the population size of each city is obtained from the Hubei Statistical Yearbook (Hubei Provincial Bureau of Statistics, 2020). Based on the Baidu locationbased service data (https://qianxi.baidu.com/) and the fact that around 5 million people have moved out of Wuhan before the city lockdown on January 23 rd (Zhu et al., 2020) , the number of people that traveled between the cities in Hubei Province from January 1 st to January 29 th , 2020 is obtained.\n\nSince data about the actual people contact network inside a city are unavailable, we created contact networks among people within each city following with the homogenous network topology, namely the Erd\u0151s-R\u00e9nyi model (Erd\u0151s & R\u00e9nyi, 1960) . More specifically, nodes inside a city are randomly connected with a predefined probability such that each node has around 15 links (the average node degree is 15). Intercity links are created to simulate the interaction among the cities according to the number of people that traveled between the cities. For example, if the daily population flow from city to city is number of people, number of directed links will be randomly generated between people in city to people in city . Considering the implementation of city lockdown on January 23 rd , we alter the intercity network topology once during the simulation. In the first network topology, links among cities are created based on the average daily population movement between January 1 st -22 nd , while the second network reflects the population movement from January 23 rd -29 th .\n\nTo fit the model, we consider the COVID-19 epidemic outbreak starting in Wuhan City from January 19 th , because all confirmed cases reported in Hubei Province were in Wuhan City before January 19 th , 2020. To reduce the computational cost, the population of each city and population flows among the cities are scaled by 198, which is the number of cumulative confirmed cases in Hubei Province up to January 19 th . After scaling, the total number of nodes in the network equals 298,838. In addition, as the criteria for counting the confirmed cases are changed on February 12 th , 2020, there is a jump in the reported number of confirmed cases in Hubei Province on February 13 th , 2020. Accordingly, by keeping = 0.33 day -1 and = 0.25 day -1 (average) unchanged, we fitted the transmission model to the cumulative number of confirmed cases in Hubei Province (Health Commission of Hubei Province, 2020), from January 19 th to February 12 th by tuning the infection rate \u2032 ( ). We then examine the future course of the epidemic under different scenarios.\n\nGEMF is available in MATLAB, R, Python, and C programming language (Sahneh, Vajdi, Shakeri, Fan, & Scoglio, 2017) . We performed extensive stochastic simulations by adapting the GEMF toolbox with MATLAB during the experiment. The number of simulation runs is 500 in all scenarios. We track the number of nodes in each compartment for 365 days and demonstrate the simulation results with confidence intervals.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.03.27.20045625 doi: medRxiv preprint\n\nSince the outbreak of COVID-19, many studies have emerged to learn how this disease spreads. However, an overwhelming majority of the epidemic models have considered Markov processes, in which the transition between compartments follows an exponential distribution. To the best of the authors' knowledge, very few works have been done incorporating non-Markovian processes to epidemic models with respect to COVID-19. In this section, we take Wuhan City as a study area and try to demonstrate how distributions of key epidemiological factors can influence the predicted trajectory of the disease spreading.\n\nMore specifically, we incorporate non-exponential interevent time distributions to the SEIR model using the modified Gillespie algorithm proposed by Bogu\u00f1\u00e1, Lafuerza, Toral, & Serrano (2014) . Transitions from the susceptible state to the exposed state is a Poisson process that follows the exponential distribution. Following lognormal distributions, the mean and median of the incubation period are estimated at 5.6 days and 5.0 days, respectively, while the infectious period is of mean 3.9 days and median 1.5 days , which is in line with Sanche et al. (2020) . The number of simulation runs is 80.\n\nIn this section, we provide results regarding the short-term analysis with the Kalman filter. From the long-term perspective, we first present results based on GEMF stochastic simulations and then compare the results based on non-Markovian processes and Markov processes.\n\nThe predictions of COVID-19 cases in Wuhan city from February 22 nd to March 1 st were conducted. Every predictive simulation was run 250 iterations. The removing rate we used was 1/7 and the infection rate was estimated by EnKF. The model noise and measurement noise was tuned by state of art. Fig. 1 shows the distributions of the predicted numbers of COVID-19 cases based on data 1, 2 and 3 days before. The results of the EnKF prediction give two rangesthe weak one from minimum to maximum (the solid black line) which can include all the reported real data (the green circle); the stronger one from the lower quartile to the upper quartile (the blue box) which also covers most of the real numbers. The red line inside the box indicates the median of the samples. We can see that most medians are very close to the corresponding real numbers. Taking the median as our predicted number gives the relative error shown in Fig. 1(d) . The mean absolute percentage error (MAPE) for 1-day-ahead prediction is 0.19%; the MAPE for 2-day-ahead prediction is 0.32%; the one for 3-day-ahead is 0.62%. The performance of 1-day-ahead prediction is the best and the one of 3-day-ahead is the worst. When n-day-ahead prediction is conducted, the results from (n-1)-day-ahead is used, so the errors will accumulate.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https: //doi.org/10.1101 //doi.org/10. /2020 The estimation of infection rate \u03b2 from January 15 th to February 27 th is presented as the blue line in Fig.3 . The orange line in Fig. 3 presents the removing rate. From January 15 th to January 27 th , the infection rate \u03b2 is increasing. After January 27th, \u03b2 starts to decrease. The self-quarantine policy was carried out on January 23 rd in Wuhan and a series of administrative actions were taken to prevent the disease from spreading. Considering that there are several days delay from the infection to detection, the estimated \u03b2 matches with the real situation. On February 12 th , because Wuhan authorities changed the case definition to include symptomatic patients in addition to tested ones, there was a huge increase in cases, which results in a huge increase in estimated infection rate \u03b2 as well. Therefore, the estimated \u03b2 on February 12 th is inaccurate. After February 14 th , the infection rate \u03b2 is less than the removing rate \u03b3, which means the epidemic had peaked in Wuhan.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 \n\nTo reconstruct the epidemics in Hubei province at its early stage, we continuously tune the infection rate parameter \u2032 to match the number of nodes in the removed compartment with the number of cumulative confirmed cases from January 19 th to February 12 th , as shown in Fig. 4.   Fig. 4 Fitting the model to the cumulative confirmed cases from January 19 th to February 12 th .\n\nBy performing GEMF stochastic simulations, we obtain that \u2032 is equal to 0.12 for day 0-7, and then becomes 0.027 for day 8-10, and 0.024 for day 11-18. Starting from day 19, \u2032 = 0.02. The infection rate dramatically drops, indicating that public health interventions implemented in Hubei Province have considerably controlled the epidemic development since the nascent stage of the outbreak.\n\nThe predicted epidemic dynamics from GEMF stochastic simulations are shown in Fig. 5 . We consider four different scenarios: continuing the current trend (Scenario1); decreasing 2 by 25% (Scenario 2); reducing the average node degree inside a city from 15 to 10 (Scenario 3); reducing 2 by 25% and average node degree from 15 to 10 (Scenario 4). Preventive measures such as wearing masks can help reduce the infection rate. On the other hand, the average node degree refers to the possible contacts a person may have in daily life, and this can be reduced by contact reduction and social distancing.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 In Fig. 5 , if the current trend as of February 12 th continues, the epidemics in Hubei Province could have become endemic and not been contained in one year. When \u2032 is reduced by 25% in Scenario 2, the number of infectious cases in Hubei Province would reach the peak at day 22 on average (median: 24, and fade out at around day 250 in Fig. 5(c) . Reducing the average node degree inside each city from 15 to 10, the epidemic would reach the peak at around day 21 (median: 24, and fade out at day 150 on average. When a combination of reducing \u2032 and average node degree is conducted in scenario 4, the number of infectious cases would reach the peak at around day 19 (median: 23, , and the number of removed cases would approximate the actual epidemic trajectory in Hubei Province in the steady-state as shown in Fig. 5 (e) .\n\nOverall, GEMF simulation results suggest that more strict prevention and control measures have been taken since February 12 th to achieve the current cumulative confirmed cases in Hubei Province. Preventive measures and social distancing measures need to be taken in combination by the government to speed up the containment of the epidemic and reduce the peak infection dramatically.\n\n(a) Scaled number of susceptible cases (b) Scaled number of exposed cases (c) Scaled number of infectious cases (d) Scaled number of removed cases . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https: //doi.org/10.1101 //doi.org/10. /2020 (e) Scaled number of removed cases compared to the cumulative confirmed cases up to March 24 th Fig 5. Epidemic dynamics under different scenarios from GEMF stochastic simulations.\n\nWith mean infectious period (from compartments \u2192 ) set as 3.9 days and mean incubation period (from compartments \u2192 ) set as 5 days, we first use ordinary differential equations based on Markov processes to estimate the infection rate from compartments \u2192 . Assuming that the epidemic starts from December 1 st , is equal to 0.68 to match the number of cumulative confirmed cases in Wuhan city.\n\nSecond, we simulate the disease spread in Wuhan city with transmission between compartments incorporating non-Markovian dynamics. The transition from compartment \u2192 still evolves according to an exponential distribution with = 0.68, while transitions from compartments \u2192 and \u2192 follow the lognormal distributions from Sanche et al., 2020) in Fig. 6 (a-b) . Note that the width of the infectious period becomes much shorter (blue curve) after January 18 th , as shown in Fig. 6 (a) , because the government has started to trace back and monitor those people who have contact with confirmed cases and built temporary hospitals to hospitalize both patients with mild and severe symptoms since mid-January. In Fig. 6 (a-b) , we also show curves of different exponential distributions compared with these lognormal distributions for demonstration purposes.\n\nIn Fig. 6 (c-d), simulated results incorporating non-Markovian processes deviate from the results obtained from Markov processes. More specifically, the epidemic curve with non-Markovian processes is flattened with a smaller epidemic peak compared with that from Markov processes. This is because the infectious period used in the Markovian model has an exponential distribution (mean =3.9 days) similar to the shape of the exponential distribution (mean=4.0 days) in Fig. 6 (a) , but shorter than the lognormal distribution (mean=3.9 days, median=1.5 days) used after January 18 th . The reasons above indicate that control measures to reduce the infectious period can effectively mitigate the outbreak.\n\nOn the other hand, these two methods with different distributions but with the same mean infectious period lead to inconsistent results. Since the actual infectious period and incubation period do not follow exponential distributions, these simulations suggest that future works need to consider distributions of epidemiological characteristics to better capture the COVID-19 spreading trajectory. Instead of taking mean values derived from clinical studies as input to the epidemic models, researchers need to take into account the empirically derived distribution of the parameters.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 \n\nIn this work, the ensemble Kalman filter is used to make short-term predictions of the COVID-19 cases in Wuhan City, which resulted in accurate forecasts of daily case reports. The model is able to predict daily cases and the epidemic peak. Knowing the daily cases from forecasts three days in advance allows for the proper resource allocation. The ensemble Kalman filter also allows parameter estimation, which is extremely useful for modeling purposes.\n\nFrom an epidemiological modeling perspective, we simulate the epidemic spreading in Wuhan city based on non-Markovian processes, and show that different distributions with the same mean infectious period can lead to inconsistency in terms of epidemic dynamics. Since most current network-based approaches are based on Markov processes, in which epidemiological parameters are assumed to follow exponential distributions, non-Markovian process-based models need to be further explored to better predict the COVID-19 spreading. Our results show that reducing the infectious period via measures such as early case identification and isolation can reduce the epidemic size significantly.\n\nIn the long-term perspective, we test and confirm the effectiveness of non-pharmaceutical interventions on the containment of the epidemic dynamics by performing GEMF stochastic simulations. The daily cases . CC-BY-NC-ND 4.0 International license It is made available under a author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nis the (which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10. 1101 of the COVID-19 epidemic in Hubei Province peaked at over 15,000 on February 12 th and became almost zero in mid-March (Xinhua, 2020) . Our simulation results indicate that the containment of this highly contagious disease was achieved by stringent control measures by the Chinese government. Without continued and aggressive control measures, the epidemic in Hubei Province would have become persistent. If the infection rate is reduced through the enhanced protective measures by 25%, the epidemic would reach the peak in mid-February and fade out in late September. Reducing the average node degree inside each city via social distancing measures, the number of infectious cases would peak at mid-February and decrease to zero at mid-June. Only with combined implementation of enhanced protective measures and social distancing measures, the epidemic dynamics would peak at around mid-February and approximate the actual epidemic trajectory in March. This can be an important message for countries going through the exponential growth of the epidemic in the current days."}