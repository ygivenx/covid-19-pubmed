{"title": "Case Detection Algorithms", "body": "This chapter focuses on algorithmic methods for case detection. As we discussed in Chapter 3, the objective of case detection is to notice the existence of a single case of a disease. Case detection is a core activity of biosurveillance. Detection of an outbreak usually depends on detection of individual cases, although it is also possible to detect an outbreak from data other than case data (e.g., retail sales of thermometers or satellite imagery).\n\nFor most of the 20th century, governmental public health relied almost exclusively on the astute clinician and the clinical laboratory to detect and report cases via the notifiable disease system. Algorithms for case detection did not exist, with the possible exception of case definitions discussed in Chapter 3, which are algorithms in the sense that they are formal specifications that a clinician or epidemiologist can follow to classify an individual as a suspected or confirmed case.\n\nAround the beginning of the 21st century, emerging diseases and the threat of bioterrorism began to stress the capabilities of the notifiable disease system. Health departments endeavored to improve it by creating web-based forms for disease reporting and electronic laboratory reporting. Their goal is to increase completeness of reporting and decrease time latencies inherent in paper-based reporting.\n\nAfter the anthrax postal attacks of 2001, health departments redoubled their efforts to improve disease reporting by increasing the \"astuteness\" of clinicians through education and training . A specialist in infectious diseases had detected and reported the first case of inhalational anthrax (Kolata, 2001) ; thus, the conventional wisdom was that the notifiable disease system worked. For the foreseeable future, increasing the ability of front-line physicians to diagnose rare diseases through better training was our best defense against bioterrorism. The conventional wisdom was correct insofar as case detection by clinicians is important in outbreak detection. However, it was overly sanguine about the ability of training to improve the existing capability.1\n\nThere is a limit to which additional training can improve a clinician's ability to detect and report rare diseases to a biosurveillance organization. Humans are not perfectible in this manner, as noted first by Dr. Clem McDonald, who entitled his seminal paper on physician performance Protocol-Based Computer Reminders, the Quality of Care and the Non-Perfectability of Man (McDonald, 1976b) . 2\n\nThe best case detection system imaginable would be one in which every individual in a community is examined every morning by the best diagnostician in the world. This diagnostician would have all the time in the world to interview and examine each person. Since she would be examining everyone every day, she would notice patterns (clusters) of early illness in a community. Her awareness of patterns would appropriately bias her diagnostic thinking (and treatment) of individual patients. Physicians are taught (and reminded incessantly) \"when you hear hoof beats, don't think of zebras.\" This adage is an informal statement that when the evidence available about a particular patient supports equally a diagnosis of either influenza or SARS (e.g., the patient has constitutional symptoms and no history of exposure to SARS), they should conclude that the diagnosis of influenza is far more likely than SARS. This diagnostician would also never fail to report immediately each fever, early syndromic presentation, or reportable disease to governmental public health.\n\nThis ideal scenario recognizes the importance of the knowledge, judgment, and skills that clinicians bring to bear on the diagnosis of disease. The importance of expert knowledge and judgment underlies the opinion, expressed by experts in public health after the anthrax letters in 2001, that there is no substitute for an astute clinician. This ideal scenario also recognizes that knowledge of the prevalence of disease in a population influences the diagnostic work up and management of individual patients.\n\nOf course, such a system is not feasible due to the impossibility of having every person seen by the same diagnostician every day or the alternative of cloning the best diagnostician and ensuring that the clones could instantly share information about individuals they were seeing. Nevertheless, it represents a benchmark against which we can compare other schemes that are perhaps superior to current approaches.\n\nIn the next section, we discuss diagnostic expert systems, which are computer programs (algorithms) that embody the diagnostic knowledge and diagnostic skills of expert clinicians. Diagnostic expert systems are far less expensive than clinicians, never tire, and we can clone them at will. They make it reasonable to imagine a biosurveillance system in which a highly competent diagnostician examines thousands of individuals in a community every day with consistent diagnostic quality--reporting fevers, syndromes, and reportable diseases to a health department without fail and without delay. They make it possible to imagine a biosurveillance system in which the health department analyzes highly improved case data and communicates up-to-the-minute information about patterns of illness in the community back to the diagnosticians.\n\nDiagnostic expert systems are computer algorithms that automate the cognitive process of medical (or veterinary) diagnosis.\n\nMany readers will be surprised to learn that researchers in the fields of artificial intelligence and medical informatics have been developing and fielding such systems since the 1960s. The first fielded system, developed by Dr. Homer Warner in Salt Lake City, provided diagnostic assistance for children with congenital heart disease (Warner et al., 1961 , Warner et al., 1964 . Congenital heart diseases are severe birth defects of the valves and structure of the heart. In the 1960s, the exact nature of heart malformations was very difficult to diagnose without invasive and risky angiographic procedures. Dr. E Timothy de Dombal developed a similar system for the differential diagnosis of the acute abdomen, another high-stakes diagnostic problem. A surgeon must differentiate between conditions that require emergency surgery, such as appendicitis, and conditions, such as pancreatitis, for which surgery is relatively contraindicated (de Dombal et al., 1972 , de Dombal et al., 1974 , Wilson et al., 1975 , de Dombal, 1975 , Wilson et al., 1977 , de Dombal, 1984 , Adams et al., 1986 , McAdam et al., 1990 , de Dombal, 1990 , de Dombal et al., 1993 , American College of Emergency Physicians, 1994 .\n\nWe can perhaps best explain how a diagnostic expert system works by analogy to the process that a physician uses to diagnose a patient. Like a physician, a diagnostic expert system begins by collecting information about the patient's illness-symptoms, observations from physical examination, results from laboratory tests, risk factors for disease (e.g., travel to a foreign country) and pre-existing medical conditions (e.g., diabetes). We refer to this diagnostic information collectively as the findings. Of course, the computer usually does not interview the patient and (at present) never examines the patient. Rather, a physician interviews and examines the patient after which she or an assistant enters the findings into the program (e.g., Warner and Bouhaddou, 1994 , London, 1998 , Buchanan and Shortliffe, 1984 , Miller et al., 1986 , Shwe et al., 1991 , Heckerman et al., 1992 . Increasingly, diagnostic expert systems acquire findings automatically from clinical information systems (Aronsky et al., 2001 , Burnside et al., 2004 , McDonald et al., 1991 . There are also examples of diagnostic expert systems that interview patients directly to obtain their medical histories (Pynsent and Fairbank, 1989, Wald et al., 1995) . Notes: The notation p(FMD) actually is shorthand for a probability of an event variable called FMD that can take the values true or false. So, p(FMD) actually stands for p(foot and mouth disease is present) or p(foot and mouth disease is not present). If we to write Table 13 .1 out in its full form, it would have four rows corresponding to p(FMD is present) = 0.001, p(FMD is absent) = 0.999, p(MCD is present) = 0.001, p(MCD is absent) = 0.999. The laws of probability require that the sum of the probabilities for all the event variable outcomes will be equal to 1 (e.g., p[FMD is present] + p[FMD is absent] = 1, because it is a certainty that something is either present or it is absent), so knowledge engineers usually save space by only writing one row per disease. FMD, foot and mouth disease; MCD, mad cow disease.\n\nLike the physician, the c o m p u t e r p r o g r a m generates a differential diagnosis for the sick individual. A differential diagnosis is a list of diseases that are most likely to account for the findings in a patient. The diagnostic expert system typically creates its differential diagnosis by computing the posterior probability for every disease given the findings. A disease's posterior probability is the chance that the patient has the disease, given the findings. \n\nA differential diagnosis must be \"resolved\"; that is, the diseases in the list must be ruled in or ruled out. Like an expert physician, the diagnostic expert system engages in a cyclic process often referred to as \"hypothesize and test\" to resolve the differential diagnosis. A diagnostic expert system uses valueof-information calculations (Weinstein, 1980) to r e c o m m e n d to the physician user additional findings that will resolve the differential diagnosis efficiently. Value-of-information calculations identify those findings, which, if k n o w n to be present or absent, optimally discriminate a m o n g the diseases in the differential diagnosis, where optimality takes into account not only the probability of a diagnosis, but cost-benefit considerations, such as w h e t h e r a diagnosis is treatable. The net result of this cyclic process is the diagnostic certainty about the diagnoses in the differential increases over time (i.e., probabilities of the diagnoses in the differential m o v e towards zero, indicating certainty that a disease is not present, or one, indicating certainty that a disease is present) (Figure 13 .1). \n\nThe process of diagnosis. Like a physician, a diagnostic expert system analyzes patient data to generate a differential diagnosis. Based on the differential diagnosis and value of information calculations, the diagnostic expert system can suggest additional questions to ask the patient, additional physical observations to make about the patient, or additional tests to consider. A physician may accept the recommendations or not. As additional information about the patient's illness arrives over time (either as a result of tests or questions suggested by the computer; or by the physician; or simply the passage of time, this user can enter this new information and rerun the computer program to generate an updated differential diagnosis). This process of data collection and analysis can be repeated frequently until the diagnosis for a patient is established with sufficient certainty and diagnostic precision that further diagnostic evaluation is not necessary. expert systems in the domains of diseases of humans and cattle, respectively.\n\nIliad was developed by Homer R. Warner, Jr. and colleagues at the University of Utah in the 1980s (Warner, 1989 , Sorenson et al., 1988 , Cundick et al., 1989 , Warner and Bouhaddou, 1994 , Warner, 1990 . Iliad is a stand-alone diagnostic expert system; that is, it requires a user (physician) to enter findings into the program. Iliad uses Bayes rules to compute a differential diagnosis for the patient's illness. It uses value-of-information calculations to recommend additional tests and observations. Iliad performs differential diagnosis of human diseases in a variety of fields: internal medicine, sports medicine, pediatrics, dermatology, psychiatry, obstetrics/gynecology, urology, peripheral vascular diseases, and sleep disorders. Iliad covers more than 900 diseases and 1500 syndromes (which means that there are tables of information about diseases and findings for approximately 2400 diseases similar to those shown in Figures 13.1 and 13.2). Iliad computes a differential diagnosis for a patient and then displays the diseases and syndromes to the user in order of posterior probability as shown in Figure 13 .2. If the user asks Iliad to suggest additional tests or questions to ask the patient, the program performs value-of-information calculations to suggest findings that would discriminate among the diseases in the differential diagnosis ( Figure 13 .3).\n\nResearchers have compared Iliad's diagnostic performance on real cases with that of expert physicians and found equivalent performance (Graber and VanScoy, 2003, Friedman et al., 1999, Elstein et al., 1996 , Murphy et al., 1996 . Interestingly, Iliad did not achieve widespread acceptance in clinical practice because the entering of patient data was too time-consuming for busy clinicians and the program is no longer in use.\n\nThe Bovine Syndromic Surveillance System (BOSSS) is a webbased disease-reporting tool that incorporates a diagnostic expert system for diagnosis of diseases of cattle ( Figure 13 .4) (Shephard et al., 2005) . BOSSS requires a user (veterinarian or cattle herd worker) to enter findings into the program ( Figure 13 .5). BOSSS uses Bayes rules to compute a Fill U R E 13.2 Consultation mode of Iliad showing the patient findings that the physician entered (lower right panel), and the differential diagnosis (panel on left) that Iliad generated from those findings. (Courtesy of LE Widman, http://www.informaticamedica.org.br/informaticamedica/nOlO5/widman.htm.) F I G U R E 13.4 Log-in page of the web-based bovine syndromic surveillance system. differential diagnosis for the patient's illness. It also uses value-of-information calculations to recommend additional tests and observations. Shephard and colleagues developed BOSSS to meet a need to capture disease and syndrome observation data from field observations made by veterinarians, producers, and lay observers. These observations are important to populationbased surveillance of cattle herds and to the business of cattle production, but are largely unrecorded and, therefore, unavailable for biosurveillance purposes. BOSSS encourages use by rewarding a user with diagnostic support in his efforts to determine the cause of illness or death in cattle.\n\nLike Iliad, BOSSS contains information on the prevalence of diseases (for approximately 1000 diseases of cattle). It also contains the sensitivity and specificity of each finding for each disease. (We discuss sensitivity and specificity in Sect. 5.1.) The development team compiled this information from veterinary literature and the opinions of veterinary experts. Like Iliad, it F I G U R E 13.5 A graphic user interface for entering findings of a sick animal. uses Bayes rules to determine the posterior probability of each disease given the findings (Figure 13 .6).The program promotes the capture of extra information on each case through the use of an interrogation module that presents questions to the user (Figure 13 .7). These questions are key differentiating signs for the most likely diseases identified by the system that have not already been recorded by the user. Unlike Iliad, BOSSS has an explicit biosurveillance mission. The \"syndromic-surveillance\" component of BOSSS is illustrated by the mapping of cases shown in Figure 13 .8.\n\nThe developers of BOSSS, learning lessons from Iliad and other diagnostic expert systems about the importance of fitting F I G U R E 13.7 A graphic user interface for guided examination.\n\ninto the workflow of busy clinicians, are developing a palmcomputer version of BOSSS. This portable version will fit into the practice patterns of cattle veterinarians, who spend their days at different locations and most definitely do not work in an office setting. A training manual is available for download at http://www.ausvet, com.au/bosss/resources/B OSSS_ManuaLpdf\n\nAs previously discussed, a diagnostic expert system contains an internal store of facts about diseases, including (1) the prevalence of each disease, (2) their findings, and (3) the statistical relationships between the findings and the diseases. We call this collection the knowledge base. In addition to the knowledge base, a diagnostic expert system contains an inference engine, which performs diagnostic reasoning (Figure 13 .9).\n\nTo demonstrate how a diagnostic expert system uses Bayes rules to compute a differential diagnosis, we created mini-BOSSS, a tiny version of BOSSS. In particular, mini-BOSSS has a knowledge base with only two diseases and two findings. The diseases are foot and mouth disease (FMD) and mad cow disease (MCD). The findings are drooling saliva and whether there is more than one cow in the herd with this symptom.\n\nWe note that there are several kinds of expert systems, including the probabilistic diagnostic expert systems that we have been discussing, and rule-based expert systems. We discuss rule-based expert systems later in this chapter.\n\nA probabilistic knowledge base uses probabilities to represent the prevalence of disease and the relationships between findings and diseases. A development team creates a knowledge F I G U R E 13.8 A mapping tool that displays geographic locations of reported cases.\n\nbase by a labor-intensive literature review supplemented by interviews with experts. Increasingly, developers use large data sets collected by hospital information systems (especially for disease prevalence) to develop knowledge bases. The process that developers use to elicit knowledge from experts and to F I G U R E 13.9 Components and process flow in an expert system. The inference engine uses both patient data and medical knowledge to compute a differential diagnosis and to generate suggestions for additional collection of data. The inference engine obtains data from an inbound data-acquisition interface and it outputs the differential diagnosis and suggestions for additional data through an outbound results interface. In a freestanding diagnostic expert system such as Iliad or BOSSS, both the data-acquisition and results interfaces are screens that a physician interacts with. In an embedded system like Antibiotic Assistant, the dataacquisition interface is with hospital information systems (and to some extent with the user, but only for selected items of information that the user wishes to provide). The results interface could also be with another computer system such as a point-of-care system, which would present the differential diagnosis and suggestions through its own screens. convert information in the literature into a knowledge base is referred to as knowledge acquisition or knowledge engineering (Feigenbaum, 1977) .\n\nThe prior probability is the prevalence of disease in the population. We represent prior probabilities using the notation P(Disease). For example, P ( F M D ) represents the prior probability of foot and mouth disease. Table 13 .1 shows the prior probabilities of F M D and M C D that we use in our example. Table 13 .1 also shows the prior odds of the diseases in mini-BOSSS. Odds are a simple mathematical transform of probabilities, which are essentially equal to probabilities when probabilities are less than 0.1. The reason that we show odds in Table 13 .1 is that we use the odds-likelihood form of Bayes rules in our example. We will define odds and the odds-likelihood form of Bayes shortly.\n\nA conditional probability is the chance of one event occurring given the occurrence of another event. In diagnostic expert systems, we use conditional probabilities to describe the probability of seeing a certain finding (one event) when a disease is present (another event). If the conditional probability is high, it means that the particular finding is often associated with the disease. The mathematical notation for the conditional probability of a finding, given a disease, is P(FindinglDisease). For example, P(drooling of saliva is presentIFMD is present) is the probability of observing drooling of saliva in a cow with foot and mouth disease. Table 13 .2 lists the conditional probabilities for the findings and diseases in mini-BOSSS.\n\nIf you are familiar with the concepts of sensitivity and specificity (discussed in detail in Chapter 20), you may recognize that the conditional probability p(drooling of saliva is pres-entlFMD is present) is the sensitivity of the symptom drooling of saliva for the disease FMD. Similarly, p(drooling of saliva is absentIFMD is absent) is the specificity of drooling of saliva for FMD. Many readers will be quite familiar and comfortable with the concept of sensitivity and specificity of laboratory tests, but perhaps not with the idea of sensitivity and specificity of other findings. In fact, symptoms, travel history, results of physical examination, and results of laboratory tests are all nothing more than observations that we make about an individual that may help us discriminate between individuals with disease and those without disease. It is possible to measure a sensitivity, specificity (or, alternatively, likelihood ratios) for any of these diagnostic observations. Consider the diseases presented in mini-BOSSS. Cattle affected with FMD develop very severe mouth vesicles and ulcers. This mouth pain results in excessive salivation; therefore, it causes drooling of saliva. Cattle affected with MCD do not develop mouth wounds; therefore, they are not likely to be observed drooling saliva. The conditional probabilities in Table 13 .2 reflect the observations above; P(drooling of salivalFMD) is equal to 0.95 and p(drooling of salivalMCD) is equal to 0.001.\n\nIf our knowledge base included laboratory tests for FMD and MCD, these conditional probabilities would be the sensitivities and specificities of the laboratory tests for FMD and MCD.\n\nResearchers working in the field of diagnostic expert systems sometimes refer to conditional probabilities of findings for given diseases as textbook knowledge because these probabilities are often available in textbooks of medicine (human or veterinary). For example, a chapter in a textbook of veterinary medicine on FMD will contain many statements about the frequency with which different findings occur in animals with FMD. These frequencies are basic facts, highly relevant to diagnosis.\n\nA probabilistic inference engine is an algorithm that computes a differential diagnosis for a sick individual. In particular, it computes the posterior probability of each disease in its knowledge base, given the findings for a sick individual. In our example, the algorithm will compute the posterior probability p(FMD is presentldrooling of saliva is present, more than one animal is affected) and the posterior probability p(MCD is presentldrooling of saliva is present, more than one animal is affected).\n\nA probabilistic inference engine uses Bayes rules to compute the posterior probability from the prior probability (or prior odds) and the sensitivities and specificities of the observed findings. Once it has computed the posterior probability of every disease in its knowledge base, the inference engine outputs a differential diagnosis, that is, a list of all diseases in the knowledge base sorted from most probable to least probable.\n\nBayes rules are sometimes referred to as Bayesian inversion because it inverts the conditional probability that a given finding will be observed in an individual with disease (textbook knowledge) into the probability that an individual has the disease, given that we observe a finding in that individual (diagnostic knowledge). That is, it inverts p(drooling of saliva is presentlFMD is present) to p(FMD is presentldrooling of saliva is present), which is exactly what a veterinarian needs to know. A veterinarian needs to know the likelihood that the cow has FMD or MCD, given the findings.\n\nA complete discussion of the various algorithms that a probabilistic inference engine can use to compute posterior probabilities using Bayes rules would fill a book, such as the excellent textbook by Richard Neapolitan (2003) . For teaching purposes, we will use a simple form of Bayes rules called the odds-likelihood form of Bayes rules. This simplified form rests on an assumption that findings are independent, given the disease, which is why researchers called this formulation (and similar formulations) naive Bayes. This simple form of Bayes rules works surprisingly well in many diagnostic expert systems, including the systems developed by Homer Warner (congenital heart advisor) and Homer Warner Jr. (Iliad), as well as the BOSSS. We will use the odds-likelihood version of Bayes rules to illustrate how BOSSS computes a differential diagnosis for two diseases, given two findings about a sick cow.\n\nFor clarity and convenient reference, we here provide the definition of odds:\n\n(1)\n\nOdds are simply a rescaling of probability from a range of 0 to 1 to a range of 0 to infinity (which you can prove to yourself by substituting probabilities of zero and one into Eq. 1). For probabilities less than 0.1, probabilities and odds are roughly equal. A probability of 0.1, for example, equals an odds of 0.1 = 0.11. You can safely think \"probability\" 1-0.1 whenever we use the term \"odds\" and vice versa, as we will be dealing with small probabilities. Upon reading Appendix D, which contains the simplest probabilistic formulation of Bayes rules, you will see why we use the odds-likelihood form in this chapter--it is simpler to learn Bayes rules using this form, and more illuminating.\n\nEquation 2 is the odds-likelihood form of Bayes rules when we have only one finding.\n\n( 2) This equation says that if we know the prior odds Odds(D) (read prevalence) of a disease D and we observe one finding f of that disease in an individual, we can compute the posterior odds (read probability) by multiplying the prior odds times the likelihood ratio of that finding for that disease.\n\nLikelihood ratios are nothing more than an alternative way of expressing the sensitivity and specificity of a test or observation for a disease. In fact, the likelihood ratio is defined in terms of sensitivities and specificities. The likelihood ratio positive (positive means that the finding drooling saliva is known to be present) of drooling saliva for the disease FMD follows:\n\np(drooling saliva presentlFMD present) LRdrooling salivalFMD = p(drooling saliva presentlFMD absent) (3) In Equation 3, the numerator is sensitivity, and the denominator is the false positive rate (equal to 1 m specificity).\n\nNote that the beauty of the likelihood ratio LR+drooling salivalFMD is that it is a very direct measure of how well drooling saliva discriminates between animals with FMD and animals without FMD. If drooling of saliva occurs much more frequently in animals with FMD than animals without FMD, LR+drooling salivalFMD will be a large number. For a finding that is pathognomic (meaning that the finding in itself is sufficient to diagnose a disease), the denominator will be zero and the LR + will be infinity, meaning that no matter how small the prior odds are, the posterior odds will be infinity (which converts to a probability of 1.0, and means that the individual has the disease with certainty). If, on the other hand, drooling of saliva occurs with equal frequency in animals with FMD and animals without FMD, the numerator and the denominator will be equal and the LR+drooling salivalFMD will be equal to one, which when multiplied times the prior odds of FMD will result in a posterior odds that is equal to the prior odds. This result makes sense. If a finding cannot discriminate between animals with FMD and without FMD, it contains no diagnostic information for the disease FMD, and should not increase or decrease our belief that the animal has FMD.\n\nThe likelihood ratio negative (negative means that the finding drooling saliva is known to be absent) follows:\n\np(drooling saliva absentlFMD present) LRdr~176 salivalFMD = p(drooling saliva absentlFMD absent)\n\nIn Eq. 4, the numerator is the false negative rate (equal to 1 -sensitivity), and the denominator is specificity. In medicine, the absence of a finding that we expect to see if the patient actually has the disease in question is useful information.\n\nThere is even a term for itmsignificant negative finding. A significant negative finding, such as a negative laboratory test, helps to rule out a diagnosis. A likelihood ratio negative is always a number that is less than one (but greater or equal to zero) for findings that we expect to see more often in individuals with the disease than in individuals without the disease. Equation 2 expresses the essence of Bayes rules. Diagnosticians use Bayes rules to update their prior belief in a diagnosis in light of new information. When a diagnostician has no information whatsoever about an individual, her belief that the individual has a disease should be the prevalence of the disease. If she makes an observation (whether positive or negative), she should update her belief in the diagnosis by multiplying the likelihood ratio for the test or observation for that disease times the prior odds of the disease (think \"prevalence\").\n\nIf we know nothing about a cow whatsoever, then our belief that the cow has FMD is simply the prevalence of FMD. If we subsequently observe that the cow is drooling saliva, Bayes rules instructs us to update our belief that the cow has FMD using the information in If we subsequently observe that a second cow is sick, we can apply Bayes rules a second time. In effect, we are treating the posterior odds from the prior calculation as the new prior odds:\n\nOdds(FMD I drooling saliva, more than one animal affected) = LR+more than one animal affectedlFMD )< Odds(FMDI drooling saliva) p(more than one animal affected l FMD present) =\n\nx 0.0019 p(more than one animal affected l FMD absent) In general, if we have N diagnostic facts about a cow (or person), the odds-likelihood form of Bayes rules has the following form:\n\nOdds(Dlfl,f 2 .... ,fn)= LRflID xLRf21D x...xLRql D xOdds(D) (7) The result of Eq. 6, Odds(FMDldrooling saliva, more than one animal affected) + 0.09, is the odds (think probability) that the cow has FMD given that we have observed drooling of saliva in this cow and at least one other cow. The probabilistic inference engine would repeat the same calculation for the disease MCD, using the prior odds of MCD and the likelihood ratios for the two findings for MCD. The result of this calculation (not shown) is 9.8 x 10 -8 . Cows with MCD stagger, but rarely drool saliva. Table 13 .3 shows the differential diagnosis that our extremely simple diagnostic expert system would show to a user. The two diseases are sorted in order of posterior odds. Note that we converted the posterior odds back to posterior probabilities odds using the formula P = 1 + odds' which we obtained by solving Eq. 2 forp.\n\nNote that the posterior odds (and probabilities) in this example are very low. The low posterior odds are also partly due to the low prior prevalence of FMD and MCD that we arbitrarily assign (note that zero prior probability is not acceptable for the likelihood ratio computation). Countries that are currently free from these diseases or within the final stage of a disease eradication program for the diseases use low prior prevalence for exotic diseases (e.g., FMD and MCD). The LR+s for these findings for the disease FMD are only 19 and 4.75, respectively. If we had a third finding, such as blisters on feet, the LR + for this finding would be a third multiplier in the equation, possibly increasing the posterior odds for one or both diagnoses. If we had a positive result from a highly sensitive and specific test for FMD (very high LR+), the posterior odds for FMD might be quite high. The key question for biosurveillance systems is at what level of certainty of a diagnosis in a single individual or a set of individuals different response actions are warranted. The answer to this question depends on treatability and other cost-benefit considerations that we discuss in Part V of this book.\n\nReaders should be aware that there are other forms of Bayes rules that do not rest on an assumption of conditional independence, given a diagnosis. A developer of a probabilistic expert system may choose to use these alternative forms to improve the diagnostic accuracy of a system. Although mathematically too complex to cover in a brief introductory tutorial to Bayesian inference, the differences among these more complex forms of Bayes rules are simple to explain using a graphical representation called a Bayesian network (Figure 13 .10). A Bayesian network comprises a set of nodes and arcs where each node represents a conditional probability distribution for the variable that the node represents, conditioned on its parents (the nodes from which directed arcs connect to the node). For the benefit of statisticians, a Bayesian network is a (compact) factorization of the complete joint probability distribution over all variables represented by the nodes (Neapolitan, 2003) . The arcs in a Bayesian network represent the statistical dependence and independence relationships among the variables in the model. Figure 13 .10 is a Bayesian network diagram for our mini-BOSSS diagnostic expert system.\n\nThe fact that there is no arc between drooling saliva and more than one animal affected indicates that the probability of observing drooling of saliva in a cow, once we know whether the cow has FMD or MCD, is not affected by knowing that other animals have these symptoms and vice versa (knowing that other animals have drooling once we know that this cow has FMD does not change the probability that this animal is drooling). If drooling saliva and more than one animal affected were not independent, given that we know that the cow has FMD, then we could add an arc between them. Figure 13 .11 shows a portion of the Bayesian network that underlies the Pathfinder system, which is a diagnostic expert system for pathologists who are interpreting biopsies of lymph nodes (Heckerman et al., 1992) . The arcs between findings indicate that they are not independent, given diagnoses. Note that the Pathfinder network is a more realistic illustration of the size and complexity of the models used in diagnostic expert systems. In chapter 18, we discuss Bayesian networks in the context of Bayesian biosurveillance. That chapter discusses a really big model.\n\nRule-based expert systems may also find application in biosurveillance. A rule-based expert system (also known as a deterministic expert system) encodes medical knowledge in a set of if-then rules. Rule-based expert systems are simpler, conceptually, than probabilistic systems, b u t they are only appropriate for problems that do not involve reasoning under uncertainty. A rule-based formalism is appropriate when diagnostic or other knowledge can be represented as Boolean statements (e.g.,if A and B then C).A hospital or biosurveillance organization can use a rule-based expert system to automate case detection when the findings are diagnostically precise (e.g., when case-detection is based on diagnostically precise data such as a positive tuberculosis culture [Miller et al., 1997] ). Figure 13 .12 is an anthrax case detection rule from the Clinical Event Monitor, an embedded rule-based expert system developed by several of the authors (Wagner et al., 1997) . This rule is in a format that can be interpreted by a rule-based inference engine called CLIPS (National Aeronautics and Space Administration). The rule contains variables that represent findings of the disease anthrax. The part of the rule before the _> symbol is the IF part and the part after the symbol is the THEN part. If all the conditions defined in the IF segment are true--wide mediastinum is found in a chest radiograph report and gram positive rods are reported in laboratory results within 10 days of each othermthen the rule will conclude that there is a possible anthrax case. A typical rule-based expert system contains hundreds of such rules.\n\nIn medical applications, the requirement for manual input of data by busy clinicians is a significant barrier to the use of diagnostic expert systems (Graber and VanScoy, 2003) . In the 1970s, several research groups took this barrier seriously. They began to explore methods to embed diagnostic expert systemsm providing diagnostic support and, more generally, decision support--to clinicians without asking them to enter patient findings. Their research demonstrated that it is possible to obtain needed findings directly from existing clinical information systems (Evans, 1991 , Gardner et al., 1999 , Rind et al., 1993 , McDonald, 1976c , McDonald et al., 1992a , McDonald, 1976b , McDonald et al., 1992b , Overhage et al., 1996 (defrule detect anthrax (event Radiologyrepoa) (report (patient, id ?patient, id)) (freete~ ?freetext) (test (str-index \"wide mediasfinum\" (lowcase ?freetex~))) =3> (if(> (cCheckC~ams ?patientid \"GPR\" I 0) -1) then (event ANTHRAX) (printout t \"Found gram positive rods and widened mediastinum in chest x-ray\" crlf) (printout t ........ Detected a possible ANTHRAX case ..... \" crlf) ) F ! G U R E 13.12 An anthrax-case detection rule in the Clinical Event Monitor, a rule-based expert system. The rule is written in CLIPS, a language and expert system shell developed by the National Aeronautics and Space Administration. Wagner et al., 1997) and from alterations in work flow, such as replacing unstructured paper records with computer-generated encounter forms (from which findings can be optically scanned or manually extracted) (McDonald, 1976a , McDonald et al., 1992a , McDonald, 1976b , McDonald et al., 1992b . The research also demonstrated how diagnostic expert systems can be embedded in clinical information systems, such as physician order entry systems (Tierney et al., 1993 , Dexter et al., 2001 and electronic medical records (Gardner et al., 1999 , Warner et al., 1997 . Several of these systems functioned in the domain of hospital infection control (Hripcsak et al., 1997 , Hripcsak et al., 1999 , Kahn et al., 1996a , Kahn et al., 1996b , Kahn et al., 1993 . The secret to successful deployment of a diagnostic or other expert system in medicine is designing a system in which the benefits to clinicians (from decision support and increases in efficiency) outweigh any additional effort required by clinicians to enter data by a considerable margin.\n\nIn addition to the diagnostic expert systems for hospital infection control just outlined, there are two other projects developing systems in the domain of biosurveillance. Shannon and colleagues at the Children's Hospital in Boston are developing a web-based diagnostic expert system to assist emergency room clinicians with diagnosis of approximately 20 diseases caused by biological agents known to have been weaponized or that are otherwise of concern as potential bioterrorist threats. The system has developed and evaluated on-line educational modules about the biological agents (Chung et al., 2004) , and is intended to support the reporting of cases to local, state, and federal agencies (Shannon et al., 2002) . Similar to stand-alone expert systems, the web-based tool requires clinicians to manually enter patient information.\n\nThe National Library of Medicine has developed a system called WISER (Wireless Information System for Emergency Responders) to assist first responders when they arrive at a hazardous material (Hazmat) incident, such as a chemical spill (http://wiser.nlm.nih.gov/). WISER operates on a personal digital assistant (PDA) and can send and receive data with a central location and other PDAs running the WISER program through a wireless network. WISER contains a diagnostic expert system that provides assistance in identification of an unknown substance and, once the substance is identified, provides guidance on actions to save lives and protect the environment. The WISER framework could be expanded to include a diagnostic expert system for the analysis of patient or animal findings.\n\nRecall that the best case detection system imaginable would be one in which every individual in a community is examined every morning by the best diagnostician in the world. Since she would be examining everyone every day, she would be aware of patterns of illness in a community and this awareness would appropriately influence her diagnostic thinking (and treatment) of individual patients. 3 This diagnostician would also never fail to report immediately each fever, early syndromic presentation, or reportable disease to governmental public health.\n\nDiagnostic expert systems are the key to building such a system. The research we reviewed in this chapter has already solved most, if not all, of the technical problems. What is needed is the will to create such a system.\n\nIf and when diagnostic expert systems are embedded in the clinical information systems of every hospital (animal and human), long-term care facility, clinic, and laboratory in a region, they will be able to notify a health department or other biosurveillance organization of every fever, syndromic presentation, and reportable disease in individuals receiving medical or veterinary care. If diagnostic expert systems are made available to the public or to selected high-risk populations (e.g., postal employees or patients with preexisting conditions such as asthma or diabetes), case finding would be extended to an even larger fraction of the population, approximating the \"every-patient-every-day\" capabilities of an ideal case detection system. If a biosurveillance system located in a region's health department were to receive the differential diagnosis for each individual in the region in real time (anonymously, of course, and perhaps selectively based on diseases and probability thresholds), it could compute the current incidences of these conditions. It could monitor the region for increases in incidence of findings, syndromes, and diseases of concern.\n\nNote that the outputs of a probabilistic diagnostic expert system are posterior probabilities of diseases for one patient, so the central monitoring would be monitoring of the sums of the probabilities for all reported patients. Figure 13 .13 illustrates this summation. It plots the daily sums of the posterior probabilities of \"flu-like\" illness of all patients seen in emergency departments on each day. If the diagnostic expert systems are well calibrated, the sums of the posterior probabilities should equal the actual number of patients with the disease in the population being evaluated by the system.\n\nFinally, if the biosurveillance system would then communicate the current fever, syndrome, and disease incidences back to the diagnostic expert systems being used by clinicians and citizens, we would realize the \"diagnosticians-are-aware-ofpatterns-of-illness-in-the-community\" capability of an ideal case detection system. F I 6 O R E 13.13 Daily sum of syndrome probabilities produced by SyCO 2. SyCO 2 computes the posterior probability that a patient has a flu-like illness from his chief complaint. (From Espino, J., Dara, J., Dowling J, et al. (2005) . SyCo2: A Bayesian Machine Learning Method for Extracting Symptoms from Chief Complaints And Combining Them Using Probabilistic Case Definitions. Pittsburgh, PA: Center for Biomedical Informatics, University of Pittsburgh, with permission.) An outbreak-detection system would sum the posterior probabilities of flu-like illness from all patients seen in 24-hour periods to form a time series of expected daily counts of patients with respiratory illness. Readers familiar with Bayesian statistics will recognize this sum as the expectation for the number of individuals with a given diagnosis. This ideal approach underlies the Bayesian approach to outbreak detection described in Chapter 18 Bayesian Methods for Diagnosing Outbreaks. PANDA (Population-wide ANomaly Detection and Assessment)rathe research system described in that chapter--actually merges many individual diagnostic Bayesian networks into a very large network that also includes a subnetwork that draws inferences about the presence or absence of an outbreak. PANDA is pursuing this idea on a citywide scale. Conceptually, a PANDA network comprises millions of person-specific diagnostic Bayesian networks, each of whose probabilities of disease (e.g., anthrax) are being influenced by population-level observations (e.g., aggregate sales of over-the-counter medications) and population-level inferences (e.g., the likelihood that other individuals who may have inhalational anthrax are present in a population). PANDA also includes a prior probability distribution over outbreak diseases (e.g, the prior probability of inhalational anthrax, based on the national terror alert level). By integrating person-specific diagnostic submodels into a population-wide super model, approaches like PANDA are able to make inferences about the probability of a disease outbreak in the population as a whole, as well as the probability of disease in individual people (or subgroups of people) within the population.\n\nAn ideal case detection system would also support case finding during outbreak investigations. Case definitions (described in Chapter 3) are the basis for case-control studies and investigations of emerging diseases. A computer-interpretable case definition is a prerequisite for providing computer-support to case finding during investigations. As discussed in Chapter 3, case definitions are Boolean (logical) statement of findings (Figure 13 .14).\n\nCase definitions, as currently written, are not well suited for automation. The authors of the SARS case definition intended it for use by physicians and epidemiologists, not computers. The clause \"findings of lower respiratory illness (e.g., cough, shortness of breath, difficulty breathing)\" does not enumerate all findings of lower respiratory illness. A computer requires a complete enumeration of all findings that it should count as evidence of lower respiratory illness (e.g., cough, shortness of breath, difficulty breathing, wheezing, cyanosis, tachypnea, dullness to percussion, fremitus, whispered pectoriloquy, rales, and rhonchi). The findings would also have to be described more precisely. For example, a physician or an epidemiologist would not count chronic cough or cough associated with asthma as a finding of lower respiratory illness when applying this case definition, but a computer would (unless told otherwise). Note that it is difficult, if not impossible, to enumerate all of the possible exceptions to the counting of a finding as evidence of a disease. This difficulty is the reason that diagnostic expert systems in medicine are probabilistic. They quantify the number of exceptions to a categorical statement about the relationship between findings and disease using probabilities. For example, 70% of patients with cough have an acute lower respiratory illness, but 30% (the exceptions) have some other cause. This observation suggests that computerinterpretable case definitions will employ Bayesian networks, as illustrated by Figure 13 .15.\n\nFor readers interested in the topic of knowledge representations for computer-interpretable case definitions, there is Case definition for confirmed case of SARS-CoV disease: (early OR mild-tomoderate OR severe illness) AND laboratory confirmation Definitions of Terms used in Case Definition:\n\nEarly illness: two or more of the following findings: fever (might be subjective), chills, rigors, myalgia, headache, diarrhea, sore throat, rhinorrhea.\n\nMild-to-moderate respiratory illness: Temperature of>100.4~ F (>38 ~ C) AND one or more findings of lower respiratoIT illness (e.g., cough, shortness of breath, difficulty breathing) Severe illness* Laboratory confirmation: serum antibody to SARS-CoV by a test validated by CDC (e.g., enzyme immunoassay [EIA]), OR isolation in cell culture of SARS-CoV from a clinical specimen, OR S ARS-CoV RNA by a reverse-transcripti~176 chain reaction (RT-PCR) test validated by CDC and with subsequent confirmation in a reference laboratory (e.g., CDC).\n\nFIGU RE 13.14 Excerpt from the CDC case definition for confirmed SARS-CoV disease (http://www.cdc.gov/ncidod/sars/guidance/b/appl.htm). Only the definitions relevant for classifying a patient as a probable case of SARS CoV are shown. (We omitted the definition of severe respiratory illness for clarity. The illness clause in the case definition for confirmed case of SARS-CoV disease is a disjunction, and all patients that satisfy the definitional criteria for severe disease also satisfy the criteria for mild to moderate respiratory illness. F I G U R E 13.15 A Bayesian network \"case definition\" for anthrax. The network computes the posterior probability for a patient addmitted to the emergency department. Cxr order, electronic record of an order for a chest radiograph; wide med, chest radiograph finding of wide mediastinum; Gpr, gram-positive rods in blood or cerebrospinal fluid (CSF) smear; micro order, order for a blood or CSF culture. (From Espino J., Tsui, E-C. (2000) . A Bayesian network for detecting inhalational anthrax outbreaks. Pittsburgh, PA: Center for Biomedical Informatics, University of Pittsburgh, with permission.) literature from research on computer-interpretable patient care guidelines that is relevant to this topic (Shiffman et al., 2004 , Tu and Musen, 2001 , Boxwala et al., 2004 , Wang et al., 2003 , Seyfang et al., 2002 , Fox et al., 1997 , Terenziani et al., 2003 , de Clercq et al., 2004 , Johnson et al., 2001 , Ciccarese et al., 2004 , Parker et al., 2004 .\n\nDespite the unfamiliarity of most readers with diagnostic expert systems, we chose to begin our discussion of algorithms for biosurveillance with this topic because case detection provides the case data needed for outbreak detection. Outbreak detection cannot function without case detection (unless the surveillance data are aggregated data, such as daily sales of over-the-counter thermometers).\n\nDiagnostic expert systems have the potential to improve the quality and completeness of the case data available to analytic methods designed to detect and characterize outbreaks, which we discuss in the following chapters. They can profoundly improve the reporting of syndromes. Improvements in case detection will translate directly into improvements in the earliness of outbreak detection and characterization.\n\nMcDonald did not conclude in his seminal paper that the solution to the non-perfectibility of man was to admit only women to medical schools. Rather, he stated, \"Thus, I conclude that though the individual physician is not perfectible, the system of care is, and that the computer will play a major part in the perfection of future care systems.\" His pointmthat technology can be used to create a system (involving both humans and computers) that can then be perfected--also seems to apply to biosurveillance systems.\n\nFor readers who are interested in diagnostic expert systems for diagnosing plant diseases, Travis and Latin (1991) briefly reviewed several diagnostic expert systems in plant pathology, including PLANT/ed, Apple Pest and Disease Diagnosis, CALEX/Peaches, Muskmelon disorder management system, and Penn State Apple Orchard Consultant, in \"Development, Implementation, and Adoption of Expert Systems in Plant Pathology.\""}