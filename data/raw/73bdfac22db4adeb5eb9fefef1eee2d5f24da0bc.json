{"title": "WSE, a new sequence distance measure based on word frequencies", "body": "The elucidation of the evolutionary history of different species is a major concern to biological science. Early approaches to deal with it were mainly based on the alignment of a gene or protein sequence. But on one hand, ''different genes may tell different stories\"-unequal mutational rates of different genes or different pieces of genes and lateral gene transfer are widely detected, so a single gene or protein sequence usually does not have enough information to determine its phylogenetic position. On the other hand, traditional alignment methods are computationally intensive and meaningless to whole genome comparison because each genome has its own genes and gene order. In a word, there is an urgent need to develop new phylogenetic methods utilizing the ever-increasing genome data.\n\nIn recent years, several alignment-free phylogenetic methods have been proposed [1] [2] [3] [4] [5] [6] [7] [8] [9] [10] [11] [12] [13] [14] [15] . Among the earliest attempts is the gene content method [1, 2] , which utilizes the ratio between the number of genes two species share and the total number of genes. This method is very simple and can be applied to long genomes. But it fails when species are closely related to each other, e.g., mt genome sequences of some placental mammals used by Cao et al. [3] . Because these genomes share exactly the same genes and gene order. Similar work along this line is the gene order method [4] , which also fails in the above case. Besides, some methods based on graphical representations of DNA sequences are outlined [5] [6] [7] [8] [9] [10] , which usually translate a DNA sequence to a set of plots in 2D/3D space, and use some graphical invariants to characterize this sequence. These methods provide a simple way of viewing, sorting and comparing various gene structures.\n\nAnother widely studied method is based on the short word composition of biological sequences. Observing that relative abundances of all dinucleotide are remarkably constant across the genome, Karlin et al. [11] [12] [13] proposed the genome signature to characterize this genome. The genome signature consists of the array of dinucleotide relative abundances q xy \u00bc f xy =f x f y extended over all dinucleotides, where f x is the frequency of nucleotide x and f xy is the frequency of dinucleotide xy. Alternatively, relative abundance of tri-, tetra-or even k-nucleotides can also be calculated. Besides phylogenetic inference, these signatures have been used in several applications, e.g., assessment of general relatedness of genomes [12] , genetic sequence classification [16] , clustering of genes from different genomes [17] , and recognition of species-specific sequence blocks [18] .\n\nAfter counting frequencies of all k-nucleotides (or k-mer, kword, etc.) in a DNA or protein sequence, we can represent this sequence as a vector in the 4 k or 20 k -dimensional Euclidean space. Since the frequency of a k-nucleotide measures the probability of its occurrence in the given sequence, it is intuitive to use the relative entropy between two frequency vectors as a measure of distance. Let p i A and p i B be the observed frequencies of the i-th knucleotide in sequences A and B, respectively. The relative entropy (or Kullback-Leibler distance) [19] is defined as The relative entropy is the inefficiency of assuming that the distribution is p B when the true distribution is p A . It does not satisfy the symmetry condition and the triangle inequality, so it is not strictly a distance measure. The relative entropy, however, satisfies many important and useful mathematical properties. For example, it is a convex function of p i A , always nonnegative, and vanishes if and only if p i A \u00bc p i B for all possible i. Apparently, vector representations of biological sequences will lose some information in the case of small k, e.g., only nucleotide composition is known when k \u00bc 1. More information (especially the sequence-order information) will be captured if we consider higher-order words. But unfortunately, as the word order increases, some word types in one sequence may be absent in the other sequence. This leads to the degenerate result when Formula (1) is used. Meanwhile, it is widely detected that some ''word spaces\" are not saturated for an individual genome, especially for protein sequences. A research of the 101,602 protein sequences in SWISS-PROT database Rel. 40 (2000) showed that all these proteins have taken only less than 26% of the 6-aminoacids strings. In particular, EcoliK has taken less than 2% and Mycge less than 0.3% of the 6-aminoacids strings [20] .\n\nTraditionally, in order to avoid the degeneracy, one can unite some k-words (i.e., words with frequencies up to a particular threshold) into one event. However, this will also be accompanied by a loss of sequence information. In this paper, we give a new distance metric to overcome the degeneracy. As a revision of the classical relative entropy, this metric works equivalently to the relative entropy in phylogenetic inference when k is small, and avoids the degeneration in the case of large k. In the main text, we give the mathematical description and a simple implementation of this metric. As to its application, we construct phylogenetic trees of 25 viruses including SARS-CoVs.\n\nGiven a DNA or protein sequence of length L, we count the occurrences of words of length k. Partial overlap of words is allowed. There are in total 4 k possible words for DNA sequences and 20 k words for protein sequences. The frequency of a word a 1 a 2 . . . a k is obtained from its occurrence c\u00f0a 1 a 2 . . . a k \u00de by dividing the total number of words \u00f0L \u00c0 k \u00fe 1\u00de in the given sequence\n\nThe above frequency reflects both the results of natural selection and random mutations [20] . In order to highlight the selective diversification of sequence composition, one should subtract the background from the simple frequency results by dividing the corresponding expected value:\n\nwhere f exp \u00f0a 1 a 2 . . . a k \u00de is the background frequency of word a 1 a 2 . . . a k . There are many approaches to estimate background frequency of a word in a sequence. In the present paper, we use the simplest one which is based on the Markov model of order 0 [11] [12] [13] 21] . For example, the trinucleotide ACT has the expected frequency f exp \u00f0ACT\u00de \u00bc f \u00f0A\u00def \u00f0C\u00def \u00f0T\u00de. More elaborate estimations, e.g., models of higher-order Markov process, can be defined accordingly.\n\nNote that p \u00c3 is actually not a probability distribution since the sum of its components is not 1. We normalize it here by dividing the sum:\n\nIn order to overcome the degeneracy, we replace p i\n\nOur remedy is meaningful since\n\nis also a distribution. Actually, Formula (2) can be treated as the relative entropy between p A and the arithmetical average value of distributions p A and p B . Here RE 1 \u00f0A; B\u00de 6 \u00bc RE 1 \u00f0B; A\u00de. In order to ensure the symmetry condition, we take the sum\n\nRecall that Shannon's information entropy\n\nas the entropy of arithmetical average value of distributions p A and p B . Then D 1 \u00f0A; B\u00de can be rewritten as\n\nAlternatively, we can give more elaborate weights to p i A and p i B , e.g., the sequence lengths L A and L B , or their square roots ffiffiffiffiffi L A p and ffiffiffiffi ffi L B p (the accuracy in estimation of probability in multinomial distribution is proportional to square root of the corresponding sequence length). This gives another two relative entropy functions\n\nTheir corresponding distance measures can be defined and calculated similarly,\n\nSince D 1 , D 2 and D 3 are all linear combinations of Shannon entropies, we call them the Weighted Sequence Entropy (WSE). According to their definitions, these distances can avoid the degeneracy as their upper bounds are 2,\n\nTo illustrate the virtues of WSE, we give an example as follows. The first exon of b-globin gene of Lemur is S = ATGACTTTGCTG AGTGCTGAGGAGAATGCTCATGTCACCTCTCTGTGGGGCAAGGTGGAT GTAGAGAAAGTTGGTGGCGAGGCCTTGGGCAG. There is only one dinucleotide TA in this sequence. If a point mutation which changes T in the only dinucleotide TA to C occurs (denotes the new sequence by S 0 ), then the relative entropy between S and S 0 is 1, which contradicts the biological meaning. While our methods give the values 0.0245821, 2.26155 and 0.23578 instead.\n\nThe outbreak of severe acute respiratory syndrome coronavirus (SARS-CoV) in 2003 has had a tremendous impact on worldwide health care systems [22, 23] . Coronaviruses are members of a family of enveloped viruses that replicate in the cytoplasm of animal host cell. According to the type of the host, coronaviruses isolated previously can be classified into three groups. Groups I and II contain mammalian viruses, whereas group III contains only avian viruses. After genome sequencing of some SARS-CoVs, many efforts have been made to identify the phylogenetic position of SARS-CoVs in coronavirus tree using molecular data. However, this is still a controversial topic-alignment-based methods showed that SARS-CoVs are not closely related to any previously isolated groups and form a new group [24, 25] ; maximum likelihood tree built from a fragment of the spike protein preferred SARS-CoVs clustering with group II coronaviruses (murine hepatitis virus and rat coronavirus) [26] ; while an information-based method, which makes use of the whole genome sequences, indicated that SARS-CoVs are close to the group I coronaviruses rather than form a new group [27] .\n\nIn the present work, we select 25 complete virus genomes: 12 coronaviruses from the three isolated typical groups, 12 SARS-CoV strains, and a torovirus, which serves as the outgroup for coronaviruses [28] (Table 1) . Pairwise distance matrices for these 25 sequences are calculated using our distances (D 1 , D 2 and D 3 ) and the classical relative entropy. Notice that RE does not satisfy the symmetry condition. We use the sum of RE\u00f0A; B\u00de and RE\u00f0B; A\u00de instead. Then, phylogenetic trees are built from these matrices using the UPGMA program in the PHYLIP package [29] . Finally, rooted phylogenetic trees are drawn by TREEVIEW program [30] , and some of them are shown in Figs. 1 and 2.\n\nOur three WSE distances (D 1 , D 2 and D 3 ) perform similarly for all values of k (from 2 to 7). They get nearly the same phylogeny except for the length of some branches. This is under our expectation since these genomes have no significant difference in length (except for torovirus).\n\nTrees constructed by RE and our distances are of the same topology at the word lengths k \u00bc 2 and 3 (these common topologies are shown in Fig. 1 ). But when k P 4, the relative entropy fails as some words are absent in these genomes (Table 2) . Explicitly, (1) Phylogenetic result got for k \u00bc 2 deviates significantly from the commonly accepted one. This phylogeny prefers murine hepatitis viruses as the outgroup (Fig. 1a) ; (2) The word order k \u00bc 3 seems to make a remarkable improvement ( Fig. 1b) : three typical groups of coronaviruses, and 12 SARS-CoVs, all cluster accordingly. Two big branches are formed: one is the group I coronaviruses and all SARS genomes, the other is the torovirus and group II and III coronaviruses. But this topology also does not support the outgroup status of torovirus.\n\nWith the definition of WSE, we can study higher-order words and check whether they are suitable to estimate phylogenies. WSE trees at word lengths k \u00bc 4; 5; 6; 7 are shown in Fig. 2 . As can be seen from Figs. 1 and 2, topologies of evolutionary trees converge with the increase of k, and become stable at k \u00bc 4, 5 and 6. These stable trees maintain the main topologies of Fig. 1b , and also successfully support the outgroup status of torovirus relative to all coronaviruses. When k P 6, the average frequency of words is too small for the present statistical analysis. In conclusion, we prefer k \u00bc 6 giving the best phylogeny, that is, all 12 SARS-CoV strains are grouped together and form a new fourth group, which is distinctly related to the group I coronaviruses (TGEV, explicitly).\n\nBesides the relative entropy, there are a great many of alignment-free comparisons on the basis of short word composition. In this part, we will list some of them and compare them with our method through phylogenetic experiments on the same data set.\n\n(1) Euclidean distance [31, 32] :\n\nwhere f i A and f i B are the frequencies of the ith word in sequences A and B, respectively.\n\n(2) Linear correlation coefficient [33] :\n\n(3) Cosine function [20, 34] : where\n\nA , and f i A is the expect frequency of word i in sequence A estimated from the frequencies of appropriate shorter subwords under a Markov model of order k \u00c0 2.\n\n(4) Information-based similarity index [35] :\n\nwhere H i A \u00bc \u00c0f i A log f i A is the Shannon entropy for word i in sequences A. R i A and R i B represent the ranks of word i in sequences A and B.\n\nWe repeated our experiment using the above classical distances for different values of k, and some phylogenetic trees (at word length k \u00bc 6) are shown in Figs. 3-5. Phylogenetic tree obtained using Euclidean distance d Eucli as the dissimilarity metric is shown in Fig. 3 . This tree is mainly identical to our tree, i.e., torovirus stays outside of all coronaviruses, and SARS-CoVs are closer to the transmissible gastroenteritis virus (TGEV). But an obvious default in this tree is that it fails to cluster the three group I coronaviruses: HCoV-229E, PEDV and TGEV. Fig. 4 lists the phylogenetic tree constructed by d COS . This topology supports SARS-CoVs and group II as a closer pair, which is in accordance with the result of Li\u00f2 and Goldman using a fragment of the spike protein [26] . However, this tree also fails to cluster the group I coronaviruses. In Fig. 5 , we list the tree built by linear correlation coefficient between pairwise frequency vectors. This tree perfectly clusters species within each typical group, and supports the outgroup status of SARS-CoVs relative to other coronaviruses. But it fails to identify the outgroup status of torovirus relative to coronaviruses.\n\nPhylogenetic analysis from k-word composition is a good alternative approach to the traditional alignment methods. It has relatively low computational complexity, and does not suffer from genetic rearrangements and transposon activity, which serve as common ways of genome evolution. In most cases, biological sequences are represented as occurrence or composition vectors in a high dimensional Euclidean space, and phylogenetic results are high reliable on the quality of this vector representation. In order to capture more sequence information and obtain a better vector representation, the suitable word length is of critical importance. According to the information theory, this length reflects the balance between noise and information-some information may be lost if one uses overshort words, while noise will dominate when long words are considered. Moreover, suitable length of word is often species-specific. In a word, a well-defined distance measure which can be applied to any word length is of great importance.\n\nRelative entropy is one of the classical approaches to measure the dissimilarity between two composition vectors. However, as word order increases, this approach will get degenerate results due to the absent of some word types. In the present paper, we propose three revisions of the classical relative entropy (RE). These modifications perform equally with RE in phylogenetic inferences in the case of short words. But when long words are considered, our method still works and gets convergent phylogenetic topologies (in such case, RE gets degenerate results as some word types are absent). Through constructing phylogenetic trees using WSE and some classical distance measures, we find that, as far as the set of 25 virus sequences is concerned, our distances are not inferior to those classical methods. According to our tree, all SARS-CoVs form a group, which is more related to the group I coronavirus: TGEV. This result is mainly in accordance with the phylogeny given by Yang et al. [27] , and is also supported by the experimental evidence, which showed that group I coronaviruses (transmissible gastroenteritis virus, TGEV) specific antibodies are able to recog- nize antigens in SARS-CoV infected cultured cells [37] . We hope our modification can be served as an alternative approach to avoid the degeneracy, and has potential to study information expressed by different orders of words (when RE-based approaches are used). However, as sequences in our data set have no significant difference in length, our three weight methods give nearly the same phylogeny. According to the Central Limit Theorem, the accuracy in estimation of probability in multinomial distribution is proportional to sqrt(length). So when using relatively larger data sets, especially in the case that sequences have significant differences in length, we prefer the revision D 3 giving relatively competitive phylogenetic results.\n\nIn order to further assure our approach, and evaluate the performances of different WSE, we will do the following experimental and theoretical discussions. Experimentally, we will ''generate\" phylogenetic trees under different evolutionary models, and reconstruct the phylogenetic topologies from their corresponding external nodes (OTU) using our distances and RE. Then performance of different WSE can be evaluated by checking the consistency of these phylogenetic topologies. Theoretically, we hypothesize that order relations between pairwise sequence distances calculated by RE and WSE are in accordance, i.e., WSE\u00f0A; B\u00de <WSE\u00f0C; D\u00de if and only if RE\u00f0A; B\u00de < RE\u00f0C; D\u00de, for any sequences A, B, C and D (proof will be presented in our future paper). This phenomenon, on one hand, can partially explain the equivalence of WSE and RE in phylogenetic inferences in the case of short words, and on the other hand, can help to analyze the performances of different weight methods."}