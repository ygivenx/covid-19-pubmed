{"title": "Interfering Waves of Adaptation Promote Spatial Mixing", "body": "To investigate clonal interference in spatially extended populations, our model is set up to allow for an efficient simulation of many adaptation waves simultaneously in progress. The habitat is modeled by a lattice with periodic boundary conditions and is always fully populated. Each lattice site records the genetic identity of the locally dominating clone in a subpopulation. This approximate description of the gene pool of the whole population, which accelerates our simulations, is appropriate if subpopulations are strongly dominated by single clones; see Appendix A and Discussion for an explicit range of validity.\n\nWe first consider a linear habitat, where the genetic state of the population is represented by a lattice of length L. Natural selection is implemented so that adaptation waves run across sites and shift the spatial extent of different clones: In each generation, the clone at site i is replaced by the neighboring clone at site j with a probability proportional to 1 + sgn(\u0394W)c(|\u0394W|), where c is the speed of a Fisher wave driven by a fitness difference \u0394W = Wj \u2212 Wi, where the sign of \u0394W defines the direction of the wave.\n\nIn effect, the replacement rule generates adaptation waves traveling at an average velocity given by c = c(\u0394W). The function c(\u0394W) is chosen to represent the classical Fisher wave speed c(\u0394W)=2m\u0394W (with migration rate m = 14), valid for large populations with negligible genetic drift (Fisher 1937; Kolmogorov et al. 1937). Alternatively, we use the wave speed given by c \u223c 2\u03c1m\u0394W for strong noise (Doering et al. 2003; Hallatschek and Korolev 2009) with \u03c1m = 1, where \u03c1 represents the population density (see Appendix A for further details).\n\nTo simulate planar habitats, we represent the population on a hexagonal lattice of size L \u00d7 L. Natural selection is implemented such that the clone at site i is replaced by one of the neighboring clones j with a probability proportional to its fitness, Wj (normalized by the fitness summed over all neighbors). This replacement rule generates adaptation waves traveling at an average velocity c=2m\u0394W with a migration rate of m = 14, consistent with the classical Fisher\u2013Kolmogorov wave theory (see also Appendix A).\n\nNew beneficial mutations appear at a rate \u03bc per site (\u03bc thus represents the product of population density \u03c1 and beneficial mutation rate per genome) and survive genetic drift with probability 2s (Maruyama 1974), where s is the selective fitness advantage. When a mutation becomes established at position i, the fitness Wi of the i-th clone is updated according to Wi(t) = Wi(t \u2212 1) \u22c5 (1 + s). Effects of epistasis are absent, and the habitat is homogeneous such that selective pressures are the same throughout the habitat. The selective fitness advantage s of a mutation is chosen to be either constant s0 or drawn from a distribution with mean value s0. We choose either an exponential distribution or a hump-shaped gamma distribution with shape parameter k = 2, which are both frequently used in theoretical evolution models (Eyre-Walker and Keightley 2007). See inset in Figure 3 for the shape of these distributions.\n\nIn our simulations of interfering Fisher waves, we vary the following parameters: the beneficial mutation rate \u03bc per site, the habitat size L, the relation between speed c of traveling waves and fitness differences (linear habitat only), and the mean selective fitness advantage s0.\n\nStarting from a population devoid of genetic variation, our model generates a population of genotypes that differ in the amount and type of beneficial mutations they carry. After a transient period, in which genetic diversity builds up, the mean fitness in the population increases at a steady pace by the fixation of beneficial mutations. We quantify the speed V of adaptation by the mean fitness increase per generation.\n\nFigure 2 shows the adaptation speed as a function of the habitat size L for various mutation rates and selection coefficients. For small habitat sizes, the adaptation speed is linear in the habitat size, which indicates that adaptation is limited by the occurrence of mutations: Doubling the habitat size, and thus the influx of beneficial mutations, doubles the adaptation speed. We thus recover the classical regime of periodic selection, in which beneficial mutations sweep strictly sequentially, as illustrated in Figure 1A. In this regime, the dynamics of individual sweeps are irrelevant, and the mean fitness increase per generation is given by 2NUbs02, just as in the corresponding well-mixed case. However, as the habitat size exceeds a characteristic length scale Lc, we observe that the adaptation speed begins to saturate due to clonal interference. For very large systems, the adaptation speed approaches a limiting value Vmax.\n\nThese results call for an explanation of the \u201cinterference\u201d scale Lc at which clonal interference sets in and of how the magnitude of the \u201cspeed limit\u201d Vmax depends on the parameters, in particular mutation rates and Fisher wave speed. It turns out that\u2014for constant fitness effects\u2014relatively simple estimations can be given for both quantities.\n\nThe condition for clonal interference, and hence the characteristic scale Lc, can be determined by comparing two important timescales. The first timescale estimates how long it takes for a single adaptation wave to run across the length L of the habitat. This fixation time is given by tfix \u2248 L/c0, where the traveling speed c0 depends on the selection coefficient s0. The second timescale is the waiting time tmut for a new beneficial mutation to become established, which is inversely proportional to both the establishment probability 2s and the rate \u03bcbLd at which beneficial mutations appear. The latter depends on the dimension d of the habitat (d = 1 and d = 2 for a linear and a planar habitat, respectively). We thus obtain the mutation waiting time tmut \u2248 (2s0Ld\u03bc)\u22121. Now, the mode of adaptation depends on the relative size of tfix and tmut: If the fixation time is smaller than the mutation waiting time (tmut < tfix), we expect periodic selection. In the opposite case, we expect clonal competition. The crossover from periodic selection to clonal interference occurs just when tfix \u223c tmut, implying a characteristic \u201dinterference scale\u201d of\n\nNext, we use this estimate to find an approximate expression for the adaptation speed limit Vmax observed in Figure 2. To this end, it is convenient to express the adaptation speed in the following general form:(2)V=2s02Ld\u03bc\u22c5F(LLc).The factor 2s02Ld\u03bc on the right-hand side is the rate at which beneficial mutations accumulate in the absence of clonal interference. The function F represents the probability that a mutation reaches fixation once established. When mutations arise sequentially, each established mutation also reaches fixation; hence F \u223c 1 for small habitats, L \u226a Lc. On the other hand, for large habitats (L \u226b Lc) clones interfere and F becomes very small. How small? Given that the adaptation speed saturates at large system sizes, as inferred from our simulation results in Figure 2, we must require that the habitat length L drops out of Equation 2 for large habitats. This can occur only if F(L/Lc) \u223c (Lc/L)d for large L. Hence, we estimate the speed limit for large systems by(3)Vmax\u223cs02Lcd\u03bc\u221d{\u03bc1/2,linear habitat\u03bc1/3,planar habitat.It can be seen from Equation 2 that the scaled adaptation speed V/V0 with V0 = s0c0/L should be a unique function of the scaled mutation rate \u03bc/\u03bc0 with \u03bc0 = c0/(2s0Ld+1). Therefore, if we plot our data sets for different parameters in one figure using axes V/V0 and \u03bc/\u03bc0, they should all collapse on a single master curve. The resulting scaling plots for linear and planar habitats are shown in Figure 3. Data corresponding to constant selection coefficients (Figure 3, black line) do indeed collapse on a single master curve, even though we varied \u03bc, s0, and the type of adaptation wave (weak/strong genetic drift). Note also the transition from a linear regime to the sublinear regimes with power law exponents 12 and 13 in one and two dimensions, respectively. These exponents are consistent with our prediction in Equation 3.\n\nMoreover, Figure 3 displays results for simulations in which the fitness effects of new mutations were drawn from an exponential and a gamma distribution (with shape parameter k = 2), respectively. Note that although data for the different distributions follow our scaling predictions individually, they are slightly shifted with respect to each other. This indicates that the prefactors of the adaptation speed depend on the tails of the distribution. Broader distributions tend to yield larger adaptation speeds, apparently because they will more frequently give rise to the sampling of unusually large-s clones that outcompete average-s clones. As a consequence, fixations are more frequent and the adaptation speed is higher (see also Appendix F). The effect is stronger in the clonal interference than in the periodic selection regime.\n\nBoth the existence of a speed limit Vmax for large habitats and its dependence on mutation rates contrast with the well-mixed case, where the adaptation speed depends logarithmically on both population size and mutation rates (see Discussion).\n\nTo further characterize the clonal interference regime, we have measured fixation times and fitness correlations in linear habitats as a function of habitat size; see Appendixes B and C. We find that tfix \u223c L3/2 for clonal interference and that the fitness variance scales linearly with the size of the habitat. Both observations suggest that our model shares some universal features with certain types of crystal growth models that have been extensively studied in physics (Kardar et al. 1986).\n\nWe investigate two strategies of mitigating clonal interference and increasing adaptation speeds. The classical solution to clonal interference is recombination, which allows us to combine beneficial mutations arising on different genetic backgrounds. For well-mixed populations, it has been predicted that the adaptation speed increases with the recombination rate as V \u221d r2 for large populations where clones interfere (Neher et al. 2010). This result demonstrates that increasing recombination rates can strongly speed up evolution. The effectiveness of this strategy can be appreciated from Figure 4A, which displays the adaptation speed as a function of habitat size for various recombination rates. To generate these data, we have incorporated recombination in our simulations as follows. Recombinants are produced at a rate r per site from two (haploid) individuals randomly selected from the nearest neighborhood in the parent generation (selfing is allowed). Recombinant genotypes are formed from the parental genotypes by one-point recombination: The parent chromosomes are paired and a point is randomly chosen by which both chromosomes are split. The mutations to both sides of the recombination point are then exchanged between the two chromosomes, forming the recombinant genotype (see Appendix A for further details).\n\nNext, we study spatial mixing as an alternative way of mitigating clonal interference. Spatial mixing is implemented so that any given clone competes at a small rate ml with a randomly chosen clone rather than with its immediate neighbor (see Appendix A for details of the implementation). The effect of these long-range jumps on the adaptation speed is shown in Figure 4B. Long-range migration has no effect on the periodic selection regime, because it does not change the limiting supply of beneficial mutations. In the clonal interference regime, however, adaptation speeds are continually increasing as a function of jump rate. The effect is large: Allowing for long-range jumps only every 1000 generations approximately yields a fivefold increased adaptation speed in the clonal interference regime.\n\nLong-range migration seems to be an efficient way to mitigate clonal interference, which has significant consequences for evolution (see Discussion). The basic mechanism can be understood as follows: Long-range migration allows clones to replicate themselves at different locations, which enables them to effectively grow at a faster rate. In other words, a clone that has led to a second \u201cseed\u201d by means of long-range migration will grow twice as fast as a clone with only one seed. A third seed triples the growth rate, etc. In effect, when clonal interference is absent, one obtains exponential growth with the rate(4)se=2mlc0,which depends on the selection coefficient through the wave velocity relation c0 = c(s0). A derivation for this rate is given in Appendix E. Note that the resulting exponential growth of mutants mirrors selective sweeps in well-mixed populations, however, with a quite different effective selection coefficient se (see also Discussion). Importantly, the resulting fast Malthusian growth accelerates the fixation process of beneficial mutations. As a consequence, mutations that would interfere without long-range migration are now more likely to arise sequentially. Consistent with this view, Figure 4 shows that the linear regime of periodic selection is extended to a larger parameter range as the long-range migration rate is increased. Of course, for sufficiently large habitat sizes, clonal interference also occurs in the presence of long-range migration. However, the number of simultaneously competing clones is reduced due to the faster sweeps. This leads to generally larger adaptation rates than for clonal interference without long-range migration, as seen in Figure 4.\n\nA crucial feature of adaptation in spatially extended populations is that advantageous mutations spread through the population by means of traveling waves (Fisher 1937; Kolmogorov et al. 1937). This wave-like motion implies that clones grow at a constant speed, in strong contrast to the accelerating logistic growth characteristic of well-mixed populations. We have established a model of adaptation by waves to investigate the rate at which beneficial mutations are accumulated in spatially extended populations. Our model represents the gene pool of local subpopulations by the locally dominating genotype. This representation is appropriate when clonal interference is absent within these subpopulations. This sets an upper bound to the beneficial mutation rate Ub\u226as0/m/K (see Appendix A). When the beneficial mutation rate is still larger, one obtains a hybrid scenario of clonal interference on a local well-mixed scale and clonal interference by adaptation waves (E. A. Martens and O. Hallatschek, unpublished results). With the assumptions of a homogeneous habitat (constant selection pressure), short-range migration, and negligible epistasis, our model is a first step toward understanding clonal interference in spatially structured populations, such as microbial colonies or biofilms. We expect that similar phenomena to those reported here may be observed in other rapidly evolving populations. Many natural populations are, however, characterized by more complex migration patterns than the stepping-stone model used in our work, for instance, influenza or SARS (Hufnagel et al. 2004; Kaluza et al. 2010; Eggo et al. 2011). For concrete predictions, the existing model needs to be extended to include these migration networks. There is also increasing evidence that spatial structure is relevant in evolutionary processes related to cancer progression (Salk et al. 2009), suggesting that similar modeling approaches may apply (Martens et al. 2011). In the following, we estimate under which conditions clonal interference might be observable in microbial colonies and discuss our key predictions and how they may be verified in microbial evolution experiments.\n\nClonal interference generally occurs when fixation times are larger than the waiting time for new beneficial mutations to arise in the population. Since adaptation waves travel at a constant speed and thus advance much more slowly than Malthusian sweeps, fixation times are much larger in spatially extended than in well-mixed populations. As a consequence, the regime of clonal interference is inflated in structured populations compared to well-mixed ones. The condition for clonal interference is made explicit by comparing the typical fixation time of a single beneficial mutation with the waiting time for it to arise. We found that clonal interference occurs when the habitat size is larger than a characteristic size Lc. The interference scale Lc not only defines a crossover, but also measures the typical distance an adaptation wave travels freely before it collides with another wave that arose independently of the first one. The tug-of-war between adaptation waves and the role of the interference scale Lc can be discerned from the simulation results in Figure 5.\n\nOur simple quantitative expression in Equation 1 for the interference scale was found to increase with the speed of adaptation waves and decrease with the rate of beneficial mutations per site. A similar characteristic length appears in the context of soft sweeps, where \u03bc has to be interpreted as the establishment rate for a particular beneficial mutation (Ralph and Coop 2010). For L > Lc, multiple clones carrying the same mutation collide and subdivide the habitat into patches of size Lc (see Figure 5A). This situation is similar to our case of s = const. when \u03bc is interpreted as the occurrence rate of a particular adaptation; in our model, however, waves belonging to different adaptations keep interfering with each other until one clone has reached fixation in the habitat.\n\nTo see whether clonal interference is relevant to microbial colonies, we estimate the order of magnitude of Lc (for details see Appendix D). We assume fitness effects on the order of 1% and mutation rates in the range of 10\u22126\u201310\u22124 per genome and generation. Given the large variance of the thickness of biofilms and microbial colonies, we consider a range of cell densities between 1 and 1000 per square cell diameter. This yields a mutation supply rate \u03bc that lies within the range of 10\u22126 and 10\u22121 per square cell diameter. For s = 1%, we estimate a deterministic Fisher wave speed c0 in the range of 0.1\u201310 cell diameters per generation by assuming that microbes in dense colonies disperse between 1 and 100 cell diameters per generation. Thus, we estimate Lc = (c0/(2s0\u03bc))1/3 to lie within 4 and 800 cell diameters. The characteristic interference length scale Lc = (c0/(2s0\u03bc))1/2 for a linear habitat could be relevant for expanding microcolonies. For instance, it has been shown that the expansion of a colony is driven by a thin layer of pioneer cells (Hallatschek and Nelson 2010; Nadell et al. 2010). This pioneer population at the expanding front evolves in an effectively linear habitat. Applying similar estimates to the above to the context of an expanding microbial colony, we estimate an interference scale between 50 and 500 cell diameters. Importantly, the length scales both for planar and for linear habitats are much smaller than typical sizes of microbial colonies or biofilms. We thus expect clonal interference to be a widespread phenomenon\u2014rather than the exception\u2014in growing dense cellular clusters that conserve their spatial structure over time.\n\nOur most important predictions for the regime of clonal interference may be summarized as follows: When the habitat size exceeds a characteristic length Lc, multiple adaptation waves are simultaneously in progress at any one time because beneficial mutations frequently arise on different genetic backgrounds. Which of the competing clones prevails and reaches fixation depends on a tug-of-war between interfering Fisher waves. Remarkably, we find that in this \u201cfrustrated\u201d situation, increasing the habitat size does not only lead to an increased loss of beneficial mutation: The adaptation speed actually even saturates to a limiting value Vmax, which is seen for both constant and distributed selective coefficients (see Appendix F). This speed limit of adaptation and its dependence on parameters were not revealed in a previous study (Gordo and Campos 2006), seemingly because too small habitats were simulated. A simple approximate expression for the speed limit is provided by Equation 3. In particular, we found that Vmax is proportional to \u03bc1/2 and \u03bc1/3 in linear and planar habitats, respectively. This scaling was shown to hold for various distributions of fitness effects, including constant and exponentially distributed fitness effects, for very noisy and for deterministic Fisher waves. We may thus conclude that the predicted power laws are very robust toward details of the underlying model.\n\nBoth the speed limit and the robust power law scaling with the mutation rate are in stark contrast to well-mixed standard models, which predict that adaptation speeds never saturate and depend logarithmically on both population size and mutation rates. An experimental comparison of adaptation in well-mixed and spatially structured habitats should therefore yield qualitatively and quantitatively different results. Experiments have already found qualitative differences in the adaptation dynamics of well-mixed and structured E. coli populations (Habets et al. 2006, 2007; Perfeito et al. 2008). Our model suggests that the speed limit of adaptation, Vmax, may be detected and thus quantified by varying the size of the microbial colony. The power law dependence of the limiting adaptation speed on both mutation rate and population density could be tested by comparing wild type with a mutator strain (Shaver et al. 2002) and by manipulating the thickness of the colony, respectively.\n\nThe prevalence of clonal interference and the associated speed limit raises the question of how clonal interference may be overcome in spatially extended populations. Certainly, genetic exchange [in bacteria through lateral gene transfer (Cooper 2007)] provides a mechanism that lessens clonal interference as it allows one to bring together beneficial mutations that arose on different genetic backgrounds; see Figure 5B. This hypothesis, originally formulated by Fisher (1930) and Muller (1932), is corroborated by our simulation results in Figure 4A. However, our simulations also show that spatial mixing is a very efficient alternative mechanism of mitigating clonal interference in structured populations. Spatial mixing increases the growth rate of fitter clones and thus lowers fixation times. Lowering fixation times increases the likelihood for beneficial mutations to occur sequentially on the same background, and therefore clonal interference is attenuated. In our simulations, spatial mixing was introduced by allowing for a small rate of long-range jumps. These jumps enable clones to replicate themselves at distant locations in the habitat, which was shown to lead to accelerated clonal growth, as illustrated in Figure 5C. When clones do not interfere, the growth is exponential. The rate of this exponential growth, or effective selection coefficient se, was found to depend on both the actual selection coefficient and the rate of long-range jumps (cf. Equation 4). Importantly, we found that, due to these fast Malthusian sweeps, even very small rates of long-range jumps strongly increased adaptation speeds in the clonal interference regime (cf. Figure 4B). Thus, long-range migration seems highly beneficial in spatially extended populations with homogeneous selection pressures. Nevertheless, it remains to be seen in future work whether alleles conferring the ability of long-range migration are actually selected, even if large jumps impose a danger (for instance, a long-range jump could be fatal to a cell if the cell is swept away to a harmful environment). This evolutionary mechanism could be relevant for biofilm-forming bacteria and select for occasional switching from the biofilm state to the more efficiently dispersing planctonic phenotype.\n\nIn summary, we have analyzed a model of interfering waves. Our model suggests that clonal interference is widespread in biofilms and leads to markedly different adaptation dynamics than in well-mixed populations. In particular, the speed limit Vmax and its power law dependence on mutation rates should be quantifiable in evolving microbial colonies. Finally, we found spatial mixing to be highly beneficial in structured populations as it relaxes clonal interference and speeds up adaptation."}