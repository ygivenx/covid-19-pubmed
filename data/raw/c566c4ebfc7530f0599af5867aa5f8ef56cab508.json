{"title": "A comparative evaluation of modelling strategies for the effect of treatment and host interactions on the spread of drug resistance", "body": "At the beginning of the 21st century, the emergence and spread of drug resistant pathogens presents a growing problem worldwide. The evolution of resistance is primarily affected by factors that govern pathogen-host interactions, with regard to both survival (such as the ability to replicate) and extinction (such as treatment regimens). These, combined with the ensuing processes of between-host pathogen transmission, call for a better understanding of mechanisms by which pathogens overcome the pressures that are applied to limit their replication and spread (Domingo and Holland, 1997) . Management of drug-resistance at both the individual and population levels has therefore become a crucial component of interventions directed against persistent pathogens (e.g., HIV, tuberculosis, influenza) and preparedness strategies for emerging infectious diseases (e.g., influenza pandemic) (Blower and Chou, 2004; Blower et al., 2003 Bright et al., 2005; de Jong et al., 2005; Kiso et al., 2004; Moscona, 2005) .\n\nSince resistance is both a cause and a consequence of drug use, integrated efforts are required to prioritize and develop effective treatment strategies that address the influence of immunological/ epidemiological characteristics of the individuals/population on the emergence of resistance. Mathematical models have proven to be essential tools for evaluating the impact of these competing strategies, by incorporating critical parameters that describe the dynamics of pathogen evolution and transmission (Dieckmann et al., 2002; Keeling and Rohani, 2008) . For instance, models describing the within-host infectious dynamics have provided new insights into the treatment regimens for acute self-limiting infections, and suggested that drug-resistance is unlikely to develop if treatment is initiated after the time at which the immune responses reach a certain threshold (Lloyd and Wodarz, 2006; Wodarz, 2001; Wodarz and Lloyd, 2004) . Recent studies have capitalized on such findings to design strategies for the prudent use of drugs at the population level, in order to reduce the pressure to select resistant pathogens (Alexander et al., 2007; Moghadas, 2008; Moghadas et al., 2008) . The results obtained from these studies for influenza infection as a case study show that, in the absence of pre-existing pathogen-specific immunity in the population, resistance is less likely to emerge if the large-scale treatment is delayed for a certain amount of time after the introduction of the pathogen. The principal mechanism underlying this treatment strategy is to sufficiently deplete the pool of susceptible hosts through initial prevalence of the drug-sensitive pathogen, which will in turn avert population-wide spread of resistance should selection occur when intensive treatment is implemented (Moghadas, 2008) .\n\nIn this study, we further investigate the merits of this adaptive treatment strategy in order to identify key parameters that affect its long-term epidemiological outcomes. To this end, the findings of a homogeneously mixing (mean-field) population dynamical model (Moghadas, 2008) is compared with its stochastic version. We extend this comparison to a more realistic situation, by considering heterogeneity of the population and incorporating local spatial correlations. In general, an individual (site) can potentially transmit infection to a small number of individuals through local contacts with neighbours. The set of these local interactions define a contact network, and disease spreads along the edges of this network. Such network models have been shown to offer a better approximation to the behaviour of large-scale epidemics than homogeneous models (Newman, 2002 (Newman, , 2005 . Here, we consider the simplest case, the so-called pair-approximation, in which the dynamics of only pair-wise interactions of neighbouring individuals is taken into account. Specifically, the pair-approximation assumes that the correlation between states of two neighbouring sites is independent of the state of any other randomly selected neighbour of the focal pair (Rand, 1999) . Taking correlations into account could significantly impact the spatial dynamics of an epidemic, particularly when pathogen strains with different characteristics/transmissibility compete for a single host population. In the following, we describe the assumptions that are embedded in the core of these models, and formulate their equations. To provide a comparative evaluation of treatment strategies, we simulate these models for influenza infection using parameter estimates extracted from recent modelling and clinical studies. Finally, we present the results and discuss the significance of our findings in the context of disease epidemiology and public health.\n\nTo formulate the models for disease transmission, we assume that the population is initially entirely susceptible to the invading pathogen that is sensitive to the drugs, but can subsequently develop resistance. Susceptible individuals may become infected through contacts with sensitive or resistant infections. Individuals infected with the sensitive pathogen may receive treatment and develop drug resistance during the course of treatment. Since the evolution of resistance is generally associated with fitness cost (Domingo and Holland, 1997) , we assume that the resistant pathogen is less transmissible than the sensitive pathogen. It is assumed that treatment reduces the infectiousness level of the sensitive infection (and therefore its transmissibility), but remains ineffective against resistant infection. For outbreaks with short duration, we ignore rates of birth and natural death, but consider disease-induced mortality. We also assume that recovered individuals acquire immunity that confers full protection against all pathogen strains.\n\nAssuming homogeneous mixing, we divided the population into classes of susceptible \u00f0S\u00de, infected with the sensitive pathogen who are untreated \u00f0I U \u00de and treated \u00f0I T \u00de, infected with the resistant pathogen \u00f0I r \u00de, recovered \u00f0R\u00de, and dead \u00f0D\u00de individuals. Fig. 1 shows the movements of individuals between these classes during the course of infection. Since treatment is ineffective against the resistant pathogen, we combined classes of untreated and treated resistant infection into a single population compartment \u00f0I r \u00de. Taking into account the above assumptions, the model can be expressed as the following system of deterministic equations:\n\nwhere the prime ' 0 ' denotes the derivative of the compartments with respect to time; b is the baseline transmission rate of the sensitive pathogen; d T represents the reduction in transmission of the sensitive pathogen from treated infected individuals; d r is the relative transmissibility of the resistant pathogen; d U and d U;r are disease-induced death rates of sensitive and resistant pathogens, respectively; d T is the disease-induced death rate of treated infected individuals; g U and g T represent recovery rates of untreated and treated infected individuals, respectively; a T is the rate at which treated individuals develop drug-resistance; and p is the fraction of infected individuals which receives treatment, referred to as the treatment level. Further details of the model structure can be found in Moghadas (2008) .\n\nAgain assuming homogeneity, we develop an alternative stochastic model for the dynamics of pathogen transmission in the context of drug-resistance, using the same classes of individuals as described for the mean-field model. Considering \n\nwhere Y\u00f0\u00c1\u00de \u00bc \u00c01 decrease in the class \u00f0\u00c1\u00de; 0 no changes in the class \u00f0\u00c1\u00de; 1 increase in the class \u00f0\u00c1\u00de:\n\nThe function Y\u00f0\u00c1\u00de describes the change in the status of an individual in the population by moving from one class to another during the time interval Dt. It is assumed that Dt is sufficiently small to allow for the occurrence of at most one change in every state of the model. Thus, the corresponding continuous time Markov chain model is fully described through possible transition rates given in Table 1 . Based on transition probabilities, the It\u00f4 stochastic differential equation (SDE) model can be formulated as dX\u00f0t\u00de \u00bcf \u00f0X\u00f0t\u00de\u00de dt \u00fe D\u00f0X\u00f0t\u00de\u00de d\u00f5\u00f0t\u00de,\n\nwheref \u00f0X\u00f0t\u00de\u00de is the drift vector, D\u00f0X\u00f0t\u00de\u00de is the diffusion matrix, and d\u00f5\u00f0t\u00de is a vector of independent Wiener processes (Allen, 2003) . The stochastic differential model can be explicitly expressed by definingf \u00f0X\u00f0t\u00de\u00de \u00bc E\u00f0DX\u00f0t\u00de\u00de, where, for example,\n\nHence,f \u00f0X\u00f0t\u00de\u00de is determined by the right hand side of the equations in the corresponding mean-field model. The term D\u00f0X\u00f0t\u00de\u00de in (8) is given by the square root of the covariance matrix \u00bdV\u00f0X\u00f0t\u00de\u00de, where\n\nV\u00f0X\u00f0t\u00de\u00de \u00bc E\u00f0DX\u00f0t\u00de\u00bdDX\u00f0t\u00de transpose \u00de \u00fe o\u00f0\u00f0Dt\u00de 2 \u00de.\n\nThe homogeneous mixing approach, in either its deterministic or stochastic formulation considered above, assumes that populations are uniformly spread through space and that individuals mix rapidly. More realistically, disease propagation occurs through localized, discrete interactions between susceptible and infected individuals, and therefore it is imperative to determine the effects of including spatial effects. A previous study of species interactions (Durrett and Levin, 1994) , represented by various models excluding mean-field and including spatial structure and stochastic effects, exhibited qualitatively different behaviours. More recently, stochastic, individual-based SIR models (Sch\u00fc tz et al., 2008) and other types of disease mechanism have shown the existence of stable spatial structures and other qualitative differences with the mean-field model. It is therefore essential to compare the results derived from the models considered above, with those that incorporate spatial structure. Inevitably, the latter possess parameters (e.g., the number of nearest neighbours and the degree of clustering in the population) that have no counterparts in the mean-field model, and it will be necessary to examine their behaviour over some realistic ranges of these parameters.\n\nWhile agent-based models can fully capture spatial effects through the dynamics of individual interactions, there are various methods that include some aspects of these effects and the simplest and most tractable way is to consider pair-wise correlations between neighbouring individuals (Keeling, 1999; Morris, 1997; Rand, 1999 ). The resulting system is comprised of a coupled infinite hierarchy of pair-, triplet-, and higher-order correlations; and therefore some form of moment closure assumption is required. The lowest-order closure (no correlations) yields the mean-field model. The next order, which is considered below, includes pair-wise interactions exactly and employs a closure assumption for representing triplets in terms of singlets and pairs. The population is represented by nodes of a contact network, and contacts between individuals by edges between nodes. Let A; B; C; . . . represent the states of individual nodes, and \u00bdA the number of individuals in state A, \u00bdAB the number of A \u00c0 B pairs, and \u00bdABC the number of A \u00c0 B \u00c0 C triplets, using the convention that \u00bdAB counts both A \u00c0 B and B \u00c0 A pairs (also, note that \u00bdABC \u00bc \u00bdCBA but \u00bdABCa\u00bdBCA, etc.). Therefore, all correlations of order three or higher are effectively treated as random noise (Rand, 1999) . It is worth mentioning that despite its simplicity, the pair-approximation appears to provide good quantitative agreement with stochastic simulation modelling of disease spread across a network (Keeling, 1999 ).\n\nLet f be the fraction of all triplets that also form triangles (Keeling, 1999; Morris, 1997) , and consider the triplet A \u00c0 B \u00c0 C: if this forms an open triangle (no edge between A and C) there is no correlation between A and C, whereas for a closed triangle correlation exists. For the entire population of N nodes, each node having n neighbours, the correlation between nodes of type A and C is defined as (Keeling, 1999) \n\nThus, when C AC \u00bc 1, A and C are uncorrelated and randomly located with respect to each other. To formulate closure in the pair-approximation model, we use the pair-closure assumption (Morris, 1997 ; van Baalen, 2000 )\n\nLocal interactions describing the pair dynamics in our model can be obtained in a similar way to the stochastic formulation above, as was also done in the standard 3-state SIR model (Keeling, 1999) . In the present model, the transmission rate per infected-susceptible pair is given by t \u00bc bS 0 =n, where S 0 is the initial size of the susceptible population. Also, both recovery and (disease-induced) death remove individuals from further interactions in the system, and for purposes of simplifying the dynamics can be merged into 'absorbing states' X and X r for recovery or death from sensitive and resistant pathogens, respectively. This reduces the model to a 6-state system: S, I U , I T , I r , X, X r whose pair-dynamics are described by \u00f06 \u00c2 7\u00de=2 \u00bc 21 equations (see Appendix A). The corresponding singlet dynamics (number of individuals in each state at a given time) follow from the general relationship (Keeling, 1999) :\n\nwhich allows for a direct comparison with the mean-field and stochastic models. Note that since the total population\n\nequations is redundant; however, it is retained in order to track numerical accuracy of the simulations (see Appendix A).\n\nOne of the most important parameters in disease transmission models is the basic reproduction number, defined as the number of new infections generated by a single infected individual introduced into an entirely susceptible population (Diekmann and Heesterbeek, 2000) . This threshold quantity, which characterizes whether or not an invasion is successful, is the product of three important parameters: the number of contacts with susceptible hosts per unit time; the probability of pathogen transmission; and the generation time. A related quantity is the control reproduction number that can be used to evaluate the potential impact of public health intervention strategies on containment of disease spread.\n\nFor evaluating and comparing the outcome of an adaptive treatment strategy in models developed above, we first compute the control reproduction number \u00f0R c \u00de when treatment is put in place. Since sensitive and resistant pathogens may have different transmissibility, we need to consider the introduction of each one into the population in the absence of the competing pathogen. In the mean-field model, assuming that an individual infected with the sensitive pathogen is introduced into the population of size S 0 such that I U \u00f00\u00de \u00bc 1, and I T \u00f00\u00de \u00bc I r \u00f00\u00de \u00bc R\u00f00\u00de \u00bc D\u00f00\u00de \u00bc 0, the number of new infections generated during treatment is pd T bS 0 =\u00f0d T \u00fe g T \u00fe a T \u00de. Without treatment, the number of secondary cases is given by \u00f01 \u00c0 p\u00debS 0 =\u00f0d U \u00fe g U \u00de, and therefore the total number of infections with the sensitive pathogen is\n\nA sensitive infection can develop drug-resistance during treatment with probability a T =\u00f0d T \u00fe g T \u00fe a T \u00de, and thereby generate a number of new resistant cases given by\n\nAssuming that an individual infected with the resistant pathogen introduced into the population such that I r \u00f00\u00de \u00bc 1, I U \u00f00\u00de \u00bc I T \u00f00\u00de \u00bc R\u00f00\u00de \u00bc D\u00f00\u00de \u00bc 0, and considering that treatment is ineffective, the total number of secondary cases with the resistant pathogen is given by R r \u00bc d r bS 0 =\u00f0d U;r \u00fe g U \u00de. Using the next generation matrix (Diekmann and Heesterbeek, 2000) , the control reproduction number is given by R c \u00bc maxfR s c ; R r g. In the absence of treatment \u00f0p \u00bc 0\u00de, R c reduces to R s 0 \u00bc bS 0 =\u00f0d U \u00fe g U \u00de as the basic reproduction number of the sensitive pathogen. It is generally expected that if the basic reproduction number is less than one, then the pathogen will be unsuccessful in invading the population and causing an outbreak. This motivates the implementation of public health measures (such as treatment) for reducing the transmissibility of a pathogen, should it invade with a reproduction number greater than one.\n\nSince the mean-field and stochastic models are concerned with the dynamics of individuals on a global scale, the method of next generation matrix can also be employed for the stochastic model, which leads to the same reproduction number R s 0 as obtained above. However, the pair-approximation model describes the dynamics of pairs of individuals at a local scale, and the first generation of infection occurs when an infected individual transmits infection to neighbouring individuals. Assuming in the pair model that each individual has n neighbours, and introducing one infected into a purely susceptible population, each of its n neighbours has a finite probability of infection in one generation. Since infected-neighbour pairs are state-independent, the expression for R s 0 in the absence of treatment is given by\n\nA generalization of a previously established technique for computing the control reproduction number in SIR models (Keeling, 1999) is presented in Appendix B when correlations are taken into account.\n\nFor the purpose of simulations, we consider influenza infection for which drug resistance is a well-documented evolutionary consequence of antiviral agents used for treatment of clinical disease. Here, we investigate a scenario in which drug resistant mutants are initially absent, and resistance may emerge during the course of an outbreak as a result of treatment. To simulate the models formulated above, estimated parameters are taken from the published literature for influenza, with the values of R s 0 in the range 1-3 (see Table 2 ).\n\nWe consider a susceptible population of size S 0 \u00bc 100; 000, and assume fixed values of n \u00bc 6 and f \u00bc 0:2. We also assume that the resistant strain is initially absent \u00f0I r \u00f00\u00de \u00bc 0\u00de, but emerges with a relative transmissibility d r \u00bc 0:8 during the outbreak. Furthermore, we seed the population with I U \u00f00\u00de \u00bc 100 infections such that each infected individual makes initial contact with only susceptible neighbours. This would be the case, for example, if infected individuals were initially uniformly distributed through the population. Figs. 2a-c show the final size of the outbreak (the total number of infections caused by both strains at the end of the epidemic including recovered and dead individuals) in each model as a function of treatment level p, for different values of R s 0 . Since treatment reduces the transmission of the sensitive strain, a substantial reduction in morbidity (and therefore mortality) of the population is achieved when treatment is maintained at low to moderate levels. However, high treatment levels exert significant selective pressure that allows the resistant strain to gain enough competitive advantage to establish a self-sustaining resistant outbreak, thereby increasing the total number of infections. These simulations indicate that there is an optimal treatment level associated with each value of R s 0 that minimizes the final size of the outbreak. While these models produce qualitatively similar results, the emergence of resistance in the pair-approximation model (Fig. 2c ) requires a higher reproduction number with a significantly lower optimal treatment level compared to the homogeneous models ( Figs. 2a and b) . As is evidence, treatment levels above approximately 40% leads to the wide-spread resistance for R s 0 \u00bc 1:4, 1.8, 2.2 (solid, dashed, dotted curves in Figs. 2a and b, respectively) in both mean-field and stochastic models, whereas the spread of disease is largely controlled in the pair-approximation model with very few resistant infected cases.\n\nTo illustrate the time course of the outbreak when treatment is maintained at a constant level, we assume R s 0 \u00bc 2:4, corresponding to the dot-dashed curves in Fig. 2. For a low treatment level (30%), the sensitive strain spreads quickly (with slower rate in the pair-approximation model) and depletes the susceptible population (Figs. 3a-c, solid curves), and therefore a limited number of resistant cases is generated (Figs. 3a-c, dashed curves) . Increasing treatment in each model to the optimal level associated with R s 0 \u00bc 2:4 leads to the further reduction in the spread of the sensitive strain, but the generation of more resistant infections. In this case, while emergent resistant strains cause a small outbreak (Figs. 3d-f, dashed curves), the total number of infections is minimal. Further increase in the treatment level to 80% enhances the spread of drug-resistance by shifting the competitive balance in favor of the resistant strain. As shown in Figs. 3g and h (dashed curves), a single wave of outbreak (virtually identical to the total number of infections) is largely caused by the spread of resistance in both mean-field and stochastic models. However, in the pair-approximation model, we observe two distinct infection curves: the earlier (smaller) outbreak is caused by the sensitive strain (which can account for the establishment of the disease in the population, the so-called seeding phase of the pathogen), and the subsequent (larger) outbreak is driven by the resistant strain (Fig. 3i, solid and dashed curves) . This phenomenon can also be observed for a wide range of treatment levels above the optimal level (37%), with the possibility of distinct large outbreaks of both sensitive and resistant infections. As illustrated in Fig. 4a for a 37.4% treatment level with a smaller number of initial infections \u00f0I U \u00f00\u00de \u00bc 20\u00de, the first wave of infections unfolds with a magnitude comparable to that of the second outbreak triggered by the emergence of highly transmissible resistance. Increasing treatment to higher levels leads to a more rapid emergence of resistance (with less prevalence of the sensitive strain), and an earlier occurrence of the subsequent resistant outbreak with a larger magnitude (Fig. 3i) . The magnitude and the peak time for these outbreaks depend not only on the treatment level, but also on other parameters involved in the spread of pathogen strains, such as the fitness of resistance. This is shown in Fig. 4b for slightly lower fitness of resistance \u00f0d r \u00bc 0:78\u00de and a 39% treatment level with I U \u00f00\u00de \u00bc 20, demonstrating a lower magnitude of outbreaks with further delay in the spread of resistance. Our simulations also indicate that when treatment is maintained at low levels or sufficiently close to the optimal level, the final size of infections in each outbreak has very marginal dependence on the initial number of infections (Figs. 5a-c) . This suggests that the epidemic has spread well beyond the establishment phase ( Figs. 4a and b) . Table 2 . \n\nTo prevent the spread of resistance in the population, previous studies suggest an alternative strategy that delays the onset of large-scale treatment for a certain amount of time after the introduction of the drug-sensitive pathogen (Moghadas, 2008; Moghadas et al., 2008) . Here, we investigate this strategy by allowing the treatment level to change during the outbreak, and compare the outcome with the scenario in which treatment is kept constant at the optimal level for each model. With an initial 20% treatment level, we compute the total number of infections \u00f0T a \u00de when, after a delay, treatment changes to a higher level during the outbreak. Figs. 6a-c show the ratio T a =T c , where T c represent the total number of infections with a constant treatment at the optimal level (57% in mean-field model; 63% in stochastic model; 37% in pair-approximation model). These comparative simulations reveal a higher final size of infection if intensive treatment is administered too early (thus promoting resistance) or too late (allowing the sensitive strain to propagate widely). In contrast, the prevalence of resistance can be prevented, and in addition a significant reduction in the size of outbreak achieved, if a timely increase in the level of treatment is managed. While this outcome is common to all models, the optimal timing and increase in the level of treatment depend greatly on the type of model, with a larger morbidity-reduction being achieved in mean-field and stochastic models than in the pair-approximation model. This is due to the fact that in homogeneously mixing models, the sensitive strain spreads more readily than the resistant strain due to higher transmissibility and more frequent interactions between individuals. By contrast, large-scale resistance spreads more rapidly in the pair-approximation model with even lower treatment levels, where heterogeneity in population interactions lessens the superiority in the fitnessadvantage of the drug-sensitive strain, resulting in its less extensive propagation than in a homogeneous structure.\n\nTo further explore the effect of contact structure in the pairapproximation model on the emergence of drug-resistance, the model was simulated for the final size of outbreak as a function of f, when the initial 20% treatment level is raised to 80% during the outbreak. Assuming R s 0 \u00bc 2:4, Fig. 7a shows that for low values of f (approximately t0:3), there is an optimal timing ($30 days after the start of outbreak) at which increasing the treatment level minimizes the total number of infections. Fig. 7c shows that the early onset of intensive treatment leads to a large outbreak by promoting the spread of resistance. As R s 0 increases, the existence of an optimal timing can be observed for a wider range of f (approximately t0:45), as illustrated in Fig. 7b for R s 0 \u00bc 3. This clearly indicates that, in addition to the transmissibility of the pathogen and the treatment level, network structure of the population can play a major role in determining the complex dynamics of competition between sensitive and resistant strains.\n\nThis paper compares three models for the propagation of drugresistant infection that initially arises from the treatment of a drug-sensitive pathogen strain. A number of strategies for drug treatment were considered and compared between the models. The first two models assume homogeneous mixing of the population, and ignore spatial effects such as correlations between neighbouring individuals; thus they implement a mean-field approach. These homogeneous models are either deterministic or stochastic, the latter incorporating fluctuations in the onset and transmission of disease in individuals which may be important for the occurrence of an outbreak with a small number of initial infections (see Appendix C). The third model implements a pair-correlation approximation, representing the simplest way to include spatial effects, in which higher-order correlations are treated as 'stochastic noise'. In order to provide closure for the pair-approximation equations, a triplet approximation was used that includes a parameter f for specifying the fraction of triplets that also form triangles, thereby providing a simple description of social structure within the population. Table 2 . Simulations were run with an initial treatment level of 20% and then changed to the level shown on the vertical axis at the time displayed on the horizontal axis (corresponding to the time-course of the outbreak). The colour bars illustrate the ratio of the total number of infections caused by both strains in adaptive treatment strategy \u00f0Ta\u00de to that generated when treatment is maintained constant at the optimal level associated with R s 0 in each model \u00f0Tc\u00de. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) When f is large, clustering is high and most (but not all) interactions occur within local groups. However, for small f, clustering is low and interactions are more uniformly spread.\n\nA number of key findings have emerged from this comparative study. Foremost is the result that, when the reproduction number exceeds a threshold value, the emergence of resistance occurs more quickly with lower treatment levels in heterogeneous populations (in which local social interactions comprise the majority of contacts) than in homogeneous populations (in which all contacts between individuals are equally probable). For example, simulations in Fig. 8a for R s 0 \u00bc 2:4 show that population-wide spread of resistance can occur in the pairapproximation model with a 50% treatment level. However, despite a much larger magnitude of outbreak for a similar scenario in homogeneous interactions, few resistant cases are generated and the final size of infections (largely caused by the sensitive strain) can still be reduced in the mean-field and stochastic models by a further 5-10% increase in the treatment level above 50%. We observed similar comparisons for higher reproduction numbers, as illustrated in Fig. 8b for a particular value of R s 0 \u00bc 3. While the resistant strain is generally outcompeted by the sensitive strain due to the latter's higher transmissibility, more complex dynamics may arise from competition between pathogen strains at high treatment levels. For homogeneous structure, aggressive treatment beyond the optimal level (that minimizes the total number of infections in a constant treatment strategy) will significantly interrupt the transmission of the dominant competitor (sensitive strain), and therefore promote the emergence and the large-scale propagation of resistance. The extent to which resistance spreads in the population depends not only on the treatment level, but also the time at which selection of resistance occurs during the outbreak. If a significant number of susceptible hosts have already been infected with the sensitive strain, the selective advantage of the resistant strain may not be enough for a subsequent resistant outbreak. In heterogeneous populations, while the outbreak occurs with a smaller magnitude than in homogeneous populations, the effects of resistance emergence are much more pronounced for high treatment levels. This is evident from Fig. 3i (see also Fig. 4) where the resistant strain dominates the sensitive strain after several weeks and causes a subsequent wave of infection. However, due to a larger number of contacts (essentially, the entire population) in the homogeneous models, resistance appears within the single wave of outbreak earlier than in pair-approximation model (Figs. 3g and h) . Comparisons between constant and adaptive treatment strategies in Fig. 6 show that the dominance of local interactions in heterogeneous populations can largely subdue the fitness-advantage of the sensitive strain; thereby providing an opportunity for the resistant strain to spread readily through edges of connected sites in local groups. This is highlighted in Fig. 7 , which underscores the timely implementation of intensive treatment for minimizing the likelihood of resistant outbreaks.\n\nThe models considered in this study include a number of key parameters, such as basic reproduction number, degree of clustering, and treatment level. Considering realistic ranges of these parameters, the results of simulations enable us to determine under what conditions the homogeneous and pairwise models are expected to exhibit similar behaviour. However, it is of greater importance to determine differences in their predictions that could influence policy making. For example, due to the assumption of random mixing, homogeneous models generally represent larger epidemic outbreaks and may overestimate the final size of infections. This was highlighted in the spread of severe acute respiratory syndrome (SARS), for which estimates of the reproduction number led to predictions of epidemic size that far exceeded what was observed (Meyers et al., 2005) . On the other hand, the pair-approximation model displays a much later peak time of outbreak than homogeneous models and this can have important implications for policy implementation, as retarding the progression of disease in the population is generally beneficial for the development of more aggressive pathogen-specific control measures during the outbreak. Furthermore, we observed that the minimum in the final size of infections occurs at some intermediate treatment level when the reproduction number exceeds a threshold-value, and this threshold is lower for the homogeneous models than for the pair model-as illustrated in Fig. 2 , for a fixed value of f \u00bc 0:2. Further investigation revealed that as f ! 0, the profile more closely resembles that of a homogeneous model. However, for heterogeneous structures, raising the degree of clustering causes a reduction in the overall disease incidence in the population, which occurs at a higher f as the reproduction number increases ( Figs. 7a and b) . This fact is also evident in Figs. 7c and d, where for a fixed delay in treatment, an increase in f rapidly quenches the resistant outbreak. An important observation is that the implementation of intensive treatment in the adaptive strategy requires longer delay (represented by the green valley between the red areas in Figs. 7a and b) as f increases or the reproduction number decreases. Finally, we demonstrated that a second (resistant) wave of infection can potentially occur after a sufficiently long delay following the outbreak of sensitive infection (Fig. 4) . Moreover, this phenomenon occurs despite the much reduced number of total infections relative to the homogeneous models. This feature is entirely absent from the homogeneous models, and represents a phenomenon peculiar to inhomogeneous (clustering) models when a constant treatment strategy is put in place.\n\nThe results of this study are based on dynamical approaches that consider a constant structure of contact patterns. However, in addition to being heterogeneous, network contacts generally evolve during the course of a disease outbreak, due to changes that occur in individuals' mobility patterns according to their clinical/epidemiological status in the population. For example, infected individuals tend to isolate from the rest of the population for the duration of their infection, and reconnect once they have recovered (and acquired immunity). The co-evolution of individual disease states and the contact network has recently been considered for simple SIS and SIRS models (Risau-Gusman and Zanette, 2008; Shaw and Schwartz, 2008; Zanette and Risau-Gusman, 2007) , and new phenomena (such as backward bifurcations) not encountered in traditional models were found. Generalization of the models presented in this paper to incorporate coevolution of contacts and individual disease progression could suggest alternative control strategies for mitigating the spread of infection. Although this study considers treatment as a single intervention strategy, a combination of control measures (e.g., vaccination, isolation/quarantine, and other social distancing mechanisms) is likely to take place during an outbreak, which can profoundly influence the dynamics of network contacts and spread of resistance in the population. This further underscores the importance of optimizing control strategies from a societal point of view, especially in the face of inadequate resources and limited capacity to cope with surging demand in healthcare.\n\nOur results have important implications for the management of public health crises, particularly those caused by the emergence of novel infectious pathogens such as pandemic influenza viruses. This is currently a major global concern due to outbreaks of the deadly avian strain H5N1 (Jennings and Peiris, 2006 ) that claims a high mortality rate amongst infected humans (WHO, 2008) . Several strategies have been proposed and evaluated to mitigate the impact of a nascent pandemic virus, and antiviral therapy has been rationalized as the first line defense in the absence of an effective virus-specific vaccine (Ferguson et al., 2005; Gani et al., 2005; Gardam et al., 2007; Longini et al., 2005) . Considering the risk of containment failure at the source of a pandemic, potential evolutionary-epidemiological consequences of drug use should be taken into account when developing more nuanced, targeted, or geographically specific antiviral strategies (Moghadas, 2008; Moghadas et al., 2008) . In the presence of antiviral treatment, emergence of resistance can result in a rapid and wasteful depletion of available drug supplies that are currently being stockpiled, and therefore strategies that prolong the effectiveness of drugs should be prioritized. A recent study, using a stochastic modelling approach, indicates that an adaptive treatment strategy may be suitable if a secondary resistant outbreak is unavoidable (Handel et al., 2009) . While being appropriate for management of resistance and minimizing the final size of infections, this strategy may involve decisions for rationing of drug supplies and possibly withholding treatment from infected individuals at low risk of disease-induced complications or death (Handel et al., 2007) . The ethical framework of such decisions is complex; however, comparison of the potential consequences of competing strategies will allow public health authorities to optimize policy decisions for maximum protection of community health. where R s 0 and R r correspond to the homogeneous case described in Section 3. It is clear that the correlations C SU , C ST , and C Sr play a significant role in determining whether an epidemic outbreak occurs. For the initial conditions used in the simulations (Section 4), we have \u00bdSI U \u00bc n\u00bdI U ; \u00bdSI T \u00bc \u00bdSI r \u00bc 0; and \u00bdS \u00bc N \u00c0 \u00bdI U , from which we obtain initial values of C SU \u00bc N=n\u00bdSI U =\u00bdS\u00bdI U \u00bc N=\u00f0N \u00c0 \u00bdI U \u00de \u00bc 1:001; C ST \u00bc C Sr \u00bc 1. Numerical simulations (not reported here) suggest that these correlations converge to equilibrium values soon after the onset of the outbreak. For uncorrelated distributions \u00f0C SU \u00bc C ST \u00bc C Sr \u00bc 1\u00de, the expressions in (14) and (15) reduce to the homogeneous case, so thatR s c \u00bc R s c andR r \u00bc R r . Preliminary analysis confirms that the equilibrium value of C Sr , and thereforeR r , is a decreasing function of f. The analysis of the corresponding behaviour ofR s c (involving C SU and C ST ) as a function of f appears to be more complicated and is currently being investigated.\n\nWe used the Markov Chain Monte Carlo method to simulate the stochastic dynamic model. In simple stochastic SIR models, the basic reproduction number can be used to assess the likelihood of an outbreak taking place, which is determined by the probability 1 \u00c0 \u00f01=R s 0 \u00de I 0 (Allen, 2003) , where I 0 is the initial number of infections. In our model, this means that if R s 0 is greater than one but small (for example R s 0 \u00bc 1 \u00fe ), then the probability of transition for I U is initially low \u00f0% I U \u00f00\u00de\u00de for small I U \u00f00\u00de. This reflects the fact that stochastic effects dominate in the system at the beginning of the transition period. For the purpose of simulations, we chose the initial number of infections \u00f0I U \u00f00\u00de \u00bc 100\u00de sufficient to result in an outbreak. A key parameter in stochastic simulations is the step-size of the Monte Carlo method. Using a fixed step-size requires a large number of steps for the stochastic system to guarantee that every member of the infected population can transmit the disease, which is computationally very demanding in terms of both timing and resources. To reduce such computational load, the sampling scheme can be improved and an adaptive step-size used. We therefore employed a sampling method introduced by Rohani et al. (2002) to estimate the transition time to the next event \u00f0Dt\u00de by calculating the sum of the frequencies of all possible events, given by Z \u00bc b\u00f0I U \u00fe d T I T \u00deS\u00f0t\u00de \u00fe d r bI r S\u00f0t\u00de\u00fe a T I T \u00fe g U \u00f0I U \u00fe I r \u00de \u00fe g T I T \u00fe d U I U \u00fe d T I T \u00fe d U;r I r .\n\nThen, letting Dt \u00bc U 1 =Z, where U 1 is uniform distribution in the interval [0,1], we ordered all possible events as an increasing fraction of Z and generated another uniform deviate \u00f0U 2 2 \u00bd0; 1\u00de to determine the nature of next event. These simulations were run for a large number of samples \u00f0N \u00bc 100; 000\u00de to guarantee the convergence of the results, and we considered the average of sample realizations of the stochastic process to generate the infection curve."}