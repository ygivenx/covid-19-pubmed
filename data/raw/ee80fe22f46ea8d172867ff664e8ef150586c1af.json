{"title": "Article Simulations Show that Virus Assembly and Budding Are Facilitated by Membrane Microdomains", "body": "Processes in which proteins assemble on membranes to drive topology changes are ubiquitous in biology. Despite extensive experimental and theoretical investigations (e.g., Baumgart et al. (1) and Krauss and Haucke (2)), how assembly-driven membrane deformation depends on protein properties, membrane properties, and membrane compositional inhomogeneity, remains incompletely understood. An important example of this phenomenon occurs during the formation of an enveloped virus, when the virion acquires a membrane envelope by budding from its host cell. Budding is typically driven at least in part by assembly of capsid proteins or viral membrane proteins (3-8), and many enveloped viruses, including HIV and influenza, preferentially bud from membrane microdomains (e.g., lipid rafts) (5, 9, 10) . Understanding how viruses exploit membrane domain structures to facilitate budding would reveal fundamental aspects of the viral lifecycle, and could focus efforts to identify targets for new antiviral drugs that interfere with budding.\n\nThere is much interest in developing enveloped viral nanoparticles as targeted transport vehicles equipped to cross cell membranes through fusion (11) (12) (13) . More generally, identifying the factors that make viral budding robust will shed light on other biological processes in which high-order complexes assemble to reshape membranes. Toward this goal, we perform dynamical simulations in which capsids simultaneously assemble and bud from model lipid membranes. We identify mechanisms by which membrane adsorption either promotes or impedes assembly, and we find multiple mechanisms by which a membrane microdomain significantly enhances assembly and budding.\n\nEnveloped viruses can be divided into two groups based on how they acquire their lipid membrane envelope. For the first group, which includes influenza and type C retroviruses (e.g., HIV), the (immature) nucleocapsid core assembles on the membrane concomitant with budding. In the second group, a core assembles in the cytoplasm before envelopment (reviewed in Sunquist and Kr\u00e4usslich (3), Hurley et al. (4) , and Welsch et al. (5) ). In many families from this group, e.g., alphavirus, envelopment is driven by assembly of viral transmembrane glycoproteins around the core (14) . For all enveloped viruses, membrane deformation is driven at least in part by a combination of weak protein-protein and protein-lipid interactions. Thus, properties of the membrane should substantially affect budding and assembly timescales. In support of this hypothesis, many viruses from both groups preferentially bud from membrane microdomains 10-100 nm in size that are concentrated with cholesterol and/or sphingolipids (5, 9, 10) . A critical question is whether viruses utilize microdomains primarily to concentrate capsid proteins or other molecules, or if the geometric and physical properties of domains facilitate budding. Answering these questions through experiments alone has been challenging (3-5).\n\nExtensive previous theoretical investigations have studied budding by preassembled cores or nanoparticles (e.g., Ruiz-Herrero et al. (15) , Chaudhuri et al. (16) , Deserno and Gelbart (17) , Deserno and Bickel (18) , Deserno (19) , Fo snari c et al. (20) , Ginzburg and Balijepalli (21) , Jiang et al. (22) , Li and Xing (23) , Li and Gu (24) , Smith et al. (25) , Tzlil et al. (26) , V\u00e1cha et al. (27) , Yang and Ma (28) , and Dasgupta et al. (29, 30) ); or have budding triggered by nonassembling subunits (31) ; or have used continuum models to study assembly and budding (32, 33) . Most closely related to our work, Matthews and Likos (34) (35) (36) recently performed simulations on a coarse-grained model of patchy colloidal particles assembling on a membrane represented as a triangulated surface. These elegant simulations provided a first look at the process of simultaneous assembly and budding, and showed that subunit adsorption onto a membrane facilitates assembly through dimensional reduction. Here, we perform dynamical simulations on a model that more closely captures the geometric features of capsid subunits and lipid bilayers, and we explore how the presence of a microdomain within the membrane can influence assembly and budding.\n\nOur simulations show that, while the membrane can promote assembly of partial capsids, free energy penalties and impeded diffusion of adsorbed subunits associated with membrane deformations can inhibit completion of assembly. We find that a microdomain within a certain size range favors membrane geometries that diminish these impediments, and thus can play a key role in enabling complete assembly and budding. Furthermore, our simulations suggest that assembly morphologies depend crucially on multiple timescales, including those of protein-protein association, membrane deformation, and protein adsorption onto the membrane. Finally, we discuss potential effects of simplifications in our coarse-grained model, and how a key prediction from the simulations can be tested in an in vitro assay.\n\nDue to the large length-and timescales associated with assembly of a capsid, simulating the process with an all-atom model is beyond the capabilities of contemporary computers (37) . Therefore, in this article we aim to elucidate the principles underlying simultaneous assembly and budding by considering a simplified geometric model for capsid proteins, inspired by previous simulations of empty capsid assembly (38) (39) (40) (41) (42) (43) (44) (45) (46) (47) (48) (49) (50) (51) (52) (53) and assembly around nucleic acids (51, (54) (55) (56) (57) . Similarly, we consider a simplified model for lipids (31, 58) that recapitulates the material properties of biological membranes. Complete details of the model are provided in Supporting Materials and Methods in the Supporting Material; we summarize the model here.\n\nThe membrane is represented by the model from Cooke and Deserno (58) , in which each amphiphile is represented by one head bead and two tail beads connected by FENE bonds (Fig. 1 c) . This is an implicit solvent model; hydrophobic forces responsible for the formation of bilayers are mimicked by attractive interactions between tail beads with interaction strength \u03b5 0 . This model enables computational feasibility while allowing the formation of bilayers with physical properties such as fluidity, diffusivity, and rigidity that are easily tuned across the range of values measured in biological membranes (15, 58) . The bead diameter is set to s \u00bc 0.9 nm to obtain bilayers with widths of 5 nm and the lipid-lipid interaction strength is set to k B T/\u03b5 0 \u00bc 1.1 and u c \u00bc 1.5s to obtain fluid membranes with bending\n\nWhen studying the effect of a domain, we consider two types of lipids, with M and D referring, respectively, to the lipids outside and inside of the domain, and tail-tail interaction parameters \u03b5 ij (see Eq. S6 in the Supporting Material) set to \u03b5 DD \u00bc \u03b5 MM \u00bc \u03b5 0 , while \u03b5 DM is a variable parameter that controls the domain line tension, g. Varying \u03b5 DM from 0 to \u03b5 0 tunes g from its maximum value to 0 (see The Membrane Model in the Supporting Material). Within the parameter range studied, the line tension can be approximated by gs/k B T z 22.9-24.7\u03b5 DM /\u03b5 0 (see Fig. S3 in the Supporting Material).\n\nWe modified and extended a model for assembly of nonenveloped capsids (45, 54, 59, 60) to describe assembly on a membrane. A complete listing of the interaction potentials is provided in The Capsid Subunit Model in the Supporting Material; we summarize them here. The capsid subunit is a rigid body with a pentagonal base and radius of r pentamer \u00bc 5s formed by 15 attractive and 10 repulsive interaction sites ( Fig. 1 a and see Fig. S4 ). Subunit assembly is mediated through a Morse potential between attractor pseudoatoms located in the pentagon plane, with one located at each subunit vertex and two along each edge. Attractions occur between like attractors only, meaning that there are vertex-vertex and edge-edge attractions, but no vertex-edge attractor interactions. The 10 repulsive interaction sites are arranged symmetrically above and below the pentagon plane, so as to favor a subunit-subunit angle consistent with a dodecahedron (116 ). Further details are in The Capsid Subunit Model in the Supporting Material. \n\nThe potential between capsomers and lipids accounts for attractive interactions and excluded-volume. We add to the capsomer body six attractor pseudoatoms that have attractive interactions with lipid tail beads. When simulating a phase-separated membrane, the attractors interact only with the domain lipid tails, except for simulations presented in Fig. S1 . The attractors are placed one above each vertex and one above the center of the pentagon, each located a distance of 6s above the pentagon plane ( Fig. 1 a) . These are motivated by, e.g., the myristate group on retrovirus GAG proteins that promotes subunit adsorption by inserting into the lipid bilayer (61) . While in many cases the electrostatic interactions between capsid proteins and membrane polar headgroups also drive membrane adsorption, we did not explicitly include such an effect in order to reduce the number of model parameters. The attractor-tail interaction is the same form as the lipid tail-tail interaction except that there is no repulsive component (see Eq. S14 in the Supporting Material)). It is parameterized by the interaction strength, \u03b5 ad , which tunes the adhesion free energy according to e ad \u00bc a\u03b5 ad with a \u00bc 2.276s \u00c02 (see Adhesion Energy in the Supporting Material).\n\nTo account for capsomer-lipid excluded-volume interactions, a layer of 35 excluder beads, each with diameter 1.25s, is placed in the pentagon plane ( Fig. 1 a) . Excluders experience repulsive interactions with all lipid beads. Because the mean location of the attractive interaction sites on adsorbed subunits is near the membrane midplane, the effective radius of the assembled capsid (not including the lipid coat) can be estimated from the distance between the attractors and the capsomer plane plus the capsid inradius (the radius of a sphere inscribed in a dodecahedron), which gives R capsid z 15.3s. As discussed below, this is smaller than any enveloped virus, and thus our results are qualitative.\n\nIn this work we are motivated by viruses such as HIV, where expression of the capsid protein (GAG) alone is sufficient for the formation of budded particles (62) . Therefore, we consider a model that does not include viral transmembrane proteins (spike proteins). We also do not consider how some viruses use cellular machinery to drive scission (63) , because this process is virus-specific and depends on detailed properties of cellular proteins. For those viruses our model may elucidate the mechanisms leading up to the point of scission.\n\nSimulations were performed on GPUs with a modified version HOOMD 0.10.1 (64, 65) . We modified the Andersen barostat (66) implementation to simulate the membrane at constant temperature and constant frame tension (31) and to couple the barostat to rigid-body dynamics. The membrane was coupled to the thermostat and barostat with characteristic times t T \u00bc 0.4t 0 and t P \u00bc 0.5t 0 , respectively, with t 0 the characteristic diffusion time for a lipid bead (defined below). The imposed frame tension was set to zero. Simulations with an alternative method to control tension (36) led to the same behavior.\n\nEach capsomer was simulated as a rigid body using the Brownian dynamics algorithm, which uses the (non-overdamped) Langevin equation to evolve positions and rigid body orientations in time (64, 65) . To approximate the rotational dynamics of globular proteins, we modified the rigidbody algorithm in HOOMD so that forces and torques arising from drag and random buffeting were applied separately and isotropically. Finally, the code was modified to update rigid-body positions according to changes in the box size generated by the barostat at each time step.\n\nMatthews and Likos (36) showed that hydrodynamic interactions (HI) between lipid particles can increase the rate of membrane deformation. However, since the mechanisms of assembly and budding appeared to be similar in simulations that did not include HI, the timescales for protein diffusion and association are only qualitative in a coarse-grained model, and the computational cost required to include HI is large in our more detailed model, we neglect HI in our simulations.\n\nWe set the units of energy, length, and time in our simulations equal to the characteristic energy, size, and diffusion time for a lipid bead of \u03b5 0 , s, and t 0 , respectively. The remaining parameters can be assigned physical values by setting the system to room temperature, T \u00bc 300 K, and noting that the typical width of a lipid bilayer is~5 nm, and the mass of a typical phospholipid is~660 g/mol. The units of our system can then be assigned as follows:\n\n2 mol; and\n\nFor each set of parameters, the results from four or more independent simulations were averaged to estimate the mean behavior of the system.\n\nThe diffusion coefficient of capsomers in solution is D z 4.2s 2 /t 0 , while for capsomers adsorbed on the membrane, D\u02db[0.004, 0.02] for e ad /ak B T ranging from 0.6 to 0.2. Thus timescales to diffuse by one capsomer diameter (10s) are t d z 25t 0 for capsomers in solution and t D\u02db[ 500, 2500]t 0 on the membrane. We note that these timescales are qualitative, because the reduction in degrees of freedom associated with coarse-grained models reduces the ruggedness of the underlying free energy landscape (67) . For example, comparison between the lipid model employed here with real values of lipid diffusion indicates a speed-up factor of~10 3 (58) .\n\nTo simulate an infinite membrane, periodic boundary conditions were employed for the lateral dimensions and a wall was placed at the bottom of the box. Thus, the capsomers remained below the membrane unless they budded through it. To maintain a constant and equal ideal gas pressure above and below the membrane (despite the imbalance of capsomer concentrations), phantom particles were added to the system. These particles experienced excluded-volume interactions with the lipid head beads, and no other interactions. For most simulations of inhomogeneous membranes the membrane contained n \u00bc 16,200 lipids, including those belonging to the domain. An initial bilayer configuration was equilibrated and then placed with its normal along the z axis in a cubic box of side-length L x \u00bc L y \u00bc 90s and L z \u00bc 100s. For large domains (r domain > 40) the membrane contained n \u00bc 28,800 lipids and the initial box size was 130 \u00c2 130 \u00c2 100s 3 . For most simulations of homogeneous membranes, the bilayer contained n \u00bc 7,164 lipids and the initial box size was 63.5 \u00c2 63.5 \u00c2 100s 3 ; additional simulations on larger membranes were performed to rule out finite size effects.\n\nThe capsomers were introduced in the box in two different ways, to understand how the rate of subunit translation and/or targeting to the membrane affects assembly. The first set of simulations considered budding via quasi-equilibrium states, meaning that capsid proteins adsorb onto the membrane slowly in comparison to assembly and membrane deformation timescales. This scenario corresponds to the limit of low subunit concentration and a rate of subunit protein translation or targeting of subunits to the membrane, which is slow in comparison to assembly. Specifically, each capsomer was injected at~50s below the membrane midplane once all previously injected subunits were part of the same cluster. For other simulations, capsomers were injected one by one with an interval t inject until reaching a predefined maximum number of subunits. In the limit of t inject \u00bc 0, all capsomers were placed randomly at distances between Biophysical Journal 108(3) 585-595\n\nVirus Assembly on Membrane Microdomains 30 and 50s below the membrane at the beginning of the simulation. For all simulations, the initial configuration had three free capsomers placed at 30s below the membrane. Images were generated using the program VMD (68) .\n\nTo simulate capsid protein and membrane dynamics on time-and length-scales relevant to assembly and budding, we use the models illustrated in Fig. 1, a and b, and Fig. S4 . The physical mechanisms that control the formation and size of domains (with a typical size of 10-100 nm) in cell membranes are poorly understood (69) (70) (71) . To focus on the effect of a domain on assembly rather than its formation, we simulate a minimal heterogeneous membrane comprised of two lipid species, with interaction strengths that lead to phase separation within the membrane, with the minor species forming a circular domain ( Fig. 1 d) .\n\nThe bulk membrane and domain have the same bending coefficient and area per lipid (to focus on mechanisms other than curvature-or bending stiffness-sorting (1)), but protein subunits preferentially partition into the domain (see Fig. S1 ; note that a complete listing of the interaction potentials is provided in Materials and Methods and see also The Capsid Subunit Model in the Supporting Material).\n\nWe performed simulations for a range of subunit-membrane interaction strengths e ad , microdomain sizes r domain , microdomain line tensions g, and timescales for subunit association to the membrane t inject . All simulations were performed with subunit-subunit interaction strengths of e v att \u00bc 10:55 k B T and e e att \u00bc 5:27 k B T between vertex and edge attractors respectively (see Supporting Materials and Methods in the Supporting Material). While assembly can proceed readily in bulk (into the same capsid geometry) under these conditions, in all simulations that we performed (for all values of t inject ) subunits adsorbed onto the membrane before assembling into any oligomer larger than a trimer. This behavior is consistent with enveloped viruses for which assembly in the cytosol is limited to small oligomers (e.g., HIV (72)). The results presented here correspond to long but finite simulation times, at which point assembly outcomes appeared roughly independent of increasing simu-lation time. Although these results need not necessarily correspond to equilibrium configurations, note that capsid assembly must proceed within finite timescales in in vivo or in vitro settings as well (73) .\n\nGiven that capsid proteins may be targeted to the membrane rather than arriving by diffusion (74), we have considered several modes of introducing subunits into our simulated system, as described in Materials and Methods. We began by simulating assembly on a homogeneous membrane (a single species of lipid) (Fig. 1 c) via quasi-equilibrium states, meaning that free subunits were injected into the system far from the membrane one by one, each after all previously injected subunits were assembled (see Materials and Methods). This scenario corresponds to the limit of low subunit concentration and a rate of subunit protein translation or targeting of subunits to the membrane that is slow in comparison to assembly.\n\nWe found that assembly of membrane-absorbed subunits required large subunit-subunit interactions (as compared to those required for assembly in bulk solution), but that such subunits could undergo rapid nucleation on the membrane. However, we found no parameter sets for which our model undergoes complete assembly and budding on a homogeneous membrane. In most simulations, assembly slows dramatically after formation of a half-capsid (six subunits). The nature of subsequent assembly depends on the adhesion strength. For low adhesion strengths (e ad < 0.2a), assembly beyond a half-capsid occurs when particles detach from the membrane, sometimes leading to nearly completely assembled but partially wrapped capsids (Fig. 2, a and b) . At intermediate adhesion strengths (0.2 % e ad /a % 0.4), particles do not readily dissociate from the membrane and assembly typically stalls at a halfcapsid. Higher adhesion strengths (e ad > 0.4a) yield deformed, open structures that cannot drive complete budding (Fig. 2 d) .\n\nThese results reveal that adsorption to a membrane has mixed effects on assembly. Through dimensional reduction, membrane adsorption reduces the search space and can reduce nucleation barriers by generating a high local subunit concentration (34, 36) . Similar effects occur during assembly on a polymer (54) (55) (56) 73, 75, 76) . However, assembly on the membrane also introduces new impediments to assembly.\n\nFormation of a completely enveloped capsid incurs a membrane bending free energy cost of 8pk, independent of capsid size (77) . This free energy penalty must be compensated by subunit-subunit and subunit-membrane interactions. In our model the subunit-membrane interactions do not promote membrane curvature, and thus large subunit-subunit interactions are required for assembly on the membrane. For these parameters, nucleation also occurs in bulk solution if there is no membrane present (nucleation did not occur in bulk solution with a membrane present for any value of t inject because subunits adsorbed onto the membrane before undergoing nucleation). We also considered a model in which the surface of the subunit is curved (see Fig. S10 ), so that subunit-membrane adsorption does promote local curvature. Interestingly, this model did not lead to improved assembly as compared to the flat subunits.\n\nThis result and the frustrated assembly dynamics of halfcapsid intermediates illustrate the fact that the geometry and energetics of membranes affect the assembly of membrane-associated proteins in multiple ways, altering both the probability of binding for subunits in the vicinity of an assemblage and the apparent diffusion-limited flux of subunits to the assemblage. Once intermediates reach onehalf the capsid size, additional subunits approach with orientations that are not conducive to association. Addition of such a subunit requires a large membrane deformation, which is energetically unfavorable for physically relevant values of the membrane bending rigidity and thus rare (see Fig. S6 b) . Assembly therefore stalls or, in the case of weak adhesion energy, proceeds by detachment of subunits from the membrane leading to assembled but partially wrapped capsids. The stalled assembly states resemble the partially assembled states predicted theoretically (32, 33) , while the partially wrapped capsids are consistent with the metastable partially wrapped states found for a preassembled particle in our previous simulations (15) . A second impediment to assembly arises because subunit-membrane attractions are reduced in regions where the membrane curvature is large on the length scale of the rigid subunit (see Fig. S7 ). This effect hinders subunit diffusion across the neck (see Movies S1 and S2), therefore decreasing the flux of subunits to the assembling capsid.\n\nAs discussed below, the large magnitude of the membrane-induced barrier to assembly arises in part due to the small capsid size and relatively large subunits of our model. However, the barrier is intrinsic to assembly of a spherical or convex polygonal structure on a deformable two-dimensional manifold, and thus will exist for any such model.\n\nWe next simulated assembly in the presence of a phaseseparated membrane (Fig. 1 d) to understand the effects of a membrane domain on assembly and budding. While the mechanisms by which rafts form are incompletely understood, we focus on the effect that the presence of a domain can exert on assembly and budding. We emphasize that we consider lipid-lipid interaction parameters and domain sizes for which the domain is flat and stable in the absence of capsid subunits (see Fig. S3 b) ; i.e., the domain line tension is insufficient to drive budding. We first consider budding in the quasi-equilibrium limit. Fig. 3 (left) shows the predominant final system configurations as a function of e ad and line tension for fixed domain size r domain \u00bc 35s, which corresponds to 1.3 times the area required to wrap the capsid. Moderate adhesion strengths and small line tensions lead to complete assembly and budding (Fig. 4) , meaning that: 12 subunits form a complete capsid, the capsid is completely wrapped by the membrane, and the membrane undergoes scission through spontaneous fusion of the neck to release the membraneenveloped capsid. Because it requires a relatively large thermal fluctuation, scission is characterized by long timescales. After scission, the portion of the domain not enveloping the capsid remains within the membrane.\n\nAnalysis of simulation trajectories identified three mechanisms by which the domain facilitates assembly. First, partitioning of adsorbed proteins into the domain generates a high local subunit concentration, and thus, promotes nucleation. However, in simulations in which the degree of subunit partitioning into the domain was varied (see Fig. S1 ), the outcome was insensitive to this parameter. This insensitivity arises because our system requires strong subunit-subunit interactions to drive membrane bending and thus nucleation occurs readily. Second, as noted in the case of spherical particle budding through a raft (25) , the domain line tension promotes membrane curvature (buckling), because buckling reduces the length of the domain interface (78) . While a positive membrane tension inhibits budding (19) , the effective compressive force arising due to line tension promotes budding. Modeling the partial capsid as a hemispherical cap (79) , and neglecting curvature outside the vicinity of the capsid (see Theoretical Analysis on the Effect of the Domain on Neck Geometry in the Supporting Material, and Foret (33)), the length of the interface as a function of number of subunits n in a partial capsid is given by interfacial energy between a flat domain and a completely wrapped capsid is then given by\n\n(2)\n\nFor r domain \u00bc 35s and g \u00bc 1.9 k B T/s, we have DE int z \u00c0215 k B T, which is comparable to the total bending energy associated with a wrapped capsid,\n\nThe significance of this effect and consequently the ability of a domain to promote budding diminishes as the domain size becomes large in comparison to the capsid (see Fig. S2 ).\n\nThe simulations also identified a third effect of the domain that promotes complete assembly-the presence of the domain interface changes the geometry of the membrane in the vicinity of the capsid intermediate, promoting a long shallow neck. While curvature energy favors capsid assembly in the domain interior, the line tension is minimized by a neck that extends to the domain interface. The relatively 9 k B T/s) and a \u00bc 2.276s \u00c02 . The most frequent outcomes are indicated as complete assembly and budding (green solid stars); budding of the entire domain before assembly completes, with the number indicating the typical partial capsid size upon budding (yellow solid squares); complete assembly but incomplete wrapping (orange solid triangles); stalled assembly with wrapping (red solid circles); complete assembly and wrapping without fusion of the neck (blue squares); and malformed assembly (purple circles). Snapshots from simulations for the corresponding parameter sets are also shown. The complete distribution of outcome frequencies and assembly times are shown for some parameter sets in Fig. S11 and Fig. S12 . To see this figure in color, go online.\n\nBiophysical Journal 108(3) 585-595\n\nshallow curvature of such a neck reduces the impediments to assembly on a membrane discussed in the previous section. Subunits diffuse readily across a long neck, and subsequent attachment to the assembling capsid incurs relatively small membrane deformation energies. The influence of the neck in subunit diffusion and association is illustrated by animations from assembly trajectories in Movie S1 and Movie S2. Formation of a long neck is governed by a competition between the loss of subunit-membrane adhesion energy associated with partial detachment from the capsid and the reduction in interfacial energy caused by the extended neck. The free energy difference between tightly wrapped capsids and extended necks is approximately calculated in Fig. S9 , which indicates that moderate adhesion energies and small domains favor extended necks.\n\nOutside of optimal parameter values, we observe five classes of alternative end-products, as follows:\n\n1. For large values of g or small domains, formation of a partial capsid triggers budding of the entire domain before assembly completes. Budding of the whole domain is driven by the interfacial energy, E int (n,r domain ) \u00bc gl int (n,r domain ). In the absence of assembly (n \u00bc 0), this driving force is insufficient to overcome the deformation free energy barrier to domain budding for the parameters we simulate. However, assembly of a partial capsid intermediate stabilizes curvature and thus reduces the bending energy required for budding of the whole domain. A simple estimate of this effect is obtained by assuming that the partial capsid compensates for the bending energy of a budded domain by an amount proportional to its wrapped area:\n\nFollowing Lipowsky (78) , budding of the whole domain is favorable when E int (n,r domain ) > E bend (n,r domain ). However, larger intermediates are required for budding to be spontaneous, thus enabling assembly to complete. Furthermore, for r domain > 2R capsid and intermediates beyond a half-capsid (n > N/2), wrapping of the intermediate produces curvature incommensurate with whole-domain budding. Higher values of e ad promote tight wrapping with strong curvature of the capsid, and thus disfavor whole-domain budding (Fig. 4 B) .\n\n2. For small g and e ad , the capsid assembles but wrapping is incomplete. Here the subunit-membrane adhesion energy is insufficient to compensate for the membrane bending energy cost associated with wrapping. 3. For larger-than-optimal adhesion strengths, the membrane wraps the assembling capsid tightly with a short neck. As discussed in the previous section, the high curvature associated with a short neck inhibits association of the final subunit leading to stalled, incomplete assembly. 4. For large e ad , subunit-membrane adhesion energy dominates over subunit-subunit interactions leading to misassembled structures.\n\n5. At other domain sizes (Fig. 4, right) we observe configurations in which the capsid is completely wrapped, but the neck does not undergo scission. To illustrate the timescales, interactions, and coupling between assembly and membrane configurations, the total subunit-subunit attractive interaction energy and the magnitude of membrane deformation are plotted as a function of time for a trajectory leading to each type of outcome in Fig. 5 .\n\nThe dependence of assembly and budding on the domain radius r domain for constant line tension g \u00bc 1.9 k B T/s is shown in Fig. 3 (right) . There is an optimal domain size~1-2 times the area of a wrapped capsid (35s ( r domain ( 40s) that leads to robust assembly and budding over a broad range of adhesion energies e ad . For smaller domains, low values of adhesion lead to budding of the entire domain before assembly completes. In the absence of protein assembly, line tension triggers budding above a threshold domain size; smaller domains are stable because bending energy dominates over interfacial energy (78) . However, we find here that partial capsid intermediates stabilize membrane deformation over an area proportional to their size, and thus drive budding within domains below a threshold FIGURE 5 Total subunit-subunit attractive interaction energy (top) and amplitude of membrane deformation, measured by the capsid penetration, p (bottom), as a function of time for a trajectory leading to each type of outcome described in the main text. The capsid penetration p is measured as the distance between the top of the capsid and the center of mass of the membrane. The color code represents the outcome type and follows the same format as in Fig. 3 : successful assembly (green), budding of a partial capsid (yellow), complete assembly but incomplete wrapping (orange), stalled assembly with wrapping (red) and malformed assembly (violet). To see this figure in color, go online.\n\nBiophysical Journal 108(3) 585-595\n\nVirus Assembly on Membrane Microdomains size (Eq. 3). On the other hand, for larger-than-optimal domains the assembling capsid only deforms a fraction of the domain; thus, the domain interface does not promote a long neck (see Fig. S9 ), and it provides a smaller driving force due to interfacial energy (Eq. 3). The behavior of such domains is therefore comparable to that in a homogeneous membrane.\n\nIn the quasi-equilibrium simulations discussed so far, the assembly outcomes were determined by the relative timescales of membrane deformation and partial capsid annealing. To determine the effect of the subunit adsorption timescale, we characterized the system behavior for subunit injection timescales t eject (see Materials and Methods) between the quasi-equilibrium limit and 0, where all subunits were introduced at the inception of the simulation (Fig. 6 ). We set r domain \u00bc 35s.\n\nThe predominant end-products are shown as a function of the adhesion strength and the subunit injection timescale in Fig. 6 . We see that the qualitative behavior is independent of the injection timescale; for all injection rates there is range of intermediate adhesion strengths at~e ad \u00bc 0.4a, for which complete assembly and budding is observed. However, as the injection timescale decreases, both the lower and upper bounds of this optimal range shift to weaker adhesion energies. Weak adhesion energies avoid malformed assemblages and also increase the timescale for budding of the entire domain (because domain curvature is less stabilized), thus increasing the probability of complete well-formed capsids. However, overly weak adhesion energies lead to longer necks (see Fig. S9 ) that reduce the timescale for budding of the entire domain, so that, even at high injection rates, budding precedes capsid completion. Stronger-than-optimal adhesion energies tend to result in malformed assemblages (see Fig. S13 b) at the lower injection timescales.\n\nThis result can be understood from previous studies of assembly into empty capsids or around polymers (39, 41, 51, 55, 73, 80, 81) -higher adhesion energies lead to an exponential increase in the timescale for annealing of partial capsid configurations; kinetic traps occur when annealing timescales exceed the subunit binding timescale. The ultimate fate of these large aggregates depends on the adhesion energy e ad . For smaller-than-optimal adhesion energies, assemblages are loosely wrapped and the entire domain undergoes budding once the assemblage reaches a threshold size (e.g., Fig. S13 b) . For larger e ad , malformed aggregates are tightly wrapped by the membrane and remain attached by a neck (e.g., Fig. S13 a) . The shortest injection timescales and largest adhesion energies we investigated lead to large flat aggregates that do not bend the membrane (see Fig. S13 c), or partial capsids emerging from a flat aggregate (see Fig. S13 d) . Finally, we note that as the subunit injection timescale is decreased, the diversity of outcomes at a given parameter set increases and thus the yield of budded, well-formed capsids decreases (see Fig. S15 ).\n\nWe found that the dynamics is qualitatively similar when excess subunits are included in the simulation. For example, we performed simulations on systems with 19 capsomers, 60% more than needed for capsid formation. For an injection timescale of t eject \u00bc 500t 0 , the behavior is similar to the small t eject results discussed above, except that subunits on the periphery of an assembling capsid typically form flat aggregates that can hinder budding (see Fig. S14 ). For adhesion strengths between 0.3 and 0.4 \u03b5 0 , budding is observed (see Fig. S14 ), whereas larger values of e ad lead to the forms of kinetic traps discussed above.\n\nOur simulations demonstrate that, while a fluctuating membrane can promote assembly through dimensional reduction, it also can inhibit complete assembly by limiting the orientational fluctuations and diffusion of adsorbed subunits. These effects, which are not present for assembly in bulk solution (73) , can engender metastable partially assembled or partially budded structures. While the degree of inhibition may depend on the specific membrane and protein properties (see below), it is generic to the assembly of a curved structure on a deformable surface. We find that assembly from a membrane microdomain can substantially diminish these effects, which could partly account for the prevalence of enveloped viruses that preferentially bud from lipid rafts or other membrane microdomains.\n\nAs an initial exploration of the relationship between membrane domain structure and budding, we considered a minimal model for a microdomain, which accounts only for preferential partitioning or targeting of capsid proteins within the domain. Our simulations identified three effects by which such a domain can promote assembly and budding.\n\n1. Generating a high local concentration of adsorbed subunits, 2. Generating a buckling pressure that promotes budding, and 3. Enhancing the diffusive flux of subunits to the assembling capsid by lengthening the neck around the budding capsid.\n\nImportantly, the predicted effects are sensitive to the domain size (Fig. 3) , with an optimal domain size of~1-2 times the area of a wrapped capsid. Smaller domains lead to budding before completion of assembly, whereas facilitation of budding becomes ineffective when the domain radius becomes large in comparison to the capsid size. These predictions could be tested by in vitro experiments in which capsid proteins assemble and bud from multicomponent artificial phospholipid vesicles as studied for other membrane-associated proteins (e.g., Becalska et al. (82), Thiam et al. (83) , and Manneville et al. (84)) with phase-separated or heterogeneous vesicles (e.g., Manneville et al. (84)). Finally, we consider the limitations of the model studied here. The effective diameter of our enveloped T \u00bc 1 capsid is~28 nm, while the smallest enveloped viruses found in nature have diameters of 40-50 nm (e.g., Jones et al. (85) ). Although the relationship between particle size and budding has been explored in detail for preassembled nucleocapsids or nanoparticles (e.g., Ruiz-Herrero et al. (15) , Ginzburg and Balijepalli (21) , and Yue and Zhang (86) ), to our knowledge, our simulations here have identified new factors that control simultaneous assembly and budding. During assembly of a larger capsid, each subunit would individually comprise a smaller fraction of the total capsid area and thus would incur a smaller increment of membrane deformation energy when associating with the capsid. Similarly, intrasubunit degrees of freedom could allow subunit distortions that would facilitate diffusion across the neck. However, note that such distortions would themselves involve free energy penalties and thus would still hinder diffusion.\n\nIn principle, other forms of excluded-volume interaction with the membrane could improve subunit diffusion, but changing the softness of the repulsive excluded volume interaction between our subunits in the membrane did not change the results. We also note that the potential used for the subunit-membrane interaction in this work does not represent local distortions of the lipid hydrophobic tails resulting from insertion of a hydrophobic group. Such insertions could lead to local membrane curvatures and membrane-mediated subunit interactions that could either facilitate or hinder assembly and budding; the study of these phenomena is an open and active field (e.g., Weikl et al. (67)). Given the qualitative nature of subunit-subunit interactions in our model, we do not expect these effects to qualitatively change the results.\n\nTo minimize the number of model parameters, we have set the material constants (e.g., bending modulus and fluidity) equal for the domain and background lipid species. Although this study demonstrates three contributions by which such a domain can promote membrane deformation, it will be interesting to explore additional effects that may arise due to varying material properties within microdomains (1). For example, it is believed that biological rafts have higher bending moduli than nonraft membrane environments. Similarly, for some viruses important roles are played by recruitment of additional viral proteins (6), other cellular factors that create or support membrane curvature (4, 91, 92) , and cytoskeletal machinery that actively drives budding (e.g., Welsch et al. While these results can be systematically incorporated into the model, our simulations provide a starting point to understand how microdomains facilitate budding and, through comparison with experiments, to identify the critical steps in budding.\n\nSupporting Materials and Methods, fifteen figures, and two movies are available at http://www.biophysj.org/biophysj/supplemental/S0006-3495(14) 04762-6."}