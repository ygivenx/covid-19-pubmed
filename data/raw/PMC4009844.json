{"title": "A Brief Review: The Z-curve Theory and its Application in Genome Analysis", "body": "In theoretical physics, there exist two basic mathematical approaches, algebraic and geometrical methods, which, in most cases, are complementary. In the area of genome studies, however, algebraic approaches, such as Markov chain models and hidden Markov chain models, have been widely used, while geometrical approaches have been less explored for a long time. The Z-curve theory is a geometric approach to genome analysis. \n\nThe Z-curve is a 3-dimensional curve that represents a given DNA sequence in the sense that each can be uniquely reconstructed given the other [1-3]. The Z-curve, therefore, contains all the information that the corresponding DNA sequence carries. The analysis of a DNA sequence can then be performed through studying the corresponding Z-curve. \n\nHistorically, various methods for the graphical representation of DNA sequences were proposed, such as the H curve [4] and the 2-dimensional DNA walk [5]. It has been shown that most of these methods are, in fact, special cases of the Z-curve, and an extensive comparison between the Z-curve and other representations was detailed in reference [2]. One of the advantages of the Z-curve is its intuitiveness, enabling global and local compositional features of genomes to be grasped quickly in a perceivable form. The methodology of\n\nthe Z-curve is a suitable platform on which other methods, such as statistics, can be integrated to address bioinformatics questions. The Z-curve method [1, 2] has found many applications in genome analysis since its initiation two decades ago. Here, we review the progress of the Z-curve studies from aspects of both theory and applications in genome research.\n\nThe DNA sequence is composed of 4 kinds of nucleotides, adenine, cytosine, guanine and thymine, denoted by A, C, G and T, respectively. The number of possible combinations when taking 2 bases at a time from 4 bases is 6. The 6 combinations are: R (A/G) and Y (C/T); M (A/C) and K (G/T); W (A/T) and S (G/C), where R, Y, M, K, W and S represent the bases of puRine, pYrimidine, aMino, Keto, Weak hydrogen bonds and Strong hydrogen bonds, respectively, according to the NC-IUB recommendation [6]. The chemical structures of the four bases are shown in (Fig. 1), illustrating the symmetry among the four bases. According to different criteria, the four bases can be classified into two categories.\n\n(i) Criterion 1, according to the chemical structure of having single or double rings\n\n\nBases{Purine, R=A, G,Pyrimidine, Y=C, T.\n\n\n(ii) Criterion 2, according to the chemical structure of having an amino or keto group\n\n\nBases{Amino,M=A,C,Keto,K=G,T.\n\n\n(iii) Criterion 3, according to the structure of the double helix forming two or three hydrogen bonds in the Watson-Crick pair \n\n\nBases{Weak,W=A,T,Strong,S=G,C.\n\n\nWe seek to find some geometrical representation for the above symmetry. If a 2-dimensional (plane) graph is adopted, we find that the symmetry can be represented by (Fig. 1A-C). If a 3-dimensional graph is adopted, the regular cube, as shown in (Fig. 2A), seems to be the unique choice to represent the symmetry. Each face of the cube is assigned to one, and only one, of the six characters: R, Y, M, K, W and S, thereby keeping the rule that R and Y, M and K, as well as W and S are on opposite sides. To prepare (Fig. 2A), readers may cut (Fig. 2B) and fold it along the dashed lines. Diagonals of the regular cube form a regular tetrahedron ACGT, as shown in (Fig. 2C). Assigning one of A, C, G and T to each vertex of the tetrahedron as shown in (Fig. 2C) is not arbitrary. Note that the vertex A of the tetrahedron is also the vertex of the cube, at which three faces of the cube, R, M and W, are crossed. The intersection base of R (A/G), M (A/C) and W(A/T) is A. Similar assignments can be applied to the vertices C, G and T, as shown in (Fig. 2C and D).\n\nTo further the study, a coordinate system needs to be established (Fig. 2D). The line connecting the middle point of an edge and that of the opposite edge of the tetrahedron is called the middle line. There are a total of three middle lines in a tetrahedron, crossing at the center O, and they are perpendicular to each other. A Cartesian coordinate system OXYZ can be set up by using the three middle lines, as shown in (Fig. 2D).\n\nThus, the cube-tetrahedron geometric entity established here correctly reflects the symmetry of the four DNA bases.\n\nA regular tetrahedron is a geometric entity of high symmetry. All possible rotational motions which keep the tetrahedron fixed in the space form a group, called a tetrahedron group or T-group. As shown in (Fig. 2D), a tetrahedron group consists of 12 operational elements, which are described below.\n\nI, i.e., the identity operation;\n\n\nRx, Ry and Rz, i.e., the 180\u00b0 rotation along x, y and z axes, respectively;\n\n\nRA, RC, RG and RT, i.e., the 120\u00b0 rotation along AO, CO, GO and TO axes, respectively;\n\n\nR2A, R2C, R2G and R2T, i.e., the 240\u00b0 rotation along AO, CO, GO and TO axes, respectively.\n\nA point with coordinates x, y and z will be transformed accordingly under the operational elements of the T-group. For example,\n\n\nI:x\u21d4x,y\u21d4y,z\u21d4z;Rx:x\u21d4x,y\u21d4\u2212y,z\u21d4\u2212z;Ry:x\u21d4\u2212x,y\u21d4y,z\u21d4\u2212z;Rz:x\u21d4\u2212x,y\u21d4\u2212y,z\u21d4z;\n\n\nThe transforms of x, y and z under the 12 operations of the T-group are listed in (Table 1). The four elements I, Rx, Ry and Rz form an invariant subgroup of the T-group, which is isomorphic to the Klein-4 group, or K4 group. The K4 group and its cosets exhaust the T-group. Therefore, all the 12 elements of the T-group can be divided into four classes, which are (I), (Rx,Ry, Rz), (RA, RC, RG, RT) and (R2A, R2C, R2G, R2T).\n\nOn the other hand, the set of all possible permutations of four objects forms a symmetric group, denoted by S4. Among the 24 elements of the symmetric group S4, the set of all 12 even permutations forms an invariant subgroup of S4, referred to as the alternative group of order 4, denoted by A4. The DNA group is defined as a particular A4 group, in which the permuted objects are the four DNA bases A, C, G and T. According to the group theory, the T-group and A4 group are isomorphic with each other. From the perspective of the abstract group, the T-group and the A4 group are the same group, because they have the same group structure and matrix representation. The four bases A, C, G and T are assigned to the four vertices of the tetrahedron, as shown in (Fig. 2D).\n\nThe four characters A, C, G and T will be transformed accordingly under the 12 operational elements of the DNA group or the A4 group. For example,\n\nBiologically, the transform Rx is called transition, whereas the transform Ry and Rz are called transversion. Here Rz is termed as the complementary transform.\n\nWe have previously established that the T-group and the A4 group are the same group [3], and thus their elements should have one-to-one corresponding relations, as shown in (Table 1). Both the A4 group and the T-group are called the DNA group, which forms the basis of the Z-curve theory.\n\nLet the occurrence frequencies of the four bases, A, C, G and T in a DNA sequence be denoted by a, c, g and t, respectively. The normalized condition reads\n\n\n(1)a+c+g+t=1,\n\n\nindicating that among the four real numbers a, c, g and t, only three of them are independent.\n\nSuppose that X, Y and Z are the coordinates of a point P in the coordinate system shown in (Fig. 2D), which can be expressed by a linear combination of the four frequencies a, c, g and t, as follows\n\n\n(2){X=a11a+a12c+a13g+a14t,Y=b11a+b12c+b13g+b14t,Z=c11a+c12c+c13g+c14t,\n\n\nwhere a11, a12, \u2026, c13, c14 are real coefficients. Eqs. (2) can be re-written as a matrix form\n\n\n(3)(XYZ)=(a11a12a13a14b11b12b13b14c11c12c13c14)\u00d7(acgt)\n\n\nThe coordinates of the four vertices of the regular tetrahedron A, C, G and T are already known, and shown in (Table 2). Based on the 12 numbers in (Table 2), the 12 coefficients can be uniquely determined, and eqs. (3) becomes\n\n\n(4a)(XYZ)=34(1\u221211\u2212111\u22121\u221211\u22121\u221211)\u00d7(acgt).\n\n\nEquivalently, eqs. (4) may be re-written as\n\n\n(4b){X=34[(a+g)\u2212(c+t)],Y=34[(a+c)\u2212(g+t)],X,Y,Z\u2208[\u221234Z=34[(a+t)\u2212(g+c)].,34]\n\n\nEqs. (4) are called the Z-transform formulas, which were first derived in 1991 by a totally different way [1]. The Z-transform formulas transform the four base frequencies into three coordinates of a point (called a mapping point) in a three-dimensional space. As previously indicated [1], for convenience, we introduced the reduced coordinate system x, y and z\n\n\n(5){X=34x,Y=34y,Z=34z,\n\n\nsuch that \n\n\n(6a){x=(a+g)\u2212(c+t),y=(a+c)\u2212(g+t),z=(a+t)\u2212(g+c).x,y,z\u2208[\u22121,1].\n\n\nIn what follows, we always use the Z-transform formulas based on the reduced coordinate system eqs. (6), unless otherwise indicated. Equivalently, eqs. (6a) can be also re-written as a matrix form\n\n\n(6b)(xyz)=(1\u221211\u2212111\u22121\u221211\u22121\u221211)\u00d7(acgt).\n\n\nLetting\n\n\n(7)U=(xyz),V=(acgt),\n\n\nand\n\n\n(8a)Z=(1\u221211\u2212111\u22121\u221211\u22121\u221211),\n\n\nEquivalently, eqs. (6b) may be re-written with a simplified form\n\n\n(9)U=Z\u00d7V.\n\n\nThe reverse equation of eqs. (6) is\n\n\n(10)(acgt)=14\u00d7(1111)+14\u00d7(111\u221211\u221211\u22121\u22121\u22121\u221211)\u00d7(xyz)\n\n\nIt is shown that regardless of the values of x, y and z,a+c+g+t\u22611. In fact, it was shown in 1991 that the mapping point P (x, y, z), corresponding to a, c, g and t, is always situated within the tetrahedron ACGT shown in (Fig. 2D) [1].\n\nTo provide a clear visualization, the tetrahedron and the mapping points within it are projected onto some coordinate planes. Referring to (Fig. 2C and D), note that the tetrahedron ACGT has 4 vertices A, C, G and T, and six edges AC, AG, AT, CG, CT and GT. Interestingly, the projection of six edges onto any coordinate plane forms a regular square and two diagonal lines within the square, where the projection of four vertices of the tetrahedron forms four vertices of the square, as shown in (Fig. 3A, B and C), for the x-y, x-z and y-z planes, respectively. Note that (Fig. 3A, B and C) are in accordance with (Fig. 1A,\nB and C), respectively. It should be noted that A, C, G and T are sometimes used to denote DNA bases, while the same symbols can represent vertices of the tetrahedron or squares. Refer to (Fig. 3A) first. Projections of four edges AG, AC, CT and GT form the four sides of the square, whereas those of AT and GC form the two diagonal lines of the square. Based on the Z-transform formulas eqs. (6), the base composition of a DNA sequence, i.e., the values of a, c, g and t, can be visualized by observing the position of the mapping point in the square. For example, if the DNA sequence has only one kind of base, say, A, then a = 1, c = g = t = 0. The corresponding mapping point is situated at the vertex A in (Fig. 2A). Similar results for (Fig. 3A) are summarized as follows.\n\nSimilar deductions for the annotation of (Fig. 3B and C) are left out for readers who might be interested in doing so.\n\nBased on the reduced coordinate system, the coordinates of the four vertices A, C, G and T can be represented by \n\n\n(11)(A)=(111),C=(\u221211\u22121),(G)=(1\u22121\u22121),T=(\u22121\u221211)\n\n\nWe previously established the linear representation of the DNA group, i.e., the tetrahedron group or the alternative group A4 in 1997 [3]. For readers\u2019 convenience, here we re-write the result (see eqs. (6) in [3] as follows: \n\n\n(12)I=(100010001),Rx=(1000\u22121000\u22121),Ry=(\u221210001000\u22121),Rz=(\u22121000\u221210001)RA=(001100010),RC=(001\u22121000\u221210),RG=(00\u22121\u2212100010),RT=(00\u221211000\u221210)RA2=(010001100),RC2=(0\u22121000\u22121100),RG2=(0\u221210001\u2212100),RT2=(01000\u22121\u2212100)\n\n\nThis matrix representation depicts correct relationships among the 12 elements of the DNA group. For example, a rotation of 180\u00b0 along the x-axis in (Fig. 2D), followed by another similar rotation, leads to the original state, i.e., \n\n\n(13)Rx\u00d7Rx=I\u21d4(1000\u22121000\u22121)\u00d7(1000\u22121000\u22121)=(100010001)=I\n\n\nThat is to say, the matrix representation not only results in a one-to-one correspondence among elements of the DNA group, but also correctly reflects their relations based on the multiplication of matrices.\n\nIn the following, we show that the transform matrix (3x4) eq. (8a) and its variants also constitute a one-to-one representation to each element of the DNA group. For this purpose, eq. (8a) can be re-written as\n\n\n(8b)Z=(1\u221211\u2212111\u22121\u221211\u22121\u221211)=((A)(C)(G)(T)),\n\n\nwhere (A), (C), (G) and (T) are denoted by eqs. (11). Referring to (Table 2), we find that the order of the four nucleotides above correspond to the element I of the A4 group. Similarly, its 11 variants can be derived, and are listed as follows\n\n\n(14)ZI=(1\u221211\u2212111\u22121\u221211\u22121\u221211),Zx=(1\u221211\u22121\u22121\u2212111\u2212111\u22121),Zy=(\u221211\u22121111\u22121\u22121\u2212111\u22121),Zz=(\u221211\u221211\u22121\u22121111\u22121\u221211),ZA=(1\u22121\u2212111\u221211\u2212111\u22121\u22121),ZC=(1\u22121\u221211\u221211\u221211\u22121\u2212111),ZG=(\u2212111\u22121\u221211\u22121111\u22121\u22121),ZT=(\u2212111\u221211\u221211\u22121\u22121\u2212111),ZA2=(11\u22121\u221211\u22121\u2212111\u221211\u22121),ZC2=(\u22121\u2212111\u2212111\u221211\u221211\u22121),ZG2=(\u22121\u22121111\u22121\u221211\u221211\u221211),ZT2=(11\u22121\u22121\u2212111\u22121\u221211\u221211),\n\n\nwhere ZI = Z. Based on the 12 Z matrices, we have\n\n\n(15)Zi\u00d7V=Ri\u00d7U,i=I,x,y,z,A,C,G,T,A2,C2,G2,T2.\n\n\nNote that each Zi corresponds to each Ri by a way of one-to-one correspondence. Therefore, the Z matrix also constitutes a representation of the DNA group in this sense. However, it is not an ordinary representation of the DNA group, because the similar multiplication relation such as eq. (13) does not exist among the Z matrices.\n\nIt should also be noted that the Z-transform formulas eqs. (6), which transform the nucleotide frequencies into the coordinates of a point in a three-dimensional space, are unique and invariant under the operations of the DNA group. The Z-transform formulas shown in eqs. (6) represent the unique set of equations which reflect the inherent features of the DNA group. The Z-transform formulas are the core of the Z-curve theory.\n\nTo extract features of a given DNA sequence, in addition to considering occurrence frequencies of a single nucleotide, correlations of multiple nucleotides should also be considered. Therefore, the Z-transform formulas should be extended to consider the correlations of multiple nucleotides.\n\nThe case of a single nucleotide\n\n\n(16)(xyz)=Z\u00d7(p(A)p(C)p(G)p(T)),a=p(A),c=p(C),g=p(G),t=p(T).\n\n\nEqs. (16) are equivalent to eqs. (9). Here we have 3 (= 3x4\u00b0) parameters.\n\nThe case of di-nucleotides\n\n\n(17)(xHyHzH)=Z\u00d7(p(HA)p(HC)p(HG)p(HT)),H=A,C,G,T,\n\n\nwhere p(HA) represents occurrence frequencies of the di-nucleotide HA, and so forth. Here we have 12 (=3x41)parameters.\n\nThe case of tri-nucleotides\n\n\n(18)(xHIyHIzHI)=Z\u00d7(p(HIA)p(HIC)p(HIG)p(HIT)),H,I=A,C,G,T,\n\n\nwhere p(HIA) represents occurrence frequencies of the tri-nucleotide HIA, and so forth. Here we have 48 (=3x42) parameters.\n\nThe case of tetra-nucleotides\n\n\n(19)(xHIJyHIJzHIJ)=Z\u00d7(p(HIJA)p(HIJC)p(HIJG)p(HIJT)),H,I,J=A,C,G,T,\n\n\nwhere p(HIJA) represents occurrence frequencies of the four-nucleotide HIJA, and so forth. Here we have 192 (=3x43) parameters.\n\nThe case of penta-nucleotides\n\n\n(20)(xHIJKyHIJKzHIJK)=Z\u00d7(p(HIJKA)p(HIJKC)p(HIJKG)p(HIJKT)),H,I,J,K=A,C,G,T,\n\n\nwhere p(HIJKA) represents occurrence frequencies of the five-nucleotide HIJKA, and so forth. Here we have 768 (=3x44) parameters.\n\nThe case of hexa-nucleotides\n\n\n(21)(xHIJKLyHIJKLzHJIKL)=Z\u00d7(p(HIJKLA)p(HIJKLC)p(HIJKLG)p(HIJKLT)),H,I,J,K,L=A,C,G,T,\n\n\nwhere p(HIJKLA) represents occurrence frequencies of the six-nucleotide HIJKLA, and so forth. Here we have 3072 (=3x45) parameters.\n\nTo calculate the occurrence frequencies of multiple nucleotides for a given DNA sequence, we use a moving window with size = 1, 2, 3, 4, 5 and 6. Starting from the first nucleotide or base, move the sliding window rightward one base at a time, and then the frequencies can be calculated. Substitute the frequencies into eqs. (16) to (21), and then the Z-curve parameters can be obtained. For some applications, eq. (16), i.e., 3 parameters are sufficient. However, in some cases, more parameters are needed. The space spanned by the 3 parameters is denoted by V1, and similarly we have V2, V3, V4, V5 and V6, respectively, corresponding to eqs. (16) to (21). Usually, the direct sum among different spaces is needed. For most applications, there are six possible choices \n\n\n(22)V=(V1,V1\u2295V2,V1\u2295V2\u2295V3,V1\u2295V2\u2295V3\u2295V4,V1\u2295V2\u2295V3\u2295V4\u2295V5,V1\u2295V2\u2295V3\u2295V4\u2295V5\u2295V6,)\n\n\nwhere the symbol \u2295 represents the direct sum of two spaces. The dimensions of the spaces V1 to V6 are 3, 15 (= 3+12), 63 (= 15+48), 255 (= 63+192), 1023 (= 255+768) and 4095 (= 1023+3072), respectively. Generally, for the spaceV=V1\u2295V2\u2295...\u2295Vm, the dimension is \n\nStarting from eq. (9)\n\n\n(9)U=Z\u00d7V,\n\n\nWe have\n\n\n(23)UT=VT\u00d7ZT\n\n\nwhere \u201cT\u201d means the transpose operation of a matrix. Furthermore, we find\n\n\n(24)UT\u00d7U=VT\u00d7ZT\u00d7Z\u00d7V.\n\n\nSimple derivation shows that\n\n\n(25)x2+y2+z2=4S\u22121,\n\n\nwhere S is defined by\n\n\n(26)S=a2+c2+g2+t2.\n\n\n\n S, named as \u201cgenome order index\u201d [7], is useful for designing a fast genome segmentation algorithm [8, 9]. We also observed that for most genomes\n\n\n(27)S<1/3\n\n\nEq. (27) has a clear geometrical explanation. The surface of the inscribed sphere is described by the equation\n\n\n(28)x2+y2+z2=(13)2=13.\n\n\nTherefore, S<1/3 implies that the mapping point is within the inscribed sphere [7].\n\nOne of the most important applications of the Z-transform formulas is to derive the equation of the Z-curve. Consider a DNA sequence with N bases that are inspected one base at a time. From the first base to the nth base, compute accumulative numbers of the bases A, C, G and T, denoted by An, Cn, Gn and Tn, respectively. Based on the Z-transform formulas eqs (6), we find\n\n\n(29)(x(n)y(n)z(n))=Z\u00d7(An/nCn/nGn/nTn/n).\n\n\nMultiplied by n to both hands of eq. (29), and letting\n\n\n(30)xn=n\u00d7x(n),yn=n\u00d7y(n),zn=n\u00d7z(n),\n\n\nwe have\n\n\n(31a)(xnynzn)=Z\u00d7(AnCnGnTn)\n\n\nor equivalently\n\n\n(31b){xn=(An+Gn)\u2212(Cn+Tn),yn=(An+Cn)\u2212(Gn+Tn),zn=(An+Tn)\u2212(Gn+Cn),n=0,1,2,3,....,N,xx,yn,zn\u2208[\u2212N,N],\n\n\nwhich was first derived in 1994 by an entirely different method [2]. It should be noted that An, Cn, Gn and Tn are the cumulative occurrence numbers of A, C, G and T, respectively, in the sub-sequence from the 1st base to the nth base in the sequence with length N. We define A0=C0=G0=T0=0, therefore, x0 = y0 = z0 = 0. The Z-curve is defined as the connection of the nodes P0 (x0, y0, z0), , P2 (x2, y2, z2), \u2026, PN(xN, yN, zN) one by one sequentially with straight lines. The connection results in a curve with a zigzag shape, hence the name Z-curve. Note that the Z-curve always starts from the origin of the three-dimensional coordinate system. Once the coordinates xn, yn and zn (n = 1, 2, \u2026, N) of a Z-curve are given, the corresponding DNA sequence can be reconstructed uniquely from the so-called inverse Z-transform formulas\n\n\n(32)(AnCnGnTn)=n4\u00d7(1111)+14\u00d7(111\u221211\u221211\u22121\u22121\u22121\u221211)\u00d7(xnynzn),n=1,2,...,N,\n\n\nwhere the normalized relation of An + Cn + Gn + Tn = n is used.\n\nThe three components of the Z-curve, xn, yn and zn, represent three independent distributions, that is, those of purine/pyrimidine (R/Y), amino/keto (M/K) and strong-H bond/weak-H bond (S/W) bases, respectively, and they completely describe the DNA sequence being studied. In the subsequence constituted from the 1st base to the nth bases of the sequence, when purine bases (A/G) are in excess of pyrimidine bases (C/T), xn > 0, otherwise, xn < 0, and when the numbers of purine (A/G) and pyrimidine bases (C/T) are identical, xn = 0. Similarly, when amino bases (A/C) are in excess of keto bases (G/T), yn > 0, otherwise, yn < 0, and when the numbers of amino (A/C) and keto bases (G/T) are identical, yn = 0. Finally, when weak H-bond bases (A/T) are in excess of strong H-bond bases (G/C), zn > 0, otherwise, zn < 0, and when the numbers of (A/T) and (G/C) bases are identical, zn = 0. The xn and yn components are termed RY and MK disparity curves, respectively. Similarly, the AT and GC disparity curves are defined by (xn + yn)/2 and (xn-yn)/2, which shows the excess of A over T and G over C, along the genome. The RY and MK disparity curves, as well as AT and GC disparity curves, can be used to predict replication origins of various genomes.\n\nFor most genome sequences, Chargaff Parity Rule II holds, i.e.,AN\u2245TNandCN\u2245GN, where N is the length of a genome or a chromosome. According to eqs (31), we find\n\n\n(33)xn\u22450,yn\u22450,zn>>1,forn>>1\n\n\nTherefore, the curves of zn ~ n are roughly straight lines in this case. To amplify the variations of the straight-line-like curve, the curve of zn ~ n is firstly fitted by a straight line using the least square technique,\n\n\n(34)z=kn,\n\n\nwhere (z, n) is the coordinate of a point on the fitted straight line and k is its slope. We define the z\u2019 curve, where\n\n\n(35)z\u2032n=zn\u2212kn.\n\n\nTherefore, the variations of zn ~ n curve deviated from the straight line, which corresponds to a constant G+C content (see eq. (36) below), are protruded by the z\u2019 curve. One may also use the average slope of the zn ~ n curve to compute k, k = zN / N, where zN is the terminal coordinate of the zn ~ n curve and N is the sequence length. The essence of the z\u2019 curve is to display the variations of the G+C content along a genome or chromosome based on the cumulative count of G and C bases. Let G+C\u00af denote the average G+C content within a region \u0394n in a sequence, it was shown that [10].\n\n\n(36)G+C\u00af=12(1\u2212k\u2212\u0394z\u2032n\u0394n)\u226112(1\u2212k\u2212k\u2032),\n\n\nwhere is the average slope of the z\u2019 curve within the region \u0394n. Both quantities of \u0394z\u2032n and \u0394n can be calculated by using the z\u2019 curve. It is clear to see from eq. (36) that a jump in the z\u2019 curve, i.e., k'>0, indicates a decrease of G+C content or an increase of A+T content, whereas a drop in the z\u2019 curve, i.e., k'<0, indicates an increase of G+C content or a decrease of A+T content. The region \u0394n is usually chosen to be a fragment of a DNA sequence. The above method to calculate G+C content is called the windowless technique [10].\n\nThe GC profile is defined as\u2212z\u2032, because it is more intuitive in the sense that a jump denotes an increase in GC content. We emphasize the importance of the GC profile for genome studies, because it represents a windowless technique to calculate the G+C content along genome sequences.\n\nLet n be a point within a DNA sequence of length N(2\u2264n\u2264N\u22121), which divides the whole sequence into two parts: the right and left sub-sequences, and then denote frequencies of bases in the right sub-sequence and left sub-sequence by (ar, cr, gr, tr) and (al, c1, g1, t1), respectively. The frequencies are mapped onto two points, PR (xr, yr, zr) and PL(xl, yl, zl), in a 3-D space, where \n\n\n(37)(xiyizi)=(1\u221211\u2212111\u22121\u221211\u22121\u221211)\u00d7(aicigiti),i=r,l.\n\n\nThe square of Euclidean distance between the two points is denoted by D, where \n\n\n(38)D(n)=(xr\u2212xl)2+(yr\u2212yl)2+(zr\u2212zl)2\n\n\nSubstituting eqs. (37) into eq. (38), we have\n\n\n(39)D(n)=C\u00d7[(ar\u2212al)2+(cr\u2212cl)2+(gr\u2212gl)2+(tr\u2212tl)2]\n\n\nwhere C is a constant. Note that D is a function of n. Suppose that when n=n*(2\u2264n*\u2264N\u22121)D(n*)=Maximun Then the point n* is called a compositional segmentation point [8]. The segmentation algorithm is recursive, i.e., after n* is determined, the same procedure is applied to both the left and right sub-sequences recursively, until D(n) is less than a given threshold. For more details refer to [8].\n\nEq. (39) can be extended to the case of a binary sequence. For example, by replacing the bases G and C with S, and bases A and T with W, a DNA sequence can be transformed into a binary sequence of S and W. In this case, the algorithm results in compositional segmentation points according to GC content. A software, called GC-Profile, was developed to implement the algorithm for genome segmentation [9].\n\nBased on 33 Z-curve parameters, we developed ZCURVE 1.0, which is an ab initio gene-finding software for bacterial and archaeal genomes [12]. Based on the 9 Z-curve parameters, ZCURVE_V was developed for identifying protein-coding genes in viral and phage genomes [14]. We also developed the software, ZCURVE_CoV, for gene-finding in coronavirus genomes, with special applications for SARS-coronavirus genomes [15, 16].\n\nThe above set of gene-finding software has been widely used in various laboratories worldwide. For example, ZCURVE 1.0 has been used for annotating protein-coding genes in many newly sequenced bacterial genomes, such as those of Acinetobacter baumannii [17], Variovorax paradoxus [18], Amycolatopsis mediterranei [19], Bacillus thuringiensis [20], Streptomyces tendae [21], Phaeobacter gallaeciensis [22], Desulfobacterium autotrophicum [23], Mycobacterium tuberculosis [24], Magnetospirillum gryphiswaldense [25] and Beggiatoa [26]. ZCURVE 1.0 was also used for annotating archaeal genomes, e.g., archaea of the ANME-1 group [27] (Table 3).\n\nFor some genomes, e.g., those of the bacterium Mycobacterium tuberculosis H37Ra [24] and Me Tri virus [28], ZCURVE 1.0 was the only software used for genome annotation, more frequently, however, results of ZCURVE 1.0 were combined with those of others, such as Glimmer [29] and Genmark [30]. For instance, ZCURVE 1.0 is integrated into meta-gene-finding tool YACOP [31] and GARSA [32]. It is noteworthy that ZCURVE 1.0 is especially suitable for genomes with high GC contents, e.g., GC content > 56% [12]. Likewise, ZCURVE_V and ZCURVE_CoV have been widely used for annotating protein-coding genes in newly sequenced genomes of viruses, coronaviruses [28, 33-37] and SARS coronaviruses [38-53].\n\nAlgorithms based on the Z-curve theory have been used for recognizing protein coding genes in a number of eukaryotic genomes, e.g., the budding yeast genome [11], Leptospira interrogans genome [54] and Drosophila genomes [55]. The Z-curve algorithm has also been used in recognizing short coding sequences of human genes [56]. The algorithm based on the 189 Z-curve parameters was shown to be the most accurate among those tested for a given database, with the second one being an algorithm based on the Markov chain of order five [56], and the result was later confirmed by an independent study [57]. Recognition of exons and introns of human genes was also studied by using the Z-curve method [58].\n\nThe standard genetic code defines a mapping between a codon and an amino acid. According to this mapping, protein coding regions are divided into a series of tri-nucleotides (codon or triplet), resulting in a period-3 property in coding regions. Therefore, it is possible to find coding regions by exploring the 3-periodicity of DNA sequences. Consequently, the first step is to transform the DNA sequence into a digital sequence or signal, and the Z-curve is especially suitable for this purpose.\n\nAccording to eqs. (31), \u0394xn=xn+1\u2212xn=\u00b11,\u0394yn=yn+1\u2212yn=\u00b11and\u0394zn=zn+1\u2212zn=\u00b11 . Applying the FFT to \u0394x,\u0394yand\u0394z, respectively, we are able to detect the 3-periodicity in the FFT power spectrum for each of the three numerical sequences. To increase the sensitivity, a lengthen-shuffle FFT algorithm was proposed for finding protein coding regions [59]. For example, the method was used to detect introns in the C. elegance chromosome III [60], and was later improved by using an adaptive filter to predict the exons in DNA sequences [61]. The relationship between the Z-curve and the Fourier transform for DNA sequence classification was studied in details [62].\n\nBacterial and eukaryotic genomes contain single and multiple replication origins, respectively. It was once a mystery whether archaea could have multiple oriCs.\n\nUsing the Z-curve method, we firstly predicted three oriCs as well as their precise locations for Sulfolobus solfataricus [63], and the prediction was consistent with later experimental evidence [64-67].\n\nThe archaeon Methanococcus jannaschii was the first to have its genome sequenced, however, its oriCs were notoriously difficult to locate by both theoretical and experimental methods. The Z-curve method predicted 2 oriCs [68] that were supported by later experimental evidence [66]. Similarly, we predicted a single oriC in the genome of Methanosarcina mazei [69] and 2 oriCs in the genome of A. pernix [70], which were also supported by experimental evidence [71]. The Z-curve method has been commonly used for annotating newly sequenced archaeal genomes, such as those of Sulfolobus acidocaldarius [72], Haloferax volcanii [73], Desulfurococcus kamchatkensis [74], Thermococcus sibiricus [75], and Sulfolobus islandicus [76].\n\nThe Z-curve method is an effective technique that detects the asymmetrical nucleotide distribution around replication origins. The Z-curve contains all the information of its corresponding DNA sequence, and therefore the GC-skew [77] is a special case of the Z-curve. Thus the Z-curve can reveal nucleotide asymmetry that is not detectable by GC skew [70]. For instance, RY, MK and AT disparity curves show an oriC in the archaeon Methanosarcina mazei Tuc01 (Fig. 4A), while RY, MK, and GC disparity curves show an oriC in the bacterium Salmonella enterica tr. CT18 (Fig. 4B).\n\nOri-Finder, an integrated in silico method to predict oriC regions of bacterial genomes, has been developed, based on the Z-curve method, along with distributions of DnaA box patterns, indicator genes, and phylogenetic relationships [78]. Ori-finder has become a commonly used annotation tool for identifying oriCs in newly sequenced archaeal and bacterial genomes, e.g., those of Moraxella catarrhalis [79], Sorangium cellulosum [80], Microcystis aeruginosa [80], Cyanothece [81], Cupriavidus metallidurans [82], Azolla filiculoides [83], Variovorax paradoxus [18], Corynebacterium pseudotuberculosis [84, 85], Orientia tsutsugamushi [86], Propionibacterium freudenreichii [87], Laribacter hongkongensis [88], Legionella pneumophila [89], and Ehrlichia canis [90] (Table 3).\n\nG+C content is an important characteristic of genome sequences. In the human genome, based on density gradient ultra-centrifugation experiments, it was found that long domains of relatively homogenous G+C content exist, and these domains are referred to as isochores [91, 92]. Traditionally, the G+C content along the genome is calculated using an overlapping or non-overlapping sliding window technique, based on which, however, isochores are hard to identify [93]. We developed a windowless technique in G+C content calculation, the GC profile [9, 10], which was used to study isochore structures in genomes of human [94], mouse [95], Arabidopsis thaliana [96] and chicken [97]. Based on the GC profile, the technique of wavelet multi-resolution analysis was used to identify isochore boundaries in the human genome [98]. For instance, a clear domain structure is revealed by the GC profile in chromosome 11 of finch (Fig. 4C). Other groups also used GC-Profile to study isochores in the pig genome [99] and to assess DNA curvature profiles for Aspergillus fumigatus [100].\n\nIt is generally accepted that horizontal gene transfer (HGT) plays an important role throughout the genome evolution of prokaryotes, because HGT alters the genotype of a bacterium, and could potentially lead to new traits [101]. Genomic islands (GIs) contain clusters of horizontally transferred genes and therefore, identification of horizontally-transferred GIs is an important biological issue. Because the GC profile is sensitive to changes in GC content, it is a powerful tool in identifying GIs [102].\n\nBased on the method of GC profile, GIs in many bacteria have been identified, e.g., Bacillus cereus [103], Corynebacterium glutamicum [104], Corynebacterium efficiens [105], Vibrio vulnificus CMCP6 [104], and Rhodopseudomonas palustris [106]. For instance, it was once believed that R. palustris does not have GIs, but analysis based on the GC profile identified 3 GIs that help explain how this bacterium survives in a versatile environment [106]. Corynebacterium efficiens can grow and produce glutamate at temperature above 40\u00b0C; unexpectedly, however, an aspartate kinase is less thermostable. This kinase gene is located in a GI that we identified, and this result suggests an explanation for its being less thermostable, i.e., the adaptive mutations have not occurred extensively due to the recent HGT [105]. For instance, horizontally transferred elements in Streptococcus pneumoniae ATCC 700669 can be clearly shown by the GC profile (Fig. 4D). The GC profile method has also been used for identification of GIs in other genomes, e.g., those of plant pathogens [107], Streptomyces lividans [108], Parachlamydiaceae UWE25 [109], epsilon proteobacteria Sulfurovum and Nitratiruptor [110], Acinetobacter oleivorans [111], and Silicibacter pomeroyi [112].\n\nBased on the behavior of the Z-curve near the bacterial gene translation start sites (TSS), a self-training method was proposed to find TSS with high accuracy [113]. It is likely that methods based on the same principle can also be used to recognize TSS in archaea and eukaryotes as well. Indeed, the Z-curve method was used to recognize human Pol II promoters [114] and promoters for bacterial genomes [115]. The positioning of nucleosomes, an elementary structural unit in eukaryotic chromatin, is pivotal in regulating many cellular processes, such as gene transcription. The Z-curve algorithm has been used to construct a genome-wide dynamic nucleosome positioning map for the budding yeast [116].\n\nOne of the aims for developing the Z-curve theory is to visualize DNA sequences. By using the Z-curve, features of related DNA sequences can be grasped quickly in a perceivable form [1, 2]. Therefore, we constructed the Z-curve database (www.zcurve.net), which contains Z-curves for currently available genomes, online Z-curve drawing tools and other Z-curve related software [117]. For instance, human chromosome 6 and chimpanzee chromosome 6 are homologous, and they apparently have similar Z-curve patterns (Fig. 5A and B). A typical example is the visualization of the genomes of related SARS-coronaviruses. Based on the 3-D coordinates of the corresponding Z-curves, the phylogenetic tree was constructed and was found to be in agreement with that based on sequence alignment [118]. Comparative genomics based on the GC profile was used to identify genomic islands [103, 119].\n\nAccording to eqs. (6), the base composition of a DNA sequence can be represented by a point in a 3-D space, thus providing an intuitive method to display base compositions. This method was used to study the codon usage in the genomes of AIDS virus [120], human [121], E. coli [122], Vibrio cholerae [123], Aeropyrum pernix K1 [124], Streptomyces coelicolor A3(2) [125] and seven GC-rich bacteria [126]. In prokaryotic genomes with high-GC content, coding ORFs and non-coding ORFs are located in distinct regions in a 9-dimensional space revealed by the Z-curve method, forming a flower-like pattern (Fig. 5C and D).\n\nThe three components of the Z-curve, x, y and z, which display distributions of purine/pyrimidine (R/Y), amino/keto (M/K) and strong-H bond/weak-H bond (S/W) bases, respectively, are independent, and completely describe the DNA sequence. The x and y components are related to the disparities of RY, MK, AT and GC bases, and can therefore be used to identify oriC regions in prokaryotic and eukaryotic genomes. The component z is related to G+C content, and can therefore be used to identify domain structures of eukaryotic genomes and genomic islands of prokaryotic genomes. The set of all three components can be used in identifications of protein-coding genes, promoters, translational start sites or in other bioinformatics issues. Generally, further applications are expected to benefit from the use of functions based on the three components, i.e., f (x, y, z), with potential integration of other parameters.\n\nIn conclusion, the methodology of the Z-curve provides a geometrical approach to analyzing genomic DNA sequences. Considerable progress in applying the Z-curve method has been achieved, and the Z-curve theory provides a solid basis for future developments."}