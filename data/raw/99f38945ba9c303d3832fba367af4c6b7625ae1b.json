{"title": "A Bayesian dynamic model for influenza surveillance", "body": "The 2001 Anthrax attacks, the spread of SARS during the Winter of 2002-2003, the shortage of flu vaccine in 2004, and the looming threat of an influenza pandemic caused by the H5N1 virus motivate the urgent need for surveillance systems able to provide early quantitative predictions of acute respiratory infections. Although less lethal than SARS, influenza is the seventh leading cause of death for people above 65 and below 4 years of age, and among the top 10 in almost all age groups [1] . Every year influenza infects up to 40 million Americans, causes the hospitalization of over 114 000 [2] , kills approximately 36 000 [3] and costs the United States between two and five billion dollars in physician visits, lost productivity, and lost wages [4] . This cost could grow to 160 billion dollars in the event of an influenza pandemic: a sudden and widespread outbreak of a new strain of the influenza virus that has significant morbidity and mortality [5] . Historically, the periodicity of pandemics has ranged between 9 and 39 years, with the last one in [1968] [1969] . A new pandemic in the next few years is considered today a looming if not inevitable threat [6] , which is reinforced by the increasing number of outbreaks caused by the H5N1 bird-flu strain [7] .\n\nBecause influenza viruses change continuously by antigenic drift and shift, nobody is immune and surveillance efforts are in place to detect changes in the viruses, to monitor their effects on hospitalization and death rates, and possibly to forecast the resurgence of a new influenza pandemic. The influenza surveillance system in the United States is managed by the Centers for Disease Control and Prevention (CDC) Influenza Branch, which collects and reports weekly information on influenza activity in the United States from September to May. Distribution of influenza activity and identification of viral types is ascertained through about 75 laboratories of the World Health Organization and 50 laboratories of the National Respiratory and Enteric Virus Surveillance System located throughout the United States. About 650 sentinel physicians report the weekly number of patients they have seen and the number of those patients with influenza-like illness (ILI) by age group that is defined as fever (temperature above 100\u00b0F) plus either a cough or a sore throat. The effect of influenza on mortality is monitored through weekly reports filed by the vital statistics offices of 122 cities that contain the total number of death certificates and the number of those for which pneumonia or influenza (P&I) were listed as a contributing cause of death.\n\nThe current influenza surveillance system monitors all these data streams individually, as shown in Plate 1. For example, ILI data are monitored to detect surges of influenza morbidity nationwide by comparing weekly data to a national baseline defined by a fixed threshold. It is acknowledged by CDC that the national baseline does not provide a useful threshold for local influenza surveillance so that the issue of local monitoring of influenza morbidity is still open [8] . The aggregate mortality data from the 122 cities are monitored to detect influenza epidemics. The detection consists of comparing the aggregated mortality data to an epidemic threshold that is calculated for each week using a baseline defined by a cyclic regression model [9] . To the best of our knowledge, no attempt is made to use and possibly integrate ILI and P&I data to forecast the course of an epidemic.\n\nFurthermore, for both states and physicians, influenza activity reporting is voluntary and data do not become available to health officials until approximately 2 weeks after the reports have been filed. An emerging approach to more timely detection is syndromic surveillance [10] , which identifies infected individuals early in the course of their disease, generally before a confirmed diagnosis is made. Patients are classified by syndrome, such as acute respiratory infection or gastrointestinal illness, based on a variety of data sources ranging from purchase of over the counter medications [11] to primary care physician and emergency department (ED) logs [12, 13] . The primary focus of these efforts has been to provide early detection of bioterrorism, following the Anthrax attacks of 2001, although this data could also provide early indication of naturally occurring disease outbreaks [14] .\n\nDespite the increasing amount of data that could potentially inform about outbreaks of disease, biosurveillance research to date has mainly focused on monitoring individual data streams [11, 13, 15] . When multiple signals have been considered, a system architecture based on a set of parallel, independent surveillance systems has been envisioned [16, 17] .\n\nThe intuition underlying our approach is that the integration of different data streams should provide complementary information about a disease and improve our ability for early detection of outbreaks. This integration, however, requires a coherent modelling framework to integrate data into a global model.\n\nIn this paper, we introduce a novel approach to integrate different data streams into a multivariate model for influenza surveillance. The novelty of our approach is in both the modelling framework that we use and in the type of data. We build a dynamic Bayesian networks that relates pediatric and adult syndromic data in two EDs to the traditional measures of influenza morbidity and mortality, and we show how to use this model for 'active' influenza surveillance by forecasting the course of influenza epidemics. Our analysis shows that the use of a dynamic Bayesian network for influenza surveillance has several advantages. By directly modelling measures of influenza morbidity and mortality, our model can be used to forecast the beginning of epidemics, as well as peaks of epidemics. Furthermore, the joint modelling of the four data streams shows that pediatric patients are infected with respiratory viruses well before the general population. In particular, the number of respiratory syndrome cases in a pediatric ED predicts influenza morbidity in the general population as early as 2 weeks in advance and influenza mortality as early as 3 weeks in advance. These findings suggest that children with respiratory syndromes seen at the ED act as sentinels for surges in influenza morbidity and mortality and that active surveillance of pediatric populations could become an important component of the influenza surveillance effort.\n\nThe next section describes the data that we used to build our dynamic models. Section 3 gives a brief introduction to dynamic Bayesian networks and Section 4 describes how we built the network with the data available and how we use it to forecast the course of an influenza epidemic. Conclusions are reported in Section 5.\n\nWe use variations in the weekly frequency of patients with respiratory syndromes presenting to two urban, tertiary care teaching hospitals in Boston, Massachusetts, to predict ILI data for the influenza seasons 1997-1998-2001-2002 , and to deaths for pneumonia and influenza (P&I) in New England from January 1998 to March 2003 published by CDC. \u2021 Both ILI and P&I data includes all age groups. The hospitals, one pediatric (CH) and the other adult (AH), share the same catchment area and each emergency department has an annual census of approximately 50 000 visits, with an average age of approximately 6 years for CH and 48 years for AH. Syndromic grouping was based on ED chief complaints as described in Reference [18] . Chief complaints were used to select those ED visits that were related to respiratory illness. At AH, chief complaints are entered as free-text during the triage process. We used two procedures to classify complaints: a text-string search, and a publicly available na\u00efve Bayesian classification program [16] . Default probabilities from an ED data set, supplied with the software, were applied to the AH data. At CH, chief complaint codes were chosen during the triage process, from a pre-defined on-line list of \u2021 http://wonder.cdc.gov/mmwr/mmwrmort.asp 181 choices. A previously validated subset of the constrained chief complaint set was chosen a priori for inclusion in the respiratory syndromic grouping. The ED data set dates back to June 1992 at CH and to June 1998 at AH. We will refer to the number of respiratory syndrome cases in either hospitals as CH and AH data.\n\nThe four time series are displayed in Figure 1 . The plot shows the apparent regularity of the four time series that are characterized by evident winter peaks during the influenza seasons, and more modest peaks in the fall seasons. Typically, the fall peaks correspond to increased activity of respiratory infections that follow the opening of schools. An intriguing feature of these time series is that the peaks do not occur simultaneously but there is an evident order with CH data (\u00b7\u00b7\u00b7) peaking first, followed by AH (-\u00b7 -) and ILI data (-) and then P&I mortality data (--).\n\nTo ascertain the temporal order of the four time series, we analysed their pair-wise crosscorrelations over 52 weeks. We use the notation \u03c1 x (A, B) to denote the cross-correlation between two time series A and B, with B shifted back by x weeks when x>0, and A shifted back by x weeks when x<0. The cross-correlation plot in the left panel of Figure 2 suggests that CH data are the earliest indicator of influenza-like illness (-: \u03c1 x (CH, ILI)>0.5 for 1 \u2264x = week \u2264 5) and deaths in the community (---: \u03c1 x (CH, P&I)>0.5 for 2 \u2264x \u22648). The large correlation between CH and ILI data for a 3 week lag suggests that the first effects of influenza emerge in CH data well before they become evident in the general population. CH data lead AH data by 1-5 weeks (\u00b7\u00b7\u00b7: \u03c1 x (CH, AH)>0.5 for 1 \u2264x \u22645) and the large correlations \u03c1 1 (CH, AH) = 0.64 for a 1 week lag, and \u03c1 2,3 (CH, AH) = 0.63 for a 2-3 week lag show that CH data can be used to predict a substantial proportion of the variability in AH data.\n\nAH data are also able to predict influenza mortality but with a shorter lead time compared to CH data and they appear to provide only slightly earlier information than ILI data currently monitored through federal surveillance programs. This finding is further supported by the cross-correlation between AH data and ILI and P&I mortality data displayed in the right panel of Figure 2 : AH data lead P&I data by 1-3 weeks (---: \u03c1 x (AH, P&I)>0.5 for 1 \u2264 x \u22643). Similarly, ILI data lead P&I mortality data by 1 week (\u00b7 \u00b7 \u00b7: \u03c1 x (ILI, P&I)>0.5 for 0 \u2264x \u22643) thus confirming that AH and ILI data contain similar information to predict P&I mortality. Compared to AH data, CH data show a smaller correlation with P&I deaths, possibly because the elderly are the most at risk of dying from influenza and pneumonia. Nonetheless, this analysis suggests that pediatric patients are the first group to show symptoms of respiratory infections, and that these early effects are seen in the ED.\n\nBy examining a pair of time series at a time, cross-correlation analysis may overlook the overall temporal dependency structure by introducing spurious or masking important dependencies. To better identify the dynamic structure among the four time series, we built a model based on a dynamic Bayesian network [19] .\n\nA dynamic Bayesian network is described by a directed acyclic graph in which nodes represent stochastic variables and arrows represent temporal dependencies that are quantified by probability distributions. Following the direction of the arrows, a node Y 1 with an incoming arrow from a node Y 2 is called a child of Y 2 , and Y 2 is called a parent of Y 1 . We assume that the probability distributions of the temporal dependencies are time invariant, so that the directed acyclic graph of a dynamic Bayesian network represents only the time transitions that are necessary and sufficient to reconstruct the overall temporal process. Figure 3 shows the directed acyclic graph of a dynamic Bayesian network with three variables. The subscript of each node denotes the time lag, so that the arrows from the nodes Y 2(t\u22121) and Y 1(t\u22121) to the node Y 1(t) describe the dependency of the probability distribution of the variable Y 1 at time t on the value of Y 1 and Y 2 at time t \u2212 1. Similarly, the directed acyclic graph shows that the probability distribution of the variable Y 2 at time t is a function of the value of Y 1 and Y 2 at time t \u2212 1. It is worth noting that a dynamic Bayesian network is not restricted to represent temporal dependency of order 1. For example the probability distribution of the variable Y 3 at time t depends on the value of the variable at time t \u2212 1 as well as the value of the variable Y 2 at time t \u2212 2.\n\nThe topology of the directed acyclic graph describes Markovian properties of the variables that allow us to decompose the network into related modules. The local Markov property asserts that a node Y is independent of its nondescendant nodes, given the parent nodes [20] , and leads to a direct factorization of the transition distribution of the network variables Y 1 , \u2026, Y k into the product of the conditional distribution of each variable given its parents \u03a0 i :\n\nwhere h t\u22121 is the history of the process through time t \u2212 1, y 1(t) ,\u2026, y k(t) denotes the value of the network variables at time t, and \u03c0 i are the parents of Y i . For example, we can fully describe the transition distribution of the three variables in Figure 3 given the past history by using only the three transition distributions:\n\nAssuming that these probability distributions are time invariant, they are sufficient to compute the probability that a process that starts from known values y 1(0) , y 2(0) , and y 3(0) evolves into y 1(T) , y 2(T) , y 3(T) , or that a process with values y 1(T) , y 2(T) , y 3(T) at time T started from the initial states y 1(0) , y 2(0) , y 3(0) . Exact algorithms exist to perform this inference when the network variables are all discrete, all continuous and modelled with Gaussian distributions, or the network topology is constrained to particular structures [21] [22] [23] . For general network topologies and nonstandard distributions, we need to resort to stochastic simulation [24] . Among the several stochastic simulation methods currently available, Gibbs sampling [25, 26] is particularly appropriate for Bayesian network reasoning because of its ability to leverage on the decomposition of joint multivariate distributions induced by the directed acyclic graph to improve computational efficiency.\n\nWe leveraged on the local Markov property to build our dynamic Bayesian network by modules. For each variable, we identified the best multiple regression model by selecting the significant predictors in the set defined by the variable itself observed at t \u2212 1,\u2026, t \u2212 10 week lags, the other variables observed over the same temporal range, and two auxiliary variables that model the seasonal pattern of the time series. We followed suggestions in Reference [27] and limited attention to additive models. Because of their significant skewness, we modelled the number of P&I deaths by a Poisson log-linear model and the number of patients with ILI symptoms with a log-normal distribution, while we modelled AH and CH data with normal distributions. We used backward step-wise regression to avoid overlooking some dependencies, and the Akaike information criterion [28] to build initial models for each time series, and then selected only significant predictors. Using the BIC criterion [28] , produced the same results. This selection procedure returned the four models in Figure 4 , one for each of the four time series. These models are described by the following set of equations:\n\nwhere the variables x 1 and x 2 are periodical functions defined as x 1 = sin(2\u03c0t/52) and x 2 = cos(2\u03c0t/52) and the probability distributions of the variables CH, AH, ILI and P&I at time t, given their parent nodes, are specified as where N(\u03bc, \u03c3 2 ) denotes the normal distribution with mean \u03bc and variance \u03c3 2 , and P(\u03bc) denotes the Poisson distribution with mean \u03bc. Table I gives further details of the parameter estimates. The overall dependency model was built joining the four regression models by their common predictors using standard path analysis [29] , and is reported in Figure 5 . Each node in the directed graphs represents one of the four variables at the time point defined by the subscript and the arrows define the temporal dependencies that are quantified by the equation above. We validated this model by examining the posterior probability of each selected temporal model versus the others. We first approximated the logarithm of the marginal likelihood of each regression model m, say l m by the Akaike information criterion [30] . Assuming uniform prior probabilities on the set of possible models, we then computed the posterior probability of each model m was p m = exp(l m )/k, with the normalizing constant k = \u03a3 m p m . The dependency structure of the selected model is very strong as shown by the plot in Figure  6 that depicts the posterior probability of 400 models describing the dependency of the number of P&I deaths on CH and AH data, for different time lags. The surface peaks when the time lag is 3 weeks for CH data and 1 week for AH data and, compared to the other temporal dependencies, there is very strong evidence that this model gives the best fit (posterior probability almost 1).\n\nThe temporal dependency structure in Figure 5 confirms some of the results suggested by the cross-correlation analysis. CH data are predictive of AH data with a 1 week lag, they are predictive of ILI data with a 2 week lag, and of the number of P&I deaths with a 3 week lag. This result confirms that children presenting to the ED with respiratory syndromes provide earlier signals of the spread of influenza epidemics compared to ILI data currently monitored through federal surveillance programs. It is worth noting that neither AH data, nor ILI data or P&I deaths are predictive of CH data, thus confirming that pediatric patients presenting to the ED are the first group to show symptoms of influenza. Both AH and ILI data are predictive of P&I deaths with a 1 week lag. Note that AH data are not predictive of ILI data, once we condition on CH data observed 2 weeks earlier, thus confirming that CH data contain earlier and stronger signals of influenza morbidity than AH data. Note also the negative effect of CH t\u22123 in the regression model fitted to P&I data, that may reflect the fact that children's data contributes to the morbidity of the disease but less to mortality.\n\nThe model in Figure 5 suggests that the spread of respiratory infections, and particularly influenza, in a community begins in children who report to the ED with respiratory syndromes. This observation is confirmed by the absence of predictive signal of ILI and P&I mortality data on CH data. Further support for this conjecture is provided by using the dynamic model for prediction of influenza morbidity and mortality a few weeks in advance and by quantifying the predictive effect of pediatric patients. For this assessment, we created competitive models by iteratively dropping each of the predictors from the selected model. We trained the competitive models on the data from June 1998 to the end of October 1999 and then computed their 2-week ahead predictions of ILI and P&I data from November 1999 to October 2000. We chose this test set as the virus circulating during the influenza season 1999-2000 had significant morbidity. After each prediction, we iteratively updated the model parameters using all data seen. Because we use non-Gaussian distributions, we had to resort to stochastic computations for the predictive inference. We used the implementation of Gibbs sampling in Winbugs 1.4 to compute the forecasts [31] . Figure 7 reports the BUGS code for this '2-week-ahead' forecast with the model in Figure 5 . The model describes the dependency structure between the four data streams assuming that we have initial values at week t \u2212 2 and we wish to forecast P&I mortality data, and ILI morbidity data at week t. To initialize the dynamic network, we need data for the parent nodes of the four variables at time t \u2212 2. Therefore, we provide CH data at week t \u2212 4, and AH data, ILI data and P&I data at week t \u2212 2 to initialize the conditional distribution of P&I at week t\u2212 1. Similarly, we use CH data at week t\u2212 2 to initialize the conditional distribution of CH at week t\u2212 1; CH data at week t\u2212 3 together with AH data at week t\u2212 2 will initialize the conditional distribution of AH at week t\u2212 1, while CH data at week t\u2212 3, and ILI data at week t \u2212 2 will initialize the conditional distribution of ILI at week t \u2212 1. The parameters that specify the transition distributions, as well as the time point t and the values of the covariates x 1 and x 2 are provided via the data file, and are iteratively updated for each weekly forecast.\n\nPlate 2 shows the number of patients with ILI symptoms recorded in MA between November 1999 and October 2000 by the sentinel physicians in the CDC influenza surveillance program (black line). The red line depicts the 2-week ahead prediction computed by the dynamic model, while the green line shows the 2-week ahead prediction when CH data are removed from the model. The pale blue line is the 2-week ahead prediction when ILI data are removed from the model. Besides the very close match between true and predicted values provided by our dynamic model, it is apparent that CH data alone are sufficient to forecast the dynamics of ILI data, while the model in which CH data are removed suffers of a delay. Statistical analysis of the forecasting error of our model showed no significant difference between observed and predicted values (t-test = 0.79, pvalue = 0.21), while removing ILI data increases the average forecasting error that is still not significant (t-test = 1.2394, p-value = 0.1104), and removing CH data makes the average forecasting error significantly different from 0 (t-test = 3.6795, p-value = 0.0002818). Similar tests were conducted to assess the predictive effect of both CH and AH data on influenza deaths and confirmed the early signature of syndromic data. For example, using only ILI data to predict PI increases the average prediction error by about 12 per cent. Using AH data only increases the average prediction error by 9 per cent and using CH data increases the average prediction error by 4 per cent.\n\nThe increasing emphasis on biosurveillance, motivated by recent epidemic and bioterrorism events, has stimulated the electronic collection of different sources of data that are supposed to contain early signs of disease outbreaks. One of the major challenges that researchers in biosurveillance face at the moment is the integration of these data streams into models that can indeed alert public health officials of impeding disease outbreaks. To achieve these objectives, we need models that can integrate information from different data streams and that can be used for accurate forecasting.\n\nIn agreement with the work of other investigators [32] , our analysis shows that dynamic Bayesian networks provide a simple but effective modelling tool for the integration of several time series data into a dynamic model. These results are in agreement with the work of other investigators. The modularity of dynamic Bayesian networks makes it possible to learn them from data comprising several variables using standard multiple regression techniques. Furthermore, the availability of software for stochastic computations with directed graphical models makes probabilistic inference with dynamic Bayesian networks very efficient, and removes the need to impose restrictive assumptions on the dependency structure or probability distribution of the network variables such as those imposed on Gaussian networks [27] . Although in this paper we have applied dynamic Bayesian networks to model four data streams, the approach can be extended to include other types of data that can be informative for influenza surveillance, such as school/work absenteeism, or syndromic data collected at other EDs [33] .\n\nAn issue created by the analysis of several time series is the fact that different data streams may be measured in different time intervals. In our application, syndromic data are measured daily, while ILI and P&I data are measured weekly. For convenience, we analysed the variations in the weekly frequency of syndromic data, with a potential loss of information and timeliness. The extension of this methodology to the analysis of time series with different time frequency is an open issue that deserves further investigation.\n\nAnother open issue is the effect of the time-invariance assumption. The predictive accuracy in our evaluation provides evidence of the good performance of our model and, therefore, of the fact that the time-invariance assumption is reasonable. In general application, the effect of this assumption should be assessed by using for example residual plots to investigate temporal patterns of the residuals.\n\nFrom the epidemiology point of view, our analysis identifies in the number of pediatric patients who present to the ED with respiratory syndromes an early quantitative indicator of influenza epidemics. Compared to hospitalization rates [34] or school absenteeism [35] used for monitoring or detecting ongoing influenza outbreaks, pediatric patients with respiratory syndromes are able to predict upcoming epidemics 2-3 weeks in advance. The pediatric sentinel signal is early enough to allow ample time to step up vaccination [36, 37] and implement other effective control measures in the community to reduce the burden of illness and mortality. Left: Cross-correlation (y-axis) between the weekly number of CH and ILI data, deaths from P&I, and the weekly number of AH data for different week lags (x-axis). For each ordered pair of time series, the cross-correlation for x weeks lag represents the correlation between the first time series shifted back by x weeks when x>0, while the second time series is shifted back by x weeks when x<0. Right: Cross-correlation between the weekly number of AH data, ILI cases and deaths from P&I. The dotted line (\u00b7 \u00b7 \u00b7) displays the cross-correlation between the series of ILI cases and deaths from P&I. A directed acyclic graph representing the temporal dependency of three categorical variables with states \u2212 and +. The conditional probability table shows the transition probabilities that quantify the dependency of Y 3 on its parent nodes. Regression models for each of the four time series (CH, AH, P&I and ILI). All nodes in the graphs represent stochastic variables and arrows represent temporal dependencies quantified by probability distributions. An arrow from a node A to a node B means that A leads B by the number of weeks identified by the subscript. For example, the graph (a) shows that the number of pediatric patients seen at the ED with respiratory syndrome at week t \u2212 1 (CH t\u22121 ) leads the number of pediatric patients at week t (CH t ). This is a simple autoregressive model of order 1. The graph (b) shows that the model describing the dynamics of P&I at week t has an autoregressive component (P&I t\u22121 ) as well as the three predictors CH t\u22123 , AH t\u22121 , and ILI t7minus;1 . Therefore, CH data lead P&I data by 3 weeks, while both AH and ILI data lead the number of pneumonia and influenza deaths by 1 week only. Similarly, the graphs (c) and (d) show that CH data lead AH data by 1 week, and the number of patients with ILI symptoms by 2 weeks. The overall dynamic Bayesian network describing the interplay between the four data streams. Posterior probability (z-axis) for the models describing the dependency of the number of deaths for pneumonia and influenza on the number of pediatric and adult patients with respiratory syndromes for varying lags in weeks (x and y axes). The probability is maximum when the number of pediatric patients with respiratory syndrome is measured with a three week lag and the number of adult patients with respiratory syndrome is measured with 1 week lag and, compared to the other models, there is very strong evidence that this model gives the best fit (posterior probability almost 1). Estimates and standard errors of the regression parameters for the four models fitted to CH, AH, ILI and P&I data when all the data are used to induce the network. The model fitted to P&I data is a log-linear model, so that the regression coefficients parameterize the logarithm of the mean. The model fitted to ILI data is in logarithmic scale. The variables x 1 and x 2 are periodical functions defined as x 1 = sin(2\u03c0t/52) and x 2 = cos(2\u03c0t/52). Note the negative effect of CH t\u22123 in the regression model fitted to P&I data, that may reflect the fact that children's data contributes to the morbidity of the disease but less to mortality.\n\nStat Med. Author manuscript; available in PMC 2014 August 11."}