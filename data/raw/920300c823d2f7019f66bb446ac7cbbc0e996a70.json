{"title": "Modeling epidemics using cellular automata", "body": "Nowadays, public health issues have a lot of importance in our society, particularly viral spread through populated areas. Epidemics refer to a disease that spreads extensively and rapidly by infection and affecting many individuals in an area or a population at the same time. Some examples of epidemics are the Black Death during the mid-14th century, the so-called Spanish Flu pandemic in 1918, the Severe Acute Respiratory Syndrome, better known by its acronym SARS, in 2002, or more recently, the Avian Influenza.\n\nWhilst a single infected host might not be significant, a disease that spreads through a large population yields serious health and economic threats. Consequently, since the first years of the last century, an interdisciplinary effort to study the spreading of a disease in a social system has been made. In this sense, mathematical epidemiology is concerned with modeling the spread of infectious disease in a population. The aim is generally to understand the time course of the disease with the goal of controlling its spread. Such models are used, for example, to guide policy in vaccination strategies for childhood diseases.\n\nMathematical modeling in epidemiology was pioneered by Bernoulli in 1760 in his work demonstrating the effectiveness of the technique of variolation against smallpox (see [1] ), although the search for understanding of the dynamics of epidemic spreading goes back to 'Epidemics' by Hippocrates. Nevertheless, the work due to Kermack and McKendrick in 1927 (see [2] ) can be considered as the starting point for the design of modern mathematical models. It consists of a SIR model. Specifically, one can consider some types of mathematical models depending on the division of the population into classes. So, we have the SIR models where susceptible (S), infected (I), and recovered (R) individuals are considered. The susceptible individuals are those capable to contracting the disease; the infected individuals are those capable of spreading the disease; and the recovered individuals are those immune from the disease, either died from the disease, or, having recovered, are definitely immune to it. For many infections there is a period of time during which the individual has been infected but is not yet infectious himself; during this latent period the individual is said to be exposed. In this case we have the SEIR model in which the new class of exposed individuals (E) must be considered. Some infections, for example the group of those responsible for the common cold, do not confer any long lasting immunity. Such infections do not have a recovered state and individuals become susceptible again after infection. Then we have the SIS models. Moreover, there are another variants of these models such as the SIRS model or the SEIRS model.\n\nTraditionally, the majority of existing mathematical models to simulate epidemics are based on ordinary differential equations. These models have serious drawbacks in that they neglect the local characteristics of the spreading process and they do not include variable susceptibility of individuals. Specifically, they fail to simulate in a proper way (1) the individual contact processes, (2) the effects of individual behaviour, (3) the spatial aspects of the epidemic spreading, and (4) the effects of mixing patterns of the individuals.\n\nCellular automata (CA for short) can overcome these drawbacks and have been used by several researches as an efficient alternative method to simulate epidemic spreading (see, for example, [3] [4] [5] [6] [7] [8] [9] [10] [11] [12] [13] , apart from another works appeared in the life sciences and computing literature). Of special interest are the CA-epidemic proposals modeling the motion of individuals (see, for example [14] [15] [16] ). Roughly speaking, cellular automata are simple models of computation capable to simulate physical, biological or environmental complex phenomena. Consequently, several models based on such mathematical objects have been appeared in the literature to simulate growth processes, reaction-diffusion systems, self-reproduction models, epidemic models, forest fire spreading, image processing algorithms, etc. (see, for example, [17] ). Specifically, a two-dimensional CA is formed by a two-dimensional array of identical objects called cells, which are endowed with a state that changes in discrete steps of time according to a specific rule. As the CA evolves, the updated function (whose variables are the states of the neighbors cells) determines how local interactions can influence the global behaviour of the system.\n\nUsually, when a CA-based model is considered to simulate an epidemic spreading, individuals are assumed to be distributed in the cellular space such that each cell stands for an individual of the population. In this work, a mathematical deterministic model to simulate epidemic spreading is introduced. It is based on cellular automata, and three classes of population are considered: susceptible, infected and recovered. Furthermore, in each cell several individuals are considered instead of only one individual, as is stated in the majority of proposals appeared in the literature, since the proposed model try to simulate epidemic spreading in large regions. Consequently, each cell stands for an square portion of the land and its state is obtained from the fraction of the number of individuals which are susceptible, infected, or recovered from the disease. Moreover, in the proposed model the vaccination process can be considered.\n\nThe rest of the paper is organized as follows: In Section 2 the basic results about cellular automata are introduced; the model to simulate the epidemic spreading is presented in Section 3; in Section 4 some simulations using artificially chosen parameters are shown, and, finally, the conclusions are introduced in Section 5.\n\nBidimensional cellular automata are discrete dynamical systems formed by a finite number of r \u00b7 c identical objects called cells which are arranged uniformly in a two-dimensional cellular space. Each cell is endowed with a state (from a finite state set Q), that changes at every step of time accordingly to a local transition rule. In this sense, the state of a particular cell at time t depends on the states of a set of cells, called its neighborhood, at the previous time step t \u00c0 1. More precisely, a CA is defined by the 4-uplet (C, Q, V, f), where C is the cellular space: C \u00bc f\u00f0i; j\u00de; 1 6 i 6 r; 1 6 j 6 cg; \u00f01\u00de Q is the finite state set whose elements are the all possible states of the cells;\n\nis the finite set of indices defining the neighborhood of each cell, such that the neighborhood of the cell (i, j) is\n\nFinally, the function f is the local transition function:\n\nwhere s t ij stands for the state of the cell (i, j) at time t. As is mentioned above, the cells are represented as identical square areas forming the cellular space (see Fig. 1(a) ). The most important types of neighborhoods are Von Neumann neighborhood (see Fig. 1 (b)) given by the cell itself and the four cells placed at north, south, east and west, and Moore neighborhood (see Fig. 1 (c)), formed by the cell itself and its eight nearest cells.\n\nThe set of indices for Von Neumann neighborhoods is the following:\n\nwhereas for Moore neighbourhoods V is defined as follows:\n\nV \u00bc f\u00f00; 0\u00de; \u00f0\u00c01; 0\u00de; \u00f0\u00c01; 1\u00de; \u00f00; 1\u00de; \u00f01; 1\u00de; \u00f01; 0\u00de; \u00f01; \u00c01\u00de; \u00f00; \u00c01\u00de; \u00f0\u00c01; \u00c01\u00deg; \u00f05\u00de\n\nAs is mentioned above, the CA evolves deterministically in discrete time steps, changing the states of the cells by means of the local transition function f. As the cellular space is considered to be finite, boundary conditions must be considered in order to assure a well-defined dynamics of the CA. These boundary conditions depends on the process to be simulated; in this work, we will use null boundary conditions, that is,\n\nIn this section, we introduce the mathematical model based on cellular automata, to simulate the spreading of a general epidemic. It is suppose that the ground where the epidemic is spreading stands for the cellular space of the CA, and it is divided into identical square areas, each of them represent a cell of the CA. Different cells will have different populations: differing densities and different 'across cell' traversal or mobility properties. Moreover, the cellular space is considered to be large enough to ensure that the epidemic spreading affects only to the central region. Indeed, in this case, the null boundary conditions stand for absorbing boundary conditions.\n\nThe main features of the epidemic and the environment where it is spreading are the following:\n\n\u2022 The epidemic is not lethal and no birth, immigration or emigration is considered; consequently, the total amount of population is constant. As a consequence, the population of each cell is always the same. \u2022 The population distribution is inhomogeneous, that is, the total population living in each cell is different, and the total population of the cell (i, j) is N ij . \u2022 It is suppose that the way of infection is the contact between the infected individual and the healthy individual. \u2022 Once the healthy individuals have contracted the infection and have recovered from it, they acquire immunity. That is, they are definitely immune to the disease and consequently they will not be susceptible individuals. \u2022 People can move from one cell to another (if there is some type of way of transport), that is, the individuals are able to go outside and come back inside their cells during each time step. \u2022 It is suppose that when an infected individual arrives at a cell, the number of healthy individuals contacted by him/her is the same independently of the total amount of population of the cell.\n\nLet S t ij 2 \u00bd0; 1 be the portion of the healthy individuals of the cell (i, j) who are susceptible to infection at time t; set I t ij 2 \u00bd0; 1 the portion of the infected population of the cell at time t who can transmit the disease to the healthy ones; and let R t ij 2 \u00bd0; 1 be the portion of recovered individuals of (i, j) from the disease at time t, that will be permanently immunised. As is stated above, the population of each cell is constant, consequently:\n\nand DR t ij suitable discretizations of the fractions of the susceptible, infected and recovered population of the cell at time t, respectively, to get elements of the finite state set Q. In this work, we will consider the state set Q = K \u00b7 K \u00b7 K, where: \n\nwhich is formed by 101 elements. Consequently, the discretization used is:\n\nwhere [x] is the nearest integer to x. Then, the state of the cellular automata used in the model is the three-uplet s t ij \u00bc \u00f0DS t ij ; DI t ij ; DR t ij \u00de 2 Q. The main goal of the model is to compute the factors S t ij , I t ij and R t ij . The local transition function used is the following: Eqs. (8) and (10) reflect that every loss in the infected population is due to a gain in the recovered population, while every gain in the infected population is due to a loss in the susceptible population. Roughly speaking, the Eq. (8) can be interpreted as saying that the portion of infected individuals of a cell (i, j) at a particular time step t is given by the portion of infected individuals which have not been recovered from the disease (first sum of the summation) and by the portion of susceptible individuals of the same cell at time t \u00c0 1 which have been infected by the infected individuals at time t \u00c0 1 of the cell (second sum of the summation) taking into account the virulence of the disease. Moreover, some susceptible individuals of the cell (i, j) can be infected by infected individuals of the neighbour cells which have travelled to the cell (third sum of the summation). Obviously, it depends on some parameters involving the virulence, the nature of the connections between the cells, the possibilities of an infected individual to be moved from one cell to another, and the relation between the population of the cells. Furthermore, Eq. (10) gives the portion of recovered individuals of the cell (i, j) at time t as the number of recovered individuals of the cell at the previous time step plus the fraction of infected individuals of the cell which have been recovered in one step of time. Finally, Eq. (9) gives the portion of susceptible individuals of the cell (i, j) at time step t as the portion of susceptible individuals at time t \u00c0 1 which have not been infected.\n\nNote that, as a simple calculus shows: S t ij \u00fe I t ij \u00fe R t ij \u00bc 1, for every cell (i, j) and every time step t. As is mentioned above, the way of infection of the epidemic to be modeled is the contact between two individuals (an infected and a healthy individual). Consequently, the healthy individuals of a particular cell can be infected by the infected individuals of this cell or by the infected individuals of the neighbour cells that have traveled to the main cell.\n\nThe first case, that is, when an individual is infected by another individual of his/her cell, is reflected in the first sum of the summation given in the Eq. (8) . In the other case, given by the second sum of the summation of (8), when the infection is carried out by individuals belonging to neighbour cells, some type of connection between the cells must be exist in order to allow the epidemic spreading. In this work, we will consider three ways of transport: by airplane, by train and by car or bus. This connection is given by the coefficients c if there is not any way of transport between the cells;\n\nThe movement factor m \u00f0i;j\u00de ab 2 \u00bd0; 1 stands for the probability of an infected individual belonging to the neighbour cell (i + a, j + b) to be moved to the main cell (i, j). Note that this parameter is different from the connection factor since it depends on the infected individuals and the other one (the connection factor) depends on the existing transport infrastructures between the cells considered. Moreover, the movement factor must be given by the main features of the disease to be modeled.\n\nFinally, it is very important to decide whether or not the outbreak disease occurs. In this sense, we will obtain the values of the parameters for which the epidemic spread from one cell to its neighbor cells. Suppose that in the initial configuration there is only one cell with infected individuals: O, and set N its north neighbor cell. Then the infected individuals of N at time step t = 1 is given by the following expression:\n\nsince I 0 N \u00bc 0 and S 0 N \u00bc 1. In our model, we suppose that there are infected individuals in the cell N at a particular time step t when DI t N 2 Q \u00c0 f0g, that is, when DI t N P 0:01. Consequently, the following equation must hold:\n\nAs a consequence, the number of infected individuals necessary to extend the epidemic out to the cell depends on the values of the parameters c N O ; m N O and v. In Table 1 some examples are shown for the case in which the population is the same in all cells.\n\nOn the other hand, if\n\nthen the evolution of the infected population is restricted to the main cell O, and the number of infected individuals becomes zero if I t O < I t\u00c01 O for every t. Consequently, as Eq. (14) holds then a simple calculus shows that for every t:\n\nif and only if S t\u00c01 O < e=v. As a consequence, I t O \u00bc I O \u00f0t\u00de is a decreasing function which tends to 0 if S 0 O < e=v, or equivalently, if\n\nwhere X is the threshold quantity called the basic reproductive number. Furtheremore, if Eq. (16) does not hold, then the infected population of the cell increases and when it exceeds the constant q the epidemic will be spread from the main cell to its neighbour cells.\n\nThe cellular space in the next simulations will be formed by a two-dimensional array of 50 \u00b7 50 cells. In the simulations we represent the proportion of infected individuals of each cell by means of a gray level code is used running from white color for the state 0 to black color for state 1. For the sake of simplicity, we will use the following artificially chosen parameters: v = 0.6, e = 0.4, m \u00f0i;j\u00de ab \u00bc 0:5, for every cell (i, j). The initial conditions consist of only one cell with infected individuals, namely (25, 25) with s 0 25;25 \u00bc \u00f00:7; 0:3; 0\u00de. Moreover, in the simulations, six configurations of the CA are shown: Those at time steps t = 0, 5, 10, 15, 20, 25.\n\nWe will consider two cases: (1) Each cell is connected with all of its neighborhoods with the same parameter: c \u00f0i;j\u00de ab \u00bc 1 for every cell (i, j), and (a, b) 2 V; (2) The connection between the cells is not constant.\n\n(1) Suppose that the population in each cell is the same, that is, N ij = 100 for every cell (i, j). Then, the simulation obtained with Von Neumann neighborhoods is shown in Fig. 2 and the simulation computed with Moore neighborhoods is shown in Fig. 3 . Note that the successive epidemic fronts (regions of spread at different times) are circular as is expected, where the starting point of the epidemic is in the center of these circular fronts. The evolutions of the number of susceptible, infected and recovered individuals are shown in Fig. 4 . Initially, only the central cell has infected individuals, specifically the 30% of population (30 persons). As is shown in Fig. 4 , the number of infected individuals increases from t = 1 to t = 44 with Von Neumann Table 1 Minimum values of infected individuals located at the cell O at time t = 0 necessary to produce the epidemic spreading to another cells\n\nMovement factor Virulence\n\nneighbourhoods and from t = 1 to t = 27 with Moore Neighborhoods. Furthermore, the number of susceptible individuals decreases as the number of recovered individuals increases.\n\nOn the other hand, suppose that the population is not constant in all the cells according to N ij = e j . Note that in this case most of the population is concentrated in the eastern cells and it decreases uniformly to the western cells. Then the evolution of the CA with Moore neighborhoods is shown in Fig. 5 . In this case, note that the epidemic will rapidly propagate through the western cells and the maximum values of the states of the cells are obtained, precisely, in these western cells given by higher gray level colors. (2) In the second case we assume that there is not constant connections between each cell and its neighborhoods. Furthermore, for the sake of simplicity, we suppose that the cellular space is divided into four artificial areas with different connection factors as follows:\n\nArea I : Fig. 6 . Note that the epidemic disease does not spread through area C 3 as the connection factor is 0. Moreover, the greater speed of the spreading is obtained in area C 2 as the connection factor is equal to 1. In the other areas, C 1 and C 4 , the rate speed of the epidemic spreading is, obviously, slower.\n\nFinally, if the population depends on the cell considered (taking into account the formula stated above), the epidemic spreading is modeled as in Fig. 7 . Note that the infected population grows rapidly in the west of the cellular space.\n\nAlso, the effect of population vaccination can be considered in this model. In this case, a vaccination parameter, x 2 [0, 1], must be considered in the local transition functions of the model. Such parameter stands for the portion of susceptible infected individuals at each time step which are vaccinated. Consequently, we have: \n\nFinally, in Fig. 8 \n\nIn this work a theoretical model to simulate the spreading of an epidemic is introduced. It is based on the use of two-dimensional cellular automata endowed with a suitable local transition function. The population is divided into three classes: susceptible, infected and recovered individuals, consequently, the proposed model can be considered as a SIR-type model. Its main features are the following:\n\n\u2022 The total amount of population in the cellular space is constant. Nevertheless, it can not be uniformly distributed between the cells. \u2022 The local transition function is very simple and several epidemiological and environmental parameters are involved. \u2022 The vaccination effect is considered.\n\nThe main characteristic of this model is the definition of the state of each cell as a three-uplet formed by a suitable discretization portion of its population which is susceptible, infected and recovered at each time step, together with the definition of the local transition function involving these parameters.\n\nThe simulations obtained using artificially chosen parameters seem to be in agreement with the expected behaviour of a real epidemic.\n\nThe proposed model can serve as a basis for the development of another algorithms to simulate real epidemics. Consequently, further work aimed at testing its performance against real data. Obviously, in real simulations one has to take care with the scale and an appropriate size of the cells must be used in order to obtain an efficient simulation.\n\nUnfortunately, the proposed model presents some shortcomings, e.g.: small world effect (non local effect) which are crucial to model SARS, Foot and mouth disease and Aviation Flu, and seasonality effects which are crucial to model measles."}