{"title": "High-throughput interrogation of programmed ribosomal", "body": "and inhibits polyamine production (Matsufuji et al., 1995; Rom and Kahana, 1994) . This negative 48 feedback loop is used by virtually all organisms from yeast to humans to control polyamine levels 49 (Ivanov et al., 2000) , attesting to the evolutionary success of PRF as a regulatory mechanism. 50\n\nFameshifting is generally believed to happen at defined positions consisting of a slippery sequence 51 and a downstream roadblock, most commonly a stable secondary RNA structure like a pseudoknot 52 or an extensive stem-loop structure (Caliskan et al., 2015; Dinman, 2012) . Most presently known -1 53 slippery sites follow the pattern X XXY YYZ, with the shift happening from codons XXY and YYZ to 54 XXX and YYY. Some known slippery sites in -1 PRF show divergence from this pattern, e.g. in the 55 NSA2 gene of west nile virus with the slippery site sequence UCCUUUU (Firth and Atkins, 2009 ; 56 expression levels (by gating for a narrow range of mCherry fluorescence to minimize effects coming 96 from the influence of the variable region on overall expression levels, Methods). This percentage value 97 does not denote the precise rate of frameshifting events, but gives us a meaningful measure of 98 frameshifting efficiencies across PRF events. We thereby obtained measurements for 8972 (67%) 99\n\nand 5922 (44%) sequences cloned into the -1 PRF and +1 PRF reporter, respectively. 100 Mean and 95% CI of -1 (C) and +1 (D) PRF signal (% GFP fluorescence) for barcode control groups corresponding to the indicated wild-type PRF sequences (blue), carrying single nucleotide deletions (green) or having a stop codon inserted upstream of the frameshift sequence (red); n between 1 and 32; the shaded area denotes the range of background fluorescence; asterisks denote significant differences between the wild-type and the other groups (single nucleotide deletion and stop-control) combined (Mann-Whitney-U test). E. Comparison of -1 and +1 PRF reporter readout (% GFP fluorescence) for previously reported PRF sites (cf. Fig 1CD, Fig S3AC) .\n\nto detect splicing events and obtained an RNA readout (at least 100 reads mapped) for 10666 variants 115 (80% of the library, 94% of the variants with readout in the -1 frame and 96% of the variants with 116 readout in the +1 frame). Even without any filtering, only 2.95% of the variants showed gaps in the 117 mapping of at least 20 nt which could represent events of cryptic splicing (Fig S2EF; 0 .95% introducing 118 a shift to frame +1 and 0.64% to frame -1). Missing stretches can also come from synthesis or cloning 119 errors (and are therefore present and filtered out on the DNA level. Considering only those cases that 120 had a potential (degenerate, cryptic) donor or acceptor splice site in the area of the gap further 121 reduced the fraction of variants for which we cannot rule out a relevant splicing event to 36 (0.55%; 122 Fig S2EF, red; 0.22% introducing a shift to frame +1 and 0.14% to frame -1). Importantly, even for 123 these cases there was no correlation between the fraction of potentially spliced reads and GFP 124 expression (Pearson r=0.01, p=0.21 for -1 PRF and r=0.02, p=0.09 for +1 PRF), indicating that cryptic 125 splicing events do not constitute a common source for false positive signal in our assay. 126\n\nDuring oligonucleotide synthesis errors can occur that can introduce a point mutation or an 127 insertion/deletion. For assaying ribosomal frameshifting, especially the latter type would be 128 detrimental, and therefore we perform full-length DNA sequencing in our assay and consider only 129 reads that exhibit perfect alignment along the length of the variable region covered by sequencing 130 reads (approximately 20 nt in the center of the variable region cannot be covered due to the read 131 happens in only a few percent of translation events. This entails a higher detection limit of our assay 151 compared to for example Luciferase assays, which is a necessary compromise to enable high-152 throughput testing. 153\n\nBased on the distribution of GFP intensities of variants with a mutation leading to GFP being in frame 154 with mCherry ( Fig S2I) we also excluded variants exhibiting a dominant peak with mean GFP 155 fluorescence above 2 12 (25% of maximal GFP fluorescence). This value corresponds to the 5 th 156 percentile of the distribution of variants with a single nucleotide insertion (above threshold). We 157 thereby aim to rule out biases stemming from DNA frameshifts occurring as synthesis or cloning errors 158 that our mapping strategy might have missed (Methods). 159\n\nWe tested previously reported frameshifting sites (with or without experimental validation, PRF events tested in our assay typically gave a signal over threshold only in either the -1 or +1 PRF 171\n\nreporter, but not in both (Fig 1E) . In cases where the native sequence contained stop codons in any 172 signal) resembles the wild-type PRF efficiencies (Fig 1C) , with the most efficient sites (HERV-K10, 241 SARS and SRV1) showing the highest and broadest sensitivity to sequence alterations. 242\n\nComparing per position the median PRF signal for variants in which this position was changed reveals 243 a sensitivity profile around the PRF site ( Fig 2B, Fig S5C) , recapitulating these context specific 244 characteristics. Across all -1 PRF events tested positive in our assay, not only mutations at the 245 slippery site (marked in grey) and downstream of it, but also mutations immediately upstream of the 246 slippery site negatively affect PRF efficiency. Other -1 PRF events reported in the literature, but not 247 yielding a signal above background in our assay, tend to show substantially increased signal upon 248 A. Clustered heat map of median percent wild-type frameshifting of variants in which the indicated region (upstream, slippery site (including the preceding codon) and downstream) differs from the native one (n=37-325). B. The median percent wild-type PRF signal of variants in which the indicated position is changed is plotted for the entire length of the variable region; gray box: slippery site. C. Percent wild-type -1 PRF signal for variants with a point mutation only in the indicated position of the slippery site (n=6-22). D. Heatmap showing median percent GFP fluorescence conferred by replacing the native slippery site in -1 PRF sites tested positive in the assay (Fig 1C) with the indicated combination of slippery site elements. E. Distribution of percent wild-type GFP fluorescence of variants in which the slippery site was replaced by any possible combination of bases following the pattern XXXYYYZ (n=19-80). F. Distribution of normalized reads across GFP (+1 frame) expression bins for variants of the OAZ1 frameshifting site, in which either the first (right) or the second (left) codon is replaced; blue lines: wild-type; green and magenta lines: bin profile for the variant in which the native codon was replaced by the indicated one; grey lines: bin profiles for other codons at this position. G. Percent GFP fluorescence for variants in which the slippery site was replace with all possible combinations of the slippery site pattern found in west nile virus (XYYZZZZ) (n=16-56).\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint mutations in the areas upstream (PEG10) and downstream (PEG10, CCR5, Rous sarcoma virus) of 249 the slippery site ( Fig S5D) . Like the specific examples of frameshifting PEG10 variants described 250 above (Fig S4EF) , this points at a strong sensitivity of these PRF events to the context in which they 251 are tested. 252\n\nMost single point mutations within the slippery sequence abrogated frameshifting and resulted in 253 green fluorescence at background levels, both for -1 and +1 frameshifting sites (Fig 2C, Fig S5E) , 254 demonstrating that we indeed measure frameshifting at the expected site. Replacing the last position 255 in the canonical slippery site X XXY YYZ had -on average -a less severe effect on PRF efficiency, 256 due to the fact that it is the wobble position in the original frame and therefore has larger flexibility (Fig  257   2C ). In high efficiency PRF sites also this position showed strong and PRF site-specific preferences: 258\n\nIn the case of SRV1 (GGGAAAC) replacing the Z position with other options than the endogenous C 259 led to a drastic decrease (U, A) or complete loss (G) of -1 PRF signal (Fig S4E) , while in the case of 260 SARS (UUUAAAU) all other nucleotides apart from the endogenous U at the Z position almost 261 completely abolished the signal. To determine whether there is a universally optimal slippery site, we 262 replaced the slippery sequence in our set of -1 PRF events with all possible variations of the pattern 263 XXXYYYZ (Fig 2D, Fig S4F) . This revealed preferences for specific combinations common in known 264 PRF sites (Fig 2D) , like UUUUUUZ (HIV, SIVmac239) and XXXAAAC (HERV-K10, HTLV, PEG10, 265 SARS), but no universally optimal combination of bases that would lead to maximal frameshifting 266 efficiency and consequently GFP fluorescence across contexts ( Fig S5F) . Notably, PRF sites showed 267 a high degree of optimization when it comes to the identity of the bases, with any substitution (although 268 preserving the canonical XXXYYYZ pattern) typically leading to a more or less severe drop in PRF 269 signal ( Fig 2E, Fig S5EF) . 270\n\nReplacing the first or second codon of the OAZ slippery site (UCC UGA) revealed a very limited 271 tolerance to sequence alterations, consistent with earlier results (Matsufuji et al., 1995) . Replacing 272 the second codon (UGA), the only variants leading to a +1 PRF signal over background where the 273 other two stop codons (UAA and UAG; Fig 2F, In this context, however, several different nucleotide combinations following the respective pattern 286 were tolerated. The only exception to this rule was human T-lymphotropic virus (Fig 2G, endogenous  287 slippery site UUUAAAC), which gave a robust -1 PRF signal corresponding to wild-type levels across 288 many variants following the (west nile virus) pattern XYYZZZZ. In summary, our data suggest that in 289 most cases a slippery site not following the canonical pattern requires a specific sequence context in The region downstream of the slippery site is thought to be crucial for PRF, typically because it creates 295 a roadblock for the translating ribosome by folding into a stable secondary structure like a hairpin or 296 a pseudoknot (Brierley and Pennell, 2001; Brierley et al., 1989; Parkin et al., 1992; Tu et al., 1992) . 297\n\nTo get an estimate of the size of the relevant downstream region in different PRF events, we replaced 298 native regions with a constant sequence, leaving stretches of different length after the slippery site 299 unchanged (Fig 3A, top; Methods). While in the case of SARS almost the entire downstream region 300 included in our reporter construct (120 nt) was crucial for frameshifting, in the HIV and SIVmac239 301 PRF sites only a comparatively small region (<24 nt) was required to achieve PRF signal >50% of 302 wild type (Fig 3B) . The shortness of the necessary downstream sequence in these cases was striking, To identify specific positions crucial for PRF we performed scanning mutagenesis of regions ranging 307 from 7 to 36 nt downstream of the slippery site (Fig 3A, bottom) . This revealed large differences in 308 the fraction of relevant downstream positions (Fig 3C) , ranging from 6% of single point mutations 309 reducing -1 PRF efficiency by more than half in the case of SIVmac239 to 53% in the case of SARS 310 (46% for +1 PRF at the OAZ1 site). The HIV gag-pol PRF site (among others) shows remarkable 311 resilience to point mutations ( Fig 3C, Fig S6A) suggesting that a reduced stem is still able to drive PRF at wild-type levels, and only forcing a 316 complete change in the structure affects frameshifting. 317 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint Figure 3 . Downstream RNA structure affects PRF efficiency in a context-dependent manner. A. Schematic of downstream sequence manipulations. B. Percent wild-type frameshifting rates of variants in which the native downstream region has been replaced by constant sequences, leaving the indicated number of nucleotides after the slippery site unchanged; n=1-3 per data point. C. Fraction of point mutations in the 40 nt downstream of the slippery site resulting in <50% of wild-type GFP fluorescence (green) and background fluorescence (<1.3% GFP fluorescence, blue), for -1 (top) and +1 (bottom) PRF events. D. The difference in mean % wild-type frameshifting between variants in which the indicated position is predicted to be paired vs unpaired along the variable region; gray box: slippery site. E. Schematic of downstream structure variations. F. Percent -1 GFP fluorescence of variants in which the downstream region is replaced by a synthetic sequence predicted to fold into the respective native secondary structure (using Vienna RNA (only stem-loop; light blue) or pKiss (including pseudoknots; dark blue; Methods)); the shaded area denotes the range of background fluorescence. G. % -1 GFP fluorescence of variants in which the downstream region is replaced by a synthetic sequence predicted to fold into the HIV (blue) or SRV1 (green) secondary structure (or variations thereof; Methods); the shaded area denotes the range of background fluorescence. H. % GFP fluorescence of variants in which the downstream region carried a single point mutation (left) or was replaced with sequences predicted to fold into variations of PRF inducing structures, plotted against the corresponding wild-type values; p-values (Mann-Whitney-U) for comparisons between groups of low (<4% GFP fluorescence) and high wild-type PRF (>4% GFP fluorescence). IJ. Clustered heatmap of Pearson correlation coefficients between percent -1 GFP fluorescence and minimum free energy of regions after the slippery site (computed using Vienna RNAfold on the 40 nt following the slippery site (I) or pKiss on the 120 nt following the slippery site (J)) for groups of variants of the indicated PRF sites; values denote the p-values of the correlations. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint the entire library and compared the median PRF signal between all variants of a PRF event, in which 320 this position is predicted to be paired or unpaired (Fig 3D) . Preferences for downstream positions to 321 be paired or unpaired reveal the architecture of structural elements downstream of the PRF site.\n\nReplacing the endogenous downstream region with elements that have different primary sequence, 326 but are predicted to fold into the same secondary structure (Fig 3E, top) abolished frameshifting in 327 most cases, regardless of whether pseudoknots were included or not (Vienna RNA vs. pKiss to 328 determine the structure that served as the input for antaRNA (Kleinkauf et al., 2015a (Kleinkauf et al., , 2015b ; Fig 3F) . including ones where the wild-type sequence did not yield a frameshifting signal in the context of our 332 assay (CCR5 and PEG10). Strikingly, events associated with higher wild-type frameshifting rates 333 could not be \"rescued\" by introducing a secondary structure variant from a different PRF event (Fig  334   3H ), indicating that more efficient frameshifting sites like SARS seem to be highly optimized, but less 335 tolerant to changes in the type of downstream secondary structure. We therefore repeated the analyses using pKiss (Janssen and Giegerich, 2015) , an algorithm that 350\n\ncan detect certain classes of pseudoknots (see Supplementary Data 2 for pKiss-predicted structures 351 of library variants with systematic sequence changes in the downstream region). MFE calculated 352\n\nusing Vienna RNAfold and pKiss, respectively, show good correlation ( Fig S6B) . We repeated the 353 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint above analysis and observed the same pattern as with RNAfold, namely widespread association 354 between secondary structure (low MFE) and higher PRF signal for small deviations from the native 355 sequence ( between PRF events whose downstream sequence was shown to fold into a hairpin structure (e.g. While mutations in the slippery site and the downstream region typically have a negative effect on 387 -1 PRF signal (e.g. PEG10, Fig S5D) . This suggests that inhibitory signals upstream of the 389 frameshifting site as found for SARS (Su et al., 2005) could be a more widespread property of PRF 390 sites, probably creating a balance to ensure that frameshift promoting signals like a rigid downstream 391 A. Schematic of sequence manipulations upstream and immediately downstream of the slippery site. B. Boxplots of % wild-type frameshifting rates for variants of \"positive\" -1 PRF sites in which the indicated number of nucleotides were deleted (negative numbers) or inserted (positive numbers, taken from two different constant sequences) after the slippery site (n=4-54). C. % GFP fluorescence for variants of \"negative\" -1 PRF sites with the sequence upstream of the slippery site being randomly recoded or replaced with sequences predicted to have the indicated secondary structure; the shaded area denotes the range of background fluorescence. D. % wild-type frameshifting rates (+1 for OAZ, blue, and -1 for HIV, green) of variants in which the native upstream region has been replaced by constant sequences up to the indicated position relative to the PRF site. E. Boxplot of percent of wild-type frameshifting rates for variants in which the -2 or -1 amino acid relative to the slippery site is replaced with an amino acid from the indicated groups, for codons which maintain the slippery site pattern XXXYYYZ (bottom) or not (top); n=10-115. F. Pearson correlation coefficient (blue) and associated p-values (green) between tAI at the indicated position of the original reading frame and % GFP fluorescence. G. Clustered heat map showing all possible combinations of 3 synthetic slippery sites, 34 synthetic downstream variants and up to 5 synthetic upstream regions (minimal value 1.3%). We expanded our search for properties affecting PRF efficiency and examined the effect of the codons 409 preceding the slippery site. We found that the presence of a charged amino acid immediately 410 upstream of the slippery site significantly reduced frameshifting signal, even when the sequence of 411 the slippery site was unchanged (Fig 4E, p<0 .0015, Wilcoxon signed-rank test). We examined also 412 the influence of decoding efficiency as measured by the tRNA adaptation index (tAI) on PRF and 413 detected an increasingly negative correlation between tAI and PRF signal in the 0 frame codons 414 leading up to the site of ribosome slippage (Fig 4F) . This observation might indicate that progressive 415 slowing down of the ribosome by limited tRNA availability might contribute to stalling at the slippery 416 site and frameshifting. 417\n\nTo not limit our analysis to endogenous frameshifting events, we designed completely synthetic 418 regions corresponding to a slippery site and the upstream and downstream region with different 419 sequence and structural properties. Some fully designed sequences were able to trigger frameshifting 420 and resulted in a -1 PRF signal of up to 11% GFP fluorescence, approximately corresponding to the 421 wild-type frameshifting rate of the most efficient event tested here (SARS coronavirus). We tested all 422 different downstream regions with synthetic slippery sequences resembling common types of -1 PRF 423 sites and found pronounced differences in combinatorial preferences (Fig 4G) , showing that also fully 424 synthetic frameshifting events exhibit the combinatorial preferences and context-dependent 425 peculiarities observed for native PRF events. whether they yielded a detectable frameshifting signal in our assay or not (Fig 5BC, Fig S10A; \"-1 446 PRF events\" vs. \"all library variants\"). 447\n\nTo determine to what extent a model trained on one PRF event could predict frameshifting potential 448 and -1 PRF signal in a different context, we trained our model (based on the full set of features) on 449 sequence variants derived from one event and predicted on variants of another event (Fig 5F, Fig  450   S10B ). While performance is usually best for variants of the same PRF event, this approach revealed 451 functional similarities that allowed relatively accurate prediction on \"foreign\" PRF events (ROC AUC 452 up to 0.94, Pearson r up to 0.69). There is considerable overlap with other attempts of functional 453 clustering, e.g. based on sensitivities to mutations (Fig 2A) , with SRV1 and HERV-K10 PRF sites 454\n\nshowing similar behavior and HIV variants yielding good prediction scores for models trained on data 455 from any retroviral PRF event (HIV, SIVmac239 and SRV1; Fig 5F) . The SARS PRF event, however, 456\n\nis not amenable to prediction based on models trained on data from other PRF events. Prediction 457 accuracy also reflects the specific components of particular importance for a PRF event, e.g. the 458 slippery site for HIV ( Fig S10C) and the downstream region for SRV1 (Fig S10D) . In these cases, 459\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint frameshifting efficiency can be predicted using models trained on data from almost any other PRF 460\n\nInterpretation of the prediction models provides an additional approach to identify the most important 462\n\nproperties of a (potential) PRF site. Here, we used Shapely (SHAP) values for determining the 463 contribution of each feature to the prediction result of every sample (Fig S11A; Lundberg et al., 2020) . 464\n\nThe features of the different subsets driving the prediction provide additional information about the 465 The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint effect of specific sequence properties on the readout (Fig S11A) , e.g. recapitulating earlier 466 observations that XXXCCCZ (\"Y=C\") and XXXGGGZ (\"Y=G\") slippery sites are disfavored (Fig S11A  467 upper left, cf. Fig 2D) . For a model trained on the MFE of different lengths of downstream region, 468 stronger secondary structure not always led to prediction of higher PRF efficiency (Fig S11A lower  469 left). When taking into account regions of e.g. 60 nt after the slippery site (\"dg60\"), a lower feature 470 value favored prediction of PRF (Fig S11B) .). While the positive effect of strong secondary structure 471 (low MFE) in the first 60 nt on PRF prediction was strongly enhanced if also the downstream region 472 as a whole showed low MFE (Fig S11B) , in general we find strong secondary structure of the entire 473 downstream region (120 nt) to be associated with prediction of no PRF (Fig S11A) . This could either 474 be explained through an effect on frameshifting efficiency or on RNA stability and overall expression 475 levels. The latter option is unlikely to explain the effect in full as we do not observe a correlation 476 between MFE of the downstream region and steady-state RNA levels ( Fig S11C) . the frameshifting site, but not in the slippery site itself (Fig S12A) . Frameshifting rates of the variants 486 are distributed around the rate observed for the lab strain HXB2 (Fig 6A) . This constitutes actual 487 differences in frameshifting rates and not only experimental variability, as isolated clones show 488 remarkably good correlation given the small differences in PRF signal we are measuring (Fig 6B) . 489\n\nSecondary structure showed the best correlation with frameshifting rates when considering the first 490 30 nucleotides after the frameshifting site (Fig S12B) , matching the region of high sequence 491 conservation (Fig S12A) . We grouped the HIV variants based on subtype and found significant 492 differences between the groups (Fig 6C, p<8 *10 -11 , one-way ANOVA), most notably higher 493 frameshifting rates in subtype C (p<6*10 -12 for the difference between C and B), in contrast to an 494 earlier report (Baril et al., 2003) . HIV subtypes show distinct geographical distributions (Hemelaar et 495 al., 2006) , and consequently we also observed differences between countries of origin (Fig S12C,  496 p<2*10 -4 ), but no change in frameshifting rates over time (Fig S12D, p=0.4) . 497\n\nOptimal gag-pol frameshifting rates have been proposed to be critical for virulence (Dinman and 498 Wickner, 1992; Felsenstein and Goff, 1988) . In order to link the frameshifting rate measured in our 499\n\nreporter assay with the replicative success of the corresponding HIV isolate we compared the viral 500 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint load in patients (where available) to frameshifting rates of the causal HIV isolate (Fig 6D) . Although 501 viral load is influenced by many factors, we nevertheless observed a clear trend for patients with high 502 viral load to have frameshifting rates close to \"wild type\" (the lab strain HXB2). These data present 503 optimality of frameshifting rates as a hallmark of HIV infection and as being associated with infectious 504 success, underscoring the potential for drugs altering the efficiency of gag-pol frameshifting. 505\n\nIn order to predict frameshifting efficiency of naturally occurring variants of the HIV gag-pol 506 frameshifting site, we built a model based on the feature sets described above. Despite eliminating 507 the most important feature of the HIV gag-pol PRF site (the slippery sequence) by restricting our 508 analysis to clinical isolates with no sequence alterations in and around the canonical UUUUUUA and 509 despite the narrow range of frameshifting rates (Fig 6A) , we could accurately predict frameshifting 510 rates of unseen variants (Pearson r=0.6; Fig 6E, left) . Interestingly, removing the features based on 511 pairedness of downstream positions and minimum free energy led to similar agreement between 512 measured and predicted values (Fig 6E, right) . This is in line with the limited importance of the exact 513 downstream structure in comparison to other PRF events tested. Including designed HIV variants in 514 the training set yielded similar prediction accuracy (Fig S12E) , indicating that our model can learn the 515 The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint relevant rules from our set of natural variants alone. Taken together, these results show that a model 516 based on data from our assay is sensitive enough to detect even subtle differences between HIV 517 variants and allows prediction of frameshifting rates with an accuracy of clinical relevance. approach entails particular limitations. While we show that our assay is highly sensitive to changes in 527 the PRF signal (e.g. in the testing of natural isolates of HIV) and therefore able to identify even subtle 528 effects of sequence alterations on frameshifting, our detection limit is higher than in assays using 529 amplification methods and/or overexpression of the reporter. 530\n\nPrediction of PRF events has up to now been largely limited to identifying sequences matching the 531 canonical pattern for slippery sites, followed by a downstream secondary structure (Belew et al., 2008; 532 Theis et al., 2008) . To the best of our knowledge, no attempts at quantitatively predicting the effect of 533 sequence variation exist to date. We used our measurements of frameshifting signal of thousands of 534 variants of known PRF sites to build a computational model based on known and novel sequence 535 features affecting frameshifting, leading to accurate prediction of frameshifting potential (up to ROC 536 AUC=0.93) and frameshifting rates (up to Pearson r=0.81). In many cases sequence properties other 537 than slippery site identity or downstream secondary structure rigidity yielded high prediction scores, 538 emphasizing the importance to include additional features such as amino acid properties and tRNA 539 availability in the investigation of PRF regulation. 540\n\nBy controlled sequence and structure manipulations in multiple contexts we aimed to dissect and 541 directly compare the regulatory architecture of 15 frameshifting events, revealing a great diversity in 542 regulatory strategies involving upstream and downstream sequence and structural elements and 543 amino acid properties. We demonstrate a high degree of optimization and specialization of regulatory 544 mechanisms. For example, no universally optimal slippery site exists, but in each of the PRF events 545 tested the native slippery site was found to be optimal given the sequence context. In addition, our analyses highlighted amino acid properties around the frameshifting sites as another 570 factor influencing PRF efficiency. Specifically, a charged amino acid at the last position before the 571 slippery site was associated with reduced frameshifting rate. Together with reports of a frameshift-572 promoting effect of specific amino-acid sequences upstream of the frameshifting site in the case of 573 +1 PRF in fungal OAZ genes (Yordanova et al., 2015) and the copA gene of Escherichia coli (Meydan 574 et al., 2017) , this observation provides additional evidence for a role of the nascent peptide in 575 regulating ribosomal frameshifting. 576\n\nIn general, our results reveal functional groups of PRF events that exhibit greater similarity in terms 577 of their sensitivities to mutations in regulatory regions and congruence in the preferences for 578 secondary structure. These functional groups also manifest themselves in a higher prediction 579 accuracy within these groups. The groups resemble similarities also according to other criteria, e.g. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint higher fluorescence signal in our assay (Fig 1C) , but greater sensitivities to even small sequence 586 changes (Fig 2B, 3C, S4AB, S5A ) and requirements for a more extensive downstream region. This 587 might also entail a greater sensitivity to the experimental context and therefore explain the lack of 588 signal (above the noise threshold) for previously reported cases depending on a pseudoknot as 589 frameshift stimulatory signal like Rous sarcoma virus (Jacks and Varmus, 1985; Marczinke et al., 590 1998) . In other cases, low wild-type rates of frameshifting, requirements for additional trans-acting 591 factors or an effect on overall expression levels might explain the lack of signal in our assay. 592\n\nComparing the HIV gag-pol site with other PRF events shows the remarkable robustness and 593 exceptional tolerance for various non-native downstream stimulatory signals. More than in other 594 cases, maintaining the wild-type slippery site UUUUUUA is crucial for frameshifting, and tends to be 595 absolutely invariable across otherwise diverse natural isolates (Biswas et al., 2004) . The quantitative 596 nature of our assay allows us nevertheless to accurately quantify the effect of sequence variation 597 away from the slippery site, revealing sub-type specific differences. Furthermore, we devised a 598 machine learning model that is able to predict the natural variation in HIV frameshifting rates for novel 599 variants (Pearson r=0.60). Precise stoichiometry of frameshifted and non-frameshifted product is 600 crucial for HIV virulence, and the ability to predict frameshifting rates of naturally occurring variants of 601 (which also predicts pseudoknots) to determine the native secondary structure of each of the 15 PRF 671 events. We then created for each PRF event two sets of ten sequences each (using antaRNA) that 672 are predicted to fold into the downstream secondary structure as determined using ViennaRNA and 673 pKiss, respectively. Furthermore we designed variants of the predicted HIV, SRV1 and nsp2F 674 (PRRSV) downstream secondary structure, e.g. by extending or reducing the length of hairpins, and 675 completely synthetic secondary structures and again used antaRNA to create sets of corresponding 676 sequences that we used to replace the native downstream structure in all 15 PRF events. The parameters for the first PCR were 95 o C for 5 min, 18 cycles of 94 o C for 30s, 65 o C for 30s, and 802 72 o C for 60s, each, and one cycle of 72 o C for 5min. In the second PCR step, each reaction contained 803 2.5 \u03bcl of the first PCR product, 25 \u03bcl of Kapa Hifi ready mix X2 (KAPA Biosystems), 2.5 \u03bcl 10 \u03bcM 5\u2032 804 primer, and 2.5 \u03bcl 10 \u03bcM 3\u2032 primer. The PCR program was 95 o C for 5 min, 24 cycles of 94 o C for 30s 805 and 72 o C for 30s, each, and one cycle of 72 o C for 5min. Specific primers corresponding to the constant 806 region of the plasmid were used. The 5\u2032 primer contained a unique upstream 8-nt bin barcode 807 sequence, and three different barcodes were used for each bin. The 3\u2032 primer was common to all bins. 808\n\nMultiple PCR reaction products of each bin were combined. The concentration of the PCR samples 809 was measured using a monochromator (Tecan i-control), and the samples were mixed in ratios 810 corresponding to their ratio in the population, as defined when sorting the cells into the 16 bins. 811\n\nSample preparation including gel elution and purification were performed as described above for 812 amplicons from cDNA. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint PCR reactions of 50 ul total volume were performed. Each reaction contained 5 ul cDNA, 25 \u03bcl of 822\n\nKapa Hifi ready mix X2 (KAPA Biosystems), 2.5 \u03bcl 10 \u03bcM 5\u2032 primer, and 2.5 \u03bcl 10 \u03bcM 3\u2032 primer. The 823 PCR program was 95\u2022C for 5 min, 20 cycles of 94\u2022C for 30s and 72\u2022C for 30s, each, and one cycle 824\n\nof 72\u2022C for 5min. Specific primers corresponding to the constant region upstream and downstream of 825 the splice sites were used. The PCR products were separated from potential unspecific fragments by 826 electrophoresis on a 1.5% agarose gel stained with EtBr, cut from the gel, and cleaned in 2 steps: gel 827 extraction kit (Qiagen) and SPRI beads (Agencourt AMPure XP). The sample was assessed for size 828 and purity at the Tapestation, using high sensitivity D1K screenTape (Agilent Technologies, Santa 829 Clara, California). We used 20 ng library DNA for library preparation for NGS; specific Illumina 830 adaptors were added, and DNA was amplified using 14 amplification cycles. The sample was 831 reanalyzed using Tapestation. 832\n\nFor RT-PCR analysis we performed RNA purification on 5 million cells from individually constructed 833 and integrated reporter constructs, followed by cDNA synthesis as described above (one reaction). 834 PCR was performed using primers within the mCherry and GFP coding region, yielding a PCR product 835 of about 1000 bp length. 40 cycles of PCR were used to obtain a strong signal even for less prominent 836 bands. PCR products were analyzed on a 1% agarose gel. 837 838\n\nMapping next generation sequencing reads 840\n\nTo unambiguously identify the variant of origin, a unique 12-mer barcode sequence was placed at the 841 5' end of each variable region. DNA was sequenced on a NextSeq-500 sequencer. We determined 842 for each read (PE150) its bin barcode and its variant barcode and discarded all the reads that could 843 not be assigned to a bin and a library variant of origin. In a second step, for each variant the mapped 844 reads (paired-end, 150 bases for each mate) were aligned to the designed sequence (in the context 845 of the reporter) and only those ones were counted that mapped without a mismatch over the whole 846 length (disregarding the last 5 bases). Reads showing a mismatch, in particular a single nucleotide 847 deletion or insertion, were quantified separately and if they passed the same threshold applied to 848 correct library variants a PRF readout (% GFP fluorescence) was calculated for them. These 849 We applied a number of filters to the raw sequencing data to reduce experimental noise. First, variants 859 with less than 20 reads (perfect matches along the whole length) mapped across bins were removed. 860\n\nSecond, for bins with a read count of less than three, the bin value was set to zero. Third, for each 861 variant we set to zero bins surrounded by zero values as these constituted isolated bins unlikely to 862 come from the actual distribution. Forth, to reduce bias coming from the \"open end\"-bins at the 863 extreme values, we set their count to match their neighbor's if it was higher, as these bins are defined 864 as containing the tails of the distribution of variants with no GFP fluorescence and maximal GFP 865 expression, respectively, and peaks in these extreme bins are considered experimental noise. For 866 each variant, we normalized the values across the 16 bins by dividing the filtered read counts for each 867 bin by the sum of all filtered read counts. To determine whether a distribution is unimodal we applied 868 a Savitzky-Golay filter for smoothing the data and removing local maxima introduced by experimental 869 noise. We detected peaks in the smoothed distribution by a simple approach in which a point is 870 considered a maximum peak if it has the maximal value, and was preceded by a value lower by 5%. 871\n\nVariants without detectable peaks (due to the read number not reaching the threshold) were excluded 872 at this stage. Variants with more than one peak were filtered out at the level of analysis. For each bin, 873\n\nwe calculated the median of the log2 of GFP fluorescence intensity as measured by FACS for all the 874 cells sorted into that bin and used this as the GFP fluorescence value associated with this bin. For 875 each variant with one peak after smoothing, we calculated the weighted average for the distribution 876 of reads across bins (using unsmoothed read counts normalized for each variant and the GFP 877 fluorescence value for the bins, as described above), resulting in what is referred to in the main text 878 and figures as the \"GFP fluorescence\" (in log2). 879\n\nAs described in the main text and illustrated in Figure S2A The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint filtering, a single variant was randomly chosen for all subsequent steps to avoid biases resulting from 896 having duplicated sequences. We created sets of variants corresponding either to the full rationally 897 designed library (\"full library\"), the -1 PRF sites from the main set of events tested positive in our 898 assay combined (\"frameshifting events\") or to all variants based on one of these PRF events in 899 isolation. 10% of the variants in the individual sets (20% in case of the HIV variants) were put aside 900 and used only for evaluation of models built using the other 90% (80%). We chose Gradient Boosting 901 For predictions based on amino acid identity, information on the type of amino acids around the 915 slippery site (from position -3 relative to the site of frameshifting until the end of the slippery site) was 916 used (\"unpolar\", \"polar\" or \"charged\"). 917 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint systematic and combinatorial fashion using 10-fold cross-validation for each set of variants and 919 features independently. Typically around 100 tests were performed and the best set of 920 hyperparameters used for subsequent steps. The code used to process the data, generate the figures and train and test the predictive models will 943 be made available as a GitHub repository (https://github.com/martinmikl/). The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint Supervision: Y.P. and E.S. 958\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/469692 doi: bioRxiv preprint"}