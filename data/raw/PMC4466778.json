{"title": "Integrated travel network model for studying epidemics: Interplay between journeys and epidemic", "body": "Our integrated travel network (ITN) model accounts for different means of transportation by different kinds of links. Figure 1(a) shows schematically an inter-city transportation network emphasizing its link inhomogeneity: Links of faster transportation (dashed lines), e.g. airlines and high-speed trains, connecting major cities and links of slower transportation (solid lines), e.g. highways, connecting to surrounding cities (blue nodes) via part of a highway network.\n\nA journey starts from a city i to an intended destination j through intermediate places along the path that takes the shortest time, which necessarily invoke the actual distance between two cities and the mode of transportation. The return journey could follow the same path or an alternative path, as depicted in Fig. 2(a,b). The ITN aims to incorporate the key features of how human travel, namely round-trip journeys of shortest time through multiple means of transportation. Here, we invoke the travel time, which depends on the distance and the means of transportation, as the key factor, instead of the effective distance43. Instead of emphasizing the multi-layered network structure as in previous works, ITN takes a traveller\u2019s viewpoint that journeys take place in a single-layered undetachable network with a diversity of links connecting cities representing an inhomogeneous transportation network, see Methods for details. It aims to provide a step closer to a realistic description of human journeys and an alternative platform for studying epidemics on which finer and further details on local area transportation could be added.\n\nContacts during journeys are important for epidemics. An example is the 2009 H1N1 cases in a Singapore\u2019s hospital that 116 of 152 patients in two months were classified as air travel-associated imported cases46. The time that travellers meet becomes a crucial factor. It is related to the length of a link and how fast agents travel on it. As a minimum model, we consider two speeds vs and vf with vs < vf (see solid and dashed lines in Fig. 1) representing slower and faster transportation. An agent starts a round-trip journey from a node (home) to a destination chosen randomly (upper Fig. 3) through intermediate (middle) nodes along the path of shortest travel time18. Let rij be the distance between neighbouring nodes i and j. The time travelling on the link is\n\n\n\nwith v = vs or vf depending on the type of transportation. To account for travel time, a link from node i to node j is divided into \u03c4ij segments, with \u03c4ij = tij if mod(rij,v) = 0 and \u03c4ij = int(tij) + 1 if mod(rij,v) \u2260 0 (lower Fig. 3), where mod(x,y) represents the modulo operation and int(x) taking the integral part of x.\n\nFor epidemic on ITN, we invoke the susceptible-infected-susceptible (SIS) model691011121314151617. A susceptible agent will be infected if it contacts an infected agent, with an infectious rate \u03b2. There are travelling and non-travelling agents in a population. Generally, people travelling are in closer contact and have a higher infectious rate \u03b22 than the non-travelling agents with \u03b2147. An infected agent recovers and becomes susceptible with a recovery rate \u03bc. For travelling agents, we assume that infections take place only among agents in the same segment kr (1 \u2264 kr \u2264 \u03c4ij) of a link. For non-travelling agents, the SIS process is confined to non-travelling agents at the same node. Explicitly, a non-travelling susceptible agent at node i has a probability 1\u2212(1\u2212\u03b21)ni,I to be infected at a time step, when there are ni,I infected non-travelling agents at the node. Similarly, a susceptible agent at a segment of a link has a probability  to be infected when there are  infected agents at that section kr.\n\nBuses on highways and high-speed trains in China together provide an example of ITN. To include a large population and to reduce the number of nodes, we consider 116 cities with population over one million (see Table S1 in Supplementary Information (SI)). From high-speed train schedule, 61 cities are served by routes of high-speed trains. For the remaining 55 cities, we construct the highway links as follows. A highway link is added between two cities in the same province or two neighbouring provinces when there is a highway between them. Finally, highway links are added to connect neighboring highway and high-speed railway nodes in the same province. Figure 4 shows the resulting ITN of 116 cities with two types of links. We give the structural properties in SI. It has a mean degree \u2329k\u232a = 4.25 and a high clustering coefficient of C = 0.35. The degree distribution is shown in Fig. S1(a) in SI. Table S2 in SI gives the lengths of the links.\n\nTypically, travels between major cities and/or nearby cities are more frequent. This was modelled by assigning weights  to a link, where Ni denotes the population at node i and rij the distance between nodes i and j4849. To incorporate factors including transportation infrastructure and convenience, we modified the weight in ITN to\n\n\n\nwhere Sij represents the daily services of high-speed trains between nodes i and j and thus an indication of how convenient it is, and Sij = 0 for highway links. Values of Sij as obtained by train schedules are listed in Table S2 in SI. Summing Wij for the ki links give the weight Wi of node i as\n\n\n\nTo set up a model for simulations, we measure population in units of 5000 and distance rij in kilometers. Thus cities of Ni \u2265 200 are considered and Ni is  of the real population. The corresponding weight distribution is shown in Fig. S1(b) in SI. Sensitivity to the choice of measuring populations in lots of 5000 is tested in Fig. S2 in SI. In each time step,  agents starts a round-trip journey from node i, where the parameter pT is chosen so that , i.e., people travelling are fewer than a city\u2019s residents. It is related to the small fraction f of the total population  starting a journey every time step by\n\n\n\nAn agent from node i picks a destination j according to the probability\n\n\n\nand follows the path of shortest travel time. An agent typically travels on slower transportation in the local area before transferring to high-speed train followed by local transportation to the destination. ITN captures the inhomogeneous means of travelling better than multi-layered networks. An agent spends some time at the destination before the return trip begins, which is taken to be 5 time steps corresponding to 5 hours5051. Returning to home city, an agent becomes a non-traveller until the next journey. Figure 3 shows a schematic journey. The travelling dynamics leads to a steady state in which  residents among  are non-travellers at node i. The number of all non-travellers  depends on f (see Fig. S2 in SI) linearly for f \u2264 0.01. We thus take f = 0.01. The values of ni and  for the 116 cities are shown in Fig. S3 in SI.\n\nLet vs = 100 (km/h) be the highway traffic speed and vf > vs be speed of high-speed train. The speeds and rij determine the time \u03c4ij of each link. After the travelling population reaches the steady state, the SIS process is initialized by assigning  agents randomly as infected at t = 0. Practically, uniformly distributed initial infection speeds up the approach to the steady state. The recovery rate is fixed at \u03bc = 0.1. Let \u03c1I be the fraction of infected agents. Figure 5(a) shows \u03c1I(t) for \u03b21 = 2 \u00d7 10\u22125 and \u03b22 = 0.004, for two values of vf = 250 and 500. An epidemic steady state is reached quickly. As a higher  shortens the time on the links that the infection rate is higher, \u03c1I is smaller for higher vf. Figure 5(b) shows the steady state \u03c1I for \u03b21 = \u03b22. There exists a threshold \u03b21c \u2248 4 \u00d7 10\u22125 above which \u03c1I \u2260 0.\n\nAs \u03b22 > \u03b21 generally, Fig. 5(c) shows \u03c1I (\u03b22) after setting \u03b21 = 2 \u00d7 10\u22125 < \u03b21c, for two values of vf. Figure 5(d) shows \u03c1I(\u03b22) for three different values of \u03b21 < \u03b21c. It is found that \u03b22c remains unchanged for different \u03b21 < \u03b21c. It is reasonable in that when the outbreaks come from infections in journeys, the infection rate \u03b21 of non-travellers is irrelevant to the threshold \u03b22c. However, for \u03b22 > \u03b22c, a higher \u03b21 leads to a higher \u03c1I.\n\nNext, we set \u03b21 = 10\u22124 > \u03b21c and Fig. 6(a) shows that \u03c1I(\u03b22) increases monotonically with \u03b22, for vf = 250 and 500. Here, \u03c1I \u2260 0 for all \u03b22. There exists a value \u03b22c\u2032 (\u03b22c\u2032 = 0.0025 for the case in Fig. 6(a) below (above) which \u03c1I for vf = 250 is lower (higher) than that for vf = 500.\n\nTo summarize the findings in a physical picture, for \u03b22  < \u03b22c\u2032, infections among non-travellers at the nodes dominate the epidemic process. A higher vf (e.g. vf = 500) reduces the time that agents spent on journeys and thus promotes infection. For \u03b22  > \u03b22c\u2032, infections among travellers on journeys dominate the epidemic process. A higher vf shortens the journey and suppresses infection.\n\nFor \u03b21 = 2 \u00d7 10\u22125 < \u03b21c and \u03b22 = 0.006 > \u03b22c, infections during journeys dominate. Figure 6(b) shows that \u03c1I increases monotonically with the fraction of travellers f, with \u03c1I for vf = 500 smaller than that for vf = 250 due to the shorter journey time.\n\nWe stressed the necessity of establishing a new framework for modelling journeys in modern times and their effects on epidemics. We illustrated the key ideas by presenting an integrated travel network constructed by considering geographic data, population data and transportation infrastructures in China. An example using only the high-speed trains and highways among the 116 cities of over a million population suffices for stressing the points. An ITN should include: (i) diversity among the links due to different distances and different speeds of transportation; (ii) diversity among the cities due to different population sizes, and transportation services often reflecting their economic growth; (iii) round-trip journeys to targeted destination via paths of shortest time; and (iv) different infection rates for travellers and non-travellers. The ITN can readily be extended to include details on local area transportation, multiple means of transportation, and journeys among different countries. For example, Fig. 1(b) shows schematically a local transportation network with stations (nodes) served by a subway network (dashed lines) and a bus network (solid lines). A journey includes generally travelling in both Fig. 1(a,b). Effects such as traffic congestion naturally emerge. As far as epidemics are concerned, faster and more convenient inter-city journeys would reduce the travel time during which passengers are crowded and thus suppress the chance of being infected, but they would also induce people to make more journeys and to farther places and thus spread a diseases more readily. Our ITN would serve as a good starting point for exploring the interplay of travelling and infection dynamics for many further work.\n\nHighway buses and high-speed trains are the major means of transportation in China. After constructing ITN (see Fig. 4) based on high-speed trains and highways data, the number of links ki is recorded for each node and the degree distribution P(k) is obtained (Fig. S1(a) in SI). The average degree  and the clustering coefficient  are calculated, where Ei is the number of links connecting the ki neighbors of node i52.\n\nFor the weights in Eq. (2), we record the actual populations in each node and reduce them to Ni in units of 5000 and the distances rij between pairs of nodes in km according to the China official website. The frequency of high-speed trains Sij is obtained based on the routes and schedules of all high-speed trains. For each route that originates from a city A and terminates at a city B, we record the cities, say A, C1, C2, C3, B, served along the route and the number of services ms per day. Then, all Sij, i.e. SA,C1, SC1,C2, CC2,C3, and SC3, B, are augmented by ms. Data for all routes give the final Sij that go into Eq. (2) for the weights of the links Wij and Eq. (3) for the weights of the nodes Wi (see Table S1 in SI).\n\nFor a journey that starts from the home city, the path of the shortest travel time to the destination is chosen. For a single type of links, i.e., vs = vf, the path of shortest travel time coincides with the shortest path. In ITN with vs < vf, the shortest paths are generally different from the paths of shortest time. As vf > vs, selected paths will involve railways as much as possible. It is convenient to discretize the journeys. The distance rij between two neighboring nodes i and j are divided into \u03c4ij time steps. At each time step,  agents at node i become travellers. The destinations are chosen according to Eq. (5). The journeys are carried out as follows:\n\nFor every path between the home city i and destination j, the sum of \u03c4ij along the path is obtained. The path of shortest time is the one with the smallest sum.Paths originated from different cities to different destinations may partially overlap. Therefore, in the intermediate nodes (cities) in a journey, some travellers may come in and other travellers may leave.Upon arrival at the destination, an agent stays 5 time steps before the return journey begins.\n\nInitially, the segments 1 \u2264 kr \u2264 \u03c4ij on the links are empty and they will be occupied only when agents travel. For a node i, there are  new travellers starting their journeys in the steady state, making a total  new travellers. Each of them has the chance  of choosing node i as the destination, giving a total  agents arriving per time step in the steady state.\n\nIn the SIS dynamics, we distinguish infections among non-travellers in the cities and among travellers in the same segment of a link with infectious rates \u03b21 and \u03b22, respectively. As travellers on trains/buses are densely packed, \u03b22 > \u03b2147. An agent is a traveller and non-traveller at different times. When he is a non-traveller in a city, he is exposed to an infectious rate of \u03b21. Once he is on a journey, he is exposed to an infectious rate of \u03b22 during each segment of his journey, regardless of the segment being in the middle of a link or a passing-by city. Only travelling agents in the same segment kr (1 \u2264 kr \u2264 \u03c4ij) towards the same direction can infect each other. Thus, SIS on ITN accounts for the continual exchanges of agents on trains and buses due to partial overlaps of agents\u2019 journeys and the spread of a diseases through journeys. A susceptible non-traveller at node i will be infected by the rate 1\u2212(1\u2212\u03b21)ni,I when he is in contact with ni,I infected agents. A susceptible traveller at a segment kr of a link will be infected by the rate  when he is in contact with  infected agents. Each infected agent recovers with a rate \u03bc. The fraction \u03c1I of infected agents is obtained by , where  is over all the segments in all links in both travelling directions and Ntot is the total population.\n\nWe make a qualitative analysis of the key behavior and illustrate that the dependence of \u03c1I on the model parameters in ITN can be captured by mean-field considerations. Let there be M cities. There are  pairs of cities that the journey between which is all on high-speed trains. The mean number of sections \u2329\u03c4\u232a in a link is \u03c4s = int(s/vs) + 1 for highway links and \u03c4f = int(s/vf) + 1 for railway links, where  is the mean distance between neighbouring nodes. There are altogether\n\n\n\nsections on the links, with d being the mean shortest path length between two nodes. It follows that Nmid decreases with m.\n\nThere are two processes in one time step: infection and motion. For the step t \u2192 (t + 1), SIS processes take place in the time interval t+ \u2192 (t + 1)\u2212 and the motion occurs at (t + 1). At a node , there are ni,s susceptible and ni,I infected agents and ni = ni,S + ni,I. Similarly, there are n\u03b1,S susceptible and n\u03b1,I infected agents at a section \u03b1 of a link, with  and . The dynamics of the infected agents can be described by\n\n\n\nwhere XI accounts for infected agents arriving at the destination or at home, YI represents infected agents starting a journey, kstation are nodes where agents switch means of transportation, and  is over the ki links to node i.\n\nThe time evolution of \u03c1I is given by  and thus\n\n\n\nwhere Ntot is the total population. The set of equations can be iterated in time for the steady state. Further generalizations of ITN can be treated accordingly.\n\nBased on Eq. (8), we make the following observations:\n\n1. For \u03b21 = \u03b22: As ni >> n\u03b1, we readily have ni,I >> n\u03b1,I and the second term in Eq. (8) dominates. Thus, \u03c1I in Fig. 5(b) comes mostly from infections at the nodes.\n\n2. For \u03b21 \u2260 \u03b22\nand \u03b21 > \u03b21c: Infections at the nodes give \u03c1 \u2260 0, but the third term in Eq. (8) becomes important when \u03b22 > \u03b21 and \u03b22 > \u03b22c. This gives the behaviour in Fig. 6(a).\n\n3. For \u03b21 \u2260 \u03b22\nwith \u03b21 < \u03b21c: Infections at the nodes alone cannot sustain \u03c1I. Infections on journeys dominate and \u03c1I becomes finite at \u03b22 = \u03b22c, independent of \u03b21 (see Fig. 5d). It follows from the equation for n\u03b1,I((t + 1)\u2212) that\n\n\n\nindicating that \u03b22c is inversely proportional to the mean number of agents travelling in a segment of a link n\u03b1.\n\n4. For different m: The third term in Eq. (8) indicates that \u03c1I \u221d Nmid. As Nmid decreases with m (see Eq. 6), \u03c1I also drops with increasing m and high-speed railways tend to prevent epidemics by shortening travel times. One should note that this captures one effect of having faster transportation. However, an opposite effect of inducing more travellers poses a risk.\n\nHow to cite this article: Ruan, Z. et al. Integrated travel network model for studying epidemics: Interplay between journeys and epidemic. Sci. Rep.\n5, 11401; doi: 10.1038/srep11401 (2015)."}