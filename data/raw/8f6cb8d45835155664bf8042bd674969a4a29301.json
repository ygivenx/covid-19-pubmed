{"title": "British Journal of Clinical Pharmacology Application of data mining techniques in pharmacovigilance", "body": "Adverse drug events (ADEs) constitute a major public health problem. They are estimated to account for up to 5% of hospital admissions [1] , 28% of all emergency department visits [2] , and 5% of hospital deaths [3] . Many ADEs, such as prescription errors, are preventable [4] , and methods have been suggested to reduce these errors [5, 6] . However other ADEs are unknown at the time of marketing as premarketing studies are generally small, of a short duration, do not detect late-onset or rare adverse effects and, by excluding patients with comorbid disease, have limited generalizability. For example the interaction between terfenadine and cytochromal p450 enzyme inhibitors causing cardiac arrhythmias was only recognized 7 years after licensing [7] . Furthermore, clinical trials typically underplay harm in their reporting [8] . For example, increased risks of serious cardiac events with rofecoxib were suggested by a further analysis [9] of the VIGOR study [10] , which occurred a year after the marketing of this therapy.\n\nIn the current regulatory environment, where efficacious drugs are brought to market as soon as possible [11] , post-marketing drug surveillance (PMS) has become increasingly important in order to characterize cost-effectiveness and harm in real practice. Recent examples of drug withdrawals, due to uncommon ADEs after millions of patients were exposed [12] , have reinforced the inadequacy of current methods of PMS.\n\nOver recent years, with the development of large electronic health data storage systems, powerful computers and new statistical algorithms, there has been an increased interest in data mining or knowledge discovery initiatives from databases. These processes, which were mainly used in the marketing industry, have gained popularity in various fields such as web mining [13] and information science [14, 15] but very little information exists on their application in pharmacovigilance [16] . The purpose of this paper is to review the current use of data mining in pharmacovigilance and provide an overview of the data mining process.\n\nAn electronic search of MEDLINE from 1966 to 2002 identified articles which contained the keywords 'datamining, data mining, signal generation, exploratory methods, exploratory tools, neural network, disproportionality, signal detection, higher than expected combination, signal, data interrogation, database interrogation, Bayesian, cluster analysis, hypothesis generation, knowledge discovery, symmetrical analysis, prescription event monitoring' and 'adverse drug effect, adverse drug event, pharmacovigilance, drug side-effect, toxicology, electronic medical records, EMR, large administrative data, linked administrative data, Medicaid, MEMO, GPRD, Tayside, Saskatchewan, Unitedhealth Group, Harvard Pilgrim Health Care'. This search resulted in 340 citations, the title and abstract of which were reviewed. Sixty-four articles in the English language were identified, of which 39 manuscripts were considered relevant and reviewed. The relevant articles will be discussed within the context of the data mining process.\n\nThere is some confusion in the terminology of data mining. Some authors refer to data mining as the process of acquiring information, whereas others refer to data mining as utilization of statistical techniques within the knowledge discovery process. We will define knowledge discovery in databases (KDD) as the process of extracting previously unknown, valid and actionable information from large information sources or databases. The process requires a definition of the project goals, dataset acquisition, data cleaning and preprocessing, data mining, data interpretation and utilization [17] . We will define data mining as the application of statistical techniques, e.g. predictive modelling, clustering, link analysis, deviation detection and disproportionality measures, to databases. All of the above KDD steps are required when embarking on a project from the beginning. However, some researchers take a given database and perform statistical analysis in order to 'mine it' for additional unrecognized information and therefore call the process data mining.\n\nMany of the statistical techniques used in data mining are the same as conventional methods of examining data. However, their use within KDD differs in that there is no prior hypothesis or null hypothesis, and power calculations are not performed. For this reason, if no signal is produced at the end of the analysis it is not possible to tell whether this is because the signal does not exist or because insufficient data are being analysed. Essentially, once the aims have been defined and the database is prepared for data mining, the statistical techniques attempt to find patterns, or associations or dissimilarities between groups of data in order to generate a signal or detect new information.\n\nSteps of knowledge discovery in databases (Table 1 )\n\nAlthough there is no detailed a priori hypothesis in KDD, and one should keep an open mind when exploring for possible ADEs [18] , it is important to have an aim, as KDD is costly in terms of data collection and management.\n\nA clearly defined aim makes it easier to determine the type of variables and data mining technique to be used. For example, assessing drug-related birth defects would require a different data set than drug-drug interactions.\n\nHowever, in order to maximize the chance of detecting a signal, the most inclusive collection of relevant variables should be used. The World Health Organization (WHO) Adverse Reaction Terminology and Medical Dictionary for Regulatory Activities (MedDRA) are examples of datasets used for pharmacovigilance [19] , but their list of variables is limited to those determined by prior assessments of causation [20] . In terms of variable availability, electronic medical records (see below) hold potential in being the repository of the widest possible medical terminology. For example, new medical conditions, such as Severe Acute Respiratory Syndrome, will be used within electronic medical records before they are incorporated into adverse reaction terminology dictionaries.\n\nAs data collection is expensive, data mining processes are often performed on existing databases, for the purposes of pharmacovigilance. The necessary size of the dataset required is difficult to determine but will depend on the data quality, the background frequency of the event and the strength of the association of the event with the drug. However, for even moderately rare events, large databases are required. The characteristics of the different large databases throughout the world are described elsewhere [21] and discussed below ( Table 2) .\n\nSpontaneous reporting databases The spontaneous reporting of a possible adverse drug reaction by healthcare providers to governmental agencies or drug com-panies (i.e. to the UK Yellow Card Scheme, http:// medicines.mhra.gov.uk/) is an important procedure in PMS. However, as spontaneous reporting is a passive system, inconsistent reporting is a limitation with more frequent reporting for unusual reactions, reactions for new drugs and serious reactions [22] . Furthermore, the accuracy of the data contained within the reports is uncertain. However, spontaneous reporting databases do contain large amounts of data, for example the Food and Drug Administration (FDA) spontaneous reporting database contains over 2 million reports over a period of 35 years. These databases can therefore be mined to obtained details of ADEs. For example, a retrospective data mining of the FDA spontaneous reporting database was shown to identify ADEs many years prior to collecting reports alone [23] , as is discussed further below.\n\nPrescription event monitoring databases Prescription event monitoring (PEM) is used to detect ADEs by collecting high-quality data from family doctors, on a select group of patients exposed to a specific (new) drug, for a limited period of time [24] . Heeley et al. [25] discuss the role of database exploration in order to detect ADE signals from a PEM database, which contains 1 million reports of events from 78 PEM studies. They point out that a limitation of PEM database mining is the lack of an adequate control group, as the database contains details of clusters of patients exposed to certain drugs. For example, tolterodine did not show evidence of hallucinations as an ADE because the control group contained patients prescribed other drugs known to Table 1 The steps with rationale and examples, of the knowledge discovery in database (KDD) process\n\nStep of KDD process Rationale Example Determine a high association with cardiovascular disease and COX-2, report this association via Dr Doctor letter and instigate a controlled observational study to prove the association cause hallucinations. When the data from these patients were removed, an ADE signal for tolterodine was discovered [25] .\n\nLinked administrative databases Large linked health administrative databases, such as Medicaid in the USA and the Ontario provincial databases, contain data on millions of subjects and may also be used as a source for data mining. The data are available at relatively small additional costs and are not subject to recall or interviewer bias. However, the completeness of details, such as diagnoses, are questionable in many circumstances, and they tend to apply to elderly or low-income populations only, so may not be representative of the whole population.\n\nThe Saskatchewan-linked administrative healthcare utilization database and the Tayside Medicines Monitoring (MEMO) are examples of linked medical health databases, and both have been utilized to identify risks of benzodiazepine therapy [26, 27] .\n\nElectronic medical records Electronic medical records (EMRs) contain a large number of data fields, including details such as the use of tobacco products, smoking and nonprescription drugs, symptoms and signs, laboratory data and social circumstances, on a smaller number of patients and may also be used for data mining. Because of the large number and detail of the variables, which can be combined to generate new diagnoses or adverse events, hypotheses, which are not restricted to existing diagnoses, can be explored. Although Honigman et al. [28] have investigated the use of EMR in detecting known ADEs, there have been no studies of data mining using EMR.\n\nOther databases Clinical trials databases and specialist databases such as overdose or toxicology databases may also contain valuable information. Data mining has been used to explore cardiovascular clinical trial databases [29] , the US Vaccine Adverse Event Reporting System [30] and a large prescription database [31] . Signals for liver-related ADEs have been reported from analysis of a biochemistry laboratory database at a higher rate than that reported by physicians [32] . Poison information centres also record details of ADEs and may contribute to the pharmacovigilance process [33] .\n\nData preprocessing involves data sampling and data quality verification to ensure the data are clean and well described. Medical data can contain erroneous data such as ages of 120 years rather than 20 years, and a documentation of hysterectomy in males. New variables of interest to be used in the analysis can be generated from the data. For example, it may be possible to estimate socio-economic status from the postal code.\n\nPredictive modelling Predictive modelling is a technique used to develop a model to relate a dependent variable with a set of independent variables in a manner similar to multiple regression analysis. There are two types of predictive modelling, namely classification, for categorical dependent variables, and value prediction, for continuous dependent variables. Classification is appropriate if the goal is to predict group membership of new records based on their characteristics (independent variables). Using classification, the most influential variable is identified and used to split the data into groups. This is then repeated with the next most influential variable until the data are fully characterized. For example, it may be possible to determine a classification criterion or rule that discriminates between different groups of patients with and without side-effects based on age, sex or socio-economic class. Value prediction uses both classification and regression to predict the future outcome of a patient based on, for example, their demographic or socio-economic characteristics. However, we need to use caution as, in any data analysis of continuous outcomes, the results of value prediction can be influenced by the presence of outliers in the data.\n\nClustering or database segmentation Clustering uses an algorithm that segregates a database by evaluating the dissimilarity between records. Pairs of records are compared by the values of the individual fields within them, and clustering into groups provides fast and effective ordering in large datasets. Segmentation could be used to group patients with similar symptoms or diagnoses to determine whether there is a drug association. Thus, clustering is a technique of choice if the goal is to reduce a large sample of records to a smaller set of specific homogeneous subgroups (clusters) without losing much information about the whole sample. Because of the heterogeneity between clusters, this analysis can also be helpful in hypothesis development about the nature of the variation between subgroups. For example, if a database contained details of different cardiac pathologies (e.g. valvular heart disease) and medication (e.g. fenfluramine-phentermine), clustering analysis may have segregated patients according to heart disease and identified fenfluramine-phentermine as one of the main factors in this group. We could then explore the hypothesis of an association or causal link between cardiac valvular disease and fenfluramine-phentermine.\n\nLink analysis Link analysis refers to methods that identify associations or links between records or sets of data [34] . It assesses associations by using an 'if x then y' type rule, by assessing patterns of behaviour or by identifying similar time sequences of events. In pharmacovigilance, link analysis could be used to identify associated factors such as the effect of renal impairment on the safety profile of diuretics.\n\nDeviation detection Deviation detection looks for outliers or values that deviate from the norm and can be seen either graphically or statistically. Visualization techniques are used to determine patterns hidden in data, e.g. scatter plots or histograms, multidimensional graphs for multivariate data, and time series plots. Statistics methods are then employed to measure significance of deviations once they have been detected. This process could be used to identify patients with idiosyncratic reactions or unusual symptoms, which could be related to medication and may constitute an ADE signal. Regression analysis and stratification can be used to assess the influence of age, sex and comorbidity on ADE signal generation.\n\nMeasures of disproportionality (Figure 1 ) To our knowledge, measures of disproportionality are the only techniques which have been used to identify ADEs. They have been used by the Netherlands Pharmacovigilance Foundation [35] , the UK Yellow Card database [36] , WHO Uppsala Monitoring Centre [37] and PEM database [25] . Using the definition of a signal as a proportional reporting ratio (see Figure 1 ) >2, c 2 >4 and three or more cases, Evans et al. [36] identified 487 signals from the Yellow Card database. Of those, 70% were recognized ADEs, 13% were due to the underlying disease and 17% were investigated further. Of the latter, 28% were reviewed in detail and in three cases the manufacturer was requested to change the product information. Using the Netherlands Pharmacovigilance Foundation it was possible to identify an association between delay of withdrawal bleeding during concomitant use of oral contraceptives and itraconazole, which had previously only been suggested by case reports [38] . The same authors also assessed the statistical interaction between the use of diuretics and nonsteroidal anti-inflammatory drugs (NSAID), and showed significantly higher use in combination, suggesting an effect of NSAID on diuretic use. In a retrospective study Lindquist et al. [39] defined an ADE subsequently reported in the medical literature as the gold standard, and reported that the Bayesian Confidence Propagation Neural Network (BCPNN) method at the WHO Uppsala\n\nMonitoring Centre had a 46% positive predictive value and a 84% negative predictive value. More recently, Bate et al. [40] have demonstrated the use of the BCPNN Data Mining approach to detect signals of specific adverse drug reactions and also adverse events as a drug class effect. They demonstrated the association of pericarditis with practolol but not with other b-blockers, the association of captopril and other angiotensinconverting enzymes with cough, and the association with terfenadine and heart rate and rhythm disorders.\n\nPuijenbroek et al. [41] discuss the advantages and disadvantages of the different methods of disproportionality and show that although they were comparable, the Information Component (see Figure 1 ) was the most versatile but required knowledge of Bayesian statistics. The US Food and Drug Administration (FDA) uses a data mining algorithm called the Multi-item Gamma Poisson Shrinker (MGPS) to interrogate their spontaneous reporting database, as this has the ability to look at drug-drug interactions. The MGPS algorithm examines the ratio of an observed ADE to the total number of ADEs (over 56 million) in order to detect a signal using Bayesian statistical analysis. In a retrospective study the MPGS was shown to identify 20 out of 30 known ADEs 1-5 years prior to detection by standard methods [23] . The same authors also show that the number signal scores (the adjusted ratio of observed to expected counts) increased for rhabdomyolysis with cerivastatin from 1998 until 2001, when this drug was voluntarily withdrawn from the market [23] .\n\nIt is likely that the KDD process will have to be repeated many times with redefinition of the goals and further analysis in light of the results of previous mining attempts. However, once a signal is identified then the degree of causation needs to be determined. Clearly the strength of the signal is important, but other criteria, suggested by Bradford-Hill, including the consistency and specificity of the finding, temporality, and plausibility, are required [42] . The Medicines Control Agency applies 'SNIP' criteria (the Strength of the signal, whether it is New, clinically Important or whether there is potential for Preventative measures), each criterion being independently associated with a signal generation [43] . Often causation is not confirmed and other methods such as case-control studies are required to examine the ADE [44, 45] . Once a potential ADE is identified and further investigation substantiates the adverse effect, this information needs to be quickly disseminated via reports to medical practitioners, e.g. the Dear Doctor letters, or articles in the medical literature [46] . In this way the medical community can be educated and steps can be put into place to reduce ADEs, making drug therapy less hazardous for patients.\n\nIt is currently not possible to link all available datasets together and run one of the data mining techniques to identify all possible adverse events. Data mining processes are not able to account for inaccurate or missing Where p(x) = probability that drug 'x' listed on case sheet p(y) = probability that ADE 'y' listed on case sheet p(y,x) = probability that drug-ADE combination 'x' and 'y' listed on case sheet data, and if a signal is not detected it is impossible to determine whether no ADE exists or the data are insufficient. Furthermore, KDD only generates a signal and, in the context of pharmacovigilance, further studies or investigations will be required to confirm a potential ADE. However, by being open minded, it is possible to search for many different ADEs at once. Also, information in many databases is under-utilized, and therefore KDD may be possible to generate new information from existing data sources at minimal extra cost. KDD will not replace traditional methods of pharmacovigilance, but if used in conjunction may reduce the time required for ADE identification [23] . It is impossible to predict the actual circumstances in which KDD will contribute to pharmacovigilance, but one would suspect that rare and atypical events, clusters of symptoms and signs not yet formulated in a diagnosis and common diagnoses not recognized as drug-related could all be flagged earlier and more reliably by employing systematic data mining techniques. Regular and repetitive analyses of accumulating data could maximize the opportunity to detect a signal of an ADE which is only evident after prolonged usage. In the future it may be possible to perform continuous data mining analysis, e.g. link analysis, on large electronic medical records to identify signals in a cost-effective manner.\n\nWe have described the steps in KDD, the different statistical processes available during the data mining procedure, and discussed examples of where these techniques have been used in pharmacovigilance. When considering the frequency and significance of ADEs, as well as the inadequacy of premarketing ADE evaluation, it is clear that cost-effective methods of quickly identifying potential ADEs are required. Given the availability of larger datasets and faster computer processing speeds, we suggest that data mining techniques will have a greater role in pharmacovigilance in the future.\n\nA.H. is the recipient of a Career Investigator Award from the Canadian Institutes for Health Research."}