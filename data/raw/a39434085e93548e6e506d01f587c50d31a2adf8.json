{"title": "How generation intervals shape the relationship between growth rates and reproductive numbers", "body": "The past decade has seen a dramatic increase in the attention paid to infectious disease epidemics as a potential health threat. This is due in part to disease outbreaks in domestic livestock (Keeling et al. 2001) , the fear of bioterrorist attacks with smallpox virus (Gani & Leach 2001) , the emergence of severe acute respiratory syndrome (SARS) in 2003 (Lipsitch et al. 2003) and the risk of an influenza pandemic among human populations (Longini et al. 2004; Ferguson et al. 2005) . Planning for the mitigation and control of such health threats relies increasingly on mathematical models of infection transmission.\n\nOne of the key parameters in mathematical transmission models is the reproductive number R 0 , defined as the number of secondary infections that arise from a typical primary case in a completely susceptible population. When infection is spreading through a population that may be partially immune, it is often more convenient to work with an effective reproductive number R, which is defined as the number of secondary infections that arise from a typical primary case. The magnitude of R is a useful indicator of both the risk of an epidemic and the effort required to control an infection (Anderson & May 1991; Roberts & Heesterbeek 2003; Heffernan et al. 2005) . Accurate estimation of the value of the reproductive number is crucial to planning for the control of an infection.\n\nFor new emerging infections, such as SARS in 2003, the available information about the transmissibility of a new infectious disease epidemic is likely to be restricted to daily counts of new cases. It is well known that these counts increase exponentially in the initial phase of an epidemic. The rate of exponential growth, r, is defined as the per capita change in number of new cases per unit of time. The observed value of the growth rate r can be related to the value of reproductive number R through a linear equation: RZ1CrT c (Anderson & May 1991; Pybus et al. 2001; Ferguson et al. 2005) . Here, T c is the mean generation interval, defined as the mean duration between time of infection of a secondary infectee and the time of infection of its primary infector (sometimes this is called the serial interval or generation time).\n\nDemographers, ecologists and evolutionary biologists take a slightly different approach. They derive the growth rate from fecundity rates, survival rates and the reproductive number R according to the so-called Lotka-Euler equation (Dublin & Lotka 1925; Feller 1941; Metz & Diekmann 1986; Keyfitz & Caswell 2005) . Ecological textbooks suggest simplifying this equation by ignoring variability in generation time (Begon et al. 1996) . The result is, after rearranging, an exponential equation: RZexp(rT c ). Here, T c is the cohort generation time, a demographic analogue of the epidemiological mean generation interval.\n\nHaving two alternative equations for relating the desired value of reproductive number to the observed value for growth rate, we face the difficulty of choosing the most appropriate one. For example, the growth rate of the Hepatitis C epidemic is estimated to be rZ0.96 per year, and the mean generation interval of this infection is of the order of T c Z20 years (Pybus et al. 2001) . The value for the reproductive number by the linear equation is RZ1C0.096!20Z2.9, whereas the value that is obtained using the exponential equation is RZexp(0.096!20)Z6.8. Such large discrepancies do matter in planning for public health interventions. There exist several other expressions that relate the reproductive number to the growth rate (Dublin & Lotka 1925; Lipsitch et al. 2003; Wearing et al. 2005) and expressions for estimating the reproductive number from time-series of case counts (Wallinga & Teunis 2004) . How should we choose the most appropriate equation for inferring the reproductive number from observed growth rates for a particular infection?\n\nWe start by recapitulating the Lotka-Euler equation in terms of human demography, and we rephrase this equation into more convenient terms for infectious disease epidemiology, following Levin et al. (1996) . We use the rephrased Lotka-Euler equation to examine the assumptions that underlie the alternative relationships between reproductive number and observed change in a number of cases. We will illustrate our findings by estimating the reproductive number R for influenza A infections. The key variables and their interpretation in ecological, demographical and epidemiological terms are presented in the electronic supplementary material.\n\nWe introduce the Lotka-Euler equation using the human population as an example. For simplicity, we focus on female individuals, assuming that there is always a sufficient supply of males to ensure reproduction. We measure time and age in years, and we will refer to the present time as tZ0, such that events in the past occurred when time t is negative and events in the future will occur when time t is positive. We assume that the population displays exponential growth at a fixed growth rate and that the age distribution of the population does not change over time.\n\nThe Lotka-Euler equation can be understood as the combination of two concepts that can be explained intuitively. First, if we add up the number of children born to mothers of all ages at a particular time, we get the total number of births at that time. The number of births to mothers of age a at time t is equal to the number of births at time tKa (the number of mothers, including those who have not survived) multiplied by the expected number of offspring per year for mothers of age a. Summing these births over all possible mothers' ages, we obtain the total number of births in year t, b\u00f0t\u00de Z \u00f0 N aZ0 b\u00f0tKa\u00den\u00f0a\u00deda;\n\n\u00f02:1\u00de\n\nwhere b(t) refers to birth rate of the population at time t and n(a) refers to the rate of production of female offspring by a mother at age a. This equation is a specific case of the renewal equation for the birth process (Feller 1941) . Second, because the population is growing exponentially with a stable age distribution, the number of births at any given time (say t) is equal to the number of births a time units ago, multiplied by the exponential growth of the population since then b\u00f0t\u00de Z b\u00f0tKa\u00dee ra : \u00f02:2\u00de\n\nCombining these two equations, we obtain an expression with b(t) on both sides b\u00f0t\u00de Z \u00f0 N aZ0 b\u00f0t\u00dee Kra n\u00f0a\u00deda:\n\n\u00f02:3\u00de\n\nThis equation has the intuitive interpretation that all the births in the past, multiplied by the number of offspring for individuals born at each time in the past, must add up to the current births. The composite parameter n(a) is more familiarly known in demography as the product of the survivorship and fecundity functions, n(a)Zl(a)m(a). Using this more familiar parameterization and removing b(t) from both sides of equation, we obtain the Lotka-Euler equation\n\n\u00f02:4\u00de\n\n(b) A moment generating function expression for the reproductive number R While the Lotka-Euler equation is a basic part of demography, in which one may be interested in deriving population growth rates from life tables, a related problem in epidemiology is to estimate the reproductive number, R, from growth rates of a disease. We have previously defined n(a) as the rate of production of female offspring by a mother at age a. It is readily seen that if we integrate n(a) over the whole lifespan, we obtain the total number of female offspring produced by a mother over her lifespan, known as R\n\nThe rate n(a) can be normalized to a distribution g (a), which is the distribution of age at child bearing (cf. Metz & Diekmann 1986) g\u00f0a\u00de Z n\u00f0a\u00de\n\nThe generation interval distribution for an infectious disease is the probability distribution function for the time from infection of an individual to the infection of a secondary case by that individual. If we take the 'age' of an infection to be the time since infection, then in the notation above, the generation interval distribution is equivalent to g(a) above. Substituting this expression for the generation interval distribution g(a) into the Lotka-Euler equation (2.4), we obtain\n\nThe term that now appears in the right-hand side of this equation is familiar to mathematicians as the so-called Laplace transform of the function g(a). More specifically, it is known to statisticians as the moment generating function M(z) of the distribution g(a) (e.g. Mood et al. 1974) M\u00f0z\u00de Z \u00f0 N aZ0 e za g\u00f0a\u00deda:\n\n\u00f02:8\u00de\n\nWe use this moment generating function to simplify the notation of the rephrased Lotka-Euler equation (2.7).\n\nHere, the argument z takes the value of minus the growth rate, Kr:\n\nprovided that M(Kr) exists.\n\nA moment generating function, if it exists, uniquely characterizes the shape of the entire probability distribution: M(z) determines g(a) and, conversely, g(a) determines M(z). The biological corollary of this moment generating function expression is then that a relationship between growth rate r and reproductive number R uniquely characterizes the shape of the generation interval distribution and, conversely, the shape of the generation interval distribution determines the appropriate relationship between the reproductive number and the growth rate. The electronic supplementary material provides further mathematical details.\n\n(a) Epidemic models An epidemic model implicitly specifies a generation interval distribution. A simple epidemic model categorizes the population of hosts according to their infection status as either susceptible, infectious or recovered. This results in the so-called susceptible-infectious-recovered (SIR) class of epidemic models. The rate of leaving the infectious stage is denoted by b, and this rate is assumed constant. The rate of making contacts during this infectious stage is also assumed constant. The duration of a generation interval is thereby implicitly specified as an exponential distribution with mean T c Z1/b. Such an exponential distribution is illustrated in figure 1a, dotted line. We substitute the moment generating function for the exponential distribution M(z)Zb/(bKz) with zZKr (see table 2 of the electronic supplementary material) into the moment generating function expression (2.9). Simplifying the result gives a linear relationship between growth rate r and reproductive number R,\n\nprovided that rOKb. This linear relationship between growth rate and reproductive number is shown in figure 1b , dotted line. The linear relationship is frequently used in infectious disease epidemiology, with the term 1/b interpreted as mean generation interval (Ferguson et al. 2005 (Ferguson et al. , 2006 or as duration of the infectious period (Anderson & May 1991; Pybus et al. 2001) .\n\nTo enhance realism of the epidemic models, we can add an exposed (infected but not yet infectious) stage. This results in the so-called susceptible-exposed-infectiousrecovered (SEIR) class of epidemic models. The rate of leaving the exposed stage is b 1 , the rate of leaving the infectious stage is b 2 and both rates are assumed constant. Thereby, the generation interval distribution is implicitly specified as a convolution of two exponential distributions with a mean T c Z1/b 1 C1/b 2 . Such a distribution has one mode with a long right tail (see figure 1a , short-dashed line). We substitute the moment generating function of this distribution (see electronic supplementary material) into the moment generating function expression (2.9).\n\nAfter rearranging, we obtain the relationship R Z \u00f01 C r=b 1 \u00de\u00f01 C r=b 2 \u00de; \u00f03:2\u00de\n\nwith the proviso that rOmin(Kb 1 ,Kb 2 ). This relationship is a quadratic increasing curve (see figure 1b, short-dashed line). The same equation has been derived by Lipsitch et al. (2003) , using a different approach. More complicated epidemic models have incorporated additional exposed and infectious stages. As an example, we consider the epidemic model proposed by Wearing et al. (2005) which has a number of x exposed stages, each with a rate b 1 , and a number of y infectious stages, each with a rate b 2 . We can compose the moment generating function of the generation interval from the generating functions of duration of each stage (see electronic supplementary material). Substitution of the resulting moment generating function into expression (2.9) gives\n\nwith the proviso that rOmin(Kb 1 ,Kb 2 ). The same equation has been presented by Wearing et al. (2005) . R Z e rT c K\u00f01=2\u00der 2 s 2 :\n\n\u00f03:4\u00de\n\nThis relationship is a convex curve that approximates an exponential curve (see figure 1b, long-dashed line). This equation also shows that a distribution which is more concentrated around the mean generation interval, with a lower value for s, results in higher values for the reproductive number R (see figure 1b : the long-dashed line which corresponds to the more concentrated distribution is above the long and short-dashed line which corresponds to the more dispersed distribution).\n\nFor an infection where all secondary infections are exactly equal to the mean generation interval T c , the distribution conforms to a so-called delta distribution. For this distribution, the moment generating function expression (2.9) reduces to a simple exponential relationship R Z e rT c :\n\n\u00f03:5\u00de\n\nThis relationship is an exponentially increasing curve (figure 1b, drawn line). The exponential equation (3.5) can be intuitively understood by realizing that the relative increase in the number of cases over an interval of T c time units is per definition exp(rT c ), and that, because in this specific case all generation intervals are of equal length, this relative increase is also exactly equal to R.\n\nThe delta distribution is the most concentrated distribution possible. We expect to find that for a given value of the growth rate and mean generation interval, the reproductive number attains the highest possible value. This can be illustrated by an example: if half of the cases will produce secondary infections a bit earlier than the average generation interval T c and the other half will produce secondary infections a bit later than average, the additional number of secondary and tertiary cases which are due to the faster infection will more than compensate for the postponed cases that result from the slower infection. Therefore, epidemics with some variation in the duration of their generation intervals will increase at a higher growth rate r for a given reproductive number R than epidemics without any variation in generation interval. And likewise, epidemics without variation in generation interval will grow at higher reproductive number R for a given growth rate r than epidemics with variation in the duration of their generation intervals.\n\nOur intuitive explanation of this upper bound is supported by a rigorous mathematical argument that invokes Jensen's inequality (see electronic supplementary material). Therefore, the exponential relationship in equation (3.5) provides an exact upper bound to the value that reproductive numbers can take. Hence, it is possible to indicate the range of values that the reproductive numbers R may attain for any shape of the generation interval distribution, using only the observed values for growth rate r and the mean generation interval T c (table 1) .\n\nWe can even obtain a criterion for the relative overestimation of the reproductive number by equation (3.5). We take the ratio of equations (3.4) and (3.5), and rearrange. The relative difference between the upper bound and the actual value of the reproductive number remains below 5% whenever the standard deviation for generation intervals s is smaller than 46% of the doubling time t d Zln 2/r.\n\nWe can observe the duration of generation intervals in a period of exponential epidemic growth, and approximate the generation interval distribution g(a) by a histogram of the observed durations. We denote the category bounds in such a histogram by a 0 , a 1 , ., a n , and the observed relative frequencies of observed generation intervals within these bounds as y 1 , y 2 , ., y n . Substituting the observed distribution into the moment generating function expression (2.9) and calculating the integral gives\n\nFor an observed histogram of generation intervals (figure 2a), this relationship is a convex increasing curve (figure 2b). \n\nreproductive number R relative frequency Figure 2 . Observed generation intervals for influenza A virus infections and the empirical relationship between reproductive number and growth rate: (a) histogram of observed generation intervals between two subsequent influenza cases in a household (after Hirotsu et al. 2004) , the lighter shading indicates observations that could be due to co-primary or tertiary infections and (b) the corresponding empirical relationship between R and r, according to equation (3.6).\n\nIn a typical infectious disease management setting, such as the initial phase of the SARS outbreak of 2003, one of the important tasks of epidemiologists is to provide insight into the change in reproductive number R after control measures have been implemented. In such conditions, the assumption of a constant environment and exponential increase in new case counts is untenable. Estimates for reproductive numbers can be obtained from the renewal equation for the birth process (equation (2.1) ). We substitute observed birth ratesb\u00f0t\u00de for b(t), and a time-varying infection rate R t g(a) for n(a). We assume that g(a) is independent of time t. After rearranging, we have an equation for the reproductive number R t (C. Fraser 2006, personal communication)\n\n\u00f04:1\u00de\n\nThis reproductive number R t assigns its value to the time t at which the secondary cases are infected. An alternative is to assign the value of the reproductive number to the time u at which the primary cases are infected. We find this value by integrating over all possible times t,\n\nThis equation has been used to estimate the time-varying reproductive number for SARS (Wallinga & Teunis 2004) .\n\nBoth estimators are generalizations of the moment generating function expression (2.9): whereas the expressions for R invoke an integral transformation of the generation interval distribution by the exponential growth curve, the estimators for R t and R u invoke an integral transformation of the generation interval distribution by the observed growth curve. In all the cases, the value of the reproductive number depends on the shape of the generation interval distribution.\n\nWe use human infections with the influenza A virus to illustrate the impact that various assumptions about the shape of the generation interval distribution may have on the estimated value of the reproductive numbers for a given growth rate. Mills et al. (2004) analysed the observed growth rates for influenza A during the initial phase of the Spanish influenza pandemic in 1918 in 45 major cities in the USA. They found that the median of initial growth rates of this influenza epidemic was rZ0.20 per day.\n\nWe focus on influenza within households and measure generation intervals as the duration from symptom onset of one household member back to the time of symptom onset of the first infected household member. We have to exclude observations where a household member developed symptoms simultaneously with the first infected household member (primary and co-primary cases), and observations where the household member was unlikely to be infected by the first infected household member (e.g. tertiary cases). Observed generation intervals for influenza A in a Japanese household study (Hirotsu et al. 2004) , after exclusion of possible co-primary and tertiary cases, yield an estimated mean of T c Z2.85 days and an estimated standard deviation of sZ0.93 days (see figure 2a) .\n\nWithout specific assumptions about the shape of the generation interval distribution (table 1), we find that the reproductive number of influenza A is larger than RZ1, but smaller than or equal to RZ1.77. Since the estimated standard deviation of sZ0.93 days is less than the criterion of 46% of the doubling time t d Zln 2/0.20z3.5 days, we know that the upper bound RZ1.77 gives only a slight overestimation. We obtain a value of the reproductive number for influenza A of RZ1.57 for the SIR epidemic model (equation (3.1) ), a value of RZ1.65 for the SEIR epidemic model (equation (3.2) ) and a value of RZ1.66 for the more complicated epidemic model with one latent stage and two infectious stages (equation (3.3), with xZ1, yZ2). Perhaps, the most accurate estimate is obtained with the empirical histogram (equation (3.6); figure 2a ). This gives a value for the reproductive number of influenza A of RZ1.73 secondary cases per primary case.\n\nNew emerging diseases require inference of the reproductive number for an unknown infectious agent from the observed increase in case counts over time. We have shown that the existing relationships between observed epidemic growth rate and a reproductive number differ only with respect to their implicit presupposition about the precise shape of the generation interval distribution. Therefore, the agreement between the presupposed and the actual shape of the generation interval distribution determines the appropriateness of a relationship between observed epidemic growth rate and reproductive number.\n\nOften, we have a poor knowledge of the precise shape of the generation interval distribution. Our results show that it is nonetheless possible to estimate the value of the reproductive number. Even in the absence of any information regarding the shape, we can indicate the upper bound to the possible values that a reproductive number can take (table 1) . And with a few observed generation intervals, we can use the empirical relationship between observed growth rate and reproductive numbers (equation (3.6)).\n\nThe reproductive number has often been named as a key concept in epidemic theory (Anderson & May 1991; Roberts & Heesterbeek 2003; Heffernan et al. 2005) . Since inference of the value of the reproductive number depends crucially on the generation interval distribution, it is surprising that very little is known about this distribution. There is potential for studying a variety of basic epidemiological and ecological questions. We address three of them here.\n\nFirstly, the theoretical framework can be expanded to include discrete generation times, which might be more appropriate for diseases where the moment of infection is tied to discrete times. Such an expanded framework allows for estimation of reproductive numbers for a wide range of infections and organisms, and it could draw on the existing theory that has been developed for life-history analysis in ecology (Caswell 2001) .\n\nSecondly, it is possible to estimate the key transmission variables in epidemic models by fitting the modelled generation interval distribution to the observed generation interval distribution. We have followed this approach by Reproductive numbers from growth rates J. Wallinga & M. Lipsitch 603 fitting the epidemic models to the observed generation intervals for influenza.\n\nThirdly, there will be benefit in collecting data to assess distributions for generation intervals for various infections. It will be interesting to see whether generation intervals within households differ from generation intervals between households. Such a difference might explain the discrepancies between the various reported values for the mean generation interval of influenza A (Longini et al. 2004; Mills et al. 2004; Ferguson et al. 2005 Ferguson et al. , 2006 .\n\nTo conclude, the variety of equations that relate observed growth rate to reproductive number can be understood within the Lotka-Euler framework which embraces both a description of the infection cycle and a description of the change in number of new case counts. The observed generation intervals and the observed epidemic growth, when taken together, specify the appropriate value of the reproductive number, and therefore, the required control effort to contain the epidemic. This means that infectious disease surveillance systems which have an objective to inform health policy makers on the required control effort should monitor the symptom onset date of new cases as well as their generation interval for new emerging infections."}