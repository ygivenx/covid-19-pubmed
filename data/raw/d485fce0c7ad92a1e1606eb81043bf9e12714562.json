{"title": "Realized generation times: contraction and impact of infectious period, reproduction number and population size", "body": "parameters is critical for public health decision-makers in order to take appropriate actions for the global prevention and management of outbreaks and other health emergencies. A key example is given by the prediction models of the reproduction numbers: these rely on the generation time distribution that is usually estimated from contact tracing data collected at a precise calendar time. The forward scheme is used in such a prediction model and the knowledge of its evolution over time is crucial to correctly estimate the parameters of interest. It is therefore important to characterize the causes that lead to the contraction of the mean forward generation time during the course of an outbreak.\n\nIn this paper, we firstly identify the impact of the epidemiological quantities as reproduction number, infectious period and population size on the mean forward and backward generation time. Moreover, we analyze the phenomena of competition among infectives and depletion of susceptible individuals highlighting their effects on the contraction of the mean forward generation time. The upshot of this investigation is that the variance of the infectious period distribution and the reproduction number have a strong impact on the generation times affecting both the mean value and the evolution over time. Furthermore, competition and depletion can both cause contraction even for small values of the reproduction number suggesting that, in epidemic models where the generation time is considered time-inhomogeneous, estimators accounting for both depletion and competing risks are to be preferred in the inference of the generation interval distributions.\n\nIn infectious disease epidemiology, mathematical models are increasingly being used to 2 study the transmission dynamics of infectious agents in a population and thereby 3 providing fundamental tools for developing control policies. An optimal control strategy 4 is based on an appropriate prediction model that in turn requires reliable estimates of 5 the key epidemic parameters. 6 Most research has focused on the 'basic reproduction number', R 0 , which is defined 7 as the expected number of secondary cases resulting from introducing a typical infected 8 person into an entirely susceptible population [2] . The inference of its value in the 9 ascending phase of an epidemic is based either explicitly or implicitly on assumptions 10 about the generation interval distribution [3] . 11 The generation interval, or generation time, is defined to be the time interval 12 between the infection time of an infectee and the infection time of its infector [4] . 13 Generation times are lengths of time intervals and thus there is not a unequivocal 14 procedure to define their dependence on a precise calendar time t. To account for the 15 evolution over time a choice has to be made weather considering generations from the 16 infectee or infector point of view. In the former case the time coordinate refers to the 17 time that has evolved since the infector of an infected person was infected. This is 18 called 'backward', or 'period', generation interval. In the latter case, known as 'forward', 19 or 'cohort', generation interval the average time required to infect another individual is 20 recorded [5, 6] . Considered in the forward scheme, the generation interval distributions 21 is commonly used to estimate infectious disease parameters such as the basic 22 reproduction number [6] [7] [8] [9] . 23 More ambiguity arises in the estimation of the mean generation time because actual 24 data often concern the onset of clinical symptoms rather than the time of infection. symptoms for an infectee appear prior to that of its infector [11] . Note that the serial 30 interval is only defined for symptomatic individuals; an issue that we will not discuss 31 here. 32 Statistical development led to approaches for the estimation of the generation time 33 distribution [7, 12, 13] or jointly of the basic reproduction number and the generation 34 time distribution [14] [15] [16] . The usefulness of the aforementioned approaches has been 35 demonstrated in the analysis of epidemic data during e.g. SARS outbreaks and the 36 pandemic influenza A(H1N1)V2009 outbreak [17] [18] [19] . Most of these estimation methods 37 assume the generation or serial time distribution to remain constant during the 38 epidemic. However, several authors described a non-constant evolution over time for 39 both backward and forward generation interval [5, 6, 8, 20] . In the former case as the 40 epidemic evolves the generation time increases while in the latter case the generation 41 time contracts reaching a minimum approximately at the peak of the outbreak [6, 8] . 42 We will refer to this phenomenon in the forward scheme as 'contraction' to stress the 43 particular shape that the mean generation time assumes over time. The non-constant 44 evolution of the generation interval has stimulated a search for different approaches to 45 estimate the reproduction number that avoid assuming a constant generation intervals 46 distribution through time [8, 9, 13] . Kenah et al. (2008) proposed an hazard-based 47 estimator and the so-called contact interval, the time from onset of infectiousness to an 48 infectious contact, accounting not only for depletion but also for competing risks.\n\nThe contraction of the mean forward generation time seems counter-intuitive since 50 one would expect generations to happen faster in the initial phase of the epidemic, when 51 the population is mostly susceptible. The principal aim of this paper is to clarify the 52 epidemiological mechanisms that cause contraction. Researchers typically assign to the 53 phenomenon of contraction only one among two explanations: competition among 54 infectors [8] and depletion of susceptible individuals [5, 20] . Both explanations are 55 reasonable, but a study that clearly shows which of these hypotheses are responsible for 56 the contraction of the mean forward generation time is not present in literature. The We distinguish between three time intervals that determine the between-host 89 transmission of infection. The first one is the contact interval \u03c4 i,j , defined to be the Our simulation models are based on two algorithms previously introduced in literature. 103 The stepwise algorithm was proposed by Kenah et al. (2008) ; it is based on the notion 104 contact interval [22] and it was implemented to illustrate the competition among Appendix. Since results are similar for both algorithms we report results based on the 113 parallel algorithm and defer results based on the stepwise algorithm to S1 Appendix (S1 114 Fig and S1 Table) .\n\nBaseline scenario 116 We start the investigation of the causes that affect the generation time setting a baseline 117 scenario that representing the dynamic of a stochastic SIR model. In the baseline 118 scenario, we look at the impact of the infectious period, the reproduction number and 119 the population size on the mean backward and forward generation interval using the 120 two aforementioned algorithms. In the forward scheme, the mean generation interval is 121 calculated within each infector's set of generation times and then used as a single data 122 point per infector to avoid the size biased sampling effect [5] whereas in the backward 123 observation scheme, we attribute the unique generation time to each single infectee. 124 We simulate different epidemics by varying:\n\n\u2022 R 0 =1.5, 2, 3, 4, 5\n\n\u2022 the infectious period distribution with mean 1: constant, Exp(1) = \u0393(1, 1), 127 \u0393(0.5, 2) and \u0393(2, 0.5), resulting in variances equal to 1, 2 and 0.5, respectively.\n\n\u2022 the population size: N=100, 500 and 1000 129 We work with a completely susceptible and closed population and report, based on 130 1000 simulations, the mean duration of an epidemic (T max ), the mean final size (F s ), 131 and the averages of mean forward (\u03c9 f ) and mean backward generation times (\u03c9 b ). We 132 study non-extinct outbreaks or outbreaks that persist, i.e. outbreaks in which a 133 substantial proportion of the population is infected, i.e. with final size larger than 10% 134 of the total population. Contraction of the mean forward generation time 148 We introduce three summary measures to account for competition and depletion. In case the interest is in competition, we compute the relative number of generations affected by competition p c , i.e. the number of generations for which more than an individual propose an infectious contact to a specific susceptible over the total number of generations; we report also the mean number of competitors when there is competition, \u00b5 c . In case interest is in depletion, we compute the maximum depletion \u03d5 that is defined to be:\n\nWe refer to S1 Appendix for the procedure to calculate the maximum depletion. 149 We first show that competition and depletion are present in the baseline scenario 150 and we compare these summaries for populations of size N = 4, 10, 20, 50, 100, 200 and 151 for R 0 = 1.5, 3, 5.\n\nAfter that, to investigate the phenomenon of contraction, next to the baseline 153 scenario, we study two scenarios that increase the effect of, respectively, depletion and 154 competition on the generation time distribution. In the former scenario susceptible 155 persons are vaccinated at a specific moment in time during the epidemic, referred to as 156 the vaccination scenario, and in the latter scenario infectious individuals are forced to 157 compete for the same susceptible, referred to as the competition scenario. We also study 158 a scenario in which the competition among infectors is not present: individual are 159 forced to proposed a contact only to susceptible persons who no one already proposed 160 an infectious contact to. We refer to this scenario as the pure depletion scenario. In all 161 of these scenarios the infectious period is set here to be constant to avoid that the 162 stochasticity of the infectious period distribution affects the results. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/568485 doi: bioRxiv preprint Vaccination of susceptible persons 164 We study simulations in which 30%, 60% and 90% of the susceptible population is 165 vaccinated during the epidemic. In a population of size N = 1000 and R 0 = 1.5 we do 166 so by vaccinating the remaining susceptible persons at a specific time called vaccination 167 time and indicated with t v . In this way we change the depletion effect: both augmenting 168 the intensity and changing the time at which depletion occurs. We consider simulations 169 with different vaccination times representing the initial phase (t v = 2), the main phase 170 (t v = 3, 5, 7) and the last phase (t v = 9) of the epidemic and we compute the value of the 171 epidemic characteristics. We do not report the depletion entity because of the instant Average values of duration (T max ), final size (F S), mean forward (\u03c9 f ) and mean backward (\u03c9 b ) generation times.\n\nIn Figs 1 and 2 we show the evolution over time of the mean forward and backward 208 generation times in a population of size N = 1000, respectively, for R 0 = 1.5, 2, 3, 4, 5 209 and for the infectious period distributions specified before. The mean forward 210 generation interval contracts as the reproduction number increases but still slightly even 211 for low values of the reproduction number. In the backward observation, the generation 212 time shows an increasing trend that is steeper for high value of the reproduction number 213 and for higher variance of the infectious period. The evolution over time for both the 214 forward and the backward generation intervals show a similar pattern for the different 215 infectious period distributions though we notice that a higher variability is observed for 216 scenarios in which the infectious period distribution has larger variance. Lastly, we observe that the different population sizes do not affect considerably the 217 average value of the forward and backward generation time (Table 1 ). In Fig S5 we show 218 that also the evolution over time is similar for the different sizes considered in the paper. 219 Results reported in Table 2 show that when the reproduction number increases, also 226 the number of generations affected by competition and the mean number of competitors 227 increase. Furthermore, p c is stable for the tested population size, while the depletion 228 intensity is more accentuated in small population. Average values of the proportion of generations affected by competition (p c ), the mean number of competitors (\u00b5 c ) and the depletion intensity (\u03d5). In the vaccination scenario individuals are vaccinated at a precise time during the 238 epidemic. In Table 3 Average values of duration (T max ), final size (F S), mean forward (\u03c9 f ) and mean backward (\u03c9 b ) generation times together with the proportion of generations affected by competition (p c ), mean number of competitors (\u00b5 c ) and depletion intensity (\u03d5).\n\nIn Fig 4, we report the simulated evolution over time of the mean forward generation 249\n\nMarch 5, 2019 9/23 . CC-BY-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/568485 doi: bioRxiv preprint interval for the vaccination times t v = 5. We can appreciate the phenomenon of Average values of maximum, minimum and range of the loess regression (Max loess, Min loess and Range loess) and depletion intensity (\u03d5).\n\nIn In the competition scenario, we increase competition in the time interval (3, 7) , for a 266 population of size N = 1000 and a reproduction number of value R 0 = 1.5. In Table 6 267 we report the epidemic characteristics; we notice that the mean value of the generation 268 time is smaller compared to the one in the baseline scenario (Table 1) , both for the 269 forward and the backward scheme. We also notice that the mean number of generation 270 affected by competition and the mean number of competitors is higher respect to the 271 baseline scenario with same reproduction number (Table 2) . 272 Table 6 . Epidemic characteristics -Competition scenario The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/568485 doi: bioRxiv preprint time contracts around the interval in which the competition intensity is increased. Competition also affects the generation time distribution but its effect is directed to 295 a single generation. To have a similar impact on the mean forward generation time as 296 caused by depletion, competition should affect most of all the generations that an 297 individual makes. This is simulated in the scenario where competition is increased and 298 results show a potentially large impact of competition on the forward generation time. 299 However, in a baseline scenario where competition is not increased rarely more than one 300 generation per single individual is affected by competition and the mean number of 301 competitors is not particularly high to be able to explain a decreasing mean forward 302 generation time (Fig 3) . Furthermore, the effect of competition is strongly dependent on 303 March 5, 2019 12/23 the competitor's infection time and does not not always affect the considered generation. 304 The contact interval that leads to the generation time can be the longest one among the 305 contact intervals proposed by the infectors since the next generation is the minimum of 306 the set given by the infection times plus the proposed contact times. Competition is 307 slightly affecting the forward and backward generation time: Table 6 shows a small 308 decrease probably due to the competition effect.\n\nThis paper's focus is on the evolution over time of the mean forward generation time 310 but the backward generation scheme is of interest too. The mean backward generation 311 time is known to be increasing [6, 20] and differently from the forward scheme a single 312 generation is considered for every time point. The increasing trend is due to the fact 313 that the probability of encountering a susceptible decreases over time, but a more 314 intense competition can, also in this case, modify the evolution of the mean value over 315 time. This is shown in Fig S6, where in a preliminary investigation the baseline, Although we have looked at compartmental SIR models, we expect our conclusion to 331 hold for more complicated compartmental models, and even for epidemics models on 332 structured contact networks. A limitation of our investigation is the assumption made 333 for the infectious contact process to be described by a Poisson process and to be 334 homogeneous in the population: in a structured population the infectious contact 335 process depends on the location where the contacts take place because of different 336 behaviour of individuals yielding different contact processes [21] .\n\nThe findings of the present study clearly show the non-constant behaviour of both 338 backward and forward generation interval, in line with the literature [5, 6, 8, 20] . 339 Moreover, this has been the first attempt to thoroughly examine the cause of the contact and the infection time of the next case is t (2) = t * (1)1 . At this stage, the newly infected case and its infector will contact other people randomly in the population. Unlike the stepwise algorithm, this contact can be potentially generated also for already infected person. In parallel, the first case will generate his or her second contact at time t * (1)2 = t (1) + \u03b4 (1)1 + \u03b4 (1)2 and the second case will generate his or her contact at time t *\n\n(2)1 = t (2) + \u03b4 (2)1 . As long as the contacts are made with susceptible persons and lie within the respective infectious period, they will be infectious contact. The third case will correspond to an infectious contact with the earliest contact time. The epidemic grows in this way until there are no infectious person anymore. We summarize the parallel algorithm:\n\nFor each infectious case i:\n\n1. Generate the next inter-arrival contact time \u03b4 i+ 2. Set T * i+ = T * i + \u03b4 i+ as the proposed next contact time of person i where T * i is the previous contact time made by case i.\n\n3. If T * i+ > t i + r i the case i is already recovered and the contact can not be an infectious contact, then discard it. If the contact is made with a susceptible person it is a proposed infectious time and record T * i+ . 4. The next infectious time is the minimum over all the proposed infectious time.\n\nThe two algorithms give the same results when looking at the mean value of the considered epidemic characteristics and when plotting the evolution over time of the mean forward and backward generation times. In S1 Table we reported the average quantities of mean duration T max , mean final size F S, mean forward generation tim\u0113 \u03c9 f and mean backward generation generation time\u03c9 b for simulations with the stepwise algorithm. Values are almost the same as the ones reported for the parallel case in Table 1 . In S1 Fig we compare the evolution over time of the mean forward generation time in the vaccination scenario for R 0 = 1.5, 3 varying the infectious period and using both parallel and stepwise algorithms. The plot shows that the results are independent from the selected algorithm and infectious period. Same conclusions hold also for the gamma infectious period distributions considered in this paper. S1 \n\nEvery time an infectious contact is proposed we keep track of the current time t j and the probability of encountering a susceptible individual at that specific time \u03be tj , computed as the proportion of susceptibles over the population size. We than fit a 5-parameters logistic curve f (x|{t j } j , {\u03be tj } j ) to the simulated values using the function drm of the drc package in R. At this point we approximate the derivative of the fitted function as:\n\nwhere in our simulation h is set to be h = 0, 001. According to this discretization, for a specific simulation we define the maximum depletion to be:\n\nWe then compute the mean of the depletion intensity value among all the non extinct simulations. \n\nVaccination affects the phenomenon of contraction differently, depending on the vaccination time. In S2 Fig we report plots for two different vaccination times t v = 2, 9 in the scenario with R 0 = 1.5 reported in the results section representing the ascending phase and the descending phase of an epidemic outbreak. Even if the intensity is different the phenomenon of contraction is always present. \n\nThe simulated data are analyzed in R; generations resulting from the first n non-extinct simulations are merge together in a unique data file and we predict the value of a loess regression to express the evolution over time of mean forward or backward generation time. This analysis required a huge computational memory, limiting the number of simulations that can be considered. However, this R function allows us to construct a confidence interval to quantify the variability of the loess regression used. In Another important aspect in the loess regression is the considered span. The fitting is done locally and the considered neighbourhood of a point x is based on the value of the span, parameter that has to be given as input in the loess function. In S4 Fig we report the evolution over time of the mean forward generation time for R = 1.5 in the vaccination scenario for three different values of the span parameter: 0.5, 0.75(default value) and 1.5 in the case of exponential infectious period. The plot shows differences between the curves in the last part of the outbreak after the vaccination time where few generations are registered. This is probably due to the little number of generations that happen after the vaccination time. We want to remark that the result of contraction holds independently on the type of span considered. Lastly, we want to show the evolution over time of the mean forward generation time for different population sizes. In S5 Fig we report this quantity for population of size N = 100, 500 and 1000 in the case of exponential infectious period. We notice that one plot is the re-scaling of the others; the general evolution of the forward generation intervals is not affect by the population size. The same results apply for the backward generation interval. \n\nIn a preliminary study, we investigated also the effect of competition on the mean backward generation time. In S6 Fig we report the evolution over time of the mean backward generation interval R 0 = 1.5, 3, 5 comparing the baseline, the vaccination, the competition and the pure depletion scenario. We note an overall relevant impact of competition when its effect is incremented (competition scenario), registering a smoothed increase. Furthermore, for R 0 = 3, 5 we observe that the pure depletion and the baseline scenario have different evolution indicating an impact of competition. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/568485 doi: bioRxiv preprint"}