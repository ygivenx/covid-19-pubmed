{"title": "AI-aided design of novel targeted covalent inhibitors against SARS-CoV-2", "body": "The emerging coronavirus SARS-CoV-2 has caused an outbreak of coronavirus example, the recently solved structure of SARS-CoV-2 3CL pro (PDB ID: 6LU7)\n\nindicates that the developed inhibitor N3, 6 which is a covalent inhibitor derived from non-covalent inhibitors against SARS can also bind SARS-CoV-2 3CL pro with a similar binding conformation ( Figure S4 ).\n\nAll the above available information paved a way to design new targeted covalent inhibitors (TCI) 7 against SARS-CoV-2. A successful TCI against 3CL pro must first be able to fit in the binding site of 3CL pro with an appropriate pose that keeps its reactive groups close enough to the Cys145, which then undergoes a chemical step (nucleophilic attack by Cys145) leading to the formation of a stable covalent bond as presented in the scheme below:\n\nTCIs usually have a longer target residence time than the relative non-covalent inhibitors in theory given the following: 1) For the inhibition, k1 must be larger than k2, and thus the non-covalent binding is determined by the equilibrium constant k1/k2; 2)\n\nTCIs have the chemical reaction step with the target, where usually k3 >> k4; and 3) for TCIs, the binding process is controlled by k1 k3/(k2 k4), which is bigger than k1/k2 in non-covalent inhibitors. In some extreme cases k4 = 0, and hence, these irreversible inhibitors covalently bind the target until the target disappears. 7, 8 Considering the inhibitors of SARS 3CL pro may be also bio-active to SARS-CoV-2, we have created a molecular library including all the reported SARS-3CL pro inhibitors (284 molecules) 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29 and we will also add new validated molecular structures into this library with our research progresses. To date, there are no clinically approved vaccines or drugs specifically targeting SARS-CoV-2.\n\nThus, with the hope to discover novel candidate drugs targeting SARS-CoV-2, we combine artificial intelligence (AI) with the structure-based drug design (SBDD) to accelerate generating potential lead compounds and design TCIs. AI, especially deep learning, has been applied in predicting molecular properties 30, 31, 32, 33 and designing novel molecules 34 . Unlike earlier deep-learning molecular design by adding single atom one at a time 34, 35 , our approach explores new molecules by adding a meaningful molecular fragment one by one, which is not only computationally more efficient but also chemically more reasonable. To make our AI model work well, the first step is to prepare the molecular fragment library as shown in Figure 1 . We used our collected SARS-CoV 3CL pro inhibitors (284 molecules) as the initial molecule database targeting SARS-CoV-2 3CL pro . Then, we split this set of molecules into fragments with a molecule weight no more than 200 daltons. Both of the collected inhibitors and the fragments are supplied in https://github.com/tbwxmu/2019-nCov.\n\nThen we applied an advanced deep Q-learning network with the fragment-based drug design (ADQN-FBDD) for generating potential lead compounds. Noted, if researchers have enough experience and internal lead compounds or biased fragments, they can inject all such information into ADQN-FBDD by manually adding the lead compounds and biased fragments to the corresponding files. By using the same fragments directly from existing bioactivate molecules, our ADQN-FBDD agent can easily access the potential chemical space focused on 3CL pro of SARS-CoV-2.\n\nauthor/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint After ADQN-FBDD automatically generated novel compounds targeting this new virus 3CL pro , we obtained a covalent lead compound library with 4,922 unique valid structures. In total, 47 of these compounds were selected with high scores from our AImodel's reward function. Then these molecules were further evaluated by docking and covalent docking studies. The lead compound #46 with a high covalent docking score attracts our attention, which also has a low difference between non-covalent and covalent docking pose among the 47 lead compounds. After carefully checking the lead #46's interaction mode with 3CL pro , we believe there is still much space to optimize lead it. Then we designed a series of derivatives from compound #46 based on our chemical biology knowledge and the structure-based optimization policy. All the generated molecular structures are published in our code library https://github.com/tbwxmu/2019-nCov. We encourage researchers who are interested in finding a potential treatment for this viral infection to synthesize and evaluate some of these molecules for treating COVID-19. The solid lines represent taken actions including the addition/deletion of a different fragment or no modification during each step. The dashed lines represent actions that our reinforcement learning agent considered but did not make. After the first three actions to S1, S2, and S3, the fourth action to S4 was an exploratory action, meaning that it was taken even though another sibling action, the one colored in red author/funder. All rights reserved. No reuse allowed without permission. (Table S1) were kept for the next non-covalent docking and covalent-docking evaluation. These 47 virtual leads display suitable 3Dcomplexity with common characteristics of peptidomimetics and protein-protein interaction (PPI) inhibitors. They are mainly ranked by covalent-docking scores, considering covalent-docking also contains the scores of non-covalent docking. 36 And we also paid attention on the RMSD difference between the covalent binding and noncovalent binding poses based on all heavy atoms. Finally, we selected the lead molecule #46 as displayed in Figure 3 with both a good covalent docking score and a small RMSD value (Table S1 ). We further optimized it and get a series of derivatives based on the SBDD approach.\n\nMolecule #46 was ranked number 1 based on the covalent docking score and its interaction model with the binding site was carefully checked as shown in Figure 3 .\n\nAlthough compound #46 has the best covalent docking score, it has the alerting group aldehyde. Considering there is still much space for compound #46 to fill in the S1'\n\nsubsite and \u03b1-ketoamides may be good to fit the oxyanion hole ( Figure 4A ) of 3CL pro , 3 author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint we replaced the aldehyde by formamide and also replaced the 1,4 Michael acceptors by alpha-ketoamides. Thus, we optimized compound #46 to compound 46-14-1 ( Figure 4 A and B). Figure 3 . Lead compound #46 generated by AI. A: Non-covalent molecular docking model of SARS-CoV-2 3CL pro (brown surface) with the bound lead compound #46 (magenta sticks). The triazole ring binds to the S1 subsite of the catalytic active center, the covalent fragment of \u03b1, \u03b2unsaturated aldehyde binds to S1' subsite, \u03b2-lactam ring binds to S2 subsite and 5,7-dihydroxy chromone binds to S3 subsite. B: A two-dimensional (2D) view of non-bonding interaction of lead compound #46 in complex with 3CL protease based on non-covalent docking. The triazole ring, i.e., keto-amide, phenolic hydroxy forms hydrogen bond (H-bond) with His163, Glu166, and Thr190, respectively. C: Covalent docking model between compound #46 (green sticks) and 3CL protease (brown surface) exhibits a similar docking model as non-covalent docking. D: A 2D view of ligand author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint interaction between compound #46 and protease under covalent docking. The triazole ring forms an H-bond with His163; the fragment of \u03b1,\u03b2-unsaturated aldehyde forms a covalent bond with Cys145, i.e., the key residue in the catalytic center of the protease, resulting in covalent inhibition; aldehyde carbonyl forms an H-bond with His41; and besides, the hydroxyl of chromone at position 7 forms an H-bond with Thr190.\n\nThe non-bonding interaction between compound 46-14-1 and SARS-CoV-2 3CL pro is mainly hydrogen bond. The carbonyl group of covalent scaffold \u03b1-ketoamide forms Hbonds with Leu141 and Gly143 as a hydrogen acceptor or a hydrogen donor. The hydrogen on the nitrogen atom of the triazole ring forms an H-bond with Glu166, while Glu166 also forms an H-bond with the carbonyl group on the main chain. The oxygen in the \u03b2-lactam ring forms an H-bond with His41. In order to enhance the polarity of the compounds, sulfonic groups were introduced to replace the ketone carbonyl groups on the main chain and sulfonamides 46-14-2 were obtained. The covalent docking model of compound 46-14-2 with SARS-CoV-2 3CL pro is shown in Figure 4 C and D.\n\nIn order to make the compound 46-14-2 fit the active pocket with a higher affinity, we added a carbon atom to the sulfonic acid group of the original molecule, extending the carbon chain to increase the flexibility of the molecule, and obtained another optimized compound 46-14-3. The mode of covalent docking with SARS-CoV-2 3CL pro is shown in Figure 5 . Due to the introduction of carbon atoms and the enhancement of molecular flexibility, the \u03b2-lactam ring can be inserted deeper into the S2 pocket and the other fragments of the compound can better adapt to the S1, S1' and S3 subsites. The \u03b1carbonyl carbon on the \u03b1-ketoamide of compound 46-14-3 forms a covalent bond with the key residue Cys145 on the protease, but the main non-bond interaction is still hydrogen bond (indicated by a yellow dash). The triazole ring mainly forms H-bonds with Phe140 and Glu166 residues in the S1 pocket; \u03b1-ketoamide covalent binding fragment mainly forms H-bonds with key amino acid residues Cys145, Gly143 and Ser144 in the S1' subsite, which forms an oxyanion hole in the red circle in Figure 9 ; the \u03b2-lactam side chain mainly forms H-bonds with residues Tyr54 and AsS187 in the author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . S2 pocket; the chromone scaffold mainly forms H-bonds with key residues Thr190 and Gln192 in the S3 pocket. In addition, the oxygen on the sulfonyl group of the main chain forms an H-bond with Glu166 in the S1 pocket. author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint\n\nThe representatives were selected (46-14-1, 46-14-2 and 46-14-3 as Figure 6 displays), which may be further evaluated by molecular dynamics simulation to get the binding free energy and by quantum chemical calculation to get the reaction energy barrier.\n\nMeanwhile, 46-14-1, 46-14-2 and 46-14-3 are chosen as our candidates for chemical synthesis and anti-SARS-CoV-2 activity testing, which is ongoing. The copyright holder for this preprint (which was not peer-reviewed) is the . efficient and effective as ADQN-FBBD is molecular fragment-based growing with the knowledge of chemical reactions, while other models are all atom-based with no rules of chemical reactions at all 34, 38, 39 . 4) ADQN-FBDD is highly flexible and user-friendly for the medicinal chemists, who can easily inject their drug discovery experience into the reward function to guide the novel molecule generation. Our ADQN-FBDD and related pipeline can be used not only for designing anti-COVID-19 drugs but also other structure-based drug discoveries, especially for emerging infetious diseases that require treatments timely.\n\nIntuitively, the problem of chemical structure graph generation is formulated as learning a reinforced agent, which performs discrete actions of chemical reaction-based fragment addition or removal in a chemistry-aware Markov Decision Process (MDP). Ac={At} denotes a set of actions that describe the modification made on the current molecule structure at each time step t. Here, each action can be classified into three author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint categories: fragment addition, fragment deletion, and no modification.\n\nprobability, which specifies the next possible state given the current state and action at time step t. Here, we define the state transition to be deterministic. For example, as Figure 2C indicates S0 to S1, by adding a 1H-1,2,3-triazol-4-yl fragment on S0, the next state S1 will be the new structure of added 1H-1,2,3-triazol-4-yl with a probability of 1.\n\nR is the reward function that specifies the reward after reaching state ', (0,1] is the discount factor and typically \u03b3 = 0.9 in our study. In our framework, the state always has a valid and complete chemical structure at each step as Figure 2C indicates. A reward is given not just at the terminal states, but at each step. Both intermediate rewards and final rewards are used to guide the behavior of the reinforcement learning (RL) agent. So, there is no delayed or sparse reward issue as many other reinforced frameworks suffered. 40, 41 Furthermore, to ensure that the last state is rewarded the most, we use \u03b3 T-t to discount the value of the rewards at state ' . In addition, our reward function can directly integrate the experience of medicinal chemists. For example, given a core of interest, medicinal chemists may add biased fragments of their interests and their input can be used to design a reward function that gives high reward signal values to biased fragments so that ADQN-FBDD may have a better chance to generate the desired structures.\n\nIn our RL framework, the chemical environment receives action at from the agent and emits scalar reward rt and state s ' 3 to the agent as Figure 2A shows. Note that the definition of the environment state is different from the general approach that the environment state is only the environment's private representation invisible to the agent.\n\nWe define the state of the chemical environment s ' 3 as the intermediate generated molecule structure at time step t, which is fully observable by the RL agent. Simply, author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint the environment's state s ' 3 is the agent's state '45 . For the task of molecule generation, the environment incorporates rules of chemistry. In our study, chemistry rules are not only the basic chemical valency, but also the rules about adding and removing the fragments derived from known inhibitors based on chemical reactions.\n\nThe detail information of 45 defined chemical reaction rules is presented in Table S2 .\n\nAs indicated in Figure where < =~8 (? = ) is the expectation within policy \u03c0 on state st taken at and R( E , E )\n\ndenotes the reward at step n. Value function Q \u03c0 (st , at) measures the value of taking action at on state st. V \u03c0 (st ) is the value of being at state st means how good to be in this state. Obviously, V \u03c0 (st ) can be seen as a part of Q \u03c0 (st , at). Then, the rest part from Q \u03c0 (st , at) can be defined as the so-called advantage function A \u03c0 (st , at) 42 as:\n\nIntuitively, the advantage value shows how advantageous selecting the action is relative to the others at the same given state. Then Eqn.\n\n(2) can be rewritten according to Eqn.\n\n(4):\n\nauthor/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint Note that , and come from the dueling Q-network as Figure 7 indicates. |Ac| is the size of action space and '\n\n. To make our RL agent more robust to be more stable learning and to handle the problem of the overestimation of Q-values, double Qnetwork 43 and fixed Q-targets 44 are also incorporated: \n\nwhere, TD is the temporal-difference; '<e 8 is another dueling DQN network as the target network and its parameters ( \u2032, \u2032, \u2032) keep fixed and copy from the dueling DQN author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint 8 every m steps (m=20 as we used). To update the parameters ( , , ) from the dueling DQN as Figure 7 displays, we can train our RL agent by minimizing the loss function:\n\nwhere E is the expectation. As the L2 loss has a disadvantage of the tendency to be dominated by outliers, we use the Huber loss as the loss function o :\n\nPrioritized Experience Replay (PER) 45 is a technique to enable reinforcement learning agents remember and reuse experience from the past, and to replay important transitions more frequently. PER is very useful for replaying some less frequent experiences. Here, we use the same code of \"Prioritized Replay Buffer\" from open AI's gym with version 0.15.4. 46 Finally, our RL agent is the double dueling deep Q learning with fixed qtargets and prioritized experience replay.\n\nThe fragment-based approach to drug discovery (FBDD) has been established as an efficient tool in the search for new drugs. 47 The idea of FBDD is that proper optimization of each unique interaction in the binding site and subsequent incorporation into a single molecular entity should produce a compound with a binding affinity that is the sum of the individual interactions. However, the widely used fragment libraries only consider the diversity of fragments, such as the ZINC fragment database. They have a very low probability to exhibit the desired bioactivity for a given protein.\n\nauthor/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint\n\nTo combine the idea of FBDD with our RL framework, we first collected and built a SARS-CoV-2 3CL pro inhibitor dataset containing 284 reported molecules. Then using the improved BRICS algorithm 48 \n\nStudies have identified various scaffolds or core structures that have privileged characteristics in terms of the activity of a certain target. 49, 50, 51 Core structure selection is the starting point in a scaffold-based drug discovery. Choosing or designing a proper author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint initial scaffold is never trivial, and medicinal chemists may need enough experience to get such a skill. Luckily, there are serval reported privileged core structures targeting SARS M pro . 3, 52 Here, we chose 4-aminopent-2-enal and 3-amino-2-oxobutanal as the starting cores as Figure 8 displays, because both cores have been validated to generate covalent bonds with the Cys145 of SARS or SARS-CoV-2 3CL pro .\n\nMost reported RL methods using the complete structure information of a positive drug or inhibitor as the template, 38, 39 and they design a reward function for the RL agent to learn to regenerate the template structure or generate highly similar structures to the template. This way may be useful in testing the performance of RL methods but not suitable in a real-world drug design because no one knows the complete structural information of the novel molecule. A more practical approach is to learn the structure features of existing drugs or inhibitors to local, focused chemical space for a specific protein target. Instead of simply putting attention on the diversity of molecule structure, we explore the possibility of generating novel molecules based on the existing knowledge. Here, we designed a deep reinforcement learning reward (DRL-reward) function that consists of the final property score, containing specific fragments (CSF) score and pharmacophore score as:\n\nwhere yez represents weight for the quantitative estimate of drug-likeness (QED)\n\nproperty and its default value is 0.1. yez stands for the QED. QED values can range from 0 (all properties are unfavourable) to 1 (all properties are favourable), which are calculated by eight molecular properties. 53 The score function {?\u20ac of containing specific fragments (csf) is:\n\nauthor/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint pocket are shown as surface, which are assigned as S1 (green), S1' (red), S2 (magenta), and S3(cyan). B:\n\nThe key residues of the binding site are displayed by green, red, magenta and cyan lines (S1, S1', S2 and S3). The pictures of the binding site are generated using PyMol ((http://www.pymol.org/).\n\nThe binding site of SARS-CoV-2 3CL pro ( Figure 9 ) is commonly divided into the catalytic activity center (His41 and Cys145, specified as S1') and several subsites, defined as S1 (His163, Glu166, Phe140, Leu141 and Asn142), S1' (His41, Cys145, Gly143 and Ser144), S2 (Tyr54, Asp187, His41, Arg188, His164 and Met49), and S3\n\n(Thr190, Gln192, Glu166, Met165, Leu167 and Gln189). Each subsite may have its own favorable binding fragment. When generated structures (including the intermediates) containing those favorable fragments, {?\u20ac is equivalent to give an additional reward to our RL agent. {zE controls the contribution of the biased fragment to the reward signal and the default value is 0.6. \u017d<'{| stands for how many biased fragments have been matched in one generated structure. 'z'<o is the number of biased fragments defined based on our knowledge learned from related work. y|< author/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the .\n\nrepresents the score function of pharmacophores, which mainly depends on the ligandprotein interaction mode from the crystal structure (PDB ID: 6LU7): y|< ( ) = } 1 \u210e \u210e \u210e \u210e 0 (13) The pharmacophores plot was added in Figure S5 . y|< controls the contribution of the pharmacophore score to the reward and the default value is 0.4.\n\nAs discussed in the above reward design part, our reward function considers the molecular descriptor thresholds (QED>0.1), the defined pharmacophores and biased fragments. In total, 4,922 unique valid structures were automatically generated and all matched the defined rules by using ADQN-FBDD without any pre-training as many other methods need. 35, 40, 41, 54, 55 Next, All the molecules with high deep reinforcement learning scores (DRL score: R(S)>0.6) were kept (47 molecules). Then, these 47 unique molecules were prepared to generate at least 1 conformation with the local energy minimization using the OPLS-2005 force field by the \"ligand prepare\" module of Schr\u00f6dinger 2015 software. The 47 unique molecules generated a total of 163 3D\n\nconformations before docking into the substrate-binding site of SARS-CoV-2 3CL pro .\n\nConsidering the balance between precision and calculation time, the stand-precision (SP) Glide 56 was firstly used to predict the possible non-covalent binding poses in this binding site and the binding site grid centered on the original ligand N3 57 with 20 \u00c5 buffer dimensions. Following this non-covalent docking, we also calculated the covalent docking poses and scores for those 47 molecules. We reordered the docking results mainly based on the covalent docking score and the RMSD value from covalent docking pose to non-covalent (Table S1 ).\n\nauthor/funder. All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint"}