{"title": "The Spatial Resolution of Epidemic Peaks", "body": "Novel respiratory pathogens continue to pose substantial public health challenges, not least because of the risk that large epidemics may overwhelm key health care resources such as vaccination stockpiles and intensive care facilities. Recent epidemics of concern include: SARS [1], influenza [2]\u2013[4], H7N9 [5], [6] and MERS [7], [8]. During an epidemic it is important to accurately predict the impact of the epidemic over different spatial scales, where scale refers to the size of the region being monitored; such as a hospital, city, country or globally. Intervention policies should be defined relative to this spatial scale, for example taking account of how long it will take to vaccinate a whole city or to distribute a treatment country-wide. Those making decisions about intervention strategies need a clear understanding of the underlying epidemic process, so as to anticipate the magnitude and timing of peak incidence at their scale of interest and to effectively control the epidemic.\n\nSpatially explicit transmission models are used frequently to increase understanding of the spread of epidemics caused by pathogens which transmit between individuals close in space. For example: influenza [9]\u2013[11], measles [12]\u2013[14], and smallpox [15], [16] have all been represented by spatially explicit epidemic models. All of these examples can be thought of as metapopulation models in which the population of interest is represented as a collection of sub-populations located in space, for example households [17]\u2013[19], airports (GLEaM [20]) or districts/states [21]. The advantages of these models are that they can capture complicated mobility and mixing patterns and heterogeneous population density, without the complexity of an individual-based model. Also, model output can be easily reported for specific populations, such as counties or cities.\n\nIt is known that heterogeneity both in population density and typical mixing behaviour heavily influence disease spread. Both of these are defined according to the resolution of the population representation, where resolution defines the number and size of the pixels making up the \u201cimage\u201d of the population within the model. A pixel is the smallest single component of an image. A high resolution representation will divide the region into many small pixels; a lower resolution uses fewer, larger pixels (Fig. S1). The resolution chosen is usually decided by the data available: for example, population and travel data may be defined at the ward or county level only. The level of mixing between individuals in distinct pixels is defined by mobility models, these are often fitted to travel data from censuses. Also, sometimes, resolution is limited by computational capacity.\n\nThe concepts in our paper require precise definitions of the terms: scale, resolution and pixel. The literature using these three words is somewhat ambiguous with the terms resolution and scale sometimes used interchangeably. Therefore, for clarity, we have included explicit definitions at first use of the words (above) and in Table 1.\n\nWe implemented a generic metapopulation model with arbitrary spatial resolution (see Methods) varying from approximately  (30\u2033 by 30\u2033, the smallest unit representation) upwards (Fig. S1). We generated a theoretical population density in a region with total population just over 4 million and of size approximately  (49\u00d749 pixels). The region had three \u2018urban\u2019 areas where population density was generated using a 2-dimensional bivariate Gaussian and a \u2018rural\u2019 area, generated from a uniform distribution, Fig. 1G. We used this formulation to simulate the spread of a pathogen representative of influenza, with an SIR-like natural history, assuming that the generation time was 2.6 days and the basic reproductive number  was 1.8. The epidemic was seeded with 10 individuals in a central region (Fig. 1G), simulations were repeated 25 times at each resolution.\n\nThe within-pixel contact rate was fixed for all pixels. Mobility between pixels was represented by a kernel with an offset power function. A kernel defines the relative probability of travelling between two pixels. The offset power function is an adaptation of the gravity model. The gravity model states that an individual's probability of mixing in a pixel different to their home pixel is inversely proportional to the distance apart of the pixels, to some power. The offset power function adds in an offset distance parameter, which means that pixels closer together than this distance mix fully. See Methods for a full definition of the kernel and the resulting mobility model.\n\nInitially we considered three different kernels: we used an offset of 2 km and three different powers giving low, medium and high contact between pixels (the power, , was \u22126, \u22124 and \u22122 respectively), Fig. S2. The highest mobility kernel is in line with kernels fitted to commuter data in the UK and US [9]. However, our review of data on travel patterns found that only 15% of an average individual's journeys are commuting, making up just 19% of the total distance an average individual travels each year [22] (Table S1). Commuting data also excludes key at-risk groups \u2013 the under 17 s and over 70 s \u2013 who have lower mobility travel patterns compared to the 18\u201369 population [22]. Therefore, we explored more restrictive kernels than those estimated using commuting data to reflect shorter distances travelled and lower frequency travel in the most at-risk populations and the regular non-commuting travel of the wider population.\n\nWe confirmed that the overall cumulative attack rate (CAR) for our model was independent of the mobility kernel and the model resolution (Fig. 1A\u2013F). This was by design: the model was constructed such that with the assumption of mass action mobility (the rate of contact between two groups is proportional to the size of each of the groups) the epidemic was identical at every resolution. This means that the next generation matrix at any resolution and for any mobility has the same spectral radius:  was the same at all resolutions and contact levels and the local and global s were the same. A full proof that  was constant with respect to resolution is given in the Text S1 in Supporting Information S1, and is similar to that in Ref [23]. Because  was constant, if the mobility was such that there was contact between every pair of pixels, the final epidemic size was the same across all resolutions and in every pixel. If mobility was restrictive enough that some pixels were never infected the final CAR reflected this restriction. The full proof that attack rates were constant with respect to resolution is in the Text S2 in Supporting Information S1, and is similar to those in Refs [24], [25].\n\nFor the theoretical population density, the existence of a fundamental spatial resolution was apparent: at resolutions lower than this threshold, system-wide peak incidence was substantially over-estimated, obtaining a high peak incidence and fast spread similar to that obtained in a fully mixed model (the lowest resolution). However, at the fundamental resolution and above, consistent estimates of the peak attack rate were obtained (Fig. 1H). This was increasingly evident as mobility became more and more restricted: for the most localised mobility assumptions (low power), peak incidence in the fully mixed case was nearly double that at the highest resolution. At high resolutions, multiple small pixels containing low numbers of individuals and with a high heterogeneity in population size slowed the epidemic spread; resulting in a long epidemic duration and a low peak incidence compared to low resolution model scenarios.\n\nIncreased mobility reduced the effect of resolution on the epidemic trajectory. At medium mobility, peak incidence increased with decreasing resolution but there was no distinct threshold. At the highest mobility, peak incidence was unaffected by resolution: the high level of contact between pixels facilitated the quick spread of the epidemic, indicated by a short epidemic duration and a high peak incidence at every resolution (Fig. 1A\u2013C).\n\nResolution and mobility remained important when the model was constructed with real population densities. We repeated the analysis (using the same three kernels) for four regions selected from LandScan data [26]: Guangzhou, Rio de Janeiro, Delhi and New York (Fig. 2A). The smallest LandScan unit is approximately 1 km2 (30\u2033 by 30\u2033) in size. The effect of resolution was most evident when mobility was more restricted, as with the theoretical population. In Guangzhou, Rio and New York, changing the spatial resolution had a significant effect on the peak incidence when mobility was at a low to medium level, though the effect was less clear in Delhi (Fig. 2B\u2013E). The Delhi region had the largest total population size and the highest mean population density of all regions we considered (Table S2 and Fig. S3). Therefore, even at low mobility the numbers mixing will be relatively high, meaning that the disease spread will not be as restricted as it would be in a less densely populated region.\n\nWe used Latin Hypercube Sampling (LHS) [27] to determine whether the patterns we saw with the illustrative mobility kernels could be generalised within a wider parameter space of mobility functions. We varied the kernel parameters: the power, , between \u22126 and \u22122 (as discussed earlier, this selection gave a wide range of mobility levels) and the saturation distance between 1 and 10 km, choosing from a log scale (so smaller distances are more likely). We tested 50 parameter sets chosen using the LHS technique [27], with 10 separate realisations of each set for each region (variation in results from the stochastic model was low - see confidence intervals for 25 repeats in Fig. 2 for example). Kernels for the 50 sets are plotted in Fig. S4. The LHS results confirmed that the effect of resolution is most important in populations which are less mobile, Fig. 3. As mobility decreased (a combination of the offset and the power in the kernel) the difference in peak incidence between the lowest and the highest resolution increased. This was particularly true in Guangzhou, Rio and New York, but in Delhi the effect was reduced (due to Delhi having a very large population in comparison to the other regions).\n\nRecently it has been suggested that the movement of individuals depends not only on the source and destination cities, but also on the population density of the surrounding area [28]. This model is called the radiation model and has been proposed as a distinct alternative to the gravity model. However, we calculated the actual number of individuals moving between pixels (the flux) and found the radiation model flux to be very close to the offset gravity model of medium mobility, particularly at the highest resolution, Fig. 4. Indeed the radiation model is always bounded by the three gravity models we use and our LHS models explore a large space around these. More generally, gravity-like models have been implemented with a number of different normalisation assumptions, some of which produce population flux patterns very similar to the radiation model [15], [17].\n\nWhen managing epidemics it is desirable to know the size and duration of the epidemic and the magnitude and timing of the peak incidence over the spatial scale of interest [4], [29], [30]. This scale of interest may be a city, a region or a whole country. Resources such as treatment, vaccinations and diagnostic tests will take time to be deployed over this scale and it can take time to develop and generate enough of these resources for the whole affected population [31], [32]. Accurate predictions about the magnitude and timing of peak incidence would greatly enhance the ability of public health officials to effectively limit the impact of epidemics.\n\nWe have shown how the representation of population interactions can impact model estimates of key epidemic outcomes. We examined the effect of the resolution of the population density on the model predictions of epidemic spread over the scale of interest. We refer to resolution as defining the number and size of the individual pixels dividing the region; higher resolution representations use a higher number of smaller pixels. Our results imply that for plausible population densities and mobility patterns, fundamental resolutions exist for specific pathogens such that the detail of the population and their interactions must be represented faithfully if accurate epidemic trajectories are to be estimated.\n\nThe impact of model resolution was clear in models of less mobile populations: our results indicate that at lower mobility, low resolution representations overestimated the peak incidence, obtaining a high peak incidence and fast spread similar to that obtained in a fully mixed model. However, sufficiently high resolution representations gave lower and later peak incidences because of the delaying effect of multiple small pixels. Indeed at low mobility, clear thresholds existed for the resolution of the theoretical population density, such that models with resolutions below the threshold over-estimated the system-wide peak incidence. Similar thresholds existed for real population densities: Guangzhou, Rio, New York and Delhi. Increased mobility reduced the effect of resolution on the epidemic.\n\nThe kernels which were most affected by resolution were those which gave a lower mobility than that identified by commuting data (Table S1). Generally children are considered to cause the majority of transmission of pathogens like flu and measles, because their level of age group assortative mixing is very high [33], [34]. Children also travel less far than working adults [22]. Together, these imply that a kernel for children is likely to be more restrictive than those defined by commuting data alone. Therefore, our results indicate that the correct specification of population interactions and sufficient spatial resolution is particularly relevant for epidemics such as measles and flu - those in which children play a large role.\n\nAlthough we have considered age effects implicitly by including lower mobility levels than are reported for commuting data (Table S1), the explicit representation of age within a similar modelling framework may lead to additional insight. For example, transmission dynamics at different scales may be driven by different age groups: the behaviour of more mobile adults may be disproportionately important in the seeding of nearby pixels. However, the slower than expected within-country spatial spread during 2009 [35] suggests that for pandemic influenza, population sub-groups with reduced mobility likely do define the fundamental resolution.\n\nWe have chosen to represent the real biological process by a high resolution metapopulation model. Although we have not been able to push the model to resolutions higher than 1 km by 1 km, we suggest it is reasonable to assume, for the mobility kernels considered here, that the thresholds observed for peak incidence would not change substantially were we to approach the resolution of an individual-based model.\n\nThe model used here was intended specifically to test only the changing resolution of the disease transmission process. By design we did not want to assume that transmissibility was intrinsically higher or lower in different parts of the population. In future work, we hope to calibrate this model structure using actual disease incidence data and (after a minor modification to the definition of the force of infection) test for the possibility that population density affects transmissibility.\n\nAlthough it is somewhat reassuring that estimates of peak incidence are biased upwards if resolution is too low, the epidemic duration is underestimated. In order to avoid the effects of incorrect model specification, where possible, spatial resolution should be treated in a similar manner to temporal resolution in fixed-time-step models: neither the doubling nor halving of spatial resolution should have a substantive effect on key model outputs.\n\nWe defined a spatially explicit meta-population model as follows (similar to Ref. [21]). A given region of known population density was represented as  pixels, such that each pixel (index ) is the same spatial size but the number of individuals in the pixel () varied according to location. Mixing between and within each pixel was determined by a mobility model, represented by a matrix  such that an entry  was equal to the probability that for an individual from pixel , given that the individual made a contact, this contact was with an individual from pixel  (mobility was defined using a kernel, discussed later).\n\nThe rate at which susceptible individuals in pixel  became infected depended on (1) their risk of infection from those in pixel , (2) the risk of infection from infected individuals in pixel  who travelled to , (3) the risk of infection that susceptible individuals from  encountered when they travelled to . Therefore, the force of infection or the average rate that susceptible individuals in pixel  became infected per time-step was:(1)where  was the total number of pixels and for any pixel ,  was the number of individuals,  was the number of infected individuals and infectious contacts were made with other individuals present in the pixel with rate . Note that  is the same across all pixels; in future it may be of interest to vary the transmissibility across pixels (so  moves into the sum in Eqn. (1) as ).\n\nThe system of difference equations for a pixel  in the stochastic SIR model was (with the condition that all classes hold a whole number of individuals):(2)where  was the number of individuals in pixel , state  (S, I or R) that experienced the event \u2013 infection or recovery \u2013 in time-step . We ignored death in this model as we considered fairly short timescales and a non-fatal strain of influenza.\n\nEach time-step , the number of individuals experiencing each event () that occurred in pixel  and state , with a population  was determined in the following way:\n\nWe used a mobility model to determine the relative frequency of potentially infectious contact. This was represented as a matrix  with entries , defined as the probability that for an individual from pixel , given that the individual made a contact, this contact was with an individual from pixel , so:(3)where  was the total population in pixel ,  was the interaction kernel defining the effect of the distance between pixels  and  on the contact between them. The kernel defines the relative probability of travelling between two pixels and not the absolute flux, similar to [15], [17]. The factor  normalised  and ensured that the rows sum to 1. The matrix  was used in the calculation of force of infection, Eqn. (1).\n\nWe used a variation of the offset power function for the kernel (similar to [9], [15]):(4)where  was the distance below which the kernel function saturated, we used . The power  determined the mixing between pixels, this was varied to give a range of mobilities but was always less than 0.\n\nThe next generation matrix, , for the model with  pixels and force of infection  (Eqn. (1)), can be defined (similar to [21]):(5)where  was the time spent infected (which depended on recovery rate  such that , same for all pixels),  was the number of individuals in pixel , infectious contacts were made with other individuals present in the pixel with rate  and  was the mobility matrix defined earlier. Then  was equal to the spectral radius of this matrix \n[36], [37]. For this model, , i.e.  was independent of resolution and mobility; see Text S1 in Supporting Information S1 for full derivation."}