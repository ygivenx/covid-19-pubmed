{"title": "Spatial and Temporal Algorithm Evaluation for Detecting Over-The-Counter Thermometer Sale Increasing during 2009 H1N1 Pandemic Spatial and Temporal Algorithm Evaluation for Detecting Over-The-Counter Thermometer Sale Increases during 2009 H1N1 Pandemic", "body": "Over the past decades, infectious disease outbreaks routinely devastated the world's urban and suburban population. The release of anthrax in 2001, the Severe Acute Respiratory Syndrome (SARS) outbreaks in 2002, and recent H1N1 swine flu outbreaks in 2009 are examples [1, 2, 3] . Lessons learned from those outbreaks include development of disease specific vaccines and effective outbreak detection algorithms that can be employed in biosurveillance systems [2, 4, 5] .\n\nCurrently, principal approaches for outbreak detection include temporal analysis, spatial analysis and tempo-spatial analysis. Temporal analysis using time series algorithms is a conventional approach due to its simplicity when compared with spatial algorithms, which require additional geographical information. One of the algorithms, the wavelet anomaly detector (WAD) algorithm [4] developed by the University of Pittsburgh, is used in the Realtime Outbreak and Disease Surveillance (RODS) system. It computes a score for each unit (e.g., ZIP code) area based on how many standard deviations that the number of the cases from that area in the most recent day is elevated from the expected, and then reports all the areas with higher-thanthreshold scores. Some other algorithms applying temporal analysis have also been explored in [5, 6, 7] .\n\nIn addition to time series algorithms, researchers have developed spatial and tempo-spatial algorithms to take into account geographical information in the belief that the additional spatial information may lower false alarm rates and better localize outbreaks. There are two approaches for spatial and tempo-spatial algorithms: the frequentist approach and the Bayesian approach. A representative algorithm using frequentist approach is the spatial scan statistic (KSS) developed by Kulldorff et. al. in 1997 [8] , which scans the region of interest for clusters using circular windows of various sizes. Each scanning window may cover a number of ZIP code areas and is considered as a cluster candidate. This frequentist approach uses a likelihood-ratio test, a statistical test used to compare the fit of two models: the null hypothesis (no outbreaks in a region) model and the alternative hypothesis (an outbreak in a region) model, to find a window (cluster) with maximum likelihood ratio. The derivatives of KSS include the elliptic spatial scan statistic and the flexible spatial scan statistic (FSS), which are derived by relaxing the constraint of a circular cluster shape (window) [9, 10] .\n\nA representative spatial algorithm using the Bayesian approach is the Bayesian spatial scan statistic (BSS) developed by Neill et. al. [11] . It computes the posterior probability of the alternative hypothesis H 1 , P(H 1 (S)|Data), in a region S. It creates a conjugate Gamma-Poisson model to compute the posterior probability of having an outbreak in region S. BSS employs a rectangular scanning window (aligning with x and y axes) to search for clusters over a \u00d7 grid covering the whole region of interest. Each window can comprise one or more grid cells and is considered as a potential cluster. The algorithm identifies the outbreak cluster with the highest posterior probability of having an outbreak. Another spatial clustering algorithm recently developed by the authors, the rank-based spatial clustering (RSC), employs a different searching scheme which has been demonstrated to improve computational complexity [12] .\n\nSeveral previous studies have demonstrated that the aforementioned spatial algorithms are able to identify and localize outbreaks and they are preferable in some ways over time series algorithms when applied to different data sources [8, 10, 11, 13, 14, 15] . Nonetheless, those studies, regardless of whether they examined frequentist or Bayesian models, share the same assumption: only one outbreak cluster at a same point in time exists in the entire study region. The fact is that such an assumption may not hold during an outbreak or a pandemic, when disease activities can be found in multiple geographically separate places across a large region.\n\nIn this paper, we studied the applicability of spatial algorithms based on the single outbreak cluster assumption for detecting H1N1 pandemics. The methods section provides 1) a theoretical derivation of the deteriorated performance of the spatial algorithms when the single cluster assumption is no longer true, and 2) an evaluation scheme using real-world OTC data collected from Texas State during April 2009 (the starting period of the H1N1 pandemic) to compare the performance of a spatial algorithm and a time series algorithm. The hypothesis in this paper is that current existing spatial disease detection algorithms cannot detect outbreaks earlier than the time series algorithm if their underlying statistic models have the one-cluster assumption.\n\nThe common statistical models for spatial detection algorithms include the likelihood ratio (used in KSS and FSS) and the Bayesian posterior probability (used in BSS and RSC). Both models presume that there is only one cluster of an outbreak at a time possible within the whole study region [8, 11, 12] . However, this assumption would be violated in circumstances where a disease simultaneously spread from multiple separate geographic areas. In the following, we prove that both models will be defective given the assumption of one outbreak cluster is violated. Table 1 lists the main symbols used in this paper and their respective meanings. \n\nMeaning a region of interest the total observed counts in the entire study region the summed observed counts in the areas within cluster \u2212 the summed observed counts in the areas outside cluster the total expected counts in the entire study region the summed expected counts in the areas within cluster \n\nThe frequentist approach in spatial scan statistics models uses likelihood ratio ( ( )) and pvalue to determine an outbreak region. Equation (1) is the likelihood ratio ( ( )) of having an outbreak in a region against having no outbreak in the entire study region [8] . If ( ) is greater than 1 and its p-value is the most significant in the randomization test, it is likely that the cluster is the one having an outbreak.\n\nUnder the one outbreak cluster assumption, region , with more observed counts due to the outbreak and no outbreaks outside of , is likely to have ( ) \u226b 1 given 1 \u2032 \u2248 0 and 1 \u226b 0 . However, when we consider a scenario where multiple ( ) outbreak clusters are occurring concurrently in several geographically separate regions, we define = \u2044 as the infection rate for each cluster region and = 1, \u22ef , and we assume \u2248 1 for = 2, \u22ef . The likelihood ratio for region becomes close to 1 as the cluster number becomes greater (e.g., \u2192 \u221e) and the outbreak regions become to cover the entire study region, \u2211 =1 \u2192 , as shown in Eq. (2):\n\nEquation (2) shows that given any cluster region with \u2248 1 and a large , the likelihood ratio of having an outbreak approaches 1, which means there is no difference between the nonhypothesis and the alternative hypothesis even though both and 0 are much higher than 1 (e.g., their observed values are much higher than baseline values); consequently, this leads to the incorrect result of no found outbreak instead of multiple probable outbreak clusters.\n\nThe Bayesian approach in spatial scan statistics uses the posterior probability of a region having an outbreak to determine an outbreak region, as shown in Eq. (3), which requires three variables:\n\n( | 1 ( )), ( 1 ( )) and ( ). ( | 1 ( )) in Eq. (4) is the likelihood of the alternative hypothesis ( 1 ( )) (i.e., having an outbreak in region ) based on a Gamma-Poisson model. ( 1 ( )) is the prior probability of having an outbreak in any region , while ( 0 ) represents the prior of having no outbreaks. In our study, we estimated \ufffd 1 ( )\ufffd = 1 \u2044 by assuming a uniform distribution among all possible = |\u0396| regions having an outbreak and used 1 to denote the prior probability of having an outbreak cluster in the entire study region. Given\n\nis computed as the sum of two components: one is the sum of the likelihood of all possible clusters multiplied by their priors \ufffd 1 ( )\ufffd, and the other is the sum of the likelihood of the nonhypothesis multiplied by the prior ( 0 ).\n\nwhere is a constant factor.\n\nWe will focus on the computation of the likelihood ( | 1 ( )) since \n\nIf is large, such as during a pandemic period, the posterior probability 1\u2044 for each examined region would approach zero, which indicates false negatives for outbreaks. Although it is an extreme example, we are addressing the issue of lowered posterior probabilities of outbreak regions due to the violation of one-outbreak-region assumption. Thus, the Bayesian Gamma-Poisson model can be challenged as well.\n\nBeginning infected about 5,000 people [16] . Compared with the previous year, this outbreak provided much stronger signals captured in the CDC seasonal ILI trend (Fig. 1) , thus it was selected as a real-life example to test our hypothesis. We applied BSS (a spatial algorithm) and WAD (a time series algorithm) to detect the significant increase of thermometer sales which may indicate the onset of the H1N1 pandemic that occurred in the state of Texas at the end of April, 2009. The reasons for choosing these two algorithms for this study are 1) BSS is a spatial algorithm preferred over the frequentist algorithms and has been tested and applied in the applications of prospective disease surveillance [11, 13, 17] ; and 2) WAD is a well established time series algorithm which has been evaluated in multiple studies and found favorably compared with other time series algorithms [7, 18] . The goal for these two algorithms in this study is to find emerging clusters of geographic areas having significantly increased thermometer sales which may indicate increased H1N1 infections in the early stage of the pandemic.\n\nIn this study, we used routinely collected over-the-counter (OTC) sales data as the data source for detection of flu outbreaks. Because previous studies from literature have demonstrated that OTC data such as cold remedies and diarrhea remedies sales can serve as good indicators for outbreak detection and are more timely than physician diagnosis, these data were used as an influenza outbreak indicator [19, 20, 21, 22, 23, 24] . We obtained the dataset from the National Retail Data Monitor (NRDM) system [25] developed by the RODS laboratory, which has been collecting OTC sales data from 30,000+ retail stores across the country on a daily basis since 2003. The NRDM classifies each retail product sale into one of twenty three categories, taking into account both purpose of the treatment and consumer age group, such as anti-fever adult or cold relief pediatric.\n\nWe chose to study the data from Texas for the following reasons: 1) Texas is one of the two states (the other is California) where H1N1 pandemic was confirmed and identified in the early stages, 2) Texas shares the longest border line with Mexico, where H1N1 was first identified, and 3) Texas is the 2 nd largest state and it also has the second largest population in the U.S..\n\nAmong the 23 OTC categories NRDM provides, we chose the thermometer sales category as our indicator of the flu outbreak for three reasons. First, the RODS disease surveillance system signaled enormous spikes in the time series data of over-the-counter (OTC) thermometer sales in Texas at the end of April corresponding to the chronology of the 2009 H1N1 pandemic (Fig. 2) . Second, we found a strong correlation (correlation coefficient is 0.91 with 95% confidence interval [0.89,0.92]) between patients with constitutional syndrome visiting emergency departments (EDs) and OTC thermometer sales in Pennsylvania in the past flu seasons as shown in Fig. 3 . Finally, Villamarin et al. also demonstrated high correlation (0.89) between actual and predicted ED visits using thermometer sale data [26] . Although we conducted a retrospective study, a prospective analysis was mimicked by incrementally adding each day's data to the algorithms as during the evaluation period. For each day, the algorithms use previous 730 days to predict the current day's sales and estimate the values of prior parameters (e.g., 's and 's in Gamma distribution used in the Bayesian spatial detection algorithm). In order to define the alert threshold, , used by the detection algorithms, we applied the analysis to each of the 365 days between April 1, 2008 and March 31, 2009 and recorded the highest score for each day. This allows us to calculate the false alarm rate as 365 \u2044 if is the -th greatest in the set of 365 recorded scores. The assumption here is that during the 3-year period before April 1, 2009, there were no H1N1 pandemics. But note that the ignored other strains of flu that did occur in this period will result in an underestimation of algorithm performance. Figure 4 shows the accumulation of confirmed H1N1 cases in Texas after April 23, 2009 (when CDC started counting cases) as posted on CDC's official website [16] . Within about 3 weeks, the H1N1 virus spread quickly and infected more than 500 people in Texas. On the same day, the US Centers for Disease Control and Prevention (CDC) announced that 7 of the 14 Mexican samples contained the same virus strain as that found in California and Texas and suggested that the containment in the USA was \"not very likely\" [28] . Another appropriate date can be considered as the pandemic onset is the date when the first case was confirmed in Texas. Since we are comparing the relative timeliness between different detection algorithms, the absolute difference between each algorithm and the real onset date will not affect our findings.\n\nWe evaluated the Bayesian spatial scan statistic (BSS) and the Wavelet anomaly detection (WAD) algorithms using data from the real OTC thermometer sales data from the 581 ZIP code areas in Texas where reporting stores were located.\n\nWe applied WAD to these 581 ZIP code areas and chose the threshold based on the false alarm rate computed from the training data set.\n\nBSS was applied to the same data sets. We laid a 24x24 grid (576 grid cells) over a Texas state map that included the 581 ZIP code centroids. All of the resulting rectangles, of varying sizes and covering different locations, were examined. The baseline (expected count) for each ZIP code was estimated using a wavelet transform from the previous two years of data (as used in WAD). By assuming a uniform prior distribution, this approach computes the posterior probability of having an outbreak using the Gamma-Possion model we described earlier in the section. The cluster with the highest posterior probability is reported if it exceeds a threshold, which is estimated based on a preset false alarm rate described in the subsection of Study Dataset. We examined the detection timeliness of both the WAD (Wavelet anomaly detector) and the BSS (Bayesian spatial scan statistic) algorithms, respectively. We chose two false alarm rates: one false alarm per two months and one false alarm per month, allowing us to evaluate the two algorithms from a practical perspective as resources are limited to public health officials. The false alarm rate reflects how often an alarm is triggered by chance, assuming that analyses are repeated on a regular basis with a periodicity equal to the specified time interval length, e.g., on a daily basis.\n\nThe results of WAD are illustrated in Fig. 5 and Fig. 6. Fig. 5 shows the number of significantly elevated ZIP code areas in Texas between the April 23 and May 15 in the evaluation period. In addition, Fig. 6 shows the geographical distribution of the ZIP code areas with significantly elevated thermometers sales from April 25, 2009 to April 30, 2009, using the same color scheme to represent the two significance levels. As shown in both figures, the number of significantly elevated ZIP code areas stayed low (less than 20 ZIP codes) before April 27. From our past experience, the spikes shown in these areas probably resulted from an imperfect data collection process or from some other stochastic reasons (e.g., non-continuous data reporting from some stores) since the spikes are distributed randomly and only last for a day (see Fig. 6 (a), 6(b)). However, starting from April 27, 66 ZIP code areas simultaneously signaled alarms. Furthermore, the thermometer sales stayed significantly high for several days, until around May 7, and the number of significantly elevated ZIP codes exceeded 100 on April 29 and April 30 (in Fig. 6 (cf)). More specifically, the same ZIP codes in the counties Nueces, Travis, Bexar, Collin, Dallas and later El Paso, Bowie, Tarrant and Cameron, repeatedly reported significantly elevated thermometers sales within those days. These results suggest that WAD was able to detect the significant increase on April 27, 2009, by identifying 66 ZIP code areas in about 20 counties showing a significantly elevated amount of thermometer purchases from those drug stores under surveillance. BSS, on the other hand, showed different results from WAD when analyzing the same set of data. The first day BSS fired an alarm was April 30, 2009 which was 3 days later than WAD did. It reported a cluster including 409 out of total 581 ZIP codes with the posterior probabilities above the threshold corresponding to one false alarm per month ( Fig. 7(a) ). The cluster was located in the eastern central part of Texas. On the next day, May 1, 2009, BSS fired the 2 nd alarm with a cluster comprising 272 ZIP codes with significance of one false alarm per two months ( Fig. 7(b) ). Fig. 7 shows that the cluster had become more localized and moved to the southeast. However, during the first 6 days of the real outbreak, from April 24, 2009 to April 29, 2009 , BSS did not identify any significant cluster. It is also worth noting that after May 1, although the counts of thermometers sales were still high, BSS did not fire any alarms at all for the rest of days within the evaluation period (except for May 5, when a 3 ZIP code cluster was found but was believed to be a false alarm).\n\nIn the example described above, we found that WAD was able to detect the significant increase of thermometer sales, which may indicate the onset of H1N1 pandemic, 3 days earlier than BSS did. The slow timeliness of BSS in this study compared with WAD can be attributed to the violation of the basic assumption that only one outbreak cluster can occur at the same point in time in different geographic regions. Therefore, in order to rapidly detect a pandemic, such as the 2009 H1N1 flu outbreak, which takes place in multiple distant places in a sudden and simultaneous way, our results show that the spatial models with the one-cluster assumption are not preferred. However, although the time series algorithm, WAD, was able to respond 3 days earlier than the Bayesian spatial algorithm, BSS, which suggests the time series algorithms are more sensitive to pandemic detection, it also has a few drawbacks. Time series algorithms are less robust on noisy data (e.g., caused by imperfect data collection process, etc.) since they signal alarms whenever the deviation of the observed counts from the expected counts in an area exceeds a threshold. Thus, a secondary analysis is recommended to be performed. A secondary analysis may include 1) considering the output for the previous days as well to determine if the newly alarmed areas are correlated with the previous ones; 2) studying if there is a data quality problem that may cause an abnormal increase of sales; and 3) waiting for the outcome from the next time period to make better decision.\n\nIt is also important to address how strong the OTC data used in this study have the signal of real H1N1 pandemic. In the study dataset, the number of thermometer sales is much higher than the number of confirmed cases each day at the end of April. This implies that a big proportion of the elevated thermometer purchases possibly were not due to H1N1 infection but other reasons.\n\nAlthough the literature has shown that OTC data can be used to predict number of cases in Emergency Departments [26] , research on the relationship between OTC sales and medical treatment seeking is still needed especially by the people from the public health or social behavioral fields, such as the study on the relations between hospitality and behaviors during outbreaks [29, 30] . \n\nBoth the experimental data and the applied algorithms limited this study. Our experimental design was restricted to analyzing only one type of data (i.e., the OTC thermometer sales) due to data availability. Some public health organizations or biosurveillance systems, however, may have more than one possible data source (e.g., emergency department patient visits, etc.) available, which to some extent may contain better signals of H1N1 pandemic. Also it would be ideal to analyze multiple states of data and to use ED data to create a better gold standard in terms of deciding outbreak onset period. We hope in the future to use ISDS distribute project data for a larger scale study. Furthermore, the comparison in this study was only performed between one spatial algorithm and one time series algorithm. Evaluation using other algorithms (e.g., moving average, the spatial scan statistic, etc.) would be helpful to support our findings. In addition, this study only used one known H1N1 pandemic to test the performance of the two algorithms; thus confidence interval for timeliness is not available.\n\nWe have conducted a study on the detection of significantly increased thermometer sales which may indicate 2009 H1N1 pandemic in Texas by applying a time series algorithm and a spatial algorithm. Although the spatial algorithm was more robust (fewer false alarms) and informative (suggesting geographical distribution of outbreaks) than the pure time series algorithm, our results suggest that the time series analysis is still desirable in detection of pandemics as it may achieve a more sensitive performance with better timeliness. The use of time series algorithms, therefore, is still necessary for rapid outbreak detection, especially in scenarios where the singlecluster assumption does not hold. Instead of replacing the time series algorithms, we suggest epidemiologists or biomedical informaticians apply time series algorithms as a complement to current spatial algorithms for public health surveillance purposes."}