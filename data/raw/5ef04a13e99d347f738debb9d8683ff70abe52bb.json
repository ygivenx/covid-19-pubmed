{"title": "Comparing viral metagenomics methods using a highly multiplexed human viral pathogens reagent NIH Public Access", "body": "Viral metagenomics characterizes the genetic composition of viral particles enriched from environmental or biological samples. Because of low viral nucleic acid concentrations, genetic characterization first requires non-specific nucleic acid amplification followed by DNA sequencing. Sequencing can be performed by plasmid subcloning and Sanger sequencing or using highly massively parallel sequencing technologies also known as next generation or deep sequencing (Allander et al., 2001; Capobianchi, Giombini, and Rozera, 2013; Delwart, 2013; Delwart, 2007; Mokili, Rohwer, and Dutilh, 2012; Tang and Chiu, 2010) . Viral metagenomics or sequencing of nucleic acids from enriched viral particle preparations has been frequently applied for viral discovery (Chiu, 2013; Delwart, 2012; Lipkin and Firth, 2013) , resulting in the genetic characterization of numerous human and animal viruses (Allander et al., 2007; Allander et al., 2005; De Vlaminck et al., 2013; Grard et al., 2012; Handley et al., 2012; Kapoor et al., 2009; Kapoor et al., 2013; Li et al., 2013a; Li et al., 2013b; Li et al., 2011; Li et al., 2009; Quan et al., 2010; Wylie, Weinstock, and Storch, 2012) but its non-specific nature also endows it with potential as a universal virus detection assay. Viral metagenomics can also be used for detection of contaminating viruses in biological products such as human and animal vaccines (Farsang and Kulcsar, 2012; McClenahan, Uhlenhaut, and Krause, 2011; McClenahan, Uhlenhaut, and Krause, 2014; Onions et al., 2011; Victoria et al., 2010) . The mutation profile and genetic stability of attenuated vaccine viruses such as oral polio vaccine and influenza vaccines can also be tracked by deep sequencing (Bidzhieva et al., 2014; Neverov and Chumakov, 2010) .\n\nAs the cost of massively parallel DNA sequencing continues to fall (Loman et al., 2012; Metzker, 2010; Rizzo and Buck, 2012) , the limitations imposed by data transfer and bioinformatics analyses become more significant requiring increasing computing power. Until the cost of sequencing and bioinformatics become so insignificant that every molecule of nucleic acid in biological samples can be economically sequenced and analyzed, the sensitivity of viral metagenomics for virus detection remains dependent on the methods used for enriching and amplifying viral nucleic acids and the extent of deep sequencing applied to the resulting DNA library.\n\nVirus particle enrichment steps include sample homogenization, filtration, ultracentrifugation, and nuclease digestion of contaminating host and bacterial nucleic acids that dominate in biological samples, in order to reduce the amount of background nucleic acids. Non-specific nucleic acid amplification is also necessary to generate sufficient quantity of DNA in the proper format (flanked by appropriate sequences) for input into different deep sequencing platforms. In this study, a biological reagent generated by mixing numerous human DNA and RNA viral pathogens was used to compare virus particle enrichment, extraction, random amplification, and DNA library preparation methods to compare laboratory methods for viral detection and genetic characterization using deep sequencing.\n\nA biological reagent, expected to contain 25 human pathogenic viruses belonging to two DNA and seven RNA viral families was assembled from clinical specimens and egg-and cell culture-passaged viruses (Table 1) . Before pooling, the clinical specimen, allantoic fluid, and cell culture supernatant were tested positive for corresponding virus. The presence of each virus in the pool was then tested using qPCR using primer pairs targeting different genomes. The qPCR threshold cycles (Ct) below 37 are shown in table 1. Six of the expected 25 viruses were not detected by qPCR. Viral concentrations based on qPCR are only approximate since quantified viral nucleic acids were not used to generate standard viral concentration curves. Multiple aliquots of the reagent were frozen and stored at \u221280 \u00b0C and shipped on dry ice.\n\nThe viral multiplex reagents (200 \u03bcl each) were centrifuged at 12,000\u00d7g for 5 minutes at 8\u00b0C and the supernatants were filtered through a 0.45 \u03bcM filter (Millipore, Billerica, Massachusetts, USA) to remove possible host cellular debris and bacteria. The filtrates were treated with a nuclease mixture of 14U turbo DNase (Ambion, Life Technologies, Grand Island, NY, USA), 3U Baseline-ZERO (Epicentre, Chicago, IL, USA) and 20U RNase One (Promega, Madison, WI, USA) in 1\u00d7 DNase buffer (Ambion, Life Technologies, Grand Island, NY, USA) at 37\u00b0C for 1.5 hour to reduce background nucleic acids from the host cells and bacteria. Viral nucleic acids protected from digestion by viral capsids, were then extracted from ~200 \u03bcl resulting solutions by different methods (Victoria et al., 2008; Victoria et al., 2009 ).\n\nThree methods were used to extract the viral nucleic acids: QIAamp Viral RNA Mini Kit (Qiagen, Hilden, Germany), Maxwell 16 Viral Total Nucleic Acid Purification Kit (Promega, Madison, WI, USA), and Trizol Reagent (Life Technologies, Grand Island, NY, USA). For Qiagen column and Maxwell bead extraction, viral nucleic acids were purified according to the manufacture's instruction. For Trizol extraction, viral RNA and DNA were isolated separately following the manufacture's protocol. The elution volume was 60 \u03bcl of nuclease free water.\n\nViral cDNA synthesis was performed by incubation of 10 \u03bcl extracted viral nucleic acids with 100 pmol of a primer containing a fixed 18 bp sequence plus a random nonamer at the 3\u2032 end (GCCGACTAATGCGTAGTCNNNNNNNNN) at 85\u00b0C for 2 min. Then, 200U SuperScript III reverse transcriptase (Invitrogen, Waltham, Massachusetts, USA), 0.5mM of each deoxynucloside triphosphate (dNTP), 10mM dithiothreitol, and 1\u00d7 first-strand extension buffer were added to the mixture and incubated at 25\u00b0C for 10 min, followed by 50\u00b0C incubation for 1 hour. The 2nd strand DNA synthesis was performed by incubation with 50 pmol of random primer at 95\u00b0C for 2 min, 4 \u00b0C for 2min, and then with 5U Klenow Fragment (New England Biolabs, Ipswich, Massachusetts, USA) at 37\u00b0C for 1 hour. The resulting products were either put into library preparation directly or PCR amplified by using 5 \u03bcl of the RT-Klenow DNA products and 2.5 \u03bcM primer consisting of the fixed 18 bp portion of the random primer (GCCGACTAATGCGTAGTC) with 1U AmpliTaq Gold DNA polymerase (Life Technologies, Grand Island, NY, USA), 2.5mM MgCl 2 , 0.2mM dNTPs, and 1\u00d7 PCR Gold buffer in a reaction volume of 50 \u03bcl. Temperature cycling was performed as follows: 1 cycle of 95\u00b0C for 5 min, 30 cycles of denaturing at 95\u00b0C for 30 sec, 55\u00b0C for 30 sec, 72\u00b0C for 1.5 min (33, 34 ). An additional extension for 10 min at 72\u00b0C was added to the end of the run. The PCR products were purified twice by Agencourt AMPure XP beads (Beckman Coulter, Brea, CA, United States) with 0.8:1 ratio of beads to sample.\n\nThree NGS library preparation methods were explored using Nextera XT DNA Sample Preparation Kit (Illumina, San Diego, CA, USA), TruSeq RNA Sample Prep Kit v2 (Illumina, San Diego, CA, USA), and ScriptSeq v2 RNA-Seq Library Preparation Kit (Epicentre, Chicago, IL, USA) according to the manufacture's protocols with minor modifications. The DNA input for Nextera library preparations was either the RT and Klenow DNA polymerase dsDNA products or that same product following PCR amplification products (Table 2 ). For TruSeq library preparation, the same pre-amplification products nucleic acids were used as input DNA. For ScriptSeq library preparation, 10 \u03bcl of extracted viral nucleic acids were used directly as input and recommended PCR cycles were increased to 25 and 35 to obtain sufficient products for sequencing. The quality of the libraries was assessed by 2100 Bioanalyzer (Agilent Technologies, Santa Clara, CA, USA) and the quantification was estimated by KAPA Library Quant Kit (Kapa Biosystems, Wilmington, Massachusetts, USA) real time PCR following the manufacturer's instructions.\n\nThe resulting libraries of single-stranded DNA fragments were sequenced using the MiSeq Illumina platform and in two multiplexed runs were performed by using 2\u00d7250 cycle MiSeq Reagent Kit v2 (Illumina, San Diego, CA, USA). The different treatments and library preparation methods (Table 2) were distinguished using unique barcodes/indices.\n\nPaired-end reads of 250 bp generated by MiSeq were demultiplexed using vendor software from Illumina. A virus discovery pipeline running on a 32-nodes Linux cluster was used to process the data. Human host reads and bacterial reads were subtracted by mapping the reads to human reference genome hg19 and bacterial RefSeq genomes release 59 using bowtie2 (Langmead and Salzberg, 2012) . Low sequencing quality tails were trimmed using Phred quality score 10 as the threshold. Adaptor and primer sequences were trimmed using the default parameters of VecScreen. Reads were considered duplicates if bases at position 5 to 55 from 5 prime end were identical. One random copy of duplicates was kept. The filtered reads were assembled using a de novo sequence assembler consists of SOAPdenovo2 (Luo et al., 2012) , ABySS (Simpson et al., 2009) , meta-Velvet (Namiki et al., 2012) and CAP3 (Huang and Madan, 1999) . The assembled contigs and singlets were translated and aligned to a viral proteome database (consisting of all annotated full or near full viral genomes) using BLASTx. The significant hits to virus were then aligned to a non-virus-non-redundant (NVNR) universal proteome database using BLASTx. Hits with more significant E-value to NVNR than to virus were removed. A web-based graphical user interface was developed to present users with the virus hits, along with taxonomy information and processing metainformation. The genome coverage of the target viruses were analyzed by Geneious 7 (Biomatters, San Francisco, CA, USA).\n\nTwo MiSeq runs containing 9 and 7 barcodes generated ~9 and ~12 million reads respectively ( Table 2 ). The raw sequence reads were demultiplexed and put through multiple quality filters, leaving a total of ~ 6 million \"usable\" sequence reads, which were then de novo assembled separately for each barcode. The resulting contigs and singlets were then analyzed using BLAST search. In order to avoid misclassification a stringent E-value cutoff of 1\u00d710 \u221210 was used to identify viral sequences related to the 25 viruses expected in the NIBSC reagent and be considered virus hits. The efficiency of different treatments and library preparation methods in detecting these viruses are shown in Table 3 . Other viral hits were regarded as contamination from reagents, laboratory, and the biological samples in the viral pool (clinical specimens and bovine serum) including sequences from picobirnavirus, bocavirus and bovine virus diarrhea viruses. In N225 and N226 libraries 2-3% of all viral hits were to avian leucosis virus, originating from the reverse transcriptase in the ScriptSeq library preparation kit.\n\nIn order to normalize for the variable number of sequence reads with different barcode/index in the multiplexed libraries, a total of 150,000 raw sequence reads were taken randomly from each barcode for the subsequent analyses. The 150,000 raw sequence reads from each multiplexing library were deposited in the *** database under accession number ***.\n\nTo investigate the method reproducibility, three treatment groups in which samples were independently processed in the same manners were compared (Table 3) . Technical replicates were not performed for every combination of variables in Table 2. Out of the 150,000 raw sequence reads, the method N1 and its two replicates, N3 and its one replicate, and N5 and its two replicates had similar percentage of usable and target viral reads (Figure 1 and Table 3 ). The N1/N230/N231 group identified an average of 6.3 viruses (range 4 to 8), N3/N227 group identified an average of 12 viruses (range 11 to 13) and N5/ N232/N233 group identified an average of 15.6 viruses (range 15 to 17)( Table 3 ). The genome coverage of the recovered viruses was also analyzed. The read numbers and genome coverage for human herpes virus 3 (HHV3) and rotavirus (RVA) are shown (Figure 2 ), as these viruses were detected in all of the libraries with relatively high number of reads and represent a large dsDNA genome and a small ssRNA genome). RVA read numbers and genome coverage was higher and more reproducible than HHV3 (Figure 2 ).\n\nFiltration and nuclease treatment is frequently used to enrich viral particles and reduce the background of host and bacterial genetic material (Allander et al., 2001; Thurber et al., 2009; Wommack et al., 2009) . In this study, the effect of filtration and nuclease treatment on yield of viral sequence reads and number of viruses detected was estimated (Table 3) .\n\nWith one variable changing and the other parameters fixed, the effect of filtration was first measured by comparing N1 or N2 (with filtration) vs. N4 or N3 (no filtration). N1 and N4 (no filtration) had 36% and 39% of target/usable virus reads respectively (Figure 1 ). Filtration resulted in only a slight 3-4% decrease in the number of virus reads and in the number of viruses detected (3 fewer viruses) (Figure 1 and Table 3 ). In a similar fashion when the effect of nuclease digestion was compared (N1 vs. N2 and N3 vs. N4), its use decreased the number of virus reads by 11-12% ( Figure 1 ) and a smaller number of viruses were detected (2 and 5 fewer viruses) ( Table 3 ). The HHV3 detected in method N1 through N4 ranged from 836 to 2227 reads, covering 5-9% of the genome, while RVA had 4401 to 9004 reads, covering 62-88% of the genome. Overall only minor differences were seen among the groups with or without filtration and nuclease digestion (Figure 2 ).\n\nThe performance of three extraction methods using Qiagen silica columns, Maxwell silica coated magnetic beads and Trizol, guanidinium thiocyanate-phenol-chloroform extraction on recovering viral sequence reads were compared (Table 3 ). The N5 method detected the highest percentage of the target virus reads (Fig 1) and largest number of target viruses (n=20)( Table 3) . It also generated the highest genome coverage for both HHV3 and RVA (Fig 2) . Silica columns N5 and magnetic beads N1 had similar numbers of HHV3 reads (1600 vs. 1533) but the genome coverage differed greatly (70 vs. 5%) with the magnetic bead-extracted nucleic acids generating reads showing considerable overlaps thereby covering the same limited genomic regions (Fig 3) .\n\nUnlike sequencing plentiful human or bacterial DNA or RNA, amplification is necessary to generate sufficient input DNA when sequencing minute quantities of viral nucleic acids. In this study, the effect of pre-amplification of viral nucleic acids by a random RT-PCR step on subsequent virus detection and genome coverage with the Nextera kit was evaluated. The effects of such pre-amplification were compared using 3 method groups: N1 vs. N12; N3 vs. N32; N4 vs. N42 (Table 3 ).\n\nThe percentage of usable reads out of 150,000 raw reads in all 6 treatments were close (35-42%), but the target virus reads obtained by pre-amplification methods (N1, 36%; N3, 51%; N4, 39%) were much higher than non-pre-amplification methods (N12, 11%; N32, 10%; N42, 11%) (Fig 1) . Despite the higher number of virus reads, pre-amplification resulted in fewer viruses being detected (Table 3 ). The use of pre-amplification methods also resulted in lower genome coverage for HHV3 and similar coverage for RVA (Fig 2) . These results indicate that pre-amplification resulted largely in the generation of more biased genome coverage with near-duplicate reads accumulating over the same region decreasing viral genome coverage.\n\nDifferent DNA library preparation kits are available commercially. Three such kits (Table  3) . Nextera (N227) and TruSeq (N221) used as input pre-amplified DNA were compared. ScriptSeq used viral nucleic acids directly (without pre-amplification) with either 25 (N225) or 35 (N227) PCR cycles during the ScriptSeq library generation. All input nucleic acids were identically treated (without filtration and nuclease digestion). These 4 experiments generated 39%, 36%, 46% and 35% of usable reads. The target virus reads accounted for 45%, 32%, 11% and 10% of the usable reads (Fig 1) . Both ScriptSeq experiments (N225 and N226) detected 20 viruses, while Nextera (N227) and TruSeq (N221) identified 11 and 14 viruses respectively (Table 3 ). ScriptSeq also generated higher genome coverage using fewer virus reads for both HHV3 and RVA (Fig 2) . Thus, despite the lower number of viral reads, ScriptSeq methods were superior in retrieving target viruses and acquiring their viral genomes. TruSeq slightly exceeded Nextera in virus detection and genome coverage.\n\nViral metagenomics provides an effective method to identify any known virus in biological samples and thus has great potential for use in clinical diagnostic and reference labs. The sensitivity of the approach depends on the depth of sequencing and the method used to generate the input DNA libraries. In this study, the impact of four steps used in viral metagenomic library preparations on the detection of different viruses and percentage of genome coverage was compared. -A laboratory assembled biological reagent consisting of a mixture of 25 human viral pathogens was employed. This biological reagent, an important resource for the future comparisons of different viral detection methods, includes large and small viral particles with DNA or RNA viral genomes originating from cell culture supernatants or biological samples. The methodological steps compared were physical and enzymatic enrichment of viral particle-associated nucleic acids using filtration and nuclease digestion, nucleic acid extraction techniques, pre-library random RT-PCR amplification, and different Illumina library preparation methods. Viral enrichment methods including filtration and nuclease treatment slightly decreased the number of virus reads and number of viruses identified. The result with the NIBSC reagent may be due the possible retention of viruses or virus aggregate on the 0.45 \u03bcm filters or the release of nuclease-sensitive viral nucleic acids from virions in the reagent solution. Unlike the sample analyzed in this study the use of filtration and nuclease treatment are considered useful to reduce background host and bacterial DNA for biologically more complex clinical samples such as tissue, plasma, feces, and respiratory secretions (Allander et al., 2001; Delwart, 2007) . The lower efficiency of the Trizol extraction method may be due to the loss of nucleic acids during the interphase collection and precipitation steps. The silica columns yielded the best results despite the known release of background nucleic acids from these columns (Lysholm et al., 2012; Naccache et al., 2013; Naccache et al., 2014) . Preamplification, while increasing the number of viral reads actually decreased genome coverage and number of viruses detected. This observation is due to the generation of many similar reads over the same limited genome region reducing overall coverage. Thus, nonspecific pre-amplification (prior to the PCR required to incorporate Illumina primers) is best avoided when the input DNA (from the initial RT and Klenow steps) is in sufficient quantity for direct library preparation using Illumina kits. Lastly the use of the ScriptSeq kits detected more viruses with greater genome coverage than the Nextera and TruSeq kits despite generating fewer viral reads. This result may also reflect the fewer PCR cycles used in the use of the TruSeq kit resulting in fewer duplicate reads covering the same genome region. The maximum number of viruses detected was 20 out of 25 (N225 and N226) when analyzing a normalized 150,000 reads or 22/25 (N226) viruses when all ~2 million usable reads were included (3 and 4 reads for IFN A H3N2 and PIV3 respectively were detected).\n\nFew studies have measured the efficiency of viral metagenomics relative to PCR. A study by Greninger et al (Greninger et al., 2010) compared Illumina deep sequencing to RT-PCR for the detection of influenza A virus H1N1 in nasopharyngeal swabs. It was shown that deep sequencing detected H1N1 at titers near the detection limit of specific RT-PCR particularly when samples were first treated with DNase prior to extraction, and the percentage of sequence reads was correlated with virus titer (Greninger et al., 2010) . Here, all viruses quantifiable by qPCR with Ct <37 as well as 4 of the 6 viruses not detectable by qPCR were detected by deep sequencing. This result indicates that deep sequencing is a highly sensitive method with the advantage of simultaneously detecting all known viruses. Further studies will be required to compare the sensitivity of viral metagenomics to that of highly optimized clinical PCRs. The sensitivity of viral metagenomics for any specific virus target will also be affected by the quantity of other nucleic acids, both non-viral and from other viruses, which may vary widely between clinical samples.\n\nDefining limits of detection in different types of clinical samples and the ability to quantify viral loads based on viral read numbers will require further studies including appropriate viral spiking studies into biologically more complex samples including tissues, plasma, feces, or respiratory secretions. Because different random amplification methods may show different efficiencies with different types of viral nucleic acids (circular, linear, ss, ds, RNA or DNA genomes) the use of multiple amplification methods may be required to optimize sensitivity for the wide range of possible viral nucleic acids.\n\nThe use of deep sequencing for viral diagnostic purposes will benefit from specimen typespecific protocols to maximally enrich viral nucleic acids. Spiking of diverse biological samples with the multi-virus reagent analyzed -in this study should allow the sensitivity of different methods to be more readily compared. Usable reads and target virus hits in randomized subset data of 150,000 raw sequence reads. Human herpesvirus 3 reads (E value \u2264 1\u00d710 \u221210 ) and genome coverage % (A) and rotavirus A reads (E value \u2264 1\u00d710 \u221210 ) and genome coverage % (B). Effect of extraction method on HHV3 genome coverage. A) Bead extraction N1 methods obtained 1533 HHV3 reads, covering 4.5% of the reference genome. B) Silica column N5 method obtained 1600 reads, covering 69.6% of the reference genome. Assembly to reference genome JQ972913 was done with Geneious 7.0. Different scales are used to show depth of sequencing. Table 3 Heat map of viral reads for target viruses (E-value \u2264 1\u00d710 \u221210 Note: The qPCR Ct values for all the viruses are given for information only and cannot be compared."}