{"title": "211-290 pi", "body": "Thus far, reports of computerisation in clinical virology laboratories have been few. The solutions adopted have used a large computer (Blomberg et al., 1979) or a microcomputer (Ahmed et al., 1989) sited outside the laboratory, or a large computer sited within the laboratory (Habermehl, 1983) . The lirst two alternatives pose difficulties with restriction of access to confidential data, and all three options are expensive and require the de novo generation of a complex software package. We describe a low-cost self-contained data base developed for a large diagnostic virology laboratory using a network of personal computers. The system is physically sited within the laboratory, yet it provides a comprehensive patient and results record and allows standardised hard-copy reporting of results.\n\nThe North Manchester Virus Laboratory provides comprehensive diagnostic virology and chlamydiology services to a population of approximately one million in north and central Manchester.\n\nSeventeen hospitals and approximately 300400 general practitioners submit specimens. In 1991, 52 405 specimens were received, I1 255 for virus detection, 14 595 for chlamydia detection, and 26 555 for virus serology. Tests in routine use include virus isolation in cell culture, respiratory virus antigen detection by immunofluorescence (Morris and Semple, 1990b) , cytomegalovirus immediate early antigen detection (Morris et al., 1987) the polymerase chain reaction for the diagnosis of herpes simplex virus encephalitis adenovirus immune dot-blot (Killough et al., 1990 ) chlamydial isolation in cell culture and immune dot-blot (Mearns et al., 1988) electron microscopy including serotyping of faecal adenoviruses (Wood et al., 1989) rotavirus enzyme-linked immunosorbent assay, hepatitis A, B, C and D virus and human immunodeticiency virus (HIV) serological tests (Morris et al., 1990a) , rubella and toxoplasma screening and serological diagnosis, complement fixation tests, screening for recent B 19 parvovirus infection (Rayment et al., 1990) , and cytomegalovirus antibody tests on organ donors (Morris et al., 1990~) .\n\nAfter receipt the specimen request card follows the specimen round the laboratory.\n\nThis allows a written record to be made on the card of the investigations planned by a senior member of laboratory staff and of the test results.\n\nThe network comprises six work stations each with a keyboard, a visual 219 display unit, and a personal computer (three Vectra CS with 2 megabyte (MB) memory) and one Vectra RS20 with 25 MB memory (Hewlett Packard, Sunnyvale, USA), one V386 with 25 MB memory and one VPC II with 2MB memory (Victor Technologies, Stockholm, Sweden). There are three Epson SQ2500 printers. Long-term data storage is provided by a Hewlett-PackardTM 486/25T tile server, and back up data copies are made on magnetic tape (Inmac, Runcorn, UK) using; tape streamer (Cipher Data Products, Singapore). The software is Paradox 3.0 tailored for its purpose by applications written in the Paradox Application LanguageTM USA). Networking is provided (Borland International, Scotts Val$ by eight-bit cards and uses Netware software (Novell Inc. Utah, USA)\n\nRepetition is avoided by splitting the data into four parts: (1) 'patient': surname, forename, date of birth, sex; (2) 'specimen': laboratory number, specimen type, consultant or general practitioner, hospital, hospital number, ward; (3) 'result': test, virus, result; and (4) 'memo': memorandum related to result. The patient and other data are stored in three linked sets of tables: (1) 'reception': data for each specimen entered when the specimen arrives in the laboratory; (2) 'post': temporary storage for specimen details being transferred from reception into the main tables; and (3) 'main': main storage tables for 'patient', 'specimen', 'result', and 'memo'. The data on the main tables are interlinked (Table 1) . \n\nOn arrival each specimen is given a unique laboratory number in the form X9l/number. X defines the specimen type: I for virus isolation or detection, S for serology, or C for chlamydia isolation or detection. The year is abbreviated as its last two integers (e.g., 1991 as 91). The number is chosen from a consecutive series starting at 1 for the first specimen in each calendar year.\n\nSpecimen details are entered onto a screen (Fig. I) which has fields for surname, forename (or initials), sex (M, F, or ?), date of birth (in day, month, and year format), laboratory number, specimen type, initials of consultant or general practitioner, hospital, hospital number, and ward. If only the age is known, this is entered in the date of birth field and flagged with an 'E' (estimated). The computer then records the date of birth as the first of January in the year of birth. More than one specimen can be entered for the same patient without the need to start a new data entry sequence. Once the specimen data are stored in the 'reception' tables, they are accessible by surname to all terminals in the network. An specimen entry in the 'reception' table may be edited or deleted from only one terminal at a time.\n\nPatient and specimen data in the temporary input 'reception' tables can be transferred to the 'main' storage tables by posting. All specimen records with duplicate numbers are kept within the 'reception' tables. Other specimen data are transferred from the 'reception' to the 'post' tables where matching of each specimen record with data on the 'main' tables is attempted. Any specimen found to have a patient surname, sex and date of birth identical with that of a patient already in the main data base will not be transferred from the 'post' to 281 the 'main' tables, but will be offered to the operator. He or she checks whether the two patients are the same (if necessary by checking the current specimen request card against any previous specimen cards stored in the laboratory tiles). If they are identical the records of the two patients are merged.\n\nThe autoposting programme is designed to run overnight and is the standard method for transferring specimen data from the 'reception' tables to the 'main' tables. Five functions are performed. First, three print-outs of the entries for that day are produced in surname order, one for serology, one for virus isolation, and one for chlamydia detection (Fig. 2a) . These are filed in one of Booth Hall three office day books and used as a back-up to the computer record for the identification of patient entries. These office day books are also used to record by hand the issuing of reports (as a parallel to the results record on the computer) and to detail the subsequent destination of the request card (files or further tests). Second, three other hard copies of the entries for that day are produced in laboratory number order, again one for each specimen category (Fig. 2b) . After filing in one of the three laboratory day books, they are used to provide a back-up to the computer for specimen records. In addition, all results on each specimen are recorded by hand in the relevant laboratory day book to provide a parallel record to the results entered in the computer. Third, all specimen records with duplicate laboratory numbers are left in the 'reception' tables for editing the following morning. Fourth, any specimen record with a match of its patient details with an existing patient record is left in post file for manual posting. All other records are transferred to the 'main' tables. Fifth, back-up copies of the 'main' table are made onto magnetic tape.\n\nResults may be entered for any specimen stored in the 'main' tables. The relevant patient record is retrieved from the 'main' tables using one of the query functions (see below). The format for results entry is 'test, virus, result'. Once a result has been inserted an individualised memorandum may be attached to it. Identical results for a series of specimens with consecutive laboratory numbers can be entered without the need to retrieve all the patient records, and the same result can also be attached to other specimens identified on the basis of a laboratory number even if the result is additional to another result already recorded for that specimen. If, during the entry of a batch of results, a patient record is being altered or having a result attached by another user, the result and the specimen number will be displayed on the screen at the end of the procedure. When a malfunction occurs in a batch results entry procedure, the exercise is abandoned but the operator can begin again from the point where the programme was blocked.\n\nResults can be printed in several report styles, including 'virus, test, and result', messages in words (e.g., 'insufficient specimen', 'possible virus isolated'), or reports of tests on multiple specimens (for examples, see Fig.  3 ). Each report is printed in duplicate, validated by a senior technician, and then handwritten interpretative comments are added by a senior medical or scientific member of staff prior to issue. One copy is sent to the clinician, and one copy is attached to the specimen request card to provide a hard copy for storage. The results for a batch of specimens may be printed immediately after insertion into the 'main' tables using the batch entry method described above. If a problem with the printer arises during a batch print procedure, printing of the results can be reinstated without needing to repeat the results insertion process.\n\nThese produce printed lists of the stored data for internal use within the laboratory.\n\nThe data is selected on date range. There are three programmes. 'Specimen' offers options of surname or laboratory number order and then a range for the date selection. 'Results' includes all tables in the database, the data being presented in surname order and selected on date range. 'Day logs' produces duplicate day logs for a selected date in surname or laboratory number order.\n\nThese programmes allow access to all data on the 'main' tables. The information for each patient is displayed in a format of four levels, patient, specimen, result. and memo (Fig. 4) . Searching for a patient record is by surname and forename or by laboratory number. To exclude a misspelling of the surname entered on the main Antibodies To:- alphabetical list of the surnames of all patients on the data base can be accessed at any point and searched manually in an attempt to identify the patient required.\n\nTest ___________---______-__---_--- _--_-------- --------- -__---_-\n\nDictionary tables hold the reference lists for possible entries of hospital, result, virus, test and report style (for example, see Fig. 5 ). Each list can be accessed as a superscreen when appropriate to the current activity, and a copy printed using the reporting programme.\n\nThe number of specimens received from each hospital between detined dates may be derived. A full range of data editing facilities is available. Patient records belonging to identical patients can be merged if not matched during posting.\n\nThe network is contained entirely within the laboratory.\n\nThere are no outside links, all inputs being from specimen request cards and all outputs through hard copy reports. Reports of human immunodeliciency virus (HIV) antigen and antibody tests are only displayed on the screen or printed when the operator is one of a restricted group of laboratory personnel using a personalised set of passwords. A separate set of report styles for HIV is available (not shown). \n\nOur computer network was designed to achieve certain goals. These were matching new specimens with existing patient records, access to several years stored patient records by name or specimen number, patient confidentiality, and hard copy reporting of a broad range of diagnostic virology tests. Patient matching relies on identity of surname, date of birth, and sex, and has the advantage of an operator check on the match. En retrospect other matching criteria could perhaps have been included as patients whose date of birth is not supplied and misspelt names are not matched. At present duplicate records for the same patient may easily be created, but many are later paired when new and old request cards are matched or when the computer data base is compared with the stored request cards. However, if the matching criteria were more loose than now, much more operator time would be spent rejecting mismatches.\n\nReliable access to several-year patient records has been achieved by using a combination of a high capacity fileserver with a multiread hard disk and magnetic tapes. So far, 3-year records are maintained. The disadvantage of having such as large data base within our current network is slowness of access (up to 1 min to search for a patient record by name). Resolution of this problem will require updating of the personal computers and the current eightbit network cards with more powerful hardware and sixteen-or thirty-two bit network cards.\n\nThe design of our data base, a network of personal computers and a fileserver, means that the hardware can all be sited within the laboratory. Access is restricted to laboratory personnel, with only hard copy external links. The problems of confidentiality posed by using a main-frame (Blomberg et al., 1979) or micro-computer (Ahmed et al., 1989) sited outside the laboratory are thereby avoided, as are the cost of installing a large computer in the laboratory and of developing dedicated software (Habermehl, 1983) . The generation of hard copy reports represents a major labour-saving achievement in a laboratory performing a large number of different tests. Prior to computerisation, our laboratory reports were either hand-or type-written. A photocopy was then sent to the clinician and the original retained in the laboratory files. Now duplicate reports are generated automatically. The availability of a large number of different report styles allows the reporting and printing of virus isolation, serology, and chlamydia detection results using a single report format. Memoranda can be added at the time of report printing, though this facility is currently little used because each memorandum must be typed individually.\n\nWe decided at the outset that retention of a hard copy of all specimen request cards and reports tiled in patient name order was essential. Our view has not changed. Our current hand written request cards often contain much semilegible material which cannot be deciphered immediately. The correct spelling of names may only become apparent after comparison with stored hard-copy records, and clinical details are often only comprehensible to a medically qualified member of staff who cannot check all cards before entry. If inappropriate tests are done or patient records are not paired because of misinterpretation of information on the request card, the oversight is more easily corrected if a hard copy is available. Also the laboratory staff can continue to educate clinicians on the need for accurate, legible information on request cards and the same staff can also learn from their own mistakes. Medicolegal difficulties are much more easily avoided.\n\nWhen the requesting of laboratory tests is computerised in all the hospitals 288 and health care centres we serve, on-line input of specimen and patient details and reporting will be possible. The arguments in favour of retaining hard copy data storage and reporting (e.g., illegible handwritten request cards) will no longer be valid. Our current software is well-suited to interlinking with other computer networks and data bases. If all health care units maintain long-term patient records, we may no longer need our own long-term data storage facilities. On-line access to reliable clinical information enterred by the referring clinician onto a hospital data base linked to our computer network will allow senior staff in the laboratory to validate results on a visual display unit and add interpretative comments before on-line reporting of the results. Automated linking of a report with a particular memorandum or interpretative comment, and use of codes to speed the entry of memoranda and comments, will also be possible. The need for confidentiality will nonetheless remain. On-line test and results requesting must only be available to appropriate health care staff via a set of personalised passwords. Access to HIV requests and results will have to be restricted to senior medical staff by a similar mechanism.\n\nIn the future the facilities of our computer network should be expanded to include automated generation of laboratory work sheets. Currently work sheets are generated manually from lists of investigations hand-written on the specimen request cards. When the network has on-line access to clinical information, automation of this process could save considerable technician time. Other future developments should include greater facilities for the abstraction of data sets for a given time period. Targets include all positive results (helpful for preparing weekly returns to the national epidemiological surveillance centre), all results for a particular test, and all results for a particular virus. Also, simple statistical analyses of these data would be valuable. At present epidemiological research in our laboratory has to be done using manually prepared data (Bates et al., 1993) and statistical analyses performed without use of the laboratory computer.\n\nIn conclusion, we developed a computer network for a large virology laboratory providing a comprehensive range of diagnostic tests. Long-term storage of demographic and results data, retrieval of that data, and hard-copy reporting have been achieved without sacrificing confidentiality.\n\nRelatively simple modifications to the system should allow on-line requesting and reporting, and sophisticated epidemiological analysis of the stored data."}