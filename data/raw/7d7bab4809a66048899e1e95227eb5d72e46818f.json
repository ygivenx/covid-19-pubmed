{"title": "Unifying evolutionary and thermodynamic information for RNA folding of multiple alignments Supporting Information SCFG for the Pfold model", "body": "where r(\u03c3) is the root node of \u03c4 M (\u03c3). Since we are not using the parse tree \u03c4 M (\u03c3) explicitely in the main text, we will write Pr(r(\u03c3), A) as short for Pr \u03c4M (\u03c3) (r(\u03c3), A). \n\nPETfold uses a Nussinov style algorithm to calculate the consensus structure of an alignment with maximal expected overlap. The Nussinov algorithm uses dynamic programming to find the structure with the highest score. Let F (i, j) denote the maximal score of an RNA structure for the sequence s i . . . s j . Thus, we have\n\nwhere s(x i ) (and s(x j )) is the score for a single-stranded position x i and s(x i , x j ) is the score for paired bases x i and x j . In PETfold the single-stranded score of position x i consists of the evolutionary reliability R sg A,T,M (i) and the thermodynamic probability 1 n u q u f \u22121 A (i) over all sequences s u (1 \u2264 u \u2264 n) in the alignment, and the base pair score of the positions x i and x j consists of the evolutionary reliability R A,T,M (i, j) and the thermodynamic probability 1 n u p u f \u22121 A (i,j) . The optimal structure \u03c3 can be reproduced by backtracking from F (1, L) when L is the sequence length. In PETfold, we define ex-over(\u03c3) = F (1, L).\n\nWe present a statistical method to estimate reliability thresholds for conserved functional regions. Single stranded positions and base pair positions are collected that have a high evolutionary reliability. We write down only the base pair part. Single-stranded positions are treated analogously. For this purpose, do the following 1. Generate shuffled alignment A shuffle by shuffling the alignment columns. Then, we generate again the most likely structure under the shuffled alignment, i.e., we generate\n\nThen, we collect all the reliability scores for base pairs that are contained in this structure, and iterate this several times:\n\nFinally, we order them in size p 1 > p 2 > \u00b7 \u00b7 \u00b7 > p |B| and select a significance level \u03b8 (e.g., \u03b8 = 0.01). Then the probability p \u2308\u03b8|B|\u2309 is the base pair probability p threshold such that any base pair\n\nWe applied the previously described stepwise approach on our data set consisting of 46 RNA families. We shuffled for each family 1000 times with a conservative method which mononucleotidely shuffles only columns with the same pattern of gaps and conservation. Then we averaged over the significance values of all families. Using a significance level \u03b8 = 0.01, we got a threshold for high reliable base pairs of p threshold However, the parameter tuning has indicated that the performance of reliability thresholds depend on another parameter (the weighting factor for single-stranded positions \u03b1) which has high impact in the RNA structure prediction of PETfold, and that slightly different reliability thresholds perform better for the data set.\n\nGiven two structures in bracket notation, a more stringent secondary structure evaluation can be carried out by considering all pairs of positions, and evaluate the agreement in their structural notation (i.e., dots, opening and closing brackets) in both structures. For each pair of positions (i, j), there are five possible cases. The two positions can be unpaired (4) or paired with each other (1) . Furthermore, only the left (2) (resp. right (5)) position can have an opening (resp. closing) bracket. Finally, both positions can be paired, but with different partnersi (3).\n\nFormally, we have the following five categories (K = 5): (1) This can be evaluated by the R K correlation coefficient (K = 5) [1] . This correlation coefficient of two assignments represented by two N \u00d7 K matrices of data X and Y is defined as\n\n.\n\nThe covariance between X and Y is defined as the expected covariance between the respective k th columns X k and Y k in the matrices:\n\nwhere X k = (1/N ) N n=1 X nk and Y k are the respective means of column k, and X nk are elements of X. Note that Matthews correlation coefficient (M CC) applies to the two categories (K = 2) base paired (i bp j) and not base paired (i \u00acbp j) for any pair of bases (N = M (M \u2212 1)/2 where M is length of sequence). Correction for sliding base pairing is not used.\n\nWhen extending the consideration of unpaired bases, we obtain R 5 correlation coefficients of PETfold: 0.72, Pfold: 0.58, RNAalifold: 0.65. This evaluation is more strict as the two-category Matthews correlation coefficient. Nevertheless, both evaluations show almost the same differences between the three methods.\n\nSI Table 1 "}