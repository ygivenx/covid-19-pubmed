{"title": "A diagnostic reasoning and optimal treatment model for bacterial infections with fuzzy information", "body": "Two generic reasoning tasks are vital in medical reasoning: diagnostic reasoning and treatment planning. Diagnostic reasoning is the process of reconstructing the past facts from the observed In some clinical cases, various factors may raise the difficulty in reasoning, such as the demographic variances of nosography, the incomplete knowledge of the diseases (e.g. severe acute respiratory syndrome (SARS) in the early 2003), some specific restrictions on estimating relevant parameters of the diseases, etc. In these cases, the clinicians' experiences and judgments may be useful to diagnosis and prescription. Therefore, the site-by-site factors and clinicians' knowledge, which may be expressed as extra constraints in the reasoning systems, need to be integrated into the medical decision support systems. At the same time, owing to the difficulties to estimate the causal effects between possible pathogens and the diseases, the parameters of the knowledge base can be expressed as fuzzy numbers.\n\nConsidering the clinical issues mentioned above, the authors are motivated to develop a reasoning model with the following features.\n\n(i) Complete diagnostic reasoning as well as treatment planning. (ii) Combine the formal knowledge base as well as decision-makers' judgments that present as extra constraints. (iii) Work compatibly with the circumstance where fuzzy information is involved.\n\nIn the following section, the background of this research and the proposed approach will be interpreted.\n\nIn medical informatics and other domains, Bayesian networks [1] [2] [3] [4] [5] [6] [7] [8] [9] [10] and influence diagrams [6, 8, [11] [12] [13] are widely used knowledge representation and decision models under uncertainty. However, there are two limitations of utilizing the above approaches for solving medical reasoning problems:\n\n(i) All associated probabilities are assumed to be crisp. (ii) Difficult to consider the constraints for the relationships among the nodes in Bayesian networks or influence diagrams. (iii) Treatment planning and diagnostic problems are not considered in one paradigm.\n\nThe limitations mentioned above restrict the practical usefulness of medical reasoning on Bayesian networks and influence diagrams in the following facts. First, the conditional probabilities between a node and its parent or children nodes could be fuzzy instead of a crisp numbers, due to the difficulties of learning accurately the cause-effect relationships among the nodes [14] . Second, as a common fact, the experts may have some professional speculations in the form of constraints when reasoning from a Bayesian network or an influence diagram. These constraints could be boundary, dependency, or disjunctive conditions. Third, the investigators of influence diagrams used to maximize the utility functions by node removal processes [11] [12] [13] and ignore diagnostic reasoning tasks. Oppositely, Bayesian networks have been used widely in probabilistic reasoning but lacked the capability to suggest the optimal decision [2, 3, [8] [9] [10] .\n\nThis study proposes an optimization model to make diagnostic reasoning and treatment planning for bacterial infections, where the cause-effect relationships are expressed with an influence diagram and fuzzy data. The input information of the reasoning system are conditional probability distributions of the network model, the costs of the candidate antibiotic treatments, the expected effects of the treatments, and extra constraints regarding belief propagation. Since the prevalence of the pathogens and infections are determined by many site-by-site factors, the decisions involve uncertainty not compliant with conventional approaches. So, we allow the decisions to be made under fuzzy contexts, at which some of the parameters could be fuzzy parameters [14] , and some constraints regarding diagnosis are introduced. When a patient is received, this reasoning system can, based on the present symptoms or bacteriological tests, help the clinician make precise diagnosis at the first decision point, and also supply the suggestions of optimal treatment for the infection. The outputs of the reasoning model are the likelihood of a bacterial infection, the most likely pathogen(s), the suggestion for the optimal treatment, the gain of life expectancy of the patient related to the optimal treatment, the probability of coverage associated with the antibiotic treatment, and the cost-effect analysis of the treatment prescribed. The input-output diagram is depicted in Fig. 1 .\n\nIn the remaining of this article, the design considerations are introduced in Section 3. An influence diagram is used to represent the relationships among the variables relevant to the infections. In Section 4, this study describes the reasoning model and system thoroughly. In Section 5, we implement the diagnostic reasoning and planning problem as an optimization model. The illustration and solutions of this numerical example is given as well. In Section 6, some comments and lessons are given. Finally, we discuss the future extensions in Section 7. \n\nIn this section, the authors will introduce an example of urinary tract infection (UTI), the problem and design goal, and handling the fuzzy information sequentially.\n\nConsider one example of urinary tract infections simplified from Leibovici et al. [5] . As depicted in 4 , tr 5 }, where tr 0 stands for no treatment and tr i = 0 or 1. When tr i = 1, it means that tr i is prescribed; oppositely, tr i = 0 means that tr i is not prescribed. For the efficiency of computation, we allow only one antibiotic drug at one time, which let it possible to formulate this decision problem as a mixed 0-1 integer program. If more than one drug is mixed in the therapy, the mixed treatment will be regarded as another treatment. Notably, this node is a decision node that has effects on the coverage from urinary tract infection. \u2022 Underlying (Underlying): The underlying disorder of the patient, which will be represented by an equivalent base years of the remaining life in this illustrative example. \u2022 Cost (Cost(tr i )): A utility node associated with antibiotic treatments. \u2022 Gain (Gain): The gain in life expectancy obtained by prescribing an antibiotic drug, which is a function of the coverage (Coverage) and the underlying disorder of the patient (Underlying).\n\nEach variable above is characterized by crisp or fuzzy probabilities given the state of its parents. Table 1 The probability distributions of the pathogens and UTI P(+patho 1 ) = 0.1 P(+patho 2 ) = 0.09 P(+patho 3 \n\nFor instance, UTI \u2208 {0, 1} represents the dichotomy between having urinary tract infection and not having one. Also, +uti stands for the assertion UTI = 1 or ''urinary tract infection is present'', and \u2212uti stands for the negation of +uti, i.e., UTI = 0.\n\nDenote Y the random node set of the influence diagram depicted in Fig. 2 . The probability distribution of the random nodes given treatment tr i can be expressed as (3.1):\n\n(3.1)\n\nConsider the conditional probabilities in Table 1 and Table 2 , and the evidence that a patient has suffered from frequent micturition (Sign 2 = 1), flank pain (Sign 3 = 1) and urinary symptoms (Sign 4 = 1), but has not fallen into a suprapubic pain (Sign 1 = 0), Table 2 The conditional probabilities of signs (Sign i ) P(sign 1 | +uti) = 0.6 P(sign 1 | \u2212uti) = 0.01 P(sign 2 | +uti) = 0.9 P(sign 2 | \u2212uti) = 0.10 P(sign 3 | +uti) = 0.6 P(sign 3 | \u2212uti) = 0.05 P(sign 4 | +uti) = 0.8 P(sign 4 | \u2212uti) = 0.05 P(sign 5 | +uti) = 0.6 P(sign 5 | \u2212uti) = 0.10 P(sign 6 | +uti) = 0.7 P(sign 6 | \u2212uti) = 0.01 serum albumin (Sign 5 = 0) or fever (Sign 6 = 0). Denote the evidence set E = {e} = {Sign 1 = 0, Sign 2 = 1, Sign 3 = 1, Sign 4 = 1, Sign 5 = 0, Sign 6 = 0}. We need to solve the following two problems.\n\n(i) Compute the belief distribution of Patho 1 , Patho 2 , Patho 3 and UTI. (ii) Make the suggestion of the optimal treatment based on the information given in Table 3 , assuming the patient with resistance to the antibiotic treatments (Resist = 1).\n\nAt the first decision point, the clinician tends to make the diagnosis without biological test results; that is, the task is reasoning on the subgraph omitting the nodes Test i and simplified as to compute P(y|e), where e stands for an instance of the evidence set E, and Y shrinks as {Patho 1 , Patho 2 , Patho 3 , UTI, Coverage}. This is reasonable because the tests will have no effect on the diagnostic results if they do not provide extra information. If the treatment prescribed at the first time does not work, then some biological tests would be further required. Besides, this model would like to provide the suggestion for the optimal treatment that maximizes the gain of life expectancy and minimizes the total costs.\n\nNotice that some of the parameters in Table 1 are not crisp but fuzzy numbers. Freeling [14] claimed fuzzy probability as an extension of probability theory, which is more promising than possibility and probability theory as the uncertainty mearsure. For instance, P(+uti|+patho 1 , +patho 2 , +patho 3 ) is not a crisp but a fuzzy number, sayx 1 , that is P(+uti|+patho 1 , +patho 2 , +patho 3 ) =x 1 , and is described with a membership function \u00b5x 1 (x 1 ) represented as follows (see Fig. 3 ):\n\nwhere ''|*|'' is the absolute value of a term *.\n\nThe above expression means that the support of x 1 is between 0.6 and 1.0. For example, if x 1 = 0.7, then \u00b5x 1 (x 1 ) = 0.5. If x 1 = 0.8 then \u00b5x 1 (x 1 ) = 1.0, which implies that x 1 = 0.8 is the most confident value. If x 1 \u2264 0.6 or x 1 \u2265 1.0 then \u00b5x 1 (x 1 ) = 0, which is least possible to happen.\n\nFor the fuzzy parameters in Table 1 , we will formulate the membership functions ofx i , i = 1, 2, . . ., 8 .\n\nConsider a membership function \u00b5x(x) of a fuzzy parameterx as portrayed in Fig. 4 . This piecewise membership function is usually expressed as\n\nwhere a j , j = 1, . . ., 5 represents the break points; s i , i = 1, . . ., 4 represents the slopes of the segments. The above expression is not convenient for compu- 4 10( tation. Here, we adopt an efficient way to express a piecewise linear function. Consider the following proposition. Fig. 4 , where a j , j = 1, 2, . . ., m are the break points of \u00b5x(x), and s j , j = 1, 2, . . ., n are the slopes of line segments between a j and a j+1 , \u00b5x(x) can be expressed as the sum of absolute terms [15, 16] :\n\nNow we are ready to express the membership functions of the fuzzy parameters \u00b5x i (x i ) in Table 4 . The readers may find that all the eight fuzzy parameters are triangular fuzzy numbers. However, the membership functions in Table 4 involve absolute terms, which is not convenient for computation.\n\nSince \u00b5x(x) in (3.4) is a function to be maximized, we used the following proposition to linearize the membership functions. Max\n\nwhere d k\u22121 stands for the lower bound of distance between a k\u22121 and a k . For the detailed proof of Proposition 2, please refer to [15, 16] . Now we are ready to formulate the optimization model for diagnosis and treatment planning.\n\nHere we formulate the diagnostic reasoning and treatment planning problems as an optimization model. The objectives of this model are described as follows.\n\nThe objectives of this model are described below.\n\n(i) To maximize the sum of all fuzzy membership functions. That is, we will make the suggestions of optimal treatment under the maximal confidence of the fuzzy information [17] . (ii) To maximize the gain in life expectancy. (iii) To minimize the total costs of the treatments.\n\nIn this problem, the clinician has six candidate treatments to choose, where no treatment is included. We represent each antibiotic treatment as a binary variable tr i (including tr 0 standing for no treatment) and the cost as Cost(tr i ). The total cost is 5 i=0 Cost(tr i ). The objective functions can be expressed as follows:\n\nwhere ''E(*)'' stands for the expectation of a term *. In (4.2), we express the expected gain in life expectancy as a function of Coverage and Underlying. We assume that the underlying disorder and health status can be converted to an equivalent base year, in this case, 35 years, and the gain is a multiple of the base year. This study assumes that, in this clinical case, the patient has the ideal 35 years gain of life expectancy if the probability to recover from UTI is 1. Since the literature [5] shows that oneyear gained in life can be regarded equivalent to $ 55,000, we re-write (4.2) as (4.4) for unit standardization:\n\nSetting that only one treatment can be chosen at one decision point, we can formulate the total cost function as in (4.3) . Notably, the probability of coverage is determined by the resistance of antibiotic treatment (given Resist = 1), the pathogens (Patho j ), and the treatment (tr i ). The reader may refer to their relationships in Table 3 . Defining tr i as a 0-1 variable, the expectation of Coverage, E(Coverage) can be computed as\n\nwhere \u03b1 is the normalizing constant, which will be explained in next subsection. In this optimization program, two categories of constraints must to be satisfied: (1) the constraints for the probability theory, and (2) the extra constraints regarding belief propagation. This optimization model can be implemented with various exact propagation methods. This study does not intend to discuss the details of reasoning algorithms but focus on how to formulate this problem as an optimization model. The interested readers may refer to the literatures [2,3,7-10].\n\nNow we formulate the first category of constraints as y P(y) where \u03b1 is the normalizing constant which ensures that the sum of the probabilities of every instance of y is 1. The constraint in (4.7) regulates the clinician to prescribe only one treatment in the first decision point.\n\nAt the same time, in addition to a given formal knowledge base, the clinicians may have some professional speculations about the features of some nodes and the relationships among them, in some specific diagnostic context. These features and relationships can be identified as the following types of constraints.\n\n(i) Boundary constraints Some posterior beliefs may have upper or lower bounds. For instance, a clinician may speculate that the posterior probability of Patho 3 should be higher than 0.3 but lower than 0.5, which can be expressed as 0.3 \u2264 P(+patho 3 |e) \u2264 0.5 (4.8)\n\n(ii) Dependency constraints The beliefs of some nodes in the belief network may exist mutually dependent relationships. For example, a clinician may presume that the posterior probability of Patho 1 should be some multiple of Patho 3 . Such a relationship is expressed as P(+patho 1 |e) \u2264 0.5P(+patho 3 |e) (4.9)\n\n(iii) Disjunctive constraints Sometimes the disjunctive condition between the nodes may exist. For example, a doctor may estimate that either P(+patho 2 |e) or P(+patho 1 |e)is equal to or less than 0.4, which is expressed as either P(+patho 2 |e) \u2264 0.4 or P(+patho 1 |e) \u2264 0.4 (4.10)\n\nCombining constraints (4.8) and (4.10) into this reasoning system, this optimization program becomes Since the disjunctive constraint (4.10) is a nonlinear constraint, we will linearize it by some 0-1 variables as the following.\n\nwhere \u03b8 1 and \u03b8 2 are 0-1 variables, M is a relatively large number, and \u03b5 is a relatively small positive number. We can check the four possible combinations of \u03b8 1 and \u03b8 2 . (1) \u03b8 1 = 1, \u03b8 2 = 1: (4.12) turns into 0 \u2264 P(+patho 2 |e) \u2212 0.4 \u2264 M and 0 \u2264 P(+patho 1 |e) \u2212 0.4 \u2264 M, which are inactive constraint; (2) \u03b8 1 = 0, \u03b8 2 = 1: (4.12) turns into \u2212M \u2264 P(+patho 2 |e) \u2212 0.4 \u2264 0 and 0 \u2264 P(+patho 1 |e) \u2212 0.4 \u2264 2M, which means that when P(+patho 1 |e) \u2265 0.4, P(+patho 2 |e) must be less than or equal to 0.4; (3) \u03b8 1 = 1, \u03b8 2 = 0: (4.12) works as 0 \u2264 P(+patho 2 |e) \u2212 0.4 \u2264 2M and \u2212M \u2264 P(+patho 1 |e) \u2212 0.4 \u2264 0, which implies that when P(+patho 2 |e) \u2265 0.4, P(+patho 1 |e) must be less than or equal to 0.2; (4) \u03b8 1 = 0, \u03b8 2 = 0: (4.12) becomes \u2212M \u2264 P(+patho 2 |e) \u2212 0.4 \u2264 M and \u2212M \u2264 P(+patho 1 |e) \u2212 0.4 \u2264 M, which are inactive constraints. The third inequalities in (4.12) exclude the combinations when \u03b8 1 = 1, \u03b8 2 = 0 and \u03b8 1 = 0, \u03b8 2 = 0. To summarize, (4.12) implies that either P(+patho 2 |e) \u2264 0.4 or P(+patho 1 |e) \u2264 0.4 must be satisfied.\n\nThe model formulated in the previous section is a multiobjective program, so we adopt the fuzzy approach [18, 19] to solve it. Following the steps described below, the model is solved.\n\nStep 1: Get the ideal solutions of every objective. To obtain the ideal solutions, every objective is optimized independently regardless of other objectives. In (4.11), we maximize z 1 , z 2 , and minimize z 3 individually to acquire their ideal solutions z * 1 , z * 2 and z * 3 , respectively. The ideal values are z * 1 = 8, z * 2 = 1,722,198, and z * 3 = 5000.\n\nStep 2: Get the anti-ideal solution of every objective.\n\nTo obtain the anti-ideal solutions, every objective is computed in the opposite way regardless of other objectives. Now, we minimize z 1 , z 2 , and maximize z 3 to acquire the anti-ideal solutions z \u2212 1 , z \u2212 2 and z \u2212 3 , respectively. The anti-ideal values are z \u2212 1 = 4, z \u2212 2 = 733764.5, and z \u2212 3 = 40,000.\n\nStep 3: Define the membership function of every objective by its ideal and anti-ideal solutions.\n\nWith the ideal and anti-ideal solutions of every objective, we can define their membership functions as follows:\n\nThe membership functions evaluate the degree of fulfillment for every objective.\n\nStep 4: Maximize the minimal membership function of the three objectives. Using Zimmermann's fuzzy approach for multiobjective programs, the model (4.11) can be con-verted into (5.2):\n\nMax \u03bb\n\nwhere \u03bb is defined as \u03bb = min 1,2,3 (\u00b5 z 1 (z 1 ), \u00b5 z 2 (z 2 ), \u00b5 z 3 (z 3 )).\n\nIn ( \n\nThis study will solve (5.3) with LINGO 8.0 developed by LINDO Systems Inc. [21] . LINGO is a software designed to build and solve linear, nonlinear and integer optimization models. LINGO provides an integrated package that includes a language for expressing optimization models, a full featured environment for building and editing problems, and a set of built-in solvers. Part of the LINGO model is listed in Appendix A. LINGO 8.0 solves (5.3) in 1 s and obtains the optimal treatment as tr 1 (tr 1 = 1, tr 0 = tr 2 = tr 3 = tr 4 = tr 5 = 0), the normalizing constant \u03b1 = 303.9275, the optimal minimal membership of the objectives \u03bb = 0.5714, and the likelihood of every pathogens: P(+patho 1 |e) = 0.4000, P(+patho 2 |e) = 0.2916, P(+patho 3 |e) = 0.3606, P(+uti|e) = 0.9430. The suggested optimal treatment results in a probability of 0.8369 to cover from the urinary tract infection, equivalent gain in life expectancy as $ 1,616,259, and the total costs in $ 20,000. Besides, the clinician can make the diagnosis and optimal prescription at the first decision point with an overall confidence of the fuzzy parameters at 0.5978. We also find thatx 4 ,x 7 ,x 8 are referenced significantly apart from the most possible values. It makes sense that, under this reasoning context, the experts need to make some subjective judgment or trade-off between different, even conflicting information sources, which make the fuzzy parameters referenced apart from their most confident values. The detailed solutions and part of LINGO solution report are listed in Table 5 and Appendix B.\n\nDuring the implementation of the reasoning model, the authors find the strength of the optimization model. First, the reasoning system allows the clinicians to combine their special judgments or experiences as extra constraints, which supplement the incomplete formal knowledge. This is useful for some newly discovered disease or infections, and increase the flexibility and robustness for various clinical settings. Second, the model completes two major tasks in medical informatics: diagnostic reasoning and treatment planning simultaneously, which is an important requirement for clinical decision support systems. Third, LINGO provides an efficient computation tool for solving the optimization model, especially when the authors adopt some linearizing techniques to transform the highly nonlinear program. Based on the authors' experiences, LINGO performs better in solving linear programs than in solving nonlinear programs.\n\nHowever, the authors also find several potential challenges in developing the proposed reasoning system. First, as the clinical problems grow larger and more complex, it may be a burden for the clinicians to formulate the model. In some diseases, there may be tens or hundreds of nodes in the networks. The clinicians will have difficulties to estimate the parameters or specify the conditions of their diagnosis and prescription. Therefore, the system needs some experts in knowledge engineering or information management to participate in, which consequently increases the costs to implement. Second, as the scales of network grow larger, belief propagation will be more complicated and time-consuming. Some special techniques for belief propagation may be considered, such as clustering, joint tree decomposition, stochastic simulation, and so on [2, 3, [7] [8] [9] [10] . How to integrate these propagation methods and the optimization model will be a critical issue in implementing the reasoning system. Third, as network structures become huge, implementing the optimization model with LINGO will be fairly challenging. LINGO provides several interfaces with other applications, such as Visual C++, Visual Java, Visual Basic, etc. The system developers can bundle LINGO's functionality into their applications, or call functions from within the LINGO models that were written in an external programming language [21] . It will facilitate generating the codes for LINGO models and importing the input data from other applications.\n\nThe authors suggest several future extensions to this research.\n\n1. Global optimization: Most medical diagnostic problems are highly nonlinear, and the global optimization is difficult to achieve in most cases. The model solvers need some special techniques to search for the global optimum. These optimization techniques can improve the solution quality and reliability of the reasoning model [20] . 2. Integration with other heuristic computation techniques: As the problem and network structure grow complex, some heuristic methods may be needed for belief propagation. The computation efficiency will be improved if the reasoning systems integrate some heuristic techniques, such as stochastic simulation, genetic algorithms, neural network computing, etc.\n\nThe developers can integrate various medical knowledge bases to acquire richer diagnostic references and treatment suggestions, such as from traditional Chinese medicine, western medicine, Indian medicine, and so on. 4. Integrate with regional clinical or medical databases: The reasoning system may raise the feasibility and reliability by integrating local or regional medical databases, which will guarantee more accurate parameter estimation and fitness to different regional diagnostic environments. It is also an important stepping stone to build a complete medical decision support system. "}