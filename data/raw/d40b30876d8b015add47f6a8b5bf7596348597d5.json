{"title": "Modeling transient particle transport by fast fluid dynamics with the Markov chain method", "body": "Exposure to outdoor particles has been linked to various adverse health effects, such as asthma (Pope et al. 2002) and shortened life expectancy (Pope et al. 2009 ). Although people stay indoors for most of their time (Klepeis et al. 2001) , particles that originate outdoors can enter indoor environments through natural ventilation, mechanical ventilation, and infiltration (Chen and Zhao 2011; Chen et al. 2011ab, 2012a Lee et al. 2017; Shi et al. 2017 ). In addition to particles from the outdoor environment, there are many indoor particle sources, such as cigarette smoking (Patino and Siegel 2018) , cooking (Singer et al. 2017; Zhao and Zhao 2018) , human activity (You et al. 2013; Lai et al. 2017) , and chemical reactions (Chen et al. 2012c; Yao and Zhao 2017) . Furthermore, particles exhaled by an infected person can result in the transmission of many airborne infectious diseases indoors, including influenza (Moser et al. 1979) , tuberculosis (Menzies et al. 2000) , measles (Bloch et al. 1985) , and SARS (Yu et al. 2004; Chen et al. 2011c) . In most cases, the particle concentration distribution indoors is non-uniform, and the transport process is transient in nature. Therefore, it is crucial to correctly simulate the transient particle transport in indoor environments that further facilitate the design of indoor airflow, and finally reduce health risks.\n\nWith the development of computational hardware, computational fluid dynamics (CFD) is getting more and more popular tools for simulating indoor airflow and particle transport. For indoor airflow modeling, several studies have systematically evaluated the accuracy and robustness of various turbulence models (Chen 1995; ;\n\nList of symbols C source (n\u00b7\u0394t) source particle concentration at time n\u00b7\u0394t F i i-th component of the body forces g i gravitational component in the x i (i = 1,2,3) direction m number of time steps N i (t) number of particles in cell i at time t p n , p n+1 air pressure at the previous and current time steps P i,i probability of a particle's staying in cell i P nb,i probability of a particle's moving from a neighboring cell to cell i P i,nb probability of a particle's moving out from cell i Wang and Chen 2009 ). All these studies came to the same conclusion, that the RNG k-\u03b5 model is the most robust turbulence model for indoor airflow simulations. For modelling the particle transport, researchers and engineers traditionally used the Eulerian model and Lagrangian model Zhao et al. 2008; Wang et al. 2012; Chen et al. 2013 ). The Eulerian model solves the scalar governing equation to obtain the particle concentration distribution (e.g. Zhao et al. 2009; Seepana and Lai 2012; Li et al. 2012; Chen et al. 2014ab, 2018 , while the Lagrangian model predicts the particle trajectories to reflect the particle movements (e.g. Chao and Wan 2006; Chen et al. , 2015a Zhang and Li 2012) . However, both methods are computational demanding for particle transport calculations. For example, Wang et al. (2012) found that calculating the transient particle concentration distributions in a simple room took more than 60 hours when using the two models. Therefore, it is crucial to develop faster simulation models to facilitate the prediction of transient particle transport indoors. Since both airflow and particle modeling are time consuming, it is worthwhile to accelerate the computing for both aspects. For airflow modeling, the use of fast fluid dynamics (FFD) has been proven to reduce the computing cost in comparison with CFD (Zuo and Chen 2009; Jin et al. 2013; Liu et al. 2016 Liu et al. , 2017 Liu and Chen 2018) . FFD solves the Navier-Stokes equations with a time-advancement and pressure projection method. For example, Liu et al. (2017) reported that FFD saved the computing cost of airflow prediction by 20 times when compared with CFD, with comparable accuracy. For particle modeling, the recently developed Markov chain model does not require iterations in each time step when solving the particle transport equations and was proved to be much more efficient than the Eulerian and Lagrangian models (Chen et al. 2014c; Chen et al. 2015bc; Fontanini et al. 2015 Fontanini et al. , 2017 Mei et al. 2017; Mei and Gong 2018) . For instance, Chen et al. (2015b) applied the Markov chain model to calculate inter-person particle transport indoors and the method was more than 6 times faster than the traditional models. Although FFD and the Markov chain model can accelerate the airflow and transient particle transport calculations, respectively, the combined effects on accuracy and computing cost are unknown. Therefore, this study developed a combined FFD and Markov chain model and evaluated the model in terms of accuracy and computing cost.\n\nThis study considered the time-dependent Navier-Stokes equations for incompressible viscous indoor airflow:\n\nA standard incremental pressure-correction (SIPC) scheme (Goda 1979; Guermond et al. 2006) , which is one of the available velocity-component coupled-projection methods, was applied to solve Eqs. (1) and (2). The SIPC scheme splits Eq. (2) into the following two equations:\n\nThe pressure projection method (Pan et al. 2016 ) substitutes Eq. (4) into Eq. (1) to produce:\n\nThe SIPC scheme first solves Eq. (3), which considers the advection and diffusion terms implicitly and the pressure and source terms explicitly. With the solved intermediate velocity i U * , the SIPC scheme then solves Eq. (5) to obtain the pressure p n+1 . Finally, the SIPC makes a correction to the air velocity using Eq. (4):\n\nTo predict the transport of energy, the corresponding scalar transport equation must be solved:\n\nSince Eq. (7) is a linear partial differential equation, this study solved it iteratively with implicit schemes:\n\nWith the solution of Eq. (8), FFD adopts the Boussinesq approximation (Boussinesq 1903) to simulate the buoyancy effect in the indoor airflow:\n\nThis study applied the renormalization group (RNG) k-\u03b5 model, which is one of the best Reynolds-averaged Navier-Stokes (RANS) turbulence models for predicting the indoor airflow Blocken 2018) , to simulate the turbulence. Again, since the equations for k and \u03b5 are both scalar equations, they are solved in the same way with Eq. (7). The corresponding wall function in OpenFOAM (Jasak et al. 2007 ) was adopted for neat wall treatment. This investigation applied the second order upwind scheme to discretize the convection terms. The CFD simulations adopted the same numerical setup, except used the SIMPLE algorithm to couple the air pressure and velocity.\n\nThe Markov chain model calculates the number of particles in a given grid cell (represented by the subscript i) at the subsequent time (t + \u0394t) on the basis of the Markov chain scheme (Chen et al. 2015b) :\n\nHere, P i,i and P nb,i are called transition probabilities.\n\nOn the basis of the particle mass balance equation, after a certain time interval \u0394t, the probability of particle's remaining in the current cell can be calculated by (Chen et al. 2015b \n\nThus, the total probability of a particle moving out from the current cell i is:\n\nFor a specific neighboring cell j, the probability P i,j was calculated with the airflow rate moving from cell i to cell j:\n\nQ i,nb was the sum of the mean airflow rate (Q mean,i,nb ) and the turbulent fluctuating airflow rate (Q fluctuating,i,nb ). The readers can refer to Chen et al. (2015b) for the calculation details. Please note that in Eq. (10), P nb,i is used instead of P i,nb . Equation (10) also shows that the Markov chain model calculates the number of particles explicitly in each time step, and thus the method can be very fast. The particle number concentration in each cell is:\n\nThis Markov chain model does not consider the inertial effects of the particles, it is supposed to work well for particles with a diameter smaller than 3 \uf06dm (Chen et al. 2015b) . Furthermore, when there is a constant particle source, to reduce the computing cost, the superimposition method can be used to reduce the computing time (Gupta et al. 2011 ). The superimposition method first calculates the particle concentrations C MC (t) by the Markov chain model for a pulse source (duration of one time step \u0394t) with particle concentration of 1 #/m 3 . Then if the real source is constant, the superimposition method divides the source concentration into numbers of pulse sources with duration of one time step (\u0394t). The actual particle concentration can then be calculated by (Gupta et al. 2011) :\n\nThis study implemented the FFD for predicting air distribution and the Markov chain model for predicting particle transport in OpenFOAM (Jasak et al. 2007) , an open-source CFD toolbox. Figure 1 shows the solution flow chart, where \u03c4 is the room time constant (s). The developed solver first conducts FFD simulation for 2\u03c4 to obtain a steady-state airflow, and then it calculates the transition probabilities, which are further used to calculate the number of particles at each time step. \n\nTo validate the accuracy of the developed FFD-Markovchain model, this study applied the model to predict the transient particle transport in two cases (Zhang et al. 2009; Bolster and Linden 2009 ) and compared the predicted results with the experimental data. Besides, to test the efficiency of the FFD-Markov-chain model, this investigation compared its computing cost with the traditional CFD-Eulerian and CFD-Lagrangian models.\n\nThe ventilated chamber in Case 1 is illustrated in The numerical simulation used a grid with 18,009 hexahedral cells according to the grid independence test by Chen et al. (2015b) . For the airflow calculation by FFD, a time step size (\u0394t) of 1 s was used. The room time constant was 135 s. Therefore, the physical flow time for FFD calculation was set at 270 s. For the Markov chain model, this study set \u0394t = 0.01 s (Chen et al. 2015b) . Note that the number of particles injected varied with time; therefore, this study calculated the C MC (t) and, further, the particle concentration C(t) by using the superimposition method (Eq. (15)). For the calculation of C MC (t), the physical flow time was set at 1,500 s, as all of the particles were removed from the room after 1,500 s. In this case, the impact of deposition was not considered according to Zhao et al. (2009) .\n\nTo validate the accuracy of the FFD-Markov-chain model, this investigation compares the predicted particle concentrations with the experimental data as shown in Fig. 3 . The FFD-Markov-chain model correctly predicted the strong initial peak and the relatively weak and delayed peak in particle concentrations at Point 1 and Point 2, respectively. However, as displayed in Fig. 3(b) , the FFD-Markov-chain model over-predicted the particle concentration after the peak in comparison with the experimental data. Interestingly, the over-prediction also occurred for the CFD-Eulerian and CFD-Lagrangian models (Chen et al. 2015c) , which are also included for comparison. Please note that the three sets of simulations adopted exactly the same boundary conditions. The accuracy of the FFD-Markov-chain model was comparable to that of the other two models. The discrepancies between the simulations and experiment may be partially attributed to heat dissipated by the particle counters and the corresponding convective flow.\n\nTo quantitatively compare the accuracy of the FFD-Markov-chain model, this study calculated the normalized By replacing the C exp,i in the denominator by C CFD-Eulerian,i or C CFD-Lagrangian,i , this study also calculated the NRMSD between the predictions by FFD-Markov-chain model and that by the other two models. Table 1 lists the calculated NRMSD for the FFD-Markov-chain model, which confirms that the predictions by the FFD-Markov-chain model agreed well with the experimental data and that by the other two models.\n\nThe chamber studied in Case 2 is illustrated in Fig. 4 (Bolster and Linden 2009) . The chamber had dimensions of 1.3 m \uf0b4 Fig. 4) .\n\nThe numerical simulation used a grid with 53,740 hexahedral cells, according to the grid independence test by Chen et al. (2015b) . For FFD, this study again set \u0394t = 1 s, which was fine enough to capture the flow features. The room time constant was 400 s. Thus, the physical flow time for FFD calculation was set at 800 s. For the Markov chain model, this study set \u0394t = 0.01 s (Chen et al. 2015b ). The physical flow time was set at 1,000 s, which was sufficient for removal of all the particles from the room. Again, this investigation neglected the influences of particle deposition and resuspension for particles with a diameter of 2 \uf06dm (Zhao et al. 2009 ).\n\nThe normalized concentrations calculated from FFD-Markov-chain model were compared with the measured data for Point 1, Point 2, and Point 3 in Fig. 5 . The normalization used the particle concentration at the source. The comparisons at Points 4 and 5 were not presented because both predictions and experimental data exhibit almost zero particle concentrations there. In general, the predictions from the FFD-Markov-chain model matched well with the measured data at the three locations. At Points 1 and 3, the peaks in particle concentration occurred later than that at the 1.4 m location. The predictions by CFD-Eulerian and CFD-Lagrangian models (Chen et al. 2015c) were also provided as references. In general, the FFD-Markov-chain model had the similar performance with the CFD-Eulerian and CFD-Lagrangian models in terms of accuracy. The difference between the predictions and the experimental For Case 2, this study again calculated the NRMSD between the predictions by FFD-Markov-chain model and the experimental data and that by the other two models in Table 2 . The difference between the predictions by the FFD-Markov-chain model and the experimental data was acceptable. The differences between the predictions by the three models were minor. \n\nIn addition to accuracy, computing efficiency is another crucial factor. Note that all the calculations were performed using the same computer under the same conditions. Figure 6 compares the total computing time of the FFD-Markov-chain model with the times required by the CFD-Eulerian and CFD-Lagrangian models. For the first case, the FFD-Markov-chain model took 3.6 min, while the CFD-Eulerian and CFD-Lagrangian models took 20.7 and 501.5 min, respectively. For the second case, the FFD-Markov-chain model took 10.7 min, while the CFD-Eulerian and CFD-Lagrangian models took 83.2 and 578.7 min, respectively. Namely, for the two studied cases, the FFD-Markov-chain model was more than 4 times faster than the CFD-Eulerian model; and more than 50 times faster than the CFD-Lagrangian model. The computing times for the airflow and particle transport calculations were listed in Table 3 . For the airflow calculations, FFD was 5.9 and 12.0 times faster, respectively, than CFD for the first and second cases. For particle transport, the Markov chain model was 4.6 times faster than the Eulerian model for both cases, and 149.7 and 70.7 times faster, respectively, than the Lagrangian model for the first and second cases. In terms of absolute contribution to computing-time saving, the Markov chain model contributed more than FFD, as the transient particle transport calculations required more time than the airflow calculations. In general, the FFD-Markov-chain model took significantly less computing time than the traditional CFD-Eulerian and CFD-Lagrangian models. \n\nSeveral limitations of the FFD-Markov-chain model were identified for further improvement. As to the FFD, this investigation applied the RNG k-\u03b5 model to simulate the turbulence. For simulating more complicated flow such as indoor airflow in an aircraft cabin or outdoor airflow, large-eddy simulation (LES) would be a good choice. However, the integration of LES into FFD has not yet been achieved, and its performance in terms of accuracy and efficiency is unknown. In regard to the Markov chain model, the current version is not able to account for particle deposition, sedimentation, resuspension, and coagulation, etc. If the model is to be applied to more complex indoor environments, these influencing factors should be considered. The implementation of additional functions in the Markov chain model would allow it to compete with the well-developed Eulerian and Lagrangian models.\n\nThis study considered only steady-state airflow, and the time devoted to predicting the airflow was only a small portion of the time spent on predicting the particle transport. Although the FFD model was found to be 7 and 13 times faster, respectively, than the two CFD models, FFD did little to reduce the absolute computing time. However, our next step will be to consider transient indoor airflow, where the computing time for predicting airflow will be comparable to that for predicting particle transport. In that case, the contribution of FFD in improving computation efficiency is expected to be more significant.\n\nThis investigation proposed a combined FFD and Markov chain model for calculating transient particle transport indoors. The FFD-Markov-chain model was implemented in OpenFOAM, an open-source CFD toolbox. The proposed model was validated using the experimental data from the literature. Besides, the computing cost of the proposed model was compared with that of the CFD-Eulerian and CFD-Lagrangian models. The results lead to the following conclusions: 1) The FFD-Markov-chain model can predict transient particle transport in indoor environments with well agreement with experimental data and traditional numerical models. 2) For the two studied cases, the FFD-Markov-chain model was more than 4 times faster than the CFD-Eulerian model; and more than 50 times faster than the CFD-Lagrangian model. "}