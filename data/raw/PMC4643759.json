{"title": "A phylogenomic data-driven exploration of viral origins and evolution", "body": "The origin and evolution of viruses remain difficult to explain. This stems from numerous philosophical and technical issues, including an experimental focus on single genes and consequent failure to take into account the complete makeup of viral proteomes. Perhaps the most challenging problems plaguing the deep evolutionary studies of viruses are the fast evolution and high mutation rates of most viral genes [especially RNA viruses (1)]. This makes it difficult to unify viral families especially using sequence-based phylogenetic analysis. For example, the latest (2014) report of the International Committee on the Taxonomy of Viruses (ICTV) recognizes 7 orders, 104 families, 23 subfamilies, 505 genera, and 3186 viral species (2). Under this classification, viral families belonging to the same order have likely diverged from a common ancestral virus. However, only 26 viral families have been assigned to an order, and the evolutionary relationships of most of them remain unclear. The number of viral families without an order is expected to continuously increase, especially with the discovery of novel viruses from atypical environments, and because genes of many viral families do not exhibit significant sequence similarities (3). In fact, homologous proteins often diverge beyond recognition at sequence level after a relatively long evolutionary time has passed (4). In such cases, traditional sequence-based homology searches [for example, Basic Local Alignment Search Tool (BLAST)] and alignment software perform very poorly. However, the three-dimensional (3D) packing of amino acid side chains in cores of protein structural domains retains its arrangement over long evolutionary periods (5). Because homologous proteins often maintain 3D folds and biochemical properties, they can still be recognized at the structure and function levels (6\u201311). However, given the massive genetic and phenotypic viral diversity, this task has remained a big challenge.\n\nOne scheme for classifying protein domains based on their structural, functional, and evolutionary relationships is the Structural Classification of Proteins (SCOP) database (9). SCOP is considered the \u201cgold standard\u201d in the classification of protein domains with known 3D structures and provides useful evolutionary information on domains grouped into fold families (FFs) and fold superfamilies (FSFs). FFs include domains that are typically more than 30% identical in their sequence composition. In turn, FSFs group FFs with common 3D structural cores and biochemical properties, albeit with low sequence identity (could be <15%). Hence, FSFs are more conserved in evolution and suitable for deep evolutionary comparisons (5, 12). This is demonstrated by the fact that nearly half a million protein sequences in UniProtKB/Swiss-Prot (13) map only to ~2300 FSFs (SCOP 1.75). Empirically, it has been shown that protein structure is at least 3 to 10 times more conserved than sequence (14). Moreover, the conserved 3D core of FSF domains rarely (that is, 0.4 to 4%) evolves by convergent evolution (15). A focus on FSF domains also puts bounds on the molecular diversity of viruses and cellular organisms. This and other advantages (16) make FSF domains reliable phylogenetic characters for evolutionary studies, especially when the focus is to reconstruct the deep evolutionary history of life [as shown previously (5, 17\u201319)].\n\nHere, we analyzed a total of 5080 completely sequenced proteomes from cells and viruses and assigned FSF domains to their proteins using structure-based hidden Markov models (HMMs) defined by the SUPERFAMILY database (version 1.75) (20). The viral data set included 3460 proteomes from 1649 double-stranded DNA (dsDNA), 534 single-stranded DNA (ssDNA), 166 double-stranded RNA (dsRNA), 991 single-stranded RNA (ssRNA) (881 plus sense and 110 minus sense), and 120 retrotranscribing (56 ssRNA-RT and 64 dsDNA-RT) viruses (table S1), whereas the cellular data set included 1620 proteomes from 122, 1115, and 383 organisms from the superkingdoms Archaea, Bacteria, and Eukarya, respectively (table S2). Applying both comparative genomic and phylogenomic strategies, we asked a number of crucial questions: Can we quantify viral diversity? How many unique protein folds exist in the virosphere? What is the predominant direction of gene transfer (cell-to-virus or virus-to-cell)? Are viruses infecting different organisms evolutionarily related? Can we identify protein folds that define viral lineages based on common virion architectures? Are viruses monophyletic or polyphyletic? Where do viruses lie on the tree of life? What were the earliest replicons?\n\nAnalysis revealed that, despite exhibiting high levels of diversity, viral proteomes retain traces of ancient evolutionary history that can be recovered using advanced bioinformatics approaches. The most parsimonious hypothesis inferred from proteomic data suggests that viruses originated from multiple ancient cells that harbored segmented RNA genomes and coexisted with the ancestors of modern cells. We refer to the viral ancestors as \u201cproto-virocells\u201d to emphasize the cellular nature of ancient viruses and to distinguish them from modern virocells that produce elaborate virions [a virocell is any ribocell that, upon viral infection, produces viral progeny instead of dividing by binary fission; sensu (21, 22)]. This implies the existence of ancient cellular lineages common to both cells and viruses before the appearance of the \u201clast universal cellular ancestor\u201d that gave rise to modern cells. According to our data, the prolonged pressure of genome and particle size reduction eventually reduced virocells into modern viruses (identified by the complete loss of cellular makeup), whereas other coexisting cellular lineages diversified into modern cells. The cellular nature of viruses is restored when modern viruses (re)take control of the cellular machinery of modern cells or when they integrate into cellular genomes. The model for the origin and evolution of the \u201cviral supergroup\u201d (a collection of seven viral subgroups defined by replicon type and replication strategy), as described in the Baltimore classification (23), captures the many aspects of viral diversity (for example, host preferences, viral morphologies, and proteomic makeup) and, as we show, is backed by strong support from molecular data.\n\nA total of 1995 significant FSF domains (E < 0.0001) were detected in ~11 million proteins of 5080 proteomes sampled from cells and viruses. A four-set Venn diagram showed that roughly two-thirds of the total FSFs (1279 of 1995) were detected only in cellular proteomes (that is, A, B, E, AB, AE, BE, and ABE Venn groups), whereas the remaining FSFs (716) either were shared between cells and viruses, represented by \u201cXV\u201d Venn groups (that is, AV, BV, EV, ABV, AEV, BEV, and ABEV), or were unique to viruses (V) (Fig. 1A). Viruses shared FSFs with each and every Venn group (that is, there were no zeros), indicating that Venn diagrams can be extended to include four groups, instead of three, without any oddities. The most populated Venn groups of universal FSFs found in both cells and viruses (ABEV) or shared by Archaea, Bacteria, and Eukarya (ABE) had 442 and 457 FSFs, respectively. The large size of the ABEV group, which is one-fifth of the total FSFs (442), suggests the coexistence of ancient viruses and cells, very much like the large size of ABE strengthening the hypothesis of a common origin of modern cells. In turn, FSFs unique to superkingdoms and viruses (that is, A, B, E, and V groups) indicate possible later gains specific for each supergroup. These gains were more common in Eukarya (283 FSFs) and Bacteria (154 FSFs) than in Archaea (24 FSFs) and viruses (66 FSFs) (Fig. 1A). The 66 virus-specific FSFs (VSFs) include domains involved in viral pathogenicity such as binding to host DNA and receptors, manipulating host immune systems, and encapsulating viral genomes with capsid proteins (Tables 1 and 2). VSFs uniquely identify the viral supergroup on a scale comparable to that of Archaea, Bacteria, and Eukarya, each of which also encodes its own set of unique FSFs (Fig. 1A). In fact, VSFs were 2.75-fold greater in number than the number of specific FSFs in Archaea, which is a bona fide superkingdom.\n\nViral genomes often integrate into cellular genomes and contribute proteins to their makeup. These proteins become part of XV Venn groups. To detect such transfers, we looked at the molecular functions of each FSF in every XV group and identified FSFs that were rare in the proteomes of the corresponding superkingdom(s). As a threshold, we selected only those FSFs in the XV groups that were detected in \u22642% of the total number of X proteomes. Using this stringent criterion, we identified 43 additional FSFs that could be potential candidates for VSFs (highlighted in Table 1; see table S3 for percentages). Remarkably, the list includes several proteins critical to viruses, such as components of viral capsid/coat architectures, envelope membranes, and proteins involved in viral entry and cellular attachment. For example, the \u201cGroup II dsDNA viruses VP\u201d FSF [SCOP concise classification string (css) b.121.1], which is the \u201cdouble jelly-roll\u201d capsid fold signature of many dsDNA viruses (3), and the \u201cMajor capsid protein VP5\u201d FSF (e.48.1) of herpesviruses were categorized in the EV group, indicating that these FSFs were shared by eukaryotes and viruses. However, b.121.1 and e.48.1 were detected only in 5 of 383 (1.3%) and in 1 of 383 (0.3%) eukaryotic proteomes that were sampled, indicating a rare presence in eukaryotes. Because both FSFs are components of viral capsids and perform a \u201challmark\u201d viral function, their rare presence in eukaryotes is likely a result of horizontal gene transfer (HGT) from virus to host or a mistake in HMM assignment rather than shared innovation or vertical inheritance. Similarly, the \u201cgp9\u201d FSF (b.32.1) in the BV group helps in T4 bacteriophage attachment to its host, Escherichia coli (24). It was only detected in 1 of 1115 (0.08%) bacterial proteomes that were sampled, again suggesting either virus-to-host HGT or erroneous assignment. Remarkably, 20 of 33 (60.06%) BV FSFs were part of our selection, suggesting that a large number of BV FSFs originated in viruses. Because bacterioviruses are known to mediate gene exchange between bacterial species (25), our finding is biologically significant and less likely attributable to mistakes in HMM assignments. These observations suggest that VSFs are spreading to other Venn groups and that their number is expected to grow once a pool of more diverse viruses is sequenced and HGT-associated relationships are determined. Some of the \u201ccell-only\u201d Venn groups (that is, A, B, E, AB, AE, BE, and ABE) may also be contaminated with viral FSFs because a large number of viral FSFs remain unknown as a result of sampling biases and technical limitations in virus discovery in different species.\n\nAlthough VSFs were detected in all seven viral subgroups, they were mostly specific for them (Table 1). The exception was the \u201cViral protein domain\u201d FSF (b.19.1) shared by dsRNA (rotaviruses), plus-ssRNA (coronaviruses), and minus-ssRNA viruses (influenza viruses) (Table 1). FSF b.19.1 is the \u03b2-sandwich domain in the capsid proteins of bluetongue virus and rotaviruses, where it facilitates virus attachment to the host cell (26, 27). It is also present in the hemagglutinin glycoproteins of influenza viruses, helping recognize the cell surface receptor (28, 29). Thus, it could be a unifying feature of most RNA viruses (read below). Extending the number of VSFs from 66 to 109 by considering the 43 potential VSFs as true VSFs did not change the overall picture (Table 1). Only six additional VSFs were shared by more than one viral subgroup, including mainly viral attachment proteins and envelope glycoproteins [with the possible exception of \u201cBacterial enterotoxins\u201d FSF (b.40.2)]. Some of these could be candidates of virus-to-virus HGT during coinfection of a common host or could be vertically inherited from a common ancestor. Most VSFs were restricted to a single viral subgroup, suggesting that each genome type has evolved different VSFs to successfully carry out its reproductive cycle and that VSFs have evolved rather recently in viral lineages during infection cycles in host cells (confirmed below).\n\nIt is sometimes argued that viral genomes only grow by acquiring genes from their hosts (30, 31). To test whether this argument was supported by proteomic data, we classified viruses (according to their host type) into archaeoviruses, bacterioviruses, and eukaryoviruses, and studied their proteomic composition (Fig. 1B). In all cases, viral proteomes contained three classes of proteins: (i) those for which no structural relative was detected in the HMM library, (ii) those for which homologs existed in cellular proteomes, and (iii) proteins encoding VSFs. Class I proteins with no structural hits represented most viral proteins. Roughly 80% of prokaryotic proteins and 75% of eukaryoviral proteins belonged to this category (Fig. 1B), indicating that we know very little about the structures and functions of most viral proteins. Some of these could be very ancient and thus are no longer detectable by BLAST or structure-based HMMs. In turn, class II viral proteins are composed of FSFs that are also encoded by the proteins of their host cells. These could be either true orthologs or proteins acquired through HGT between cells and viruses. Finally, class III proteins encoding VSFs confirm that genes can originate in viruses and sometimes be transferred to cells, thus becoming class II proteins [a process that is now widely acknowledged by many authors (5, 32\u201335)]. The global nature of viral proteomes must be considered when speculating about viral origins because single-gene analyses do not provide a complete picture of viral evolution.\n\nAnalyses of FSF use (that is, total number of unique FSFs in a proteome) and reuse (total number of FSFs) (Fig. 1, C and D) revealed that giant viruses, such as Megavirus lba and Pandoravirus salinus, overlapped many parasitic and symbiotic microbial species (mostly Mycoplasma and Proteobacteria) (see table S4 for use and reuse values in all proteomes). To confirm and as a control, we plotted FSF use and reuse for viruses and only \u201cfree-living\u201d organisms that eliminated the overlap between large dsDNA viruses and microbial parasites (fig. S1). Giant viruses were not too far away from archaeal species that also have experienced genome reduction in the past (18, 36). The analysis suggests that proteomes of viruses, especially giant dsDNA viruses, are similar in size to many well-known cellular parasites and also share with them a similar lifestyle (that is, benefitting from host resources). This shows that one unifying property for cells and viruses could be common parasitic lifestyle. Because the small proteomes of cellular parasites are likely a result of reductive evolution (37\u201339), it would seem logical to extend this argument to the evolution of the viral supergroup [as previously argued (40\u201342)], albeit cautiously for RNA viruses with small proteome complements (read below).\n\nTo infer the predominant direction of gene transfer (that is, virus to cell or cell to virus), we divided FSFs in each superkingdom into two sets: (i) those shared only with cells and (ii) those also shared with viruses. FSFs specific for each superkingdom (that is, A, B, and E Venn groups in Fig. 1A) were excluded because they represent gains unique to each superkingdom and de facto could not be subject to horizontal transfers unless they were later completely lost from the donor superkingdom. A total of 1022 FSFs were encoded by archaeal proteomes. After the exclusion of 24 Archaea-specific FSFs, 533 (52%) were shared only with Bacteria and Eukarya and 465 (45%) were also shared with viruses. Similarly, of 1535 total bacterial FSFs, 154 were Bacteria-specific, 786 (51%) were shared only with Archaea and Eukarya, and 595 (39%) were also shared with viruses. Finally, eukaryal proteomes encoded a total of 1661 FSFs, including 283 that were Eukarya-specific, 774 (47%) that were shared only with the superkingdoms Archaea and Bacteria, and 604 (36%) that were also shared with viruses. Next, we calculated a fractional (f) value to determine the spread of FSFs in the proteomes of each superkingdom (Fig. 2). The f value gives the spread of each FSF in modern proteomes and ranges from 0 (complete absence in sampled proteomes) to 1 (present in all proteomes).\n\nIn all superkingdoms, FSFs shared with viruses were significantly more widespread in proteomes than those shared only with cells. The median f value in Archaea for FSFs shared only with cells was 0.45, in comparison to 0.59 for FSFs shared with viruses (that is, a 31% increase in spread). Similarly, medians increased from 0.30 to 0.62 (up by 106%) in Bacteria and increased most significantly from 0.39 to 0.93 (up by 138%) in Eukarya (Fig. 2A). Regardless of the numerical differences between superkingdoms, FSFs shared with viruses were significantly more widespread in individual members of each superkingdom. One explanation is that viruses mediated the spread of these FSFs by serving as vehicles of gene transfer. It also suggests that viruses are very ancient and most likely infected the last common ancestor of each superkingdom because viral FSFs were present in a diverse array of cellular organisms ranging from small microbes to large eukaryotes. A breakdown by viral replicon type provided additional insights (Fig. 2B). In Archaea, nearly all of the viral FSFs were well represented in member species. Surprisingly, FSFs shared with RNA viruses were also enriched in archaeal proteomes. Because RNA viruses seemingly cannot carry out a productive infectious life cycle in Archaea (read below), it is unlikely that they picked these FSFs from archaeal hosts through HGT. In turn, it is more likely that RNA viruses infecting different superkingdoms share FSFs that were retained during their evolution from ancient cells. Similar patterns were also seen in bacterial proteomes (Fig. 2B). Remarkably, FSFs shared with each viral replicon type were almost universal ( f approaching 1) among members of the Eukarya superkingdom. As we will now show, this is consistent with Eukarya hosting a large number of viruses from each replicon type.\n\nWe calculated the \u201cvirus count\u201d for each replicon type in major host groups to determine the virus-host relationships of viruses in our data set (Fig. 3A). The exercise revealed that most RNA viral subgroups were exclusive to eukaryotes (for example, minus-ssRNA and retrotranscribing viruses) (Fig. 3A). In turn, a large number of DNA viruses (mostly Caudovirales) infected prokaryotic hosts. The bias in the distribution of replicon types in superkingdoms (that is, DNA viruses in prokaryotes and RNA viruses in eukaryotes) leads to an interesting possibility about the early origin of RNA viruses and their loss in prokaryotes [see Discussion (43)]. Virus-host relationships have been described in detail previously (43\u201345). Here, the more relevant question was asked: Do viruses infecting distantly related hosts share common protein folds? To answer, we generated a Venn diagram describing viral FSF repertoires. FSFs that were shared by archaeoviruses (a), bacterioviruses (b), and eukaryoviruses (e) were pooled into the abe Venn group; those shared by viruses infecting two different superkingdoms were pooled into the ab, ae, or be group; and those unique to viruses infecting a single superkingdom were pooled into the a, b, and e groups (Venn group nomenclature avoids ambiguity with that of Fig. 1A) (Fig. 3B). We stress that FSFs in the abe group do not mean that these were present in a virus capable of infecting Archaea, Bacteria, and Eukarya. To date, no virus is known to infect organisms in more than one superkingdom. Instead, it simply refers to the count of FSFs that were shared between archaeoviruses, bacterioviruses, and eukaryoviruses.\n\nWe discovered that viruses infecting species in each of the three superkingdoms shared a total of 68 FSFs (Fig. 3B, abe group). A closer inspection revealed that these FSFs performed crucial metabolic functions (table S5) and were widespread in cellular proteomes (f > 0.75) (Fig. 3C). These FSFs originated very early in evolution (fig. S2, abe group) and were detected in a large number of viruses from each replicon type (Fig. 3C). In fact, 19 abe FSFs (28%) were shared by two or more viral subgroups. It is often argued that, because viruses infect all species, they must have originated before modern cells. Here, we show that viruses infecting the three superkingdoms have a very large and conserved structural core that is particularly enriched in crucial metabolic functions believed to be very ancient. This is a strong indication of both the ancient origin of viruses and their coexistence with ancient cells. An alternative explanation could be the transfer of these FSFs from modern cells to viruses through HGT. However, viruses do not infect hosts separated by large evolutionary distances [Fig. 3A; see also (44)]. Still these FSFs were detected in seemingly unrelated viruses. Moreover, roughly similar patterns were also observed for the ab, ae, and be FSFs (Fig. 3C and table S5). This greatly reduces confidence in cell-to-virus HGT because the probability of a large number of similar HGT events occurring in very different environments (that is, different hosts and viruses) is very unlikely.\n\nHowever, a minor role for HGT cannot be ruled out. In fact, FSFs in a, b, or e Venn groups could be more influenced by HGT because they represent viruses infecting only a single superkingdom. For example, five FSFs that were detected only in archaeoviruses (Fig. 3B, a group) [\u201cAda DNA repair protein, N-terminal domain (N-Ada 10)\u201d (g.48.1), \u201cAn anticodon binding domain of class I aminoacyl-tRNA synthetases\u201d (a.97.1), \u201cCarbamoyl phosphate synthetase, small subunit N-terminal domain\u201d (c.8.3), \u201cArfGap/RecO-like zinc finger\u201d (g.45.1), and \u201cHypothetical protein D-63\u201d (a.30.5) FSFs (table S5)] appear more \u201ccellular\u201d than \u201cviral\u201d in nature. Here, the possibility that archaeoviruses picked these FSFs from archaeal hosts during infection cannot be ruled out with confidence. These FSFs were, however, more widespread in bacterial and eukaryal proteomes than in archaeal proteomes but were absent in their respective viruses (Fig. 3C). This could be a result of the loss of viral lineages from Bacteria and Eukarya or from reductive evolution in Archaea itself (18, 36), which would again negate HGT. In turn, b and e FSFs were more represented in bacterial and eukaryal proteomes, respectively (as expected), and did not have very high f values (Fig. 3C). Specifically, 198 FSFs unique to bacterioviruses could be a result of HGT in either direction in Bacteria and viruses, especially because bacterioviruses are known to mediate gene exchange between bacterial species (for example, the 60% BV FSFs that could be potential VSFs; Table 1) and most of these FSFs originated very late in evolution (fig. S2, b group). Similar patterns were also observed for e FSFs (fig. S2, e group). Finally, only two FSFs [\u201cDNA polymerase \u03b2, N-terminal domain\u2013like\u201d (a.60.6) and \u201cAlkaline phosphatase\u2013like\u201d (c.76.1)] were shared by archaeoviruses and eukaryoviruses (ae). This is in line with previous understanding that eukaryoviruses are very distinct from archaeoviruses (46) and challenges the concept that eukaryoviruses originated from the merging of prokaryotic viruses [for example, (45); see Discussion]. In summary, the evolution of viruses follows a bidirectional route influenced by both the vertical inheritance of a structural core present in many distantly related viruses (that is, those infecting more than one superkingdom) and the HGT of FSFs from modern cells. The common core includes proteins mainly of cellular origin that likely originated in ancient cells.\n\nViruses infecting different organisms often use conserved 3D protein folds to produce capsids and show striking similarities in their virion architecture. These observations have led to the proposal of a structure-based viral taxonomy (47). Now, four major viral lineages have been defined mainly for icosahedral viruses (the most commonly seen capsid symmetry): \u201cpicornavirus-like,\u201d \u201cPRD1/adenovirus-like,\u201d \u201cHK97-like,\u201d and \u201cBTV-like\u201d (47). These lineages capture many viral families and attempt to simplify the overall diversity of the virosphere. Member viruses of the PRD1/adenovirus-like (characterized by the double jelly-roll fold) and HK97-like lineages infect species in the three superkingdoms, suggesting their ancient origin before the divergence of modern cells (47). To test this classification and to determine how the signature FSFs of each lineage distributed in our data set, we identified 22 capsid/coat\u2013related FSFs using a keyword search of \u201ccapsid\u201d and \u201ccoat\u201d in SCOP 1.75 and in the literature (Table 3). Member FSFs of each major lineage, along with their abundance in cellular proteomes, are listed in Table 3. The HMM-based computational approach quickly reproduced the four major capsid-based viral lineages along with proposals for additions to some lineages (for example, negative-sense RNA viruses in picornavirus-like lineage) (table S6). Only very few members were missing (table S6), which could be a result of using a stringent criterion in assigning FSFs to viral proteins (E < 0.0001) that likely missed some hits but also protected from false-positive assignments. In short, FSFs identified in our study could be used as bait for quick assignment of viruses to major viral lineages defined by a common virion architecture and capsid/coat similarities (47).\n\nTo confirm whether capsid/coat\u2013related FSFs were indeed exclusive to viruses, we checked for the presence of 22 capsid/coat\u2013related viral FSFs in the 1620 cellular proteomes that were sampled. Of the total 22 FSFs, 19 were either completely or nearly completely absent in cells (Table 3). Only the \u201cMajor capsid protein gp5\u201d FSF (d.183.1) of Caudovirales (HK97-like lineage) was present in ~24% of cellular proteomes. The HK97-like fold has been detected in the shell-forming protein (encapsulin) of some archaeal protein nanocompartments that store metabolic enzymes (48). These nanocompartments are polyhedral protein shells that are morphologically similar to icosahedral viruses. Because archaeal and bacterial encapsulins are homologous, it is likely that prokaryotic microcompartments are closely related to ancient viral capsids (49). Those of bacterial carboxysomes are also morphologically similar to viral capsids (50) but are built from protein folds not yet detected in viruses (51). We identified two FSFs that are part of bacterial carboxysomes: (i) \u201cCcmk-like\u201d (d.58.56) and (ii) \u201cEutN/CcmL-like\u201d (b.40.15) FSFs. Both had an f value of 0 in sampled viral proteomes, confirming a lack of overlap between carboxysomes and viral capsids. However, this could also be explained by the loss of an ancient capsid protein fold in modern viruses or an outcome of sampling biases (49). Alternatively, it is possible that viruses harboring similar folds exist in nature but remain to be discovered. An interesting analogy could also be made for eukaryotes where histone monomers assemble around DNA to produce chromatin structure. Remarkably, this process is mediated by histone chaperones that harbor the \u201cjelly-roll\u201d fold (52) that is abundant in icosahedral viruses. Thus, on the basis of current knowledge, although most viral capsid/coat FSFs have no SCOP structural relatives and lack cellular homologs (Table 3), rare capsid structural homologies in cellular proteomes suggest either instances of virus-to-host HGT or relics of the ancient coexistence of cells and viruses.\n\nNext, we explored how the 716 viral FSFs distributed between viral replicon types (Fig. 4). Most viral FSFs were only detected in dsDNA viruses (Fig. 4A). In comparison, proteomes of the ssDNA, ssRNA, dsRNA, and retrotranscribing groups were genetically poor. Roughly, 91% (649 of 716) of the total viral FSFs were unique to a single viral subgroup, and only ~9% (67) of the total viral FSFs were shared by more than one subgroup (Fig. 4A). The number of shared FSFs in each viral subgroup exceeded the number of unique FSFs, except for dsDNA and minus-ssRNA viruses. A seven-set Venn diagram made clear that each viral subgroup shared FSFs with every other subgroup (the sole exception being ssDNA and dsDNA-RT viruses) but did so sparsely (Fig. 4A, Venn diagram). The diagram shows that there was no single FSF common to all viral subgroups (Fig. 4A). However, it also revealed that the minus-ssRNA and dsDNA groups circumscribed the most widely shared FSFs (traces highlighted in the Venn diagram) (Table 4).\n\nThe \u201cDNA/RNA polymerases\u201d FSF (e.8.1), which includes T7 RNA polymerase, RNA-dependent RNA polymerase of plus-sense and dsRNA viruses, reverse transcriptase, DNA polymerase I, and the catalytic domain of Y-family DNA polymerase, was detected in six of the seven subgroups (the exception being ssDNA viruses, which replicate by using the host\u2019s polymerase). In turn, \u201cS-adenosyl-l-methionine dependent methyltransferases\u201d (c.66.1) FSF was detected in five of the seven viral subgroups, except retrotranscribing viruses. Three additional FSFs, the \u201cP-loop containing NTP hydrolase\u201d (c.37.1), the \u201cRibonuclease H\u2013like\u201d (c.55.3) and the \u201cPositive stranded ssRNA viruses\u201d (b.121.4), were detected in four of the seven viral subgroups (Table 4). The c.37.1 FSF is one of the most abundant and widespread FSFs in modern cells. The c.55.3 superfamily includes many proteins involved in informational processes (including replication and translation) that are universal among cellular proteomes. This FSF was relatively widespread in viral subgroups but was absent in the proteomes of plus-ssRNA, dsRNA, and dsDNA-RT viruses. It was especially abundant in ssRNA-RT (79% of proteomes) and dsDNA (58%) viruses. The c.55.3 FSF also includes the catalytic domain of retroviral integrase, which is an important target to silence retroviral gene expression (53) and is medically important. In turn, b.121.4 is the jelly-roll fold, which is one of the most common topologies observed in viral capsid proteins (3, 54). Finally, 10 FSFs were present in three of the six viral subgroups, whereas 52 were shared by two subgroups (Fig. 4A, Venn diagram, and Table 4).\n\nThe seven-set Venn diagram is analogous to a maze or logic puzzle that can be solved using Ariadne\u2019s thread logic (Fig. 4B). Metaphorically, threads keep track of evolutionary paths while traversing a maze sculpted by reductive loss. We define our Ariadne\u2019s threads as Venn subgroups of FSFs shared by two to six of the seven viral replicon types (there were no FSFs shared by all seven viral groups). These threads revealed that only 19 of the 120 possible Venn subgroups of shared FSFs existed (total Venn \u2212 internal groups: 27 \u2212 1 = 127), where 14 were shared by two to three viral groups. They make explicit how sparsely shared FSFs are in viral groups and uncover deep evolutionary patterns likely left by reductive evolution. Only 8 of 21 and only 6 of 35 possible subgroups shared by two and three viral groups, respectively, were present. As expected, dsDNA viruses, which hold the largest proteomes and comparatively are minimally affected by reductive evolution, were part of 11 of these 14 Venn subgroups. Remarkably, 9 of 14 (64%) subgroups with their 39 FSFs (63%) involved minus-ssRNA, plus-ssRNA, and dsRNA replicons. Similarly, of 64 possible groups sharing four to seven replicon types, only five groups were present (lines in Ariadne\u2019s thread diagram; Fig. 4B), all including RNA viruses. As mentioned previously, these five groups represent polymerases, metabolic enzymes, ribonuclease, and capsid-associated FSFs. Because RNA viruses define most threads and their proteomes are the most reduced, they are most informative in explaining FSF distribution in the viral supergroup. This leads to the speculation that perhaps RNA viruses predated DNA viruses in evolution, which we confirm with phylogenetic methods below. Finally, a large number of FSFs were shared between DNA and RNA viruses (Fig. 4C), suggesting that the virosphere may not be as disjoint as previously thought. In fact, recombination between RNA and DNA viruses can sometimes generate \u201chybrid\u201d viruses with DNA genomes but capsids typical of RNA viruses [for example, (55)].\n\nIn summary, the patchy distribution of FSFs in the viral supergroup revealed a significant overlap between viruses of different replicon types. Although most FSFs were unique to a particular subgroup, a large number of FSFs were shared between viruses belonging to different replicon types (Fig. 4).\n\nThe reconstruction of phylogenomic trees of domains (ToD), which describe the evolution of the 1995 FSF domains (taxa) that were surveyed in the 5080 sampled proteomes (characters) (see Materials and Methods for the tree reconstruction protocol), showed that most viral FSFs originated very early in evolution (see the legend bar on top of ToD in Fig. 5A). Because of its highly unbalanced nature, ToD enabled the calculation of a \u201cproxy\u201d for the relative age of each FSF domain, which was defined as the node distance (nd) value. This value was derived simply by counting the number of nodes from a terminal taxon to the root node of the tree and by expressing the phylogenetic distance on a relative scale from 0 (most ancient) to 1 (most recent) [methodology discussed elsewhere (18)]. We have previously shown that nd is a reliable proxy for the evolutionary age of FSFs and describes a clock-like behavior of FSF evolution that is remarkably consistent with geological records (56). To uncover likely evolutionary scenarios, we plotted FSFs in each of the 15 Venn groups in Fig. 1A against their FSF ages (that is, nd values) (boxplots in Fig. 5A).\n\nThe ABEV Venn group, which includes 442 FSFs encoded by both cells and viruses, was the most ancient group and covered the entire nd axis. The P-loop containing NTP hydrolase (c.37.1) FSF was the first FSF to appear at nd = 0. The median nd was ~0.4, suggesting that at least 50% of ABEV FSFs originated very early in evolution and were shared by cells and viruses. This finding is remarkable and implies that some of the most ancient FSFs found in cells were also shared by very different groups of viruses, again suggesting the ancient coexistence of cells and viruses. In turn, the relatively longer tail on the right of the graph likely includes many FSFs of recent origin (nd > 0.63) that could have been gained in viruses from cells through HGT.\n\nThe ABEV group was followed by the appearance of the ABE group. The first FSF in ABE was the \u201cACT-like\u201d FSF (d.58.18), which includes regulatory protein domains mainly involved in amino acid metabolism and transport. We propose that d.58.18 was most likely \u201clost\u201d (or never gained) in ancient viruses because simultaneous gain in three superkingdoms is less likely than loss in just one superkingdom. By extension, the appearance of the BEV group with the inception of the \u201cLysozyme-like\u201d FSF (d.2.1) at nd = 0.15 signals the loss of the first FSF in a cellular superkingdom (Archaea). Simply, the absence of an ancient FSF in one group (out of three or four groups) is more likely a result of reductive evolution than separate gains [as previously described (18)]. The previously reconstructed proteome of the last common ancestor of Archaea, Bacteria, and Eukarya was reported to encode a minimum of 70 FSFs (57). The most recent of those FSFs, \u201cTerpenoid synthases\u201d FSF (a.128.1), appeared at nd = 0.19 and was absent in all viruses, except one (African swine fever virus). These events demonstrate the early reductive tendencies in early cellular lineages, especially in ancient cells leading to viruses and Archaea.\n\nIn comparison, FSFs unique to superkingdoms and the viral supergroup appeared much later (see the A, B, E, and V groups in Fig. 5A). These gains signaled the diversification of that superkingdom or supergroup. The late appearance of VSFs (V group in Fig. 5A) is interesting because it includes FSFs involved in viral pathogenicity (Tables 1 and 2). The phylogenomic analysis shows that VSFs originated at the same time or after the diversification of modern cells. Thus, they represent the time point when proto-virocells, under prolonged genome reduction pressure, completely lost their cellular nature and became fully dependent on emerging archaeal, bacterial, and eukaryal cells for reproduction. This idea is strengthened by the evolutionary appearances of the AV, BV, and EV groups soon after the FSFs of the superkingdom-specific A, B, and E groups, respectively (see patterned regions in Fig. 5A). We speculate that FSFs in the AV, BV, and EV groups either perform functions required by viruses to successfully infect their hosts (for example, BV FSFs that perform viral functions) or are simply HGT gains from their hosts. We have already discussed the composition of the BV group, which includes ~60% FSFs of viral origin (Table 1). Similarly, the AV and EV groups also include viral FSFs, albeit in lower numbers (Table 1). A Gene Ontology (GO) enrichment test on EV FSFs, however, showed that these were enriched in biological processes crucial for cellular development and regulation, such as GO:0048483 (autonomic nervous system development), GO:0002062 (chondrocyte differentiation), and GO:0050921 (positive regulation of chemotaxis) (table S7). It is possible that this repertoire was provided to eukaryotes from viruses or was simply gained in eukaryoviruses from their eukaryotic hosts through HGT. In turn, no biological process was enriched in either AV or BV.\n\nNext, we divided viral FSFs into four subgroups: (i) those shared between prokaryotic viruses and eukaryoviruses (that is, the abe core of Fig. 3B; table S5); (ii) other viral FSFs shared with cells (cyan circles); (iii) VSFs (green circles); and (iv) FSFs not detected in viral proteomes (black circles) (Fig. 5B). Generally, FSFs of the abe core were present in a greater number of viral proteomes (higher f values) and in more replicon types (fig. S3). Some of the most popular FSFs again included the P-loop containing NTP hydrolase (c.37.1), DNA/RNA polymerases (e.8.1), and Ribonuclease H\u2013like (c.55.3) FSFs. In turn, FSFs shared with cells were relatively less widespread. However, the Lysozyme-like FSF (d.2.1) was detected in a large number of viruses (18%), mostly bacterioviruses. Lysozymes can penetrate bacterial peptidoglycan layers and facilitate viral entry. We speculate that this capability was transferred to eukaryotic cells from viruses to block bacterial infections in eukaryotes. Another relatively widespread FSF was the \u201cOrigin of replication binding domain, RBD-like\u201d (d.89.1) FSF, which was detected in ~16% of the sampled viruses. Both the abe core and FSFs shared with cells spanned the entire nd axis. Thus, viral proteomes encode both very ancient and very derived FSFs. The former group was most likely inherited vertically from the common ancestor of cells and viruses, whereas the latter could be a result of recent HGT gains from cells or shared innovation. The enrichment of very ancient FSFs in the abe core present in viruses infecting the three superkingdoms provides strong support to their ancient origin. The origin of VSFs, on the other hand, marks the onset of modern virocell life cycles. Results therefore highlight two important phases in viral evolution: (i) an early cell-like existence of viruses (the precursors of modern virocells) and (ii) a late transition to the viral mode, as we know it today.\n\nA series of experiments determined the relative age of each viral subgroup.\n\n(i) Evidence from ToD. We zoomed into the most ancient core ABEV Venn group and separated FSFs belonging to each of the seven viral replicon types (Fig. 5C). In all viruses, regardless of the replicon type, median nd values were very low (see white circles), indicating that they shared ancient FSFs with cells. Likewise, each viral subgroup had a longer tail toward the right, suggesting that HGT may have played evolutionary roles only very recently. The most ancient ABEV repertoires were derived from dsRNA, minus-ssRNA, and ssDNA viruses, suggesting that they predated dsDNA viruses in evolution.\n\n(ii) Ariadne\u2019s threads traced in evolutionary time. We traced FSF domain ages onto the threads of FSFs shared between viral subgroups (Fig. 6A). The oldest domains were spread in a transect that unified minus-ssRNA, plus-ssRNA, and dsRNA proteomes. This pattern was clearly evident in violin plots that describe FSF age in the threads along the early timeline of domain evolution (nd < 0.3) (Fig. 6B). Once again, the proteomes of minus-ssRNA viruses were particularly enriched in ancient domains, suggesting that perhaps ssRNA was involved in virocell origins (read below).\n\n(iii) Evidence from trees of proteomes (ToP). To describe the evolutionary relationships between the proteomes of cells and the proteomes of viruses (taxa), we reconstructed ToP from the abundance and occurrence of 442 ABEV FSFs (phylogenetic characters). The ABEV group was selected because it includes many FSFs of ancient origin (median nd ~0.4; Fig. 5A), the entire abe core (Fig. 3B and table S5), and ancient FSFs in Ariadne\u2019s threads (Figs. 4B and 6A). Because biases in taxon sampling could influence tree reconstruction, we randomly sampled a set of 368 proteomes (taxa) from cells and viruses, including up to 5 viral species from each viral order or family and 34 proteomes corresponding to only free-living organisms in Archaea, Bacteria, and Eukarya. The rooted phylogeny dissected proteomes into four supergroups (Fig. 7A). Viruses formed a distinct paraphyletic group at the base of ToP that was distinguishable from cells by 76% bootstrap (BS) support. In turn, archaeal organisms were clustered paraphyletically in the more basal branches (black circles), whereas Bacteria and Eukarya formed monophyletic groups (blue and green circles) supported by 66% and 100% BS, respectively (Fig. 7A). This topology supported an ancient origin of both viruses and Archaea and a sister relationship between Bacteria and Eukarya, which goes against some gene sequence\u2013based phylogenies (58\u201360) but is congruent with a number of structure- and function-based studies [discussed elsewhere (18, 61\u201365)].\n\nThe most basal taxa corresponded to RNA and retrotranscribing viruses. These included well-known dsRNA viral families that have segmented genomes such as Birnaviridae, Partitiviridae, and Picobirnaviridae (2 segments); Chrysoviridae and Quadriviridae (4 segments); and Reoviridae (10 to 12 segments). Nodaviridae that have bipartite genomes (that is, two segments) and \u201ccapsidless\u201d Narnaviridae (both plus-ssRNA viruses) also occupied the most basal positions in ToP along with dsRNA and dsDNA-RT viruses. Other very ancient viral groups included retrotranscribing viruses (Caulimoviridae, Hepadnaviridae, and Retroviridae), ssDNA viruses (Anelloviridae and Inoviridae), dsDNA viruses (Plasmaviridae and Polydnaviridae), ambisense arenaviruses, and minus-sense influenza viruses (Fig. 7A). It has been hypothesized that retrotranscribing viruses likely mediated the transition from an ancient RNA world to the modern DNA world (66). Remarkably, in our tree, retrotranscribing viruses originated before bona fide DNA viruses, validating the hypothesis (Fig. 7A). Another interesting position was that of polydnaviruses, which are \u201csymbionts\u201d of endoparasitic wasps (67). These viruses also encode segmented dsDNA genomes. These observations suggest the presence of segmented viral genomes (mostly RNA) in ancient cells and the late appearance of \u201ccapsid-encoding\u201d and DNA viruses.\n\nA tree of viruses (ToV) reconstructed from abe core FSFs (fig. S4) further confirmed an early origin in RNA viruses. Although the distribution patterns of replicon types were not entirely clear-cut, there was clear enrichment of RNA viral proteomes at the base of ToP, specifically minus-ssRNA and dsRNA viruses. This tree was poorly resolved partly as a result of the limited number of phylogenetic characters that were used to distinguish proteomes and largely as a result of the patchy distribution of abe FSFs in viral proteomes (a consequence of reductive evolution in viruses). Finally, grouping viruses by host type (that is, archaeoviruses, bacterioviruses, and eukaryoviruses) did not yield three independent groups, suggesting that viruses, regardless of host type, could be structurally (and evolutionarily) more related to each other (fig. S5). It also suggests that viruses can jump hosts [for example, severe acute respiratory syndrome (SARS) and Ebola viruses, loss of RNA viruses in prokaryotes (44)], and thus, evolutionary relationships based on virus-host preferences should be considered with caution [sensu (43)].\n\nWe evaluated ToP phylogeny by comparing it against ICTV and structure-based classifications. ToP recovered some well-known relationships. For example, the genera Flavivirus (Flaviviridae) and Alphavirus (Togaviridae) were grouped together, suggesting their close evolutionary association (66% BS). In fact, alphaviruses were initially classified by the ICTV under Flaviviridae but were later assigned their own genera in Togaviridae. Both viral families show striking similarities in virion architecture (enveloped and spherical) and genome replication strategies (monopartite linear plus-ssRNA). Similarly, Polyomaviridae, Closteroviridae, Coronaviridae, and many others also formed individual monophyletic groups (indicated by asterisk in Fig. 7A). Another largely unified group was that of filamentous dsDNA archaeoviruses (Rudiviridae and Lipothrixiviridae) that have been classified under the order \u201cLigamenvirales\u201d (68). Similarly, viral families in the \u201cnucleocytoplasmic large DNA viruses\u201d group (Poxviridae, Phycodnaviridae, Ascoviridae, Asfarviridae, Iridoviridae, and Mimiviridae) formed a paraphyletic group at the very derived positions. This group also included the recently discovered pandoraviruses (69) and pithoviruses (70) and the oddly placed bacteriophage (Myoviridae). The close grouping of all giant viruses supports the proposal of the viral order \u201cMegavirales\u201d (71) and a previous reconstruction (19). However, herpesviruses and Caudovirales that share the common HK97 capsid protein fold did not form a single group (47), but they were in close proximity (Fig. 7A). In turn, Adenoviridae and Tectiviridae that belong to the PRD1/adenovirus-like lineage were closely clustered. Similarly, Totiviridae and some Reoviridae of the BTV-like lineage occupied basal positions. Some members of the picornavirus-like lineage (for example, Luteoviridae, Caliciviridae, and Picornaviridae) and retrotranscribing viruses also clustered together, but clear-cut structure-based viral lineages did not materialize in ToP. Other discrepancies also existed with regard to viral families defined by the ICTV that did not form unified groups. However, ICTV classifications are subject to revisions and do not always yield evolutionarily informative classifications. In light of these, ToP reconstructed from the abundance of conserved FSF domains present a \u201cthird\u201d and global view of the evolutionary relationships of viruses, which adds deep lineage relationships to ICTV and structure-based classifications.\n\nToP also provide interesting information regarding the evolution of virion morphotypes. Most basal branches were populated by spherical or filamentous virions (two of the simplest designs from the point of view of tensegrity). They gradually become more decorated, with additional features such as spikes and glycoproteins (retroviruses) in spherical virions, and rod-like designs (inoviruses) likely evolving from filamentous versions. Perhaps the rods and spheres combine to form the head-tail morphotype so abundant in prokaryotic viruses. Thus, mapping of virion morphotypes onto ToP likely hints toward the origin of viruses from a limited number of structural designs (43). However, we caution that morphological similarities may also stem from convergent evolution. At this point, we lack evidence to confirm homologies between different virion morphotypes. Nevertheless, the early appearance of spherical and filamentous virions harboring segmented RNA genomes is remarkable and worthy of further attention.\n\n(iv) Evidence from distance-based networks. Typically, viral proteomes encode far less proteins and in lower abundance relative to the proteomes of cellular organisms (except for some giant viruses). To account for such differences and to test whether the phylogeny in Fig. 7A was not influenced either by HGT or by technical artifacts associated with our choice of phylogenetic model, we used FSF occurrence in distance-based networks reconstruction (Fig. 7B). The resulting topology still favored a \u201ctree-like\u201d structure (Fig. 7B), suggesting that the phylogeny of Fig. 7A was not influenced by processes that could artificially increase genomic abundance. Moreover, none of the viral proteomes clustered with their hosts (for example, plant RNA viruses did not group with plants), indicating that the predicted cellular nature of viruses was not attributable to HGT from their hosts but was likely a result of ancient coexistence. The phylogenomic network retained most evolutionary relationships defined earlier by ToP but also recovered a closer grouping of herpesviruses with Podoviridae (Caudovirales) that was not so clear in ToP derived from genomic abundance, supporting the proposal that the two viral groups are closely related (47, 72).\n\n(v) ToP derived directly from the age of protein domains. We also developed a multidimensional scaling approach to study the evolution of cells and viruses: the evolutionary principal coordinate (evoPCO) analysis (Fig. 8A). The evoPCO method combines the power of cladistic and phenetic approaches by calculating principal coordinates directly from temporal evolutionary distances between the proteomes of species (see Materials and Methods). The distance between proteomes reflects phylogenetic dissimilarity in the age of FSF domain repertoires (that is, nd values) and can be displayed in 3D temporal space, assuming that the age of an FSF is the age of the first instance of that FSF appearing in evolution. Because proteomes are biological systems that are made up of component parts (that is, FSFs in this case) but describe cellular organisms and viruses, each component (regardless of its abundance) contributes an age to the overall age of the cellular or viral system. This factor, when taken into account, results in a powerful projection of a multidimensional space of proteomes onto a 3D temporal space that allows visualization of evolutionary relationships.\n\nThe evoPCO method revealed four clouds of proteomes in temporal space that correspond to viruses and to the three cellular superkingdoms (Fig. 8A). The first three coordinates explained ~85% of the total variability. Using the previously reconstructed proteome of the last common ancestor of modern cells as reference point (57), we inferred viruses as the most ancient supergroup, followed by Archaea, Bacteria, and Eukarya, in that order (Fig. 8A). This topology supports earlier results from comparative genomic and phylogenomic analyses, adding a fifth line of evidence in support of the early origin of viruses. Remarkably, Lassa virus, which belongs to Arenaviridae and harbors segmented RNA genomes, appeared at the most basal position of the evoPCO plot, supporting the early origin of segmented RNA viruses in ToP (Fig. 7A). Some giant viruses appeared more derived, supporting their ancient coexistence with cells (19, 73). The topology and ordering of proteomes in evoPCO analysis were further supported by a distance-based neighbor-joining (NJ) tree (Fig. 8B) reconstructed directly from the temporal distance matrix, which retained the cohesive and ancient nature of the viral supergroup. The NJ tree made explicit the early origins of RNA viral families and was largely congruent with ToP recovered earlier (Fig. 7A), validating the power of the evoPCO strategy.\n\nThe search for a \u201cfourth\u201d domain of life is not new [for example, (74, 75)]. It has been the subject of intense debate in evolutionary biology [refer to (76\u201383) and references therein]. Here, we put forth the bold conjecture of a universal tree of life (uToL) that describes the evolution of cellular and viral proteomes (Figs. 7 and 8). Formally placing viruses in uToL is a daring task because many scientists even question whether viruses are living entities mainly because of (i) the lack of true viral metabolism and (ii) their inability to reproduce on their own (76, 84). However, counterarguments have recently gained popularity, especially inspired by the study of \u201cvirus factories,\u201d which are intracellular structures formed by many giant viruses inside infected cells (85). Virus factories are \u201ccell-like organisms\u201d [sensu (86)] that are compartmentalized by a membrane, have ribosomes, obtain energy from mitochondria, and contain full information to successfully produce numerous virions (85). They are strikingly similar to many intracellular parasitic bacteria that also depend on host metabolism to reproduce. For these reasons, it has been argued that the true \u201cself\u201d of a virus is the intracellular virus factory of infected cells, which is metabolically active and should be contrasted with the extracellular and metabolically inert virion state. Specifically, virocells produce viral gametes (virions) that are functionally analogous to cellular gametes of sexually reproducing species, which fuse during fertilization. These viral gametes can then fertilize (infect) other cells [sensu (86)]. Thus, viruses should be considered \u201cliving\u201d organisms that simply survive by means of an atypical reproduction method that requires infecting a cell [similar to obligate parasitism (87)].\n\nThe argument that viruses do not replicate or evolve independently of cells and hence should not be deemed worthy of living status (84) has been toned down because each species replicates and evolves in nature and requires coexistence with other life forms (87). In short, there is a need to broaden our definitions of \u201clife\u201d and to abandon viewing virions as viruses [sensu (86)]. In light of these arguments, we contend that it is legitimate to study viral origins and evolution on a scale comparable to that of Archaea, Bacteria, and Eukarya and to ask fundamental questions related to the evolutionary history of cells and viruses. Here, we propose that the encoded genetic makeup and its ancient history define the functionalities of virions, capsids, and replicons that are necessary to complete the reproduction cycle of a virus. We therefore study the proteomic composition of viral replicons to infer viral evolutionary trajectories (similar to how phylogenetic analysis of cellular genes tells us about their history), presenting a hypothesis of virus origin and evolution that is more compatible with virus biology and large-scale molecular data.\n\nOur comparative and phylogenomic data refute the \u201cvirus-first\u201d hypothesis or the precellular scenario for the origin of viruses [see (80) for a new version]. This proposal suggests an early origin of self-replicating viral replicons predating the origin of cells. However, the hypothesis is unsatisfactory because viruses are tightly associated with proteins (capsids) and must replicate in an intracellular environment to produce viral progeny. Fossil evidence also shows that cells appeared early in evolution (88, 89). The large size of the ABEV group, which includes many FSFs of ancient origin and membrane proteins, is also incompatible with the virus-first scenario and suggests an ancient cellular origin of viruses (Figs. 1A and 5). Thus, our data can be better reconciled with either the \u201cescape\u201d hypothesis or the \u201creductive\u201d hypothesis [see (31, 41, 90) for details], both of which associate viral origins with cells. Under the escape hypothesis, replicons in proto-virocells became autonomous and acquired virions to infect other ancient cells. In turn, the reduction hypothesis suggests loss of the primordial ribosomal machinery in proto-virocells and subsequent reduction into viruses. Although both hypotheses explain the origin of viruses in ancient cells, reduction seems to be more parsimonious with our data given the strong lifestyle resemblance of viruses to cellular parasites (that also evolve similarly) (37), the early loss of FSFs suggested by evolutionary timelines (Fig. 5A), and the discovery of giant viruses that overlap cellular parasites in genomic and physical features (Fig. 1, C and D) (69, 70, 91, 92). Although reduction of modern cells into virions (enclosing few proteins) may seem far-fetched, this would be relatively more straightforward in ancient cells where ribosomal machinery and other cellular features were yet to fully materialize.\n\nFrom the point of view of natural history, our bold conjecture simply invokes the existence of proto-virocells\u2014additional cellular descendants of the last universal ancestor of both modern cells and viruses. The proto-virocells reduced into modern viruses, whereas their siblings diversified into Archaea, Bacteria, and Eukarya. It is important to distinguish proto-virocells from modern-day virocells. Although infection of modern-day virocells may result in virion synthesis and cell lysis (22), the proto-virocell genomes coexisted in the intracellular environment and reproduced either without lysis (similar to endogenous viruses in cellular genomes or plasmids trapped in cells) or by producing primitive forms of virions. In the absence of the jelly-roll fold and other capsid-associated viral folds (which appeared quite late in our timelines), primitive capsid-like structures could have been built from folds seen in prokaryotic protein nanocompartments or by formation and secretion of membrane vesicles. The prokaryotic protein compartments (such as encapsulins and carboxysomes) are polyhedral protein shells that are morphologically similar to icosahedral viruses [for example, (48)]. Modern-day viral capsids store nucleic acids, whereas prokaryotic protein compartments store enzymes. Perhaps the switch from storing proteins to storing nucleic acids facilitated viral origins in an ancient cell (48). In turn, modern cells frequently secrete membrane vesicles to communicate with other cells. These vesicles are also morphologically similar to spherical viruses and can package viral genes and contribute toward viral infection (93). This vesicle secretion phenomenon is very ancient and could have played roles in the origins of ancient viruses [see (94, 95) for other vesicle-related scenarios of viral origins]. Both scenarios explain how virions were synthesized in proto-virocells to export viral genetic information. Under this scenario, plasmids and other selfish genetic elements also originated from proto-virocells but did not acquire capsids and remained tightly integrated with the emerging ribocellular makeup.\n\nOur phylogenomic reconstructions also show that proto-virocells initially harbored segmented RNA genomes and that proteomes of all seven kinds of viral replicons were enriched in ancient FSFs (Fig. 5C). Given the massive diversity in replicon type seen in modern viruses, it is likely that all kinds of replication strategies were used in proto-virocells. A logical outcome of this experimentation would be the discovery of many key replication-associated proteins and perhaps DNA itself in the virus world [an idea previously put forward by Forterre (66, 96)].\n\nIn summary, the virus-mediated infection of (ancient or modern) cells is an old process that has evolved gradually over billions of years but materialized fully once lineages of organisms diversified. After the proto-virocells reduced to completely lose their cellular nature and acquired types of folds to build viral capsids (jelly-roll and other forms), modern viruses were born. The cellular nature of viruses is restored when modern viruses infect and replicate inside modern cells or when they become integral parts of their genomes. Whether the infection is modern or ancient, it has two interesting consequences: (i) viruses gain complete access to and control of the cellular machinery to create genes and protein folds, thus explaining the large size of class I proteins and VSFs (Fig. 1, A and B), and (ii) they can also pick old or newly created genes from cells, spreading them to other cellular lineages through virus-to-cell gene transfer (Fig. 2), if it provides selective advantages to the evolving host. Thus, our model, which explains the evolution of virocells, is biphasic and identifies an early cell-like phase followed by the emergence of modern-day viral lineages.\n\nIt has been argued that viruses frequently pickpocket genes from cells and that this phenomenon explains their primary mode of evolution (76). However, our data and previous genomic analyses (97\u2013100) strongly refute this idea and have revealed the abundance of unique genes (that is, class I proteins in Fig. 1B) in viral proteomes lacking cellular homologs. A large number of these proteins are likely very ancient and thus are no longer detectable either by BLAST or HMM-based searches, whereas the remaining proteins probably originated rather recently in viral lineages (for example, VSFs in Fig. 5A). In fact, genes are continuously created by viral lineages in infected cells during viral replication cycles, when viruses have full access to the cellular machinery to produce genes (34). This phenomenon has been greatly underestimated in the past but is now being acknowledged [for example, (5, 90, 97, 100\u2013102)]. Discovery of viruses from atypical habitats and hosts is expected to improve the Protein Data Bank (PDB) representation of viral structures and will no doubt increase our knowledge about class I proteins. In turn, alternative explanations, such as the rapid evolution of class I proteins in viruses after uptake from cells or acquisition from yet-to-be-discovered cellular species, are less satisfactory and account for only a minor fraction of class I proteins. For example, the former scenario is inconsistent with the presence of class II proteins that, surprisingly, remained robust to fast evolution in the same viral proteomes (42). Moreover, synonymous-to-nonsynonymous substitution rates for \u201cunique\u201d genes in giant DNA viruses did not vary significantly from the substitution rates of vertebrate proteins (97). In turn, the latter scenario posits a decrease in the number of VSFs with the sampling of more cellular genomes, which has not been observed [for example, comparison of (19) and the present study; also discussed in (49)]. Together, the major fraction of viral proteomes includes proteins with no detectable cellular homologs. This subset is likely indicative of the gene-creation abilities of viruses during the virocell life cycles.\n\nIn turn, there are three possible routes to explain the origin of class II proteins: (i) they originated in cells and transferred to viruses; (ii) they originated in viruses and transferred to cells; and (iii) they spread vertically from the common ancestor of cells and viruses or by means of shared innovation. Each of the three possibilities has known examples. However, the gene flow from virus to cell numerically exceeds the gene flow in the opposite direction [for example, transfer of the RNA polymerase gene of dsRNA viruses to eukaryotes (103), provirus genes integrated in mitochondria (104), endogenization of viruses (105), and syncytin protein involved in mammalian placenta development (106); see also (22)]. Similarly, Cortez et al. (100) showed that a significant fraction of archaeal and bacterial genes (~15 to 20%) are of foreign origin, most likely inherited from viruses or plasmids. This is not surprising given the abundance of integrated viral-like elements in eukaryotic genomes (for example, ~50% in humans). Our discovery of 66 bona fide VSFs and 43 additional VSFs that were hidden in cellular proteomes (Table 1) is additional support for this argument. Together, we argue that the gene-creation and gene-transfer abilities of viruses have been significantly underestimated by some authors [for example, (76)]. We falsify the idea that viral genomes only evolve by acquiring genes from host species.\n\nThe very basal viral groups in the uToL exemplified by ToP, ToV, and evoPCO reconstructions (Figs. 7A and 8 and fig. S4) included minus-ssRNA viruses and families of dsRNA viruses that harbor segmented genomes. This is remarkable. The influenza virus genome typically contains six to eight RNA segments and evolves by random genetic drift or by the reassortment of genome segments with other coinfecting influenza viruses. Thus, it is likely that proto-virocells had segmented RNA genomes that often \u201cmated\u201d by combining with other RNA segments. This is compatible with the proposal of Woese (107) that the earliest cells stored genes in the form of segmented RNAs. These findings support the general idea that RNA came before DNA. The ubiquity of the use of RNA primers in the synthesis of DNA and its deoxyribonucleotide precursors from ribonucleotide precursors of RNA (108) is additional support for this argument. The principle of continuity dictates that a possible shift from RNA to DNA was gradual and was likely mediated by retrotranscribing viruses (for example, Fig. 7A).\n\nThe uToL supports a polyphyletic origin for viruses. At least two kinds of virions (spherical and filamentous), both apparently unrelated, were the likely precursors of many complex virion morphotypes (Fig. 7A). The viral mode of life therefore originated more than once in evolution but always before the divergence of modern cells from a cellular stem line of descent. In turn, the support for a monophyletic origin is weak but could be explained by reductive evolution, which is expected to confound the evolutionary patterns, especially if a long time has passed. The seven-set Venn diagram revealed a highly patchy distribution of FSFs in the viral supergroup. Although no FSF was shared by all seven viral subgroups, some ancient FSFs were shared by four to six viral subgroups including mostly RNA viruses. The data also identified a large core of abe FSFs that were shared by viruses infecting the three superkingdoms. Together, the most parsimonious explanation for structural data confirms an ancient cellular history of viruses and their origin from one or more virocell ancestors.\n\nThe early polyphyletic origin of RNA viruses is relevant to the discussion of the origin of eukaryotes and (especially) eukaryoviruses. It was recently proposed that eukaryotes originated either by \u201cfusion\u201d of two prokaryotic cells [for example, archaeon and bacterium (109, 110)] or from a subgroup of Archaea [archaeal ancestor scenario (111\u2013113)]. These scenarios logically constrain the origin of eukaryoviruses from the merging of prokaryotic viruses, as claimed by Koonin et al. (45). Here, we question these scenarios and argue that they are less parsimonious with our data and other observations [see also (46)].\n\nFirst, both scenarios postulate a transition of one domain of life into another, which is incompatible with the membrane composition of domains of life and with their biochemical differences. For example, archaeal membrane lipids are different from bacterial and eukaryal membranes, which are perhaps better suited to the extreme ecological niche of archaeal species. Thus, fusion or archaeal-ancestor scenarios posit the transition of archaeal membrane into bacterial/eukaryal membrane, an event that has never been observed in archaeal lineages despite several documented episodes of the HGT of genes from Bacteria to Archaea (114). Second, both scenarios also posit the accelerated appearance of a remarkable number of eukaryote-specific folds (283 E FSFs; Fig. 1A), including several aspects of eukaryotic cellular biology that differ starkly with prokaryotes (for example, replacement of prokaryotic-like division by mitosis and decoupling of transcription and translation). Third, and perhaps most importantly, the origin of eukaryoviruses from prokaryotic viruses is less likely because many families of eukaryoviruses have no counterpart in either Archaea or Bacteria [for example, Fig. 3A; see also (43, 44)].\n\nIf the host of the fusion event was an archaeon or if eukaryotes branched off from some archaeal phyla, one should expect eukaryoviruses to resemble archaeoviruses at the molecular and/or phenotypic (that is, virion architecture) levels and to recognize archaeal membranes for infectivity. This is clearly not the case. Only two FSFs were shared by archaeoviruses and eukaryoviruses involved in DNA replication/repair (a.60.6) and metabolism (c.76.1), both apparently unrelated to viral pathogenicity. Similarly, we recently compared the virion morphotype distribution in viruses and discovered that two morphotypes (rod-shaped and bacilliform) were unique to archaeoviruses and eukaryoviruses (44). However, close examination of the 3D folds of coat proteins of \u201crod-shaped\u201d viruses does not suggest a common origin (68, 115), and the same is probably also true for the \u201cbaciliform\u201d morphotype (44). Moreover, member viruses of the two morphotypes did not cluster together in our ToP (Fig. 7A), suggesting that the observed phenotypic resemblance is more likely a result of convergence than divergence. The distribution and abundance of RNA viruses in eukaryotes are in disagreement with the aforementioned scenarios because of the paucity of RNA viruses in prokaryotes. Although RNA viruses are abundant in the superkingdom Eukarya (for example, dsRNA in Fungi, RNA in Plants, and retrotranscribing viruses in Plants and Metazoa), no RNA viruses are now known in Archaea (and are rare in Bacteria). Although Bolduc et al. (116) isolated putative RNA viruses from a metagenomic sample rich in archaeal organisms, their host tropism could not be established with confidence and they considered contamination as an alternative but unlikely explanation. These observations greatly reduce confidence in the emergence of eukaryotic RNA viruses from viruses of a prokaryotic ancestor and point toward an alternative scenario for the origin of modern cells that is linked to differential selection of the virosphere [see also (43, 44, 46)]. Because several archaeal members are characterized by thermophilic habitats and RNA is unstable at high temperatures, the apparent bias in the distribution of viruses in cellular superkingdoms (that is, DNA viruses in prokaryotes and RNA in eukaryotes; Fig. 3A) is better explained by early loss of RNA viruses in Archaea when they migrated to harsh temperatures. Perhaps it was a driving force behind this transition (46). Archaeal viruses, plasmids, insertion sequences, and antiviral defense (clustered regularly interspaced short palindromic repeats) closely resemble the mobilome and defense system in Bacteria. In turn, plasmids are rare in eukaryotes, and more sophisticated defense systems (mediated by small interfering RNA) are used against invading viruses (46). Even the archaeal member viruses of the PRD1/adenovirus-like and HK97-like lineages are more similar to bacterioviruses than to eukaryoviruses (117). This suggests that both Archaea and Bacteria have experienced similar selection pressure to get rid of RNA viruses early in evolution (46). Although Archaea migrated to warm temperatures to escape RNA viruses, the development of a thick peptidoglycan-containing cell wall in Bacteria likely blocked the entry of many viral families (34, 118). In turn, Eukarya likely benefited from the interaction with RNA and retroviruses (triggering genomic rearrangements) and evolved toward complexity, as recently discussed by Forterre (46). In light of these arguments and our FSF data, the early origin of RNA viruses is a significant event in the history of life that triggered major evolutionary trends in coexisting cellular lineages and (perhaps) also led to the discovery of DNA genomes in ancient cells (through retrotranscribing viruses) (66).\n\nOur conclusions rely on the accuracy of HMMs to detect FSF domains in protein sequences and on the current definitions of SCOP, the influential gold standard in protein classification. The structural census could be the subject of biases in the genomes that have been sequenced so far and in our ability to appropriately survey viral and cellular biodiversity. In particular, there is a strong ascertainment bias toward the discovery and study of plant, vertebrate, and human viruses because of economic and medical reasons. Thus, the current picture of viruses and their hosts is largely incomplete.\n\nWe also stress that we focused on protein domain structure and not on protein sequence. We therefore avoided the time-erasing effect of mutations and the confounding convergent effects of historical patchworks present in multidomain protein sequences, which represent a substantial fraction of every proteome that has been sequenced (16). A global analysis involving both viral and cellular proteomes is perhaps only possible by focusing on domain structure and molecular function\u2014characters that are relatively more conserved in evolution than gene sequence (16). Thus, our analysis provides an evolutionarily deep \u201cstructural\u201d view that, as expected, is not always in line with the shallow \u201csequence\u201d view of viral evolution. This fact should be taken into consideration when interpreting our results.\n\nAlthough phylogenomic reconstructions depend on the choice of phylogenetic model and search strategy for optimal trees, our experience with these methodologies has shown that, in general, phylogenetic reconstructions are reliable. It can be argued that some ancestral FSFs were lost from our census because of historical bottlenecks that have characterized cellular evolution. To minimize such effects, we built trees of life from only ABEV FSFs that were present in all sampled groups with relatively higher abundance. Moreover, we have previously linked the evolutionary age of each FSF to its geological age (56). Loss of some ancestral FSFs as a result of extinction events would likely distort the molecular clock of protein folds. But no such distortions have been observed, suggesting that character sampling for phylogenetic studies is reliable. Moreover, occurrence- and abundance-based analyses provided largely congruent results, suggesting that both parameters of the structural census carry similar signatures of the evolutionary process (see text S1 for a discussion of the choice of the phylogenetic methods used in this study). We therefore assume that retrodiction statements are not biased by preconceptions of modernity in the extant features studied.\n\nFinally, we stress that our conclusions are the \u201cmost likely\u201d and \u201cmost parsimonious\u201d scenarios inferred from both comparative genomic (for example, Venn diagrams and f values) and phylogenomic approaches (ToD, ToP, and evoPCO). Studying viral and cellular evolution is a difficult problem complicated by many logical and technical considerations. In light of these, we hope that our study will initiate further discussions of this topic and that a consensus regarding viral evolution will be reached in the near future to benefit both viral biology and taxonomy.\n\nViral protein sequences were retrieved from the National Center for Biotechnology Information Viral Genomes Project (June 2014) (119). A total of 190,610 viral proteins corresponded to proteomes of 3966 viruses. For simplicity, unclassified and unassigned phages and viruses, and deltaviruses that require helper coviruses to replicate in host tissues (for example, Hepatitis delta virus) were excluded from the analysis. Viral proteomes were scanned against SUPERFAMILY HMMs (20) to detect significant SCOP FSF domains (E < 0.0001). Proteomes with no hits were further excluded from the analysis. This yielded a final viral data set of 3460 viral proteomes. In turn, FSF assignments for 10,930,447 proteins in 1620 cellular organisms were directly retrieved from the local installation of the SUPERFAMILY MySQL database (release July 2014; version 1.75). A total repertoire of 1995 significant FSF domains were detected in the entire set of 5080 proteomes.\n\nPhylogenomic analysis was carried out as previously described (12, 120). Specifically, we calculated the abundance (that is, the total count) of each FSF in every proteome. Raw abundance values were log-transformed and rescaled to ensure compatibility with PAUP* (version 4.0b10) (121). For example, the raw abundance value of FSF a in proteome b was log-transformed (gab) and divided by the maximum abundance value in that proteome (gab_max). This was done for each FSF in every proteome. The transformed matrix was then rescaled from 0 to 23 to yield 24 possible character states for use in PAUP*\ngab_normal=round[ln(gab+1)/ln(gab_max+1)\u00d723].\nNormalization and rescaling ensure compatibility with PAUP* and protect against the effects of unequal proteome sizes and variances. Maximum parsimony (MP) was used to reconstruct ToD and ToP. ToD described the evolution of FSF domains (taxa) using proteomes as characters. In turn, ToP resembled conventional phylogenies that described the evolution of proteomes (taxa) using FSF domain characters. Trees were rooted by the method of Lundberg (122), which does not require specification of any outgroup taxon. Instead, first, an unrooted network is calculated, which is rooted a posteriori by the branch yielding a minimum increase in tree length. For this purpose, ancestral character states were specified using the ANCSTATES command in PAUP*. ToD were polarized by the maximum character state, assuming that the more abundant and widespread FSFs should be more ancient relative to those with lower abundance and limited spread. In contrast, ToP were rooted by the minimum character state, assuming that modern proteomes evolved from a relatively simpler urancestral organism that harbored only few FSFs (57) (see text S1 for a discussion of phylogenetic assumptions and models). MP approximates maximum likelihood when phylogenetic characters evolve at different rates (123) and is appropriate for global proteome studies. BS analysis with 1000 replicates was performed to assess the reliability of deep evolutionary relationships. Trees were visualized with Dendroscope (version 3.2.8) (124).\n\nEvoPCO analysis was performed using Microsoft Excel XLSTAT plugin (125). For this reconstruction, proteomes were treated as samples and FSFs as variables. Because proteomes are composed of FSFs of different ages (that is, nd values), we transformed the FSF occurrence matrix into an FSF occurrence* (1 \u2212 nd) matrix, making the matrix a multidimensional space of the evolutionary age of domains. The \u201creverse age\u201d 1 \u2212 nd transformation ensured that we did not lose information about FSFs of very ancient origin (for example, c.37.1 that has an nd of 0 and could be confused with FSFs that were absent in a proteome). Similarly, the transformation ensured that FSF absences (domains that have not yet materialized) did not contribute age to the multidimensional temporal space. Next, we calculated Euclidean distances that described pairwise dissimilarity among proteomes. The pairwise phylogenetic distance matrix was used to calculate the first three principal coordinates that described maximum variability in data. Effectively, the evoPCO method provided the three most significant loadings that described how component parts (FSFs) contribute to the history of systems (proteomes). The evoPCO method should be considered \u201crooted\u201d in time because the multidimensional space was centered on an nd parameter that correlates with geological time (56). For reference, we added the previously reconstructed proteome of the last common ancestor of modern cells (57) as an additional sample.\n\nPhylogenomic networks were generated using the Neighbor-Net algorithm (126) implemented in the SplitsTree package (version 4.13.1) (127). An NJ tree was calculated from the pairwise phylogenetic distance matrix using the \u201cPhangorn\u201d and \u201cape\u201d packages in R version 2.15.2.\n\nGO enrichment analysis was performed using the domain-centric GO resource (128). A list of FSFs was provided as input, and only the most significant and highly specific biological process GO terms that were enriched in the given set of FSFs were retrieved."}