{"title": "Articles Integration of small world networks with multi-agent systems for simulating epidemic spatiotemporal transmission", "body": "The global outbreaks of SARS in the first half of 2003 and H1N1 influenza in 2009 have caused great harms to people. The construction of epidemic spatiotemporal transmission model will help us understand, predict and ultimately control them.\n\nAt present, the modeling methods of epidemics mainly include system dynamic equation, cellular automaton model, multi-agent system and complex network. The SIR model (S-susceptible, I-infectious, R-removed) based on differential equations was originally formulated by Kermack and McKendrick [1] . Thereafter some derivatives, such as SEIR model (E-exposed) and SIRS model [2] , were proposed. Based upon the simulation of the stochastic process of infection, onset and spreading of each SARS patient, Shi [3] constructed a system dynamic model of SARS spreading. Wang et al. [4] presented an improved dynamic model to assess the epidemic potential of SARS and the effectiveness of control measures. However, the epidemic system dynamic equations assume that the populations are total mixing and they neglect spatial effects spread of epidemics [5] .\n\nCellular Automata (CA), which were proposed by Von Neumann and Ulam in 1948, have been widely used to simulate the spatiotemporal evolution of complex system. Fu's research indicated that spatial heterogeneity can be incorporated into a CA epidemic model [6] . Mikler et al. [7] proposed a global stochastic cellular automata (GSCA) paradigm, which incorporated geographic, demographic and migratory constraints. In GSCA, one cell could interact with any other in global space. Zhang et al. [8] investigated the impacts that suburbanization had brought to the transmission of infectious disease by CA model. But most of the CA based epidemic models ignore the influences of the social relations between individuals. While the related researches indicate that social relation play quite an important role in the spread of the infectious disease [9] .\n\nA multi-agent system (MAS) is an integration of complex adaptive system theory, distributed artificial intelligence and artificial life techniques. At present, it has been an important method in complex system analysis and simulation and has been widely used in the simulation of economic, political, social, ecological, and so on [10\u221213] . Liu et al. [14] and Deng et al. [15] utilized the MAS method to simulate the outbreak of the SARS as well as the process of stabilization under control. In these studies, they investigate how the different factors affect the development of disease and try to find some effective approaches to control the epidemic. However, this kind of model has some drawbacks. Although an epidemic is usually recognized as occurring over time, it obviously is a process involving space [16, 17] . But most of the existing MAS based epidemic models mainly focused on the impacts of the infection parameters such as infection rate and cure rate. Some researches touch on the spatial process of epidemic transmission. For example, Gong et al. [18] designed a prototype system based on the virtual geographic environment platform to carry out agent-based simulation of SARS transmission in a virtual community. However, most of these MAS based epidemic models still fail to take into account the influence of social relations among agents.\n\nMilgram's \"six degrees of separation\" experiment revealed that the small-world effects in the realistic world for the first time [19] . According to social network of humans the \"small-world model\" was formally proposed by Watts and Strogatz in 1998 [20] . It has been widely used in physics, mathematics, biology and other nature scientific fields. Newman studied disease transmission on a one-dimensional small world network [9] . However, most of SWN based models cannot be directly used to simulate the transmission of epidemic simulation by using real data. This paper presents a new method of integrating multiagent systems, small-world networks and geographic information systems for solving complex simulation problems regarding epidemic spatiotemporal transmission. Thereinto MAS represents the process of spatiotemporal interactions among individuals, SWN describes the social relationship among agents and GIS is used to manage and visualize the spatial datasets of simulation process. This method is then tested by simulating the flu spread in Guangzhou, a city in south China.\n\n1 The model\n\nInfluenza (Flu) is a highly contagious viral infection of the respiratory tract. Flu spread by virus-infected droplets in the air that are coughed or sneezed into the air. Almost all the persons are susceptible to influenza virus. The person who has infected flu will get immunity after recovery and will maintain a short duration, about 8-12 months [21] . It is important to treat the flu seriously because it can lead to pneumonia and other life-threatening complications, particularly in infants, elder, and people with long-term health problems, in autumn and winter for the high incidence of flu.\n\nThe infection cycle of flu can be divided into four stages: susceptible period, exposed period, infective period and removal period. The populations can be correspondingly divided into four categories: susceptible (S), exposed (E), Infective (I) and removed (R). S(t), E(t), I(t) and R(t) are the amount of S, E, I, R at t time step respectively. The population is equal to a sum of S(t), E(t), I(t) and R(t) and can be approximately considered to be a constant. The SEIR epidemic dynamic equation can be expressed as [22] :\n\nwhere \u03b2 denotes infection rate, namely adequate contact rate, \u03c3 defines the rate of exposed becoming infective, \u03b7 defines the rate of infective becoming removed. Hence, the average duration of exposed is given by 1/\u03c3 and the average duration of infectivity is given by 1/\u03b7. Therefore, the individuals can be classified as four kinds of agents: susceptible (S) agent, exposed (E) agent, infective (I) agent and removed (R) agent. The MAS based epidemic model is composed of agent attribute definitions, agent movement rules, neighborhoods and state transition rules.\n\nThe attributes of an agent mainly include exposed days, infective days, infection dose, age group, residence, etc. The exposed days indicates the duration that an E agent has been in exposed period. The infective days indicates the duration that an I agent has been in the infective period. The epidemic threshold models indicate that S agents are not immediately infected when they contact I agents, but after receiving a certain amount of \"toxins\", namely infection doses, they will be infected [23] . Therefore, to some extent, the value of infection dose attribute is crucial to decide whether S agents will be infected or not. All the agents can be grouped as aged 0\u22124, aged 5\u221219, aged 20\u221259, aged 60 and over according to age.\n\nThe movement rule of agents can be determined according to the daily activities of the agents. Each day can be divided into three different intervals with 8 hours. Within 0\u22128:00 most agents are at home for resting. It is assumed that the transmission will not occur in this interval. There are more opportunities for agents to contact each other within 8:00\u221216:00 and 16:00\u221224:00, infection will mainly occur at these two intervals ( Figure 1 ).\n\nNeighborhoods denote the range which infective agent's behavior may impact in. The S agent will be infected if it is close to I agent, but it will not be infected if the distance between them is longer than a certain extent. As shown in Figure 2 , the shadow stands for the neighborhood of the I agent in the centre, the influence to S agents in the neighborhood from the I agent is related with the distance between them, which will be higher with the shorter distance.\n\nThe SWN model reflects an important characteristic of the social relations, that is, most friends live in the same street or serve the same company. The average path length is defined as average distance of any pairs of nodes. The clustering coefficient of the network is equal to the average clustering coefficient of all the nodes [24] . Two critical characteristics of small world network are the shorter average path length and higher clustering coefficient. The degree of the node is the number of edges that connect to it.\n\nwhere U v stands for the dregee of the node \u03bd, E is the set of all the edges. When the node v belongs to the edge l, \u03b4 v l is equal to 1, else \u03b4 v l is equal to 0. The bigger dregee of a node has, the more important the node is. The average dregee of the network is equal to the average of all the nodes' dregee.\n\nBecause MAS can be used to describe the structure of the SWN, while the nodes in the SWN can be regarded as the agents in the MAS. The links between nodes can be used to represent the social relation of the agents. Therefore, a new model based on SWN and MAS can be built. In the proposed model, the social relation can be considered in the simulation explicitly. The method by randomizing adding edge to construct SWN has been widely adopted [25] . The social relations of the agent can be classified as different types, such as family, schoolmate, colleague, neighbour and friend. The social relations among agents can be constructed as the following steps:\n\n(1) Build the family relation graph according to the distance between agents.\n\n(2) According to the spatial distribution of schools, the aged 5\u221219 agents are assigned to neighbor schools in accordance with distance. The schoolmate relation graph among the aged 5\u221219 agents can be built by randomizing adding edge between two agents who study in the same school.\n\n(3) It is assumed that the agents work around their residence. The colleague relation graph among the aged 20\u221259 agents can be built by randomizing adding edge between two agents who work in the same workplace.\n\n(4) Randomizing adding edge between two agents who live in the same 10\u00d710 grid window to build the neighbour relation graph of all the agents.\n\n(5) Randomizing adding edge between any pairs of agents in MAS to depict the friend relation graph of the agents.\n\nThe social relations of all the agents can be got by uniting above graphs.\n\nIf there is an edge between any two nodes in the social relation network, it indicates that they have a social relation, else that they have not.\n\nwhere i, j stand for node i, j respectively. If there is an edge l which links the node i and j, w is equal to 1, else w is equal to 0.\n\nThe states of agents can be changeable. If the S agents contact I agents frequently, they will be subject to infection. After being infected, they enter exposed period without infectivity. As soon as they enter the infective period, they have the ability of infecting other S agents. They will have the immunity after recovering from the epidemic and can not be infected again [26] .\n\nThe state transition rule is the core of the model. The parameter of infection probability is generally applied to decide whether the infection will happen or not in most of researches, while the parameter is remained unchanged in the whole simulation process [14, 15] . However, influences of temporal and spatial should be taken into account. If contacting with I agent recently, S agent will be infected with high probability. On the other hand, the shorter distance between S agent and I agent is, the higher probability of infective is. Whether and when S agents will be infected is due to combinations of the temporal and spatial factors.\n\n(1) Computing the total infection dose that S agent receives from the I agents. The infection dose d ik (t\u2032) which S agent receives from I agent at time step t\u2032 can be expressed as:\n\nwhere d is infection dose, R s represents the distance between the S agent and I agent, \u03b1 is a random variable, p denotes the probability of receiving infection dose of S agents when they contract I agents.\n\nAt time step t\u2032, the total doses D i (t\u2032) of S agent are equal to the summation of the doses which this S agent received from I agent that it contact. The total doses of S agent can be represented as follows [23] :\n\nwhere K is the numbers of I agents which contact this S agent at time step t\u2032.\n\n(2) Computing respective cumulative dose that each S agent received.\n\nDotts explored a generalized model to introduce the memory of post exposures to a contagious influence [23] . In this paper, we investigate further the decay effects of infection memory. The cumulative dose can be given as the following equation:\n\nEach agent maintains a memory of doses received from I agents over the previous T time steps. The parameter \u03b3 is introduced as decay rate of infection dose. When \u03b3 = 1, the decay of infection dose will not be considered in the memory of T period.\n\n(3) Comparing cumulative doses of S agent to dose threshold.\n\nIf the cumulative dose which S agent received exceed a given dose threshold, agent will be infected, otherwise will not be.\n\n, not be infected,\n\nwhere d * is the dose threshold, which decide whether S agent will be infected or not. The structure of the SWN and MAS based epidemic spatiotemporal transmission model can be shown as Figure 3 .\n\nGuangzhou city is chosen as an experimental area. The city is composed of Yuexiu district, Dongshan district, Liwan district, Haizhu district and Baiyun district, etc. Where Yuexiu district, Dongshan district and Liwan district have a high population density. Baiyun district lies in the north of the experimental area and has a low population density. It mainly covers with woodland, garden and plantation.\n\nThe fifth national population census data, flu observation data from January to March, 2006 and GIS data are collected for testing the proposed model. The January and February flu data are used for estimating parameters while the March flu data are used for verifying the model. GIS data mainly include residential lands of sub-districts or towns, detailed land-use, spatial distribution of schools and industrial lands. All the spatial data are converted to raster grids with a resolution of 100 meter, registered and overlaid with each other.\n\nTo be realized easily, the model is simplified as follows: (1) It is assumed that each E agent will become I agent. (2) There is an agent in each grid space at most. area, if every individual is regarded as an agent, computers will have not enough memory. While, Wang et al. [27] indicated that only a few of persons have opportunities to contact infection sources. Therefore, many agents can be generated to stand for most of S agents which I agents may contact.\n\nSwarm software is a platform for multi-agent system model. It was developed by the Santa Fe Institute in 1994. It supports the process control, parameter adjustment, data analysis and graphical display with the standard class libraries. In addition, the I/O operations and dynamic display about GIS data have been implemented by Java language based on the swarm class library in this research.\n\n(i) Agent attributes initialization. The population census commonly carries out every ten years. When population data between two censuses need to be used, population prediction has to been done. The life table method is an effective tool in population statistic and analysis [28] . The age structure of the experimental area population in 2006 is calculated by the Chinese population prediction software [29] , which is based on life table method.\n\nThe population census data are typically statistical and they can fit the requirements of population macro analysis of resources, environment and socio-economic development. However, they fail to reflect the real spatial distribution of population at micro level. Tian indicated that the land-use types were highly related to DEM, slope, temperature and other factors so that the land use type could be independently used as control variable to get the real spatial distribution of population [30] . So the population can be decomposed according to the habitability of land, which will conform to the reality. It mainly includes the following steps:\n\n(1) Calculating the population density of each grid. Clark indicated that the relationship between population density and distance is a negative index, with the increasing distance from downtown to suburban [31] . Xie et al. [32] validated that the Clark model can describe spatial distribution of urban population density and its evolution since 1982 in Guangzhou. The population density can be expressed as [31] :\n\nwhere r i is the distance between grid i and the city centre, which can be calculated with the coordinates of the grid and city center. F i is population density of the grid i, F 0 is coefficient for the percentage equivalent to the population density of city centre, \u03bb is the decay rate of distance. F 0 can be given as the following expression:\n\nwhere P 0 is the population of the downtown, A 0 is the number of the habitable grids of the downtown. The Jiefangnan sub-district locates in the central of the experimental area, has a high population density and can be regard as the downtown of the experimental area. The result of F 0 is 2221 persons for each grid. The population of the sub-district or town is equal to the sum of all the grid populations of the region, and it can be given as the following equation: \n\nwhere P is the population of the sub-district or town, m is the total number of \"habitable\" grids in the region, the value of \u03bb of each grid in the same region is regard as equal approximately and can be derived with the \"dichotomy\", namely continuing to narrow the solution scope. The population density F i of each \"habitable\" grid of the sub-district or town can be got from eq.(8) ultimately. The result can be shown as Figure 4 .\n\n(2) Calculating the relative population density P r of each grid. The results got from step (1) are population density of each grid. They can be standardized between 0 and 1, that is, relative population density P r , defines the probability with which an agent will appear in the grid.\n\n(3) Ultimately, determining whether and where an agent will be built. A random number \u03c4 with uniform distribution is produced in the interval [0,1], if \u03c4 is smaller than P r , then an agent will be generated in the grid. As a result, twenty thousand agents are generated in simulation. In this way, the spatial distribution of agents will be similar to that of population. In this way the residence attribute of each agent will be set.\n\nFurthermore, age group attribute will be initialized by roulette wheel selection. The age groups of population data by prediction are ranged every five years, which can be merged into four groups: aged 0\u22124, aged 5\u221219, aged 20\u221259, aged 60 and over. Then the proportion of each age group can be calculated. The roulette wheel selection is used to determine age group which an agent will belong to. The detailed steps are as follows:\n\n(1) Create a roulette wheel according to the proportion of each age group.\n\nThe selection probability P k of the k-th age group is defined as\n\nwhere A k is the proportion of the k-th age group in all the age groups.\n\n(2) Randomize a random number \u03b8 in the interval [0,1].\n\n(3) If \u03b8 \u2264 P 1 , the age group 1 will be selected as the value of agent age group attribute, namely the agent is an infant.\n\n(4) If Q k-1 < \u03b8 \u2264 Q k (2 \u2264 k \u2264 4), the k-th age group will be selected. where Q k defines the cumulative probability of the k-th age group. \n\n(ii) Constructing social relations of agents. The small world network social relation can be drawn as Figure 5 .\n\nThe average dregee of this small world network social relation is 13.01, namely the social relation of every agent is 13. The average path length is 8.62, namely averagely any pair of agents can contact each other through less than 9 agents. The result of clustering coefficient is 0.23.\n\nThe duration of exposed period and infective period is equal to 3 days and 5 days respectively [7] . According to the meanings of the parameter, the range of parameter is set, In order to investigate the influence of the social relation on the flu transmission, the SWN and MAS based model, SEIR model and MAS based model are used to simulate the transmission of flu respectively. Then the simulation results of these models are compared to real flu observation data.\n\nAs shown in Figure 6 , when the simulation precision As shown in Figure 7 , at the beginning of the simulation (T=0), there are only S agents, E agents and I agents. The proportion of E agents and I agents can be estimated based on the real flu observation data. If the frequency of infection incident of a grid is equal to 1, it means that an I agent has been initialized there. When T = 20, because of contacting with I agent, some S agents were infected. The mounts of infected agents are quite rare at this time. And most of them around I agents which were initialized at T=0. When T = 40, the number of infected agents increased significantly, most of them concentrated in a relatively dense population regions, such as Yuexiu district and northwest of the Haizhu district. When T = 60, infectious diseases overspread in the experimental area. The number of infected agents increased greatly at Liwan district and Dongshan district. The infection incident is characterized by spatially aggregating. The shorter the distance to the central city is, the bigger frequency of the infection incident is.\n\nThe incidence rate of flu is a quantitative index to describe spread of the epidemic. It can be calculated by the method that flu frequency multiplies 100000 divided by the whole population. The duration of flu data in this research is one month, so the result is the incidence rate of flu in that \n\nAs shown in Figure 8 , there is higher incidence of flu in the central of the city, while Baiyun district and the southeast of the Haizhu district have a lower incidence of flu. It shows that there a close relation between the incidence of flu and population density. In the central of the city, there are more contact opportunities, because of crowded urban traffic and frequent economic activities.\n\nE, I and R agents are characterized of being infected so far, and they can be merged as EIR agents. The statistics of the average dregee of S agents and EIR agents can be carried out respectively.\n\nAs shown in Figure 9 , during T=0\u221230 the average dregee curve of S agents decreases slowly. Since there are not many infected agents, the decrease of the average dregee of S agent does not appear to be so obvious. With the simulation going on, the agents with high dregee will be infected, the average dregee curve of S agents drops gradually. The curve of EIR agents increases during T=0\u221210, remains stable during T=10\u221230 and decreases gradually after T=30. It indicates that the agents will have a higher infection probability when they have more social relation in the beginning of the simulation. As most of the agents with higher dregee have been infected, the curve of EIR agents will rise to the maximum. Then infection spread from these agents with high dregee to the agents with lower dregee which have social relation with them. Therefore, in the end of the simulation the average of EIR agents drops gradually.\n\nMulti-agent system, small world network and geographic information system are combined to simulate spatiotemporal transmission process of infectious diseases. The decay effects of infection \"memory\", distance and social relation between agents are introduced into the model. The proposed model is applied to the simulation of flu transmission in Guangzhou city based on the swarm software platform.\n\nThe results indicate that the simulation precision of the proposed model improved obviously compared with those SEIR model and MAS based model. The analysis also finds that there is a close relation between the frequency of the infection incident and population density. The more concentrative the population is, the more the frequency of infection incident is. It is more probable for S agents with higher social relation to be infected due to contacting with I agents frequently. With the spread of the epidemic, the infection probability of the persons with lower social relation increases gradually."}