{"title": "Method of regulatory network that can explore protein regulations for disease classification", "body": "Objective: To develop regulatory network to explore and model the regulatory relationships of protein biomarkers and classify different disease groups. Methods: Regulatory network is constructed to be a hopfield-like network with nodes representing biomarkers and directional connections to be regulations in between. The input to the network is the measured expression levels of biomarkers, and the output is the summation of regulatory strengths from other biomarkers. The network is optimized towards minimizing the energy function that is defined as the measure of the disagreement between the input and output of the network. To simulate more complicated regulations, a sigmoid kernel function is imposed on each node to construct a non-linear regulatory network. Results: Two datasets have been used as test beds, one dataset includes patients of nasopharyngeal carcinoma with different responses to chemotherapy drug, and the other consists of patients of severe acute respiratory syndrome, influenza, and control normals. The regulatory networks among protein biomarkers were reconstructed for different disease conditions in each dataset. We demonstrated our methods have better classification capability when comparing with conventional methods including Fisher linear discriminant (FLD), K-nearest neighborhood (KNN), linear support vector machines (linSVM) and radial basis function based support vector machines (rbfSVM). Conclusion: The derived networks can effectively capture the unique regulatory patterns of protein markers associated with different patient groups and hence can be used for disease classification. The discovered regulation relationships can potentially provide insights to revealing the molecular signaling pathways.\n\nIn this paper, a novel technique of regulatory network is proposed on purpose of modeling biomarker regulations and classifying different disease groups. The network is composed of a certain number of nodes that are directionally connected in between in which nodes denote predictors and connections to be the regulation relationship. The network is optimized towards minimizing its energy function with biomarker expression data acquired from a specific patient group, thus the optimized network can model the regulatory relationship of biomarkers under the same circumstance. To simulate more complicated regulations, a sigmoid kernel function is imposed on each node to construct a non-linear regulatory network. The regulatory network can extract unique features of each disease condition, thus one immediate application of regulatory network is to classifying different diseases. We demonstrated that regulatory network is capable of performing disease classification through comparing with conventional methods including FLD, KNN, linSVM and rbfSVM on two protein datasets. We believe our method is promising in mining knowledge of protein regulations and be powerful for disease classification.\n\n\u00df 2009 Elsevier B.V. All rights reserved.\n\ndue to its high-dimensionality and small-sample nature. The most popular way to utilize the array data is to identifying biomarkers for specific diseases [3, 5, 6, 8] or building classification models [4, 7, 8] . These conventional approaches only target for achieving highly differentiated biomarkers or signatures, thus the relationships among biomarkers are not of their concern. Biomarker can vary drastically in different circumstances, suggesting it is risky to rely on individual biomarkers without knowing its regulations in between.\n\nRecently there is an obvious trend to discover molecular regulations through analyzing microarray data. Kim et al. [9] , Zou and Conzen [10] , and Yamaguchi et al. [11] applied Bayesian networks to analyze gene regulations with a probabilistic manner; Curtis and Brand proposed a modular regulation analysis method [14] ; Yeung et al. presented the dominant spectral component technique for discovering transcriptional regulations [15] . Some researches devoted to exploring molecular interactions for classification purpose. For instance, Qiu et al. proposed an ensemble dependence model-to-model linear dependence relationships among gene clustering centers [12] . In particular, Antonov et al. believed that molecular patterns vary in different patient groups, and proposed to extract regulatory relationships by using linear programming methods [13] . As a result, by adopting a weighted sum of the logarithms of the expression levels, the authors proposed a classification model based on regulation information. One disadvantage of aforementioned methods is that the regulation relationship is constructed for all groups, thus no unique feature can be extracted for individual patient group [16] .\n\nFrom a biological viewpoint, there exists an underlying regulatory network which is responsible for tumor genesis [17, 18] . In this paper, we propose to construct a regulatory network (RN) to model the biological regulations. In brief, a RN is constructed to be a hopfield-like network with nodes representing biomarkers and directional connections to be regulations in between. The input to the network is the measured expression levels of biomarkers, and the output is the summation of regulatory strengths from other biomarkers. An energy function is defined as the measure of the disagreement between the input and output of the network. Minimizing the energy function can thus reconstruct the regulatory relationships among biomarkers. Since RN can extract unique features of each disease condition, one immediate application of RN is to classify different diseases. To simulate more complicated regulations, a sigmoid kernel function is imposed on each node to construct a non-linear regulatory network (NRN), which will be shown can enjoy higher stability and accuracy in disease classification.\n\nOur methods were applied to model protein regulations in different disease conditions. Unlike genome, which is relatively constant and simple, proteome is much more complicated due to its extensive interactions with other molecules and environmental conditions. For instance, many proteins only function in the presence of other molecules, and some proteins may cooperatively form complexes that could be involved in the translational modification of other proteins. Proteinchip of SELDI-TOF-MS (surface-enhanced laser desorption/ionization time-of-flight mass spectrometry) is a high-throughput technique that can simultaneously interrogate thousands of proteins, thus providing abundant information of protein expressions in an organism. Two datasets have been used as test beds, one dataset includes patients of nasopharyngeal carcinoma (NPC) with different responses to chemotherapy drug, and the other consists of patients of severe acute respiratory syndrome (SARS), influenza, and control normals. The regulatory networks among protein biomarkers were reconstructed for different disease conditions in each dataset. We demonstrated our methods have better classification capability when comparing with conventional methods including Fisher linear discriminant (FLD), K-nearest neighborhood (KNN), linear support vector machines (linSVM) and radial basis function based support vector machines (rbfSVM)).\n\nOur approach was validated through two real-world protein profiling datasets. The NPC dataset [19] includes 54 patients that are categorized into two groups: 10 chemo-responders (RS) and 44 nonresponders (NR). The SARS dataset [20] includes 74 patients from three disease groups: 44 SARS patients, 20 IFZ (influenzainfected) patients, and 10 control normals. These data sets were acquired by the department of oncology of Hong Kong Queen Elizabeth Hospital using SELDI-TOF-MS technology.\n\nFor both two datasets, ProteinChip profiling spectra were generated from each serum fraction with proteins/peptides displayed as unique peaks based on their mass-to-charge ratio (m/z) as analyzed by Ciphergen ProteinChip Software 3.0.2. Each peak was first baseline subtracted, then normalized with mean total ion current and included for analysis with a cutoff signal-tonoise ratio >5 for the 1st pass and >2 for the 2nd. After preprocessing, the NPC dataset contains 530 proteins, and the SARS dataset contains 103 proteins.\n\nIn brief, the RN is constructed by employing a hopfield-like network to highlight the mutual relationships among biomarkers, as shown in Fig. 1 . Each node represents a biomarker and arrow lines denote the regulatory relationships. Without loss of generality, assume that there are p biomarkers whose expression levels are denoted by a vector x = [x 1 , x 2 , . . ., x p ] T and the regulatory matrix of the RN is denoted as A = {a ij 2 R; i, j = 1, 2, . . ., p} with the element a ij representing the regulatory coefficient from the jth node to the ith node. Let x and y = [y 1 , y 2 , . . ., y p ] T be the input and output of the network, the RN can be modeled as\n\n; or written as y\n\nwhere b i , i = 1, 2, . . ., p, is a constant bias. For the matrix A, since interaction of a biomarker to itself is meaningless, the following constraint is naturally imposed:\n\nAlthough some classic neural networks (such as Hopfield network [21] ) assume the connection matrix is symmetrical, no assumption is made to the regulation matrix of the RN because two biomarkers incline to regulate each other with different strengths from a biological viewpoint.\n\nA critical issue of building the RN is how to characterize and analyze the RN. To this end, we define an energy function for the RN. The energy function can be formulated as the measurement of the disagreement between the network input and output as follows:\n\nBy substituting Eq. (1) into Eq. (3), the energy function can be rewritten as the following form:\n\nThe definition of the energy function indicates that lower energy status corresponds to higher agreement between input and output. If high agreement state remains true for all of the samples in a specific patient group, then the connection matrix of the network can reflect the consistent patterns of biomarker interactions specific to the patient group. The unique patterns of interactions can be used for disease classification. What follows presents the obtainment and optimization of the regulation matrix.\n\nLet X = [x 1 , x 2 , . . ., x l ] be the biomarker profiling observations of a specific group of patients. The optimal connection matrix A can be achieved through solving the following objective function upon the data X:\n\nwhere I is the identity matrix. Let\u00c3 \u00bc \u00f0A \u00c0 I\u00de, the objective function can be rewritten as\n\nwhere the diagonal elements\u00e3 ii of\u00c3 satisfy:\n\nBy rewriting\u00c3 as \u00bd\u00c3 1 ;\u00c3 2 ; . . . ;\u00c3 p , Eq. (6) is expanded to the following form:\n\nwhere e is a l-dimensional row vector whose elements equal one.\n\nThe present work only considers the simple case of zero bias, i.e., b i = 0, i = 1, 2, . . ., p. In this case, the objective function becomes\n\nBy rewriting the ith row vector of X as\n\nis then converted into\n\n. . . ; a i\u00f0i\u00c01\u00de ; a i\u00f0i\u00fe1\u00de ; . . . ; a i p \u00c2 \u00c3 T is unknown. Let the derivatives of the objective function in Eq. (10) toward f i be zero,\n\nwe have:\n\nBy solving Eq. (11), the regulatory coefficients can be obtained as follows:\n\nIn case that the inverse of Z T i Z i does not exists, the pseudoinverse can be used to compute the solution.\n\nAlthough the linear RN is straightforward and easy to explain, the solution may hardly converge in a robust way due to the large variations existed in the data points (especially in marginal data points). To further improve the robustness of the algorithm, we propose to construct the NRN (non-linear regulatory networks) based on the linear RN: adding a sigmoid kernel transformation unit between the input and output of the RN. The sigmoid unit takes x as input and outputs the following vector:\n\nwhere b 2 (0, 1] is a tunable sigmoid parameter, and m i \u00bc\n\nr are the mean and standard deviation of the expression data of ith biomarkers, respectively. Then, the new vector v is fed to the linear RN unit to form the NRN. For NRN, in terms of Eqs. (4) and (13), the corresponding energy function becomes\n\nWith this new energy function, the structure of the non-linear network can be determined similar to that of the linear network. In addition, the NRN can be optimized by tuning the sigmoid parameter b in Eq. (13). \n\nThe information of mutual regulations among biomarkers is stored in the connection matrix of RN. As described above, since the network is optimized towards minimizing its energy function for all the training samples in a group of patients, the connection matrix reserves the unique pattern of this specific group. In other words, for a sample belonging to this group the network will approach a low energy status, and otherwise, the network has high energy. The regulatory networks can be used to predict disease status. Without loss of generality, consider a G-class disease classification problem, we can first obtain G RNs using the network modeling algorithm as described above, which correspond to the G groups. Based on the G RNs, a classification function can be designed as follows:\n\nwhere u represents an unknown sample, D u 2 {1, 2, . . ., G} is the predicted class label, and E g is the energy function of the gth RN. Fig. 2 illustrates the classification framework. For the designed classifier, selecting significantly regulated biomarkers to construct regulatory networks is essential to achieve good classification ability. We develop a three-step selection procedure to select key proteins. First, the regulation probability method (RPM) [22, 23] is used to pre-select a number of discriminative biomarker candidates to form a biomarker panel. Second, different numbers (p = 2, 3, 4, . . .) of biomarkers from the panel are exhaustively combined, and based on each combination, the RN classification algorithm is applied. All the combinations are then evaluated by leave-one-out-cross-validation (LOOCV) accuracy. In the evaluation, to eliminate the influence of the unbalance of sample sizes of different groups the following LOOCV accuracy (Accu) is adopted:\n\nwhere t g is the number of correctly classified samples and l g is the sample number in gth class. Finally, the biomarker combination with highest accuracy is picked up as the final biomarker set. Based on the biomarker set, the final RN classifier is constructed using all training samples.\n\nThe NPC dataset was randomly divided into training set and validation set, each with 22 nonresponders and 5 responders. Firstly, we performed the three-step selection procedure on the training data to select differently expressed proteins. To determine the size of the biomarker panel, based on the regulation probability method introduced in [23], a permutation test experiment with 50 permutations was performed to calculate the significance level for each protein. As a result, 20 significant proteins with the significance of <0.1 were picked out to form the panel of biomarker. After that, we implemented the linear and non-linear regulatory network approaches to the NPC data, respectively. For the NRN classifier, the parameter b of the sigmoid function was optimized in the set of {0.001, 0.01, 0.1, 0.5 and 1} through leaveone-out cross-validation. Since small-scale network is more computationally preferable, the number of network nodes p was initially set to 2, and then was gradually increased. Considering increasingly heavy computational burden, our experiments were performed with no more than 6 nodes. Fig. 3(A) and (B) shows the changing curves of the classification performances of the RN and NRN classifiers while p is increasing.\n\nFrom the two figures, it can be found that the accuracies of both RN and NRN tend to increase with more proteins were involved, suggesting that more regulatory information is available with more biomarkers for NPC classification. Moreover, the testing accuracies of RN and NRN reached their peaks while 5 biomarkers used, indicating that five proteins can stably support the feature space to distinguish the two groups of patients. The figures also illustrate that NRN achieved a higher testing accuracy of 93% (2 errors among 27 testing samples) compared to RN (89%, 3 errors among 27 testing samples), which suggests that NRN tends to have better classification capability. Fig. 3 also shows that the testing accuracies were consistent with the LOOCV accuracies for both RN and NRN classifiers, which further indicated RN and NRN have the good generalization ability. Fig. 4 illustrates the expression levels of the 5 proteins derived by 5-node NRN in RS and NR groups, it can be seen that two proteins are down-regulated and three are upregulated. Although proteins are distinctly expressed, their expression ranges over two groups have quite large overlap. This further indicates that the regulatory network can wisely merge noisy information to produce a quality prediction. Fig. 5 illustrates the two NRNs derived from RS and NR groups. The positive interaction strengths represent promotional regulation and the negative ones represent repressive regulation. It can be found that the connection metric of the two networks is remarkably different, suggesting the regulation patterns varied in the different chemo-response groups. For example, interaction coefficients between protein M7993_48 and M2193_50 in RS group are 0.26 and 0.32, suggesting mutual promotion between the two proteins. However, the regulatory strengths become negative, suggesting mutual repression between them. Moreover, in the network of RS group, the mutual regulations between M7993_48 and M9209_62 are very weak (0.035, 0.025), but the regulation from protein M9209_62 to M7993_48 becomes very strong (12.15) . Furthermore, both of the NRNs have different dominant biomarkers with greater regulatory coefficients than any others, as marked in the hexagon nodes in Fig. 5(A) and (B) . Such dominant biomarkers may dominate the networks associated with cancer and are the hub biomarkers of the networks, which play a crucial role in cancer development [24] . The biomarkers having smaller regulatory coefficients than others are marked in the smaller circle nodes in Fig. 5(A) and (B) , which may locate at the far end of the cancer regulation pathway. These differences of regulative patterns captured by our regulatory networks play crucial roles in the RN classifier, which could be potentially meaningful in revealing the molecular mechanism of proteins in cancer development.\n\nWe then compared the classification performance of the NRN classifiers with those of conventional methods including FLD, KNN with k = 3, linSVM and rbfSVM. These methods are either linear or non-linear, and are widely used in bioinformatics and pattern recognition [25] [26] [27] [28] [29] , among them SVM has been demonstrated to have superior classification performance in various application areas [30] . In this comparison analysis, rbfSVM parameters, namely the regularization and kernel width, were optimized via two-dimensional grid search and leave-one-out cross-validation. Fig. 6 shows the classification results of NRN and other methods on the independent test set while different numbers of proteins (p) were selected. It can be seen that when p = 2 or 3, the results of NRN, KNN and rbfSVM were really close. When p is increased to 4, 5, and 6, NRN consistently outperform other methods. NRN classifier got its best accuracy of 93% when p = 5.\n\nThe SARS dataset was split to training set and test set and each with 37 samples including 22 SARS, 10 IFZ, and 5 control normals. Similar to NPC data analysis, a panel of significant proteins was first picked out by using regulation probability methods. Best protein combinations were sought through searching the panel with cross-validation training RN and NRN on the training data. Fig. 7 shows the classification performances with different number of biomarkers (p). It can be seen that both for RN and NRN, the testing accuracies increased when more proteins were involved and similar trend on LOOCV accuracies. This again confirmed that the regulatory network approach can perform very robustly with excellent generalization power. The best test accuracy of 89% was achieved by NRN when 5 proteins were involved. Fig. 8 illustrates the expression range of the 5 proteins, in which it can be seen that C03278_7 and C08131_5 highly expressed for SARS group, C08989_3 and C08954_7 highly expressed for IFZ group, and all the proteins down-regulated for control normals. Fig. 9 illustrates the three NRNs captured by the 5-node NRN classifier. It can be found that the connection metrics of the three networks are remarkably different, suggesting the regulation patterns change in the three patient groups. For example, the regulations between C08989_3 and C3278_7 are weak in SARS (\u00c00.10, \u00c00.12) and normal (0.09, 0.14), while in IFZ group, the repression strength from C3278_7 to C08989_3 becomes very strong. Also in SARS group, regulatory coefficients between protein C05909_7 and C08989_3 are 0.23 and 0.30, suggesting mutual promotion between the two proteins; while in normal and IFZ groups, their regulatory coefficients become negative, suggesting mutual repression in between. Similar to the analysis on the NPC data, the dominant and minor biomarkers of the regulatory network of each patient group are marked in hexagon and smaller circle nodes respectively. It is observed that the three NRNs have different dominant and minor biomarkers. In summary, the obtained NRNs can remarkably discriminate the three groups from the aspect of protein regulations.\n\nWe then compared the results of our NRN classifier with those of conventional approaches. Similar to that in the NPC experiment, the regularization parameter and the width of the radial basis function kernel of rbfSVM were optimized through two-dimensional grid search and cross-validation. Fig. 10 shows the comparison results, from which it can be found that NRN can always enjoy the best testing accuracies for different number of biomarkers compared to other methods, and it reached its best accuracy of 89% when p = 5. rbfSVM classifier achieved its best accuracy of 84% when 6 proteins were involved.\n\nFrom the above two applications, it can be seen that the nonlinear regulatory network performs better than its linear version. Hence we believe that the non-linear transformation in the NRN To check more details, we further compute the deviations of the five regulatory coefficient values of a protein relation. Fig. 12 shows the probability distribution of the deviations for each patient group, indicating that the deviations approach zero. The results suggest that our proposed regulatory network approach can obtain the stable and reliable regulatory relationships as long as the sigmoid parameter is properly set.\n\nSensitivity and specificity are another two important criteria for the evaluation of classification performance. In general, sensitivity is considered to be capable of reflecting how good a test is at picking out patients with a disease, and specificity refers to the ability of the test to pick out patients who do not have the disease. As an example, for the NPC dataset, we set the nonresponder group as the positive class and responder group to be negative. For SARS dataset, we take one class as the positive class and the left two classes as negative in turn to make evaluation. As a result, the sensitivities and specificities of our NRN classifiers and the three methods, KNN, linSVM and rbfSVM, are shown in Table 1 . It can be found that all sensitivity and specificity values of our NRN classifier are higher than 80%, which are better than those of the three previous approaches. It is also observed that irrespective the NPC dataset or the SARS dataset, the NRN classifier has less variation between sensitivity and specificity than any of the three previous approaches. This advantage should be due to the capsulation of the optimized regulatory networks for each group in the NRN classifier.\n\nIn this paper, we proposed a novel approach of regulatory network for regulatory pattern extraction and disease classification. The derived networks can effectively capture the unique regulatory patterns of protein markers associated with different patient groups and hence can be used for disease classification. In the experimental section, the proposed regulatory networks have been validated on two real-world protein profiling dataset, NPC and SARS. The comparisons of our method and the conventional methods, including FLD, KNN, linSVM and rbfSVM have been made as well. Experimental results showed the effectiveness and efficiency of our networks in capturing the regulatory patterns of various diseases as well as the excellent discriminative power. In contrast to conventional methods, the proposed approach can characterize complex regulation relationships and perform disease classification in an accurate manner. The regulatory patterns of disease classes were encapsulated in the regulatory coefficients of the RNs. From a biological viewpoint, the positive coefficients represent up-regulation which promotes the expression of the regulated genes, while the negative coefficients represent downregulation which represses the expression of the regulated genes, and the absolute values of the coefficients indicate the corresponding regulation strengths. The discovered regulation relationships The best results of different methods upon the two datasets (NPC and SARS) are shown in bold values. can potentially provide insights to revealing the molecular signaling pathways."}