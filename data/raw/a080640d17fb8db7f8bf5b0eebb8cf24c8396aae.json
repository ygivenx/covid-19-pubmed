{"title": "Experimental study on a comprehensive particle swarm optimization method for locating contaminant sources in dynamic indoor environments with mechanical ventilation", "body": "In modern society, people spend as much as 90% of their time in indoor environments [1] . With the improvement of living standards, people are increasingly aware of the importance and urgency of indoor air pollution control. Improving indoor air quality has become a trending topic worldwide [2, 3] . In recent years, the continuous growth of the electronic information, aerospace, precision instrument, medical and health industries has greatly promoted the development of the clean room industry. In industrial and biological clean rooms, it is often necessary to consume a large amount of energy to strictly control airborne particles and gaseous contaminants to meet specific process requirements [4] .\n\nto achieve an ideal steady state. The main reasons are as follows: first, the air supply velocity of mechanical ventilation systems always fluctuates slightly; second, the air supply direction sometimes periodically swings up and down or left and right according to the needs of indoor personnel; and finally, various interference factors, such as the switching of ventilation modes, movement of personnel or equipment, and changes in heat source intensity, can disturb the indoor airflow field. Compared with steady-state indoor environments, dynamic indoor environments not only have more complex air distribution characteristics but also have more complex spatial and temporal contaminant distribution characteristics and therefore pose new challenges in source localization [10] .\n\nThe available methods for source localization can be roughly categorized into two types: stationary sensor network methods and robot active olfaction methods. Stationary sensor network methods require the installation of one or more sensors in the indoor space in advance, after which the source location must be identified from sensor readings by using forward or backward models. Most of the available studies on stationary sensor network methods have focused on steady-state indoor environments [8, [10] [11] [12] [13] [14] [15] [16] [17] [18] [19] [20] [21] (a detailed review is provided in [22, 23] ), and only very few attempts have been made to locate sources in dynamic indoor environments. Wang et al. [10] proposed an adjoint probability-based method for identifying the contaminant source location in dynamic indoor environments. The method was validated by computational fluid dynamics (CFD) simulations and assumed that the simulated airflow data were consistent with those obtained in real-world conditions. However, most real-time dynamic airflows are difficult to accurately simulate by CFD models due to the uncertainty and complexity of dynamic airflows, which poses a great challenge to stationary sensor network methods.\n\nRobot active olfaction methods have been inspired by many animal behaviors, such as foraging, finding mates and evading predators [24, 25] . This type of method normally uses mobile robots equipped with gas or airflow sensors to initiatively track and locate release sources and decomposes the task of locating a source into three phases [26] : plume finding (contacting the gas), plume traversal (approaching the source), and source declaration (confirming the source). Compared to stationary sensor network methods, active olfaction methods have better adaptability in unknown environments because they can be executed by directly using sensor readings independent of numerical simulations; furthermore, active olfaction methods do not require environmental model construction and environmental sensor installation in advance. According to the number of robots used, this type of method can be divided into two categories: single-robot and multi-robot active olfaction methods. In recent years, multi-robot active olfaction methods have attracted increasing attention due to their high efficiency, good scalability, and strong robustness [27] .\n\nTo date, most research on robot active olfaction methods [9, [28] [29] [30] [31] [32] has been conducted in steady-state airflow environments, and only a few attempts have been made in recent years to locate sources in dynamic indoor environments. Compared to steady-state indoor environments, dynamic indoor environments pose two major challenges to robot active olfaction methods. First, the airflow velocity and direction at any position in the indoor space can fluctuate greatly with time, which not only makes it more difficult to accurately detect the airflow velocity and direction but also reduces the timeliness of the detected information. Therefore, the airflow velocity and direction are difficult to use in active olfaction methods. Second, the contaminant concentration distribution in indoor spaces can change greatly with time, which not only leads to the generation of more local extremum areas (where the concentration is higher than that in surrounding area) but also changes the locations of these local extremum areas. Therefore, variations in the contaminant concentration distribution will make it more difficult for the robots to continuously track the plume and easier for the robots to become trapped in local extremum areas.\n\nConsidering the difficulties of locating sources in dynamic environments, most available works have used multi-robot active olfaction methods. Typical methods include the adapted ant colony optimization (ACO) method [33, 34] , the particle swarm optimization (PSO) method [35] , and modified PSO methods [36] [37] [38] [39] [40] . Although there have been some preliminary explorations of the source localization method for dynamic indoor environments, most of these methods were validated by numerical simulations, and only very few experimental studies have been reported [34, 37] . Simulation studies based on time-averaged equations cannot easily reflect the turbulence characteristics of indoor airflows, intermittent contaminant concentrations with large fluctuations, or disturbances to the airflow and concentration fields caused by robot movement. Therefore, from the perspective of practical applications, experimental research in real environments is more valuable and meaningful than numerical simulation research.\n\nAmong the available multi-robot active olfaction methods, the most commonly used algorithm is the PSO algorithm because this method is characterized by fast convergence, high cooperation efficiency, few parameters to be adjusted and ease of use [40] . However, this algorithm can easily cause the robots to become trapped in local extremum areas. To overcome this drawback, we previously developed an improved particle swarm optimization (IPSO) algorithm by combining concentrations and airflows to enable robots to continuously track the plume [41] . However, this algorithm was only validated in steady-state indoor environments that were simulated by CFD. In this study, considering the complexity of airflow and concentration distributions in dynamic indoor environments, we present a comprehensive particle swarm optimization (CPSO) method that integrates the IPSO algorithm with a source confirming algorithm and a strategy for escaping from local extremum areas to improve the success rate and efficiency of source localization. We further experimentally validated the CPSO method and compared it with a standard PSO method (SPSO) and a modified PSO method with wind utilization II (WUII) [36] . The main contributions of this paper are as follows:\n\n(1) A CPSO method was developed for source localization in dynamic indoor environments with mechanical ventilation. This method integrates our previously presented IPSO algorithm with a source confirming algorithm and a strategy for escaping from local extremum areas to improve the success rate and efficiency of source localization. (2) A multi-robot source localization system was developed, and three robots were used to validate the presented method at two typical source locations (DS, in the downwind zone, and RS, in the recirculation zone) in a dynamic indoor environment with the air supply louvers of a cabinet air conditioner periodically swinging from left to right. The presented method was tested by performing 15 independent experiments at each source location. (3) In the same experimental environment, the CPSO method was compared with the SPSO and WUII methods with respect to success rate and efficiency; the CPSO method not only has a much higher success rate than the SPSO and WUII methods but also has a higher efficiency.\n\nAccording to the CPSO method presented in this paper, the robots have three basic motion modes in the source localization process: (1) Plume finding mode. After departing from the starting positions, the robots use a plume finding algorithm to continuously search for unknown areas until one of the robots detects a specific contaminant in the air (this process is called plume finding). (2) Plume tracking mode. With a plume tracking algorithm, the robots continuously track the plume of the contaminant and move toward higher concentrations until a local extremum area is found. \"Local extremum area\" refers to an area in which the concentration is higher than that in the surrounding area. (3) Source confirming mode. The robots use a source confirming algorithm to determine whether the source has been found.\n\nAccording to the three motion modes, the presented method integrates three core algorithms: a plume finding algorithm, a plume tracking algorithm, and a source confirming algorithm. In addition, the method integrates an obstacle avoidance algorithm to prevent collisions among robots and avoid obstacles. Fig. 1 shows the basic procedure of source localization by using the presented CPSO method. First, after departing from the starting positions, the robots start in the plume finding mode. When one of the robots finds the plume, all the robots switch to the plume tracking mode. In the plume tracking process, if the robots find a local extremum area, they switch to the source confirming mode. If the robots determine that the source has been found, they terminate the source localization process and report the source location; otherwise, they restart the plume finding mode to escape from this local extremum area. After escaping from the local extremum area, the robots switch back to the plume tracking mode to find the source again.\n\nThe presented method uses a divergence search strategy in the plume finding stage [9] ( Fig. 2 ) . After the contaminant is released, all the robots depart from the starting positions and move toward different directions at the same speed to quickly find the plume and search the largest possible area. The moving trajectory of each robot is a straight line, and the angle between the lines is the same ( Fig. 2 ) . During the plume finding process, if a robot hits the building boundaries, it will change its direction of movement according to the law of reflection. If a robot detects a contaminant concentration that exceeds the preset threshold c min , all the robots will switch to the plume tracking mode. In practical applications, c min can usually be set to the detection threshold of the specific sensor carried by the robot [24] .\n\nIn our previous papers [9, 41] , we introduced the basic principles of the standard PSO algorithm and the IPSO algorithm in detail, as shown in Fig. 3 . In the following, we only briefly describe the principle of the IPSO algorithm. In this paper, the contaminant concentration detected by the i -th robot R i ( i = 1 , 2 , ..., N) at time step t ( t = 1, 2, \u2026) is represented by c i ( t ), which is used to evaluate the fitness value of R i . According to the IPSO algorithm, the location and velocity vector of R i from time step t to t +1 are updated as:\n\nwhere P i ( t ) (m) and V i ( t ) (m) are the location and velocity vector of R i at time step t , respectively; w is a dimensionless inertia weight; and l 1 , l 2 and l 3 are dimensionless learning factors (for a detailed explanation, refer to [9] ). According to previous research [36] , w, l 1 and l 2 are normally set to 1.0, 2.0 and 2.0, respectively. In this study, l 3 is set to 3.0, because a greater value of l 3 allows the robot to follow the airflow more quickly; r 1 , r 2 Schematic of the plume tracking principle using the (a) standard particle swarm optimization (SPSO) algorithm [36] and (b) improved particle swarm optimization (IPSO) algorithm [41] .\n\nR i at time step t (m), expressed as:\n\nwhere V max is the maximum step length (m), namely the maximum moving distance of a robot at a time step; V s i is the airflow velocity of R i obtained at time step t (m/s); V s min is the threshold of the airflow sensor (m/s); and V r is a dimensionless random direction vector uniformly distributed within a range of [ \u22121, 1] that is added to the upwind velocity of R i when the air velocity is lower than the sensor threshold.\n\nIf the variation in the global maximum location P * g (t) within a time step T is not greater than the maximum step length of the\n\nbelieve that they have found a local extremum area and cannot easily find a higher concentration by using the IPSO algorithm. At this time, the robots switch to the source confirming mode and use the maximum concentration method to determine whether the global maximum location is in the vicinity of the source or in a local extremum area away from the source.\n\nThe maximum concentration method is used to confirm the source and terminate the source localization process. After the robots find a local extremum area, if the concentration detected at the global maximum location is not less than the preset concentration threshold c max for source confirming, they will determine that the global maximum location is in the vicinity of the source and terminate the source localization process. Otherwise, the robots will determine that the global maximum location is in a local extremum area away from the source and will diverge to find higher concentration values and a better global maximum location.\n\nIf the robots confirm that they have been trapped in a local extremum area away from the source, they will use the divergence search algorithm ( Fig. 2 ) to escape from the local extremum area and find a higher concentration. In the divergence search process, if the robots find a concentration higher than c * ( t ) within the time\n\n, they conclude that they have escaped from the local extremum area and then adopt the IPSO algorithm ( Section 2.3 ) to track the plume. If the robots have not yet detected a concentration higher than c * ( t ) after the time step T , they conclude that they have escaped from the local extremum area (because after the divergence search in the time step T , the robots are far from the local extremum area and will not easily be trapped in this area again) and cannot find a concentration higher than c * ( t ); then, the robots turn to find a concentration higher than c min to rediscover the plume, namely,\n\nIn real-world applications, robots can rely on video vision, infrared rays, laser radar and other techniques to avoid obstacles, but this process sometimes consumes too much time. To shorten the time for avoiding obstacles and speed movement away from obstacles, we developed a simple obstacle avoidance algorithm for each robot. The algorithm uses obstacle locations and building boundaries to avoid obstacles according to the reflection law, as described in [31] . In addition, to reduce collisions among robots during their moving processes, we also specify in the obstacle avoidance algorithm that if the next position calculated by a robot is at the current position or next position of other robots, this robot will move one step in the opposite direction with a step length r \u00d7 V max ( r is a random number evenly distributed between [0, 1]).\n\nThe experiments were conducted in a laboratory with a length of 6.6 m and a width of 4.9 m ( Fig. 4 ) . The laboratory contained a test area (5.3 m \u00d7 4.9 m) where the robots were able to move and an operation area (1.3 m \u00d7 4.9 m) where personnel stayed during experiments. An armchair, a table, a cabinet air conditioner and a source release device were placed in the operation area. During each experiment, the air supply louvers of the air conditioner periodically swung from left to right (the swing range was about 0-50 \u00b0) to create a typical time-varying mechanical ventilation environment. In addition, the doors and windows with rubber seals of the laboratory were closed during each experiment to prevent the influence of the outdoor environment.\n\nEthanol vapor was used as a tracer gas because it is minimally toxic, volatile and easy to detect and has been widely used in source localization research [42] . During each experiment, a water bath (60 \u00b0C) was used to heat ethanol liquid in a flask to control its evaporation rate at approximately 12.5 mg/s, and an air pump was used to transport the ethanol vapor through a rubber pipe to the release location ( Fig. 4 (b) ). To validate the effectiveness of the presented method, two typical source locations were set: DS and RS (see Fig. 4 (c) and Table 1 ). The height of the source was set to 1.05 m, which is roughly the height of the nostrils when an average adult is sitting [43] . DS was a typical source location in the downwind zone of the laboratory because it was close to the air supply outlet of the air conditioner and was strongly affected by the air supply. In contrast, RS was a typical source location in the recirculation zone of the laboratory because it was far from the air supply outlet and was less affected by the air supply.\n\nTo test the dynamic airflow characteristics in the laboratory, two 2D ultrasonic anemometers (sampling frequency of 1 Hz) were used to measure the airflow directions and velocities at the two typical source locations (DS and RS) ( Fig. 4 (c) ). The ultrasonic anemometer can accurately measure the air velocity as low as 0.01 m/s [25] .\n\nThree Turtlebot2 mobile robots developed by Willow Garage were used; the robots have the characteristics of flexible movement (two side-by-side driving wheels and two fore and aft driven wheels for moving and rotating), high positioning accuracy (line error: \u00b15 cm, angle error: \u00b15 \u00b0), and autonomous navigation (autonomous obstacle avoidance and path planning). Each robot car- ried an embedded single-board computer (NVIDIA Jetson TK1), a laser ranging radar system (RPlidar A2), an ultrasonic anemometer (Windsonic, Gill) and a gas sensor (MICS 5524) ( Fig. 5 ) . The singleboard computer controlled the robots through the robotics middleware Robot Operating System (ROS). The laser ranging radar system combined with the robot's own odometer for navigation and to determine the robot's location. Ultrasonic anemometers were used to collect air velocity and direction information, and gas sensors were used to measure the ethanol concentration. The detailed parameters are shown in Table 2 . Before each experiment began, the windows and doors were opened to remove the remaining ethanol vapor until the indoor ethanol concentration was less than 5 ppm. Then, the windows and doors were closed, the air conditioner and the air pump were turned on, and the robots were in standby at their starting positions ( Fig. 2 (c) and Table 1 ). After ethanol vapor had been released for 60 s, the robots departed to locate the source. The robots adopted the \"move-stop-move\" strategy; that is, after each robot moved forward one step, it stayed for a while to collect airflow and concentration information and then continued to move [34] .\n\nA central computer was used to communicate with the robots and coordinate their movements. After each robot collected the concentration, air velocity and direction information, the information and the current position of each robot were sent to the central computer. The computer first calculated the time-averaged values of the concentration, air velocity and direction and then calculated the target position of each robot in the next step according to the source localization algorithm. After each robot received the target position from the computer, it moved to that position and collected information again. The use of the central computer facilitated recording the robot's positions, processing the collected information, and analyzing the source localization process in a real-time manner. Each robot moved forward one step for approximately 10 s and then stopped and collected information at a sampling frequency of 10 Hz for 5 s. In addition, each robot moved with a maximum linear speed of 0.3 m/s and a maximum step length of 0.4 m to reduce the influence of movement of the robots on the airflow and contaminant concentration.\n\nIn each experiment, the concentration threshold for each robot to find the plume was set to 15 ppm. During the plume tracking, if the global maximum location of the three robots changed by less than or equal to 0.4 m (equal to one step) in 5 consecutive steps, the robots concluded that they had entered a local extremum area and then used the concentration maximization method to confirm whether they had reached the source. The concentration threshold for source confirmation was set to 60 ppm. In addition, to avoid spending too much time on a single trial, if the robots had moved 50 steps (approximately 15 min), the robots terminated the source localization algorithm.\n\nAfter the source localization algorithm was terminated, if the distance between the source location determined by the robot (global maximum location) and the actual source location did not exceed 0.5 m, it was considered that the robots had successfully found the source; otherwise, the source localization trial was considered to have failed. The reason for this designation is first that this localization error (0.5 m) can generally meet the requirements of practical applications [44] ; second, when the source is close enough, the robots can use a camera or other device to determine the source location [45, 46] . Fig. 6 shows the airflow information measured for 300 s at the two source locations, DS and RS. As shown in the figure, the airflow direction fluctuated greatly at both DS and RS; the fluctuation at DS exhibited obvious periodicity, while the fluctuation at RS was chaotic. Moreover, the airflow velocity also fluctuated at both DS and RS. The magnitude of the airflow velocity fluctuation at DS was significantly larger than that at RS, and the airflow velocity at DS fluctuated periodically, while the airflow velocity at DS fluctuated chaotically. In addition, the time-averaged airflow velocity at DS was significantly higher than that at RS. The above results show that the airflow directions at both DS and RS fluctuated greatly; the airflow velocities at DS fluctuated more greatly than that at RS; the fluctuation in the airflow directions and velocities at DS exhibited obvious periodicity because this location was more affected by the air supply of the cabinet air conditioner.\n\nThe presented method was tested by using three robots to locate the source in two release scenarios with different source locations: DS and RS ( Fig. 4 ) . In each scenario, 15 independent experiments were conducted. As shown in Table 3 , for source location DS, the source was successfully located in all 15 experiments, and the success rate (the number of successful experiments divided by the number of total experiments) was 100%; for source location RS, 14 experiments were successful (only 1 experiment failed), and the success rate was 93.3%. These results indicated that the presented method is robust in a time-varying mechanical ventilation environment. Table 3 also lists the averages and standard deviations of the number of steps required to locate the source at DS and RS. Note that each robot moved by the same number of steps in each experiment. Therefore, the average is the average number of steps moved by any one of the robots in all successful experiments. For DS and RS, the average steps were very similar, and the difference between the points was less than one step. However, the standard deviation in steps for DS was slightly larger than that for RS. The larger the standard deviation is, the greater the dispersion of the data. The reason for the observed difference may be that the periodic swinging of the cabinet air conditioner louver from left to right causes periodic changes in the air supply; furthermore, the effect of air supply at DS is significantly greater than that at RS. In other words, the variation in the airflow and concentration field near DS over time is much larger than that near RS. Fig. 7 shows the source localization process of the robots (R1-R3) and the maximum time-averaged concentration collected by the robots at each step in a typical successful experiment (the video of the experiment is provided in the supplemental material). In this experiment, each robot moved 27 steps. After the robots departed, they first found the plume, then tracked the plume and continuously confirmed whether they had found the source during the tracking process. From finding the plume to finally locating the source, the main stages experienced by the robots are becoming trapped in a local extremum area, escaping from the local extremum area, rediscovering the plume, and then tracking the plume.\n\nAfter departing from the starting positions, the robots (R1-R3) used a divergence search strategy to move straight in different directions to quickly find the plume. At the 4th step, R2 found the plume ( Fig. 7 (a) ).\n\nAfter the 4th step, the robots switched to the plume tracking mode. At the 10th step, R2 detected a higher time-averaged concentration ( Fig. 7 (b) and (c)), which was less than the threshold c max set in Section 2.2 ; thereby, the robots determined that a local extremum area had been found according to the maximum concentration method. Subsequently, the robots used the divergence search strategy to quickly escape this area and try to find a higher concentration. At the 17th step, R2 detected a higher concentration, and then R1-R3 restarted plume tracking.\n\nFurther analysis of Fig. 7 reveals that although robot R2 was closer to the source from the 10th step to the 11th step, it failed to detect a higher concentration, which caused it to move away from the source in the next step. The above results indicate that due to the periodic variation in the air supply direction of the cabinet air conditioner, the airflow direction and contaminant concentration near the source fluctuated greatly with time, which misled the robots, causing them to move away from the source, and made it more difficult for the robots to continuously track the plume.\n\nAfter the 17th step, the robots escaped from the local extremum area and tracked the plume again. At the 22nd step, R2 detected a higher time-averaged concentration and reached the vicinity of the source ( Fig. 7 (b) and (c) ). Subsequently, R2 started searching near the source, trying to find a higher concentration; at the same time, R1 and R3 continued to approach R2. All the robots failed to find a higher concentration until the 27th step. Because the maximum time-averaged concentration detected by the robots at the 22nd step was greater than c max , the robots determined that the source had been successfully located according to the maximum concentration method and ended the source localization process. The distance between the source location determined by the robots and the actual source location was 0.11 m (less than 0.5 m); therefore, we consider that this experiment was successful.\n\nFurther analysis of Fig. 7 also reveals that after the 17th step, R2 could continuously track the plume and quickly move to the source, indicating that the presented method has a good ability to continuously track plumes in a time-varying indoor airflow field and thus can find the source with fewer moving steps (or shorter time). Fig. 8 shows the source localization process and the maximum time-averaged concentration collected by the robots at each step in a typical successful experiment (the video of the experiment is provided in the supplemental material). In this experiment, each robot moved 24 steps, and the main stages of source localization were similar to those illustrated in Fig. 7 . The detailed analysis of the source localization process is as follows.\n\nAfter the robots set off, they used a divergence search strategy to move straight in different directions, and R2 found the plume at the 8th step ( Fig. 8 (a) ). \n\nTrapping in and escaping from a local extremum area. After the 8th step, the robots switched to the plume tracking mode. At the 14th step, R1 detected a higher time-averaged concentration ( Fig. 8 (a) and (c) ), and R1-R3 considered that they had found an optimum concentration. Subsequently, R1-R3 used the maximum concentration method to confirm whether the location was close to the source. After the robots determined that they were trapped in a local extremum area rather than near the source, they used the divergence search strategy to quickly escape this area and try to find a higher concentration. At the 17th step, R3 detected a higher concentration, and then R1-R3 restarted the plume tracking mode.\n\nAfter escaping from the local extremum area and restarting the plume tracking mode, R3 detected a higher time-averaged concentration and reached the vicinity of the source at the 19th step ( Fig. 8 (b) and (c) ). Subsequently, R3 began to search near this location in an attempt to find a higher concentration, while R1 and R2 continued to approach R3. At the 24th step, R3 detected a higher concentration and returned to the vicinity of the source. Subsequently, the robots determined that the source had been successfully located according to the maximum concentration method and ended the source localization process. The distance between the source location determined by the robots and the actual source location was 0.09 m (less than 0.5 m), indicating that this experiment was successful.\n\nThe results of the only failed experiment for locating RS are shown in Fig. 9 (the video of the experiment is provided in the supplemental material). Each robot moved 21 steps in this experiment, and the main stages of source localization were similar to those illustrated in Fig. 8 . In the following, we will briefly describe the source localization process and highlight the differences between Figs. 9 and 8 .\n\nAfter departure, the robots used the divergence search algorithm to find the plume and switched to the plume tracking mode due to the discovery of the plume by R2 at the 6th step. At the 8th step, R2 detected a higher time-averaged concentration and further determined that the robots were trapped in a local extremum area, according to the concentration maximization method. Subsequently, the robots escaped from this area using the divergence search algorithm. At the 16th step, R2 detected a higher timeaveraged concentration and then tracked the plume again. At the 21st step, the robots found an optimum location again, determined that the source had been found according to the concentration maximization method and ended the source localization process. The distance between the source location determined by the robots and the actual source location was 0.65 m (slightly greater than 0.5 m), indicating that this experiment failed.\n\nFurther analysis of Fig. 9 also reveals that the distance between R3 and the source was less than 0.5 m at the 19th step and that the distance between R2 and the source at the 20th step was also less than 0.5 m, indicating that the two robots met the standard for source finding in sequence. However, at these two time steps, neither of the robots detected a higher concentration, so they subsequently moved away from the source. In the end, the robots mistakenly believed that R2 had found the source at the 16th step and ended the source localization process according to the maximum concentration method. The above results indicate that due to the periodic variation in the air supply direction of the cabinet air conditioner, the airflow direction and the contaminant concentration near the source fluctuated greatly with time, which not only made it more difficult for the robots to continuously track the plume but also may have caused the source localization process to fail according to the maximum concentration method.\n\nThe presented CPSO method was experimentally compared with two other PSO-based active olfaction methods: SPSO and WUII [36] . Considering the limitations of the experimental workload, we only chose source location DS to compare and analyze the performances of the three methods. One of the reasons is that compared with the airflow field at other locations, the airflow field at this location was more affected by the periodic variation in the air supply direction ( Fig. 6 ) and the time-dependent characteristics of the airflow field at this location were more significant. Another reason is that when the source is in the downwind zone, the spread of contaminants or hazardous substances is usually faster; therefore, DS is also a more noteworthy location.\n\nTo ensure that the benchmarks for comparison were consistent, the three experimental methods used the same plume finding strategy, obstacle avoidance algorithm and other settings, such as the number of robots used and the maximum step length of each robot. Table 4 summarizes the experimental results of the three methods. As shown in Table 4 , the CPSO method achieved the highest success rate, reaching 100%, which was significantly higher than those of the SPSO and WUII methods (20% and 40%, respectively). The success rates of the SPSO and WUII methods were less than 50%, indicating that neither method can meet the requirements of practical applications in time-varying airflow fields.\n\nFrom the perspective of source localization efficiency, the average number of steps of the CPSO method was the lowest and was significantly lower than those of the SPSO and WUII methods. The average number of steps of the CPSO method (24.4) was 26.1% and 35.8% lower than that of the SPSO method (33.0) and WUII method (38.0), respectively. These results reveal that the presented method not only has a much higher success rate but also has a higher source localization efficiency than the SPSO and WUII methods in time-varying indoor airflow environments with mechanical ventilation. The experimental results in Table 4 also show that the success rate of the WUII method was significantly higher than that of the SPSO method; however, the average number of steps of the WUII method was higher than that of the SPSO method, indicating that the introduction of the upwind effect in the WUII method helps improve the success rate of source localization but may not improve the efficiency of source localization in time-varying indoor airflow environments with mechanical ventilation.\n\nTo quickly locate a contaminant source in a time-varying indoor environment with mechanical ventilation, we presented and experimentally validated a CPSO method that was developed based on the IPSO algorithm presented in our previous study [41] . This study extended the applications of the multi-robot active olfaction method from steady-state indoor environments to time-varying indoor environments with mechanical ventilation.\n\nThe presented IPSO method used a maximum concentration method for source confirming. The accuracy of this method is closely related to the choice of concentration threshold. In this study, this threshold was the average of concentrations measured before the experiments at 8 points equally spaced on a circle centered on the source and having a radius of 0.5 m. In 30 experiments at two different source locations (DS and RS), only one experiment failed ( Fig. 9 ) , and the success rate was close to 100%, indicating that the maximum concentration method was effective and the concentration thresholds had been appropriately selected. In practical applications, we recommend that before the robots are put into use, users should first analyze the release characteristics of the source according to the specific application scenario and then determine an appropriate concentration threshold by robot experiments or simulations. In future research, we will incorporate other auxiliary information (such as airflow [47] and vision information [46] ) into the concentration maximum method to further improve the success rate of source confirming.\n\nThe presented method considers the free movement of sensors in the three directions of length, width and height, and all experiments were conducted in a three-dimensional indoor environment. However, to reduce the complexity of the robot mechanism, the sensors carried by the robots only moved in a two-dimensional plane in the experiments. In future research, we will modify the robots to realize the movement of sensors in the height direction and further analyze the effects of the sensors' movement in the height direction and the height of the contaminant source on the success rate and efficiency of source localization.\n\nThe performance of the presented method can be affected by the environmental factors (e.g., the characteristic of the dynamic airflow, ventilation mode, source location and source release rate profile), the parameters of the method (e.g., learning factors, concentration threshold for finding plume and confirming source), the robots (e.g., the number, step length and starting position) and the performance of sensors (e.g., sensor threshold and measurement error). In practice, we recommend that the users should fine tune the source localization system through real robot experiments or numerical simulations to ensure that the system can achieve the expected success rate in the specific environment. In future study, we will combine real robot experiments with numerical simulations to study the influencing factors and influence laws of the presented method, and further study how to optimize the method.\n\nThis study presented a comprehensive particle swarm optimization method (CPSO) for locating a contaminant source in timevarying indoor airflow environments with mechanical ventilation. This method uses an IPSO algorithm that combines concentration and airflow information to enable the robots to continuously track the plume. In addition, this method integrates a source confirming algorithm and divergence search strategy to guide the robots to escape from local extremum areas and finally find the source. The effectiveness of the method was validated by three robots in a typical time-varying airflow environment with the air supply louvers of a cabinet air conditioner periodically swinging from left to right. Moreover, the performance of the method was compared with the standard particle swarm optimization (SPSO) and wind utilization II (WUII) methods in the experimental environment. The experimental results led to the following conclusions:\n\n(1) For the two typical source locations, DS (in the downwind zone) and RS (in the recirculation zone), 15 and 14 experiments were successful, respectively, out of 15 experiments using the presented method (the corresponding success rates were 100% and 93.3%), indicating that the method has a high success rate and strong robustness in a timevarying airflow environment with mechanical ventilation. For DS and RS, the average numbers of steps moved by each robot were very close, 24.4 steps and 23.6 steps, respectively, and the standard deviations were 6.6 steps and 4.0 steps, respectively. The standard deviation in steps for DS was slightly higher than that for RS, indicating that the airflow and concentration fields near DS were more affected by the periodic swinging of the cabinet air conditioner louver than those near RS, which caused the larger difference in steps obtained when locating the source at DS. (2) Analysis of the source localization processes in the experiments shows that the presented method confers the robots a good ability to continuously track the plume and the ability to successfully escape from a local extremum area and continue to approach the source location when they are trapped in such an area. In the experiment, due to the periodic change in the air supply direction of the cabinet air conditioner, the airflow direction and contaminant concentration near the source fluctuated greatly with time, which not only increased the difficulty of continuously tracking the plume but also may lead to misjudgment of the source confirming algorithm based on the maximum concentration method. (3) For the source location at DS, 15 experiments were conducted by using the CPSO, SPSO and WUII methods, with 15, 3 and 6 successful experiments; success rates of 100%, 20% and 40%; averages of 24.4, 33.0, and 38.0 steps for source localization; and standard deviations of 6.62, 5.57 and 5.14 steps, respectively. The experimental results show that the presented method not only has a much higher success rate than the SPSO and WUII methods but also has higher source localization efficiency.\n\nWe declare that we do not have any commercial or associative interest that represents a conflict of interest in connection with the work submitted."}