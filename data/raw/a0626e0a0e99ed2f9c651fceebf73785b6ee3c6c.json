{"title": "Multiple peaks patterns of epidemic spreading in multi-layer networks", "body": "Epidemic spreading in networked populations has been studied intensely in the last decade, and a lot of great progresses has been achieved [1] [2] [3] [4] which significantly increased our understanding. This is actually useful for public health authorities to assess situations quickly, to take and enforce informed decisions, and to optimize vaccination and drug delivery policies. Initially, the main attention focused on static networks, where each node represents an immobile agent and the contagion occurs only between neighboring nodes: it was revealed that scale-free networks display a vanishingly small epidemic threshold in the thermodynamic limit [5, 6] . After that, the focus shifted to reaction-diffusion models [7] [8] [9] [10] , flow-driven epidemics [11] [12] [13] [14] [15] , objective spreading [16, 17] and adaptive behaviors [18] [19] [20] [21] [22] . Finally, in a third stage, multilayered [23] [24] [25] [26] [27] [28] [29] [30] [31] [32] and temporal [33, 34] networks were assumed to play a critical role on such processes.\n\nA common feature in past studies is the use of phenomenological models which typically produce a single peak of infected density in each individual epidemic spreading. An interesting question is therefore whether or not all real evolutionary processes are conveniently represented by such a framework. A scrupulous anal- * Corresponding author.\n\nE-mail address: zhliu@phy.ecnu.edu.cn (Z. Liu). ysis of a large number of real data from different cities over the world surprisingly shows that, besides a major pattern made of a single peak, there is a finite and non negligible probability for a new pattern of epidemic outbreak featuring two (or multiple) peaks. Notice that a two peaks pattern implies two outbreaks in a single spreading period, i.e. a secondary occurrence of the same epidemics, which may in turn produce severe calamities and disasters within unprepared populations. Understanding the underlying mechanism at the basis of this new pattern (with the help of a novel model extracted from real data) is therefore quintessential to properly cope with such life-threatening hazards. Previous studies showed that the phenomenon of multiple peaks in epidemics may occur in weak coupled different communities, where a full homogeneous mixing cannot be assumed [35] [36] [37] [38] . Considering that human behaviors occur in social networks, a key problem for further studies is how the network structures influence the formation of two-peaks patterns and the transition between the case of single peak and that of two peaks.\n\nWe here study this problem by presenting a network based model to reproduce the phenomenon of two peaks from epidemic data. As social activities and interactions occur in network structures, we here consider the epidemics in different geographic regions (or cities) as that occurring in multilayered graphs. Namely, we will take two coupled neighboring regions as an example, and construct a two-layered network model which fully reproduces the observed patterns of epidemics. In particular, we demonstrate that the pattern of two peaks originates from large time delays of epidemic outbreaks between the two layers, which depends in turn on both the difference in the degree distributions of the two layers and a weak coupling condition between them. To better understand the findings, an edge-based theory is developed which perfectly agree with the numerical simulations.\n\nMonitoring the potential outbreaks of an epidemic spreading is of extreme importance for protection of our society. Based on the detected trend of spreading of infections such as SARS (Severe Acute Respiratory Syndrome), H1N1 (Swine Influenza), H5H1 (Avian Influenza), and Ebola, one can indeed attempt to enforce suitable measures able to reduce the epidemic at its maximum extent. For this purpose, many countries have established their sentinel surveillance systems to collect epidemic data. For instance, Hong Kong Department of Health has organized a surveillance system, with the aim of collecting empirical data of infectious diseases, and of analyzing and predicting the trend of the infection. In such a system, there are about 64 General Out-Patient Clinics (GOPC) and 50 General Practitioners (GP), which form two distinct sentinel surveillance networks of the city [39, 40] . In these two networks, one obtains for instance the weekly consultation rates of influenza-like illness (per 1,0 0 0 consultations), which reflect the overall influenza-like illness activity in Hong Kong. Fig. 1 (a) shows the collected data from 1998/1/3 to 2014/8/2 in GP, while the corresponding data of GOPC is not shown here. From Fig. 1 (a) one sees that there are many events of epidemic spreading, and the intervals between two consecutive events are not regular, indicating non-periodic outbreaks of recurrent epidemics [40] . On the other hand, one notices from Fig. 1 (a) that most of the outbreaks correspond to a single peak of infected density, which is the pattern well described by the classical susceptible-infectedrefractory (SIR) models. However, one notices also that there is a finite probability for a novel pattern of epidemic outbreak which features, instead, two or multiple peaks. Fig. 1 (b) shows one of such patterns (with two peaks) occurring at around 2005/6, which indicates that an infectious disease raised two times during that epidemic period in Hong Kong. Such unexpected phenomenon also exists in the data from GOPC (not shown here).\n\nThese multiple peaks patterns are actually occurring generically, and are not limited to a specific geographical region. Epidemic data from other sources and cities display, indeed, ubiquitously patterns similar to that reported in Fig. 1 (b) . For instance, Fig. 1 (c) shows the data of the weekly measles infective cases (WMICs) from 1908 to 1937 in Boston [41, 42] , and a two peaks pattern is shown in Fig. 1 (d) at around 1915/4. In addition, two or multiple peaks of infected density may characterize the outbreaks in the total number of WMICs of two neighboring cities, also when uni-modal patterns are actually observed in each individual city. For example, Fig. 1 (e) and (f) report the data of WMICs in Bristol and Newcastle [43] : the yellow line denotes the total number of WMICs, whereas the blue and green lines represent the data in Bristol and Newcastle, respectively. In Fig. 1 (f) one can well appreciate that the pattern of two peaks occurs only in the total number of WMICs. Similarly, Fig. 1 \n\nTo capture the underlying mechanism, we introduce a model of a two-layered network, where the two layers represent actually two interconnected regions or cities. Fig. 2 is a sketch of the model: A and B are the two layers, which are coupled through the inter-network AB . For the sake of simplicity, we let the two networks A and B have the same size N a = N b . Furthermore, k a , k b , and k ab represent the average degrees of networks A , B and AB , respectively. In details, we first generate two separated networks A and B with the same size N and different degree distributions P A ( k ) and P B ( k ), respectively. Then, we add links between A and B. That is, we randomly choose two nodes from A and B and then connect them if they are not connected yet. The process is repeated until all the needed specifications are attained. In the above way, one obtains a uncorrelated two-layered network.\n\nUnder such a framework, we adopt the Susceptible-Infected-Refractory (SIR) model to study the epidemic spreading dynamics. Particularly, each node is a unit of the SIR model, where S, I and R represent the susceptible, infected and refractory phases of individuals, respectively. At each time step, a susceptible node will be infected by an infected neighbor with rate \u03b2, and an infected node will become refractory with probability \u03bc. The infectious process will be considered terminated when no more infected nodes exist.\n\nWhile \u03bc is taken to be the same for all networks, we let \u03b2 a , \u03b2 b and \u03b2 ab be the infectious rates of networks A , B and AB , respectively. Thus, a susceptible node will be infected with a probability\n\nwhere k inf is the infected neighbors in the same network and k in f ab is the infected neighbors in the coupled network.\n\nIn our numerical simulations, we choose A to be a scale-free [44] , and B a random regular (RR) network with a constant degree k b [45] . The network size is N a = N b = 10 0 0 0 , the average degree k a = k b = 6 , and initially 0.1% of individuals of network A are chosen to be infected.\n\nA pattern of two peaks appears in the numerical simulations of our model. The yellow circles in Fig. 3 (a) report the evolution of the infected density \u03c1 I in the whole network with the parameters \u03b3 = 2 . 1 , k a = k b = 6 , k ab = 1 . 0 , \u03b2 a = \u03b2 b = 0 . 05 , \u03b2 ab = 0 . 005 and \u03bc = 0 . 1 . One can easily differentiate two peaks of \u03c1 I , indicating that the empirical observations in Fig. 1 can be fully reproduced.\n\nTo gather a deeper understanding, we also measure the evolutions of \u03c1 A I and \u03c1 B I in both layers A and B, and report them as green triangles and blue squares in Fig. 3 (a), respectively. It is easy to see that the times at which the maximum infected density is obtained in layers A and B are different, im plying that the pattern of two peaks is likely triggered by the time difference of epidemic outbreaks in the two layers.\n\nThe next step is to focus on the factors that determines the occurrence of such two peaks pattern. For this purpose, we first concentrate on the role of the average degree k ab of the internetwork AB . Fig. 3 (b) shows the evolution of the infected density \u03c1 I with different k ab (with triangles, squares and circles denoting the cases of k ab = 3 . 0 , 1 . 0 and 0.5, respectively). One notices that the pattern of \u03c1 I is uni-modal when k ab is large, but bimodal when k ab is sufficiently small, indicating that k ab is a key factor for the appearance of a bimodal pattern: a smaller k ab favours the appearance of the two peaks pattern, indicating that the two main networks A and B should be only weakly coupled among them.\n\nFurther, we study the influence of the infectious rate \u03b2 ab on the pattern. Fig. 3 (c) reports the results obtained for different \u03b2 ab (with triangles, squares and circles representing the cases of \u03b2 ab = 0 . 05 , 0 . 005 and 0.001, respectively). Once again one may notice that the condition of a weak coupling is essential for a bimodal pattern: \u03c1 I is indeed uni-modal when \u03b2 ab is large, while the two peaks appear when \u03b2 ab is small. Finally, we study the influence of the exponent \u03b3 of the SF network. Fig. 3 (d) shows that the bimodal feature is reduced with the increase of \u03b3 . As a larger \u03b3 means a smaller difference between the structures of the SF and RR networks, one can infer that the heterogeneity between the two layers is very helpful for the appearance of two peaks patterns.\n\nAll the numerical results are fully confirmed by an edge-based compartmental theory, see our theoretical Eqs. (18) and (19) in the Theoretical analysis section. The solid curves in Fig. 3 (a)-(d) show the corresponding theoretical results.\n\nThese numerics point that a weak coupling is the necessary condition for the emergence of the new pattern, while a difference in heterogeneity between the two layers is a very helpful factor. An interesting question is whether the observed behavior corresponds to a critical phenomenon. To figure out the answer, we let \u03c4 be the time interval between the two peaks of \u03c1 I . In particular, the two peaks will merge into a single one when \u03c4 = 0 . Similarly, we let \u03b4 t = | t B max \u2212 t A max | be the time delay between the two peaks in layers A and B, where t A max and t B max are the times of occurrence of the peak in \u03c1 A I and \u03c1 B I , respectively. The trivial situation would be that for which \u03c4 = \u03b4 t , but our numerical simulations show that this condition is attained only when \u03c4 is large, whereas one has \u03c4 < \u03b4 t when \u03c4 is sufficiently small. And, in particular, one has \u03b4 t > 0 when \u03c4 = 0 . Fig. 4 (a) and (b) show the dependence of \u03c4 and \u03b4 t on \u03b2 ab for fixed \u03b3 = 2 . 1 and different k ab , respectively. From Fig. 4 (a) , one sees that when k ab is small, \u03c4 will decrease monotonically and be non-vanishing with the increasing of \u03b2 ab , indicating that the event of two peaks always exists in the pattern. However, when k ab is increased, \u03c4 will decrease rapidly to zero, implying that there is a critical \u03b2 c ab for different k ab . When \u03b2 ab < \u03b2 c ab , the epidemic spreading event occurs through a pattern of two peaks in the infected density, while for \u03b2 ab > \u03b2 c ab it occurs via the traditional pattern with a single peak. On its turn, Fig. 4 (b) shows that \u03b4 t decreases monotonically with the increase of \u03b2 ab for all the three cases of k ab , and it never vanishes. This is because the spreading speed is different in homogeneous and heterogeneous networks. Generally speaking, epidemic spreading is faster in heterogeneous network than in homogeneous network [46] . We then turn to investigate the influence of the heterogeneity in degree distribution on the occurrence of the two peaks pattern. Fig. 4 (c) and (d) show the dependence of \u03c4 and \u03b4 t on \u03b2 ab for different \u03b3 and fixed k ab = 1 . 0 . While the network heterogeneity decreases with the increasing of \u03b3 , it is easy to see that when \u03b3 is large, \u03c4 and \u03b4 t decrease more prominently with \u03b2 ab . Specifically, the difference of spreading speeds between the two layers is not distinctive for large \u03b3 , resulting in the disappearance of the two peaks. Therefore, increasing the coupling strength (i.e. k ab and \u03b2 ab ) or decreasing the heterogeneity of network topology between the networks A and B will decrease the time delay of epidemic outbreak and then suppress the pattern of two peaks.\n\nWe have also confirmed all these numerical results in Fig. 4 (a)-(d) by the theoretical Eqs. (18) and (19) in the Theoretical analysis section. For each set of parameters in Fig. 4 (a)-(d) , we first produce the infected densities \u03c1 I , \u03c1 A I , and \u03c1 B I from Eqs. (18) and (19) , as done in Fig. 3 (a)-(d), and then measure the corresponding \u03c4 and \u03b4 t . The solid curves in Fig. 4 (a)-(d) show the theoretical \u03c4 and \u03b4 t .\n\nOne can easily see that the theoretical results are fully consistent with the numerical results.\n\nIn the above text, we have discussed that the value of the coupling strength is crucial for determining the kind of pattern of the epidemic spreading. Then, a natural question is how the coupling strength influences the final size of epidemic spreading. Comparing Fig. 5 (a) with (e), one sees that the blue area in (e) is slightly smaller than that in (a), indicating that increasing k ab can also slightly enhance \u03c1 R .\n\nOn the other hand, one can also obtain \u03c1 R by the theoretical formulae in the theoretical analysis Section. The right panels in Fig. 5 (i.e. Fig. 5 (b), (d) and (f)) show the results corresponding to the left panels, respectively, and indicate that all theoretical predictions are highly consistent.\n\nLet us first illustrate the edge-based compartmental theory for a single network, by following the methods and tools introduced in Refs. [47] [48] [49] [50] [51] [52] [53] [54] [55] [56] .\n\nFor an uncorrelated, large and sparse network, the SIR model can be described in terms of the quantities S ( t ), I ( t ), and R ( t ), which represent the densities of the susceptible, infected, and recovered nodes at time t , respectively. Let \u03b8 ( t ) be the probability that a neighbor v of u has not transmitted the disease to u along the edge connecting them up to time t . Then, the node u with degree k is susceptible at time t as s (k, t ) = \u03b8 (t) k . Averaging over all k , the density of susceptible nodes at time t is given by\n\nwhere P ( k ) is the degree distribution of the network. In order to solve for S ( t ), one needs to know \u03b8 ( t ). Since a neighbor v of node u may be susceptible, infected, or recovered, \u03b8 ( t ) can be expressed as \u03b8 (t) = S (t) + I (t) + R (t) (2) where S ( t ), I ( t ), R ( t ) is the probability that the neighbor v is in the susceptible, infected, recovery state, respectively, and has not transmitted the disease to node u through their connection. Once these three parameters can be derived, we will get the density of susceptible nodes at time t by substituting them into Eq. (2) and then into Eq. (1) . To this purpose, in the following, we will focus on how to solve them.\n\nTo find S ( t ), we now consider a randomly chosen node u , and assume this node is in the cavity state, which means that it cannot transmit any disease to its neighbors v but can be infected by its neighbors. In this case, the neighbor v can only get the disease from its other neighbors except the node u . Thus, node v with degree k is susceptible with probability \u03b8 (t) k \u22121 at time t . For uncorrelated networks, the probability that one edge from node u connects with a node v with degree k is k P ( k )/ k . Summing over all possible k , one obtains\n\nAccording to the SIR spreading process, the growth of R ( t ) includes two consecutive events: first, an infected neighbor has not transmitted the infection to node u via with probability 1 \u2212 \u03b2; second, the infected neighbor has been recovered with probability \u03bc. Combining these two events, the (4) Once the infected neighbor v transmits the disease to u successfully (with probability \u03b2), the I ( t ) to 1 \u2212 \u03b8 (t) flux will be \u03b2 I ( t ), which means (5) Combining Eqs. (4) and (5) , and considering (as initial conditions) \u03b8 (0) = 1 and R (0) = 0 , one obtains\n\nSubstituting Eqs. (3) and (6) into Eq. (2) , one gets an expression for I ( t ) in terms of \u03b8 ( t ), and then one can rewrite Eq. (5) as\n\nAfter obtaining the solution of Eq. (7) , we can substitute it into Eq. (1) to obtain S ( t ). Then, I ( t ) and R ( t ) can be obtained as follows (8) In fact, Eq. (7) does not depend on Eq. (8) , so the system is governed by the single ordinary differential equation (7) . Although the resulting equation are simpler than those found by other methods, it can be proven to exactly predict the disease dynamics in the large-population limit for different network topologies [53, 57] .\n\nWhen one assumes that the population is made up of two interacting networks, then P j ( k 1 , k 2 ) denote the probability that a node of network j has k 1 degree in network 1 and k 2 in network 2. For the sake of simplicity, one can name the two networks A and B as 1 and 2. Let \u03b2 j, l be the rate of transmission across an edge from network l to network j , and let us define \u03bc to be the recovery rate of a node in any network. \u03b8 j, l can be defined to be the probability that an edge to a test node u in network j ( j = 1 , 2 ) is coming from network l ( l = 1 , 2 ), and has not transmitted the infection. Now, \u03b8 1, 2 can be solved as in the case of a single network.\n\nSince a neighbor v in network 2 of node u in network 1 may be susceptible, infected, or recovered, \u03b8 1, 2 can be expressed as\n\nwhere S 1 , 2 , I 1 , 2 , R 1 , 2 is the probability that the neighbor v is in the susceptible, infected, recovery state, and has not transmitted the disease to node u through their connection.\n\nSimilarly, to find S 1 , 2 , the neighbor v in network 1 can only get the disease from its other neighbors except the node u in network 2. Thus, the node v with degree k 1 in network 1 and degree k 2 in network 2 is susceptible with probability \u03b8 k 1 \u22121 2 , 1 \u03b8 k 2 2 , 2 at time t . For uncorrelated networks, the probability that one edge from node u connects with a node v with degree ( k 1 , k 2 ) is\n\nIt is easily to know that the growth of R 1 , 2 includes two consecutive events: first, an infected neighbor has not transmitted the infection to node u via with probability 1 \u2212 \u03b8 1 , 2 ; second, the infected neighbor has been recovered with probability \u03bc. Combining these two events, the I 1 , 2 to R 1 , 2 flux is \u03bc(1 \u2212 \u03b8 1 , 2 ) I 1 , 2 . Thus, one gets\n\nOnce the infected neighbor v in network 1 transmits the disease to node u in network 2 successfully (with probability \u03b2 1, 2 ), the I 1 , 2 to 1 \u2212 \u03b8 1 , 2 flux will be \u03b2 1 , 2 I 1 , 2 , which means\n\nCombining Eqs. (11) and (12) , and considering (as initial condi-\n\nSo, one gets\n\nSimilarly, one can write down \u03b8 1, 1 , \u03b8 2, 1 and \u03b8 2, 2 as follows \u02d9 \u03b8 1 , 1 = \u2212\u03b2 1 , 1 \u03b8 1 , 1 +\u03b2 1 , 1\n\nWith Eqs. (14) -(17) on hand, the densities associated with each distinct state can be obtained by\n\nEqs. (18) and (19) are the main theoretical results from which the theoretical results in Figs. 3-5 are calculated. Now, a critical question comes out: can our theory find out the epidemic threshold? In fact, we find that the threshold for the whole network to show epidemic outbreak can be theoretically figured out by the Jacobian matrix J of Eqs. can be expressed as\n\nFor uncorrelated networks, the matrix J can be simplified as When networks A and B can be treated as isolated graphs (i.e. when their coupling is particularly weak), the explicitly expression of the epidemic thresholds is obtained by setting\n\n. When the coupling between the layers is increased, \u03b2 A c and \u03b2 B c decrease gradually. This result is consistent with the evidences reported in Ref. [25, 58] . ters are set as P A (k ) \u223c k \u2212\u03b3 , \u03b3 = 2 . 1 , k a = 6 , k b = 6 , \u03bc = 1 and N a = N b = 10 , 0 0 0 . Once the coupling strength is strong enough, the value of is mainly determined from the contribution of the interconnection network AB , which is similar to a pure bipartite network. Looking at Fig. 7 , an interesting conclusion is that an endemic state can occur even if there are no interactions within each individual network. These results imply that, in order to control an epidemic spreading, one needs to pay more attention to the effects of the coupling strength between different regions.\n\nLet us remark that the weak coupling condition predicted by us for the occurrence of the novel epidemic pattern is actually consistent with the cases of the data of Fig. 1 . As it is well known, indeed, Hong Kong in Fig. 1 (a) consists of islands, and the movement of individuals between different islands is not as convenient as that within each single island, and thus the coupling between neighboring islands can be considered to be weak. At the same time, the population distribution in Hong Kong central island is significantly different from that characterizing the surrounding islands, confirming the presence of the second ingredient predicted by our theory: i.e. a difference in the heterogeneity of the layers' structures.\n\nIn Boston, a river separates the city into two parts, which (to all extent) can be considered as equivalent to two islands. The same reasoning applies to the neighboring cities of Bristol and Newcastle and the neighboring cities of Bristol and Sheffield. As Bristol and Newcastle, Newcastle and Sheffield are separated regions in the United Kingdom, and they can therefore be considered as a pair of weakly coupled networks.\n\nOur predictions were obtained on coupled SF-RR networks, and it is legitimate to seek for generality of the two peaks pattern phenomenon, by means of investigating coupled networks with other topological structures. For this purpose, we have also studied the case of SF-SF and RR-RR networks, respectively. Very interestingly, one finds that the pattern of two peaks can be still observed by adjusting the coupling strength between the coupled layers (see Fig. 8 ). Although the two coupled SF networks (or the two coupled RR networks) can be considered as the case with same heterogeneity, they are produced independently and thus their network topologies are different, indicating that there exists still the effect of heterogeneity between the two coupled networks. On the other hand, extension to three-layered model was also considered, and it was found that there is a small probability to produce a pattern of three peaks (see Fig. 9 ). Therefore, while in principle one can expect a multi-peaks pattern to occur in a multilayered network, the majority of unusual cases (i.e. cases in which the epidemic event is not happening with a single maximum of infected density) will be characterized by just two peaks, in full consistency with the data of Fig. 1 .\n\nIn summary, epidemic spreading has been well studied in the past decades but mainly focused on outbreaks corresponding to patterns with a single peak of infected density. We here reported (from real data) the evidence that also a pattern of two peaks in a single epidemic period is possible. We pointed out that such a pattern is a genuine product of a multi-layered interaction structure, and we have introduced a proper model able to fully capture the mechanisms for its occurrence. Our model, together with reproducing the classical pattern of a single peak, can generate the pattern with two peaks when coupling between the layers is weak, while the difference in heterogeneity of the layers' structures is also helpful."}