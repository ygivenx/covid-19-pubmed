{"title": "Maximum entropy method for estimating the reproduction number: An investigation for COVID-19 in China", "body": "In December, 2019, a cluster of pneumonia cases in Wuhan, China was caused by a novel coronavirus, the COVID-19 [1] [2] [3] [4] . At first the local governments did not take effective measures which leaded to local people not paying enough attention to the risk.\n\nHowever, with the epidemic in Wuhan further expanding, the Chinese Government started to take emergency actions to lock down the Wuhan city on January 23, 2020.\n\nDespite this, the epidemic still spread throughout the entire country. By March 12, 2020, controlling the spread of the epidemic has become a global challenge. One of the key parameters in epidemic models is the basic reproduction number 0 , defined as the number of secondary infections that arise from a typical primary case in a completely susceptible population [5] . As an infection is spreading through a population, it is more convenient to work with an effective reproduction number , which is defined as the number of secondary infections that arise from a typical primary case [5] . The magnitude of is a useful indicator for evaluating the risk of an infectious disease and the validity of controlling the epidemic. If exceeds 1, the number of incident cases will inevitably grow over time, and a large epidemic is possible. To prevent the expansion of an epidemic, must be reduced to a level below 1. Using the parameter , one can establish the susceptible-infectious-removed (SIR) epidemic model as below [6] [7] [8] :\n\nwhere ( ), ( ) and \u211b( ) are the number of susceptible, infectious, and removed (including recovered and death) individuals at time ; denotes the generation interval that is the time from infection of an individual to the infection of a secondary case by that individual, namely, the \"contagion period\" of an infection [5] . The generation interval should be a random variable. If we denote the number of populations by , we have:\n\nsimulate the evolutionary track of this epidemic. To estimate the reproduction number , the probability distribution function of the generation interval of an infectious disease, ( ), is required to be available [5, [9] [10] [11] [12] ; however, this distribution is often unknown. In the existing literature, many scholars used exponential distribution [5] , normal distribution [5] , Weibull distribution [9, 10] , and Gamma distribution [3, 12] to approximate ( ). Theoretically, to use these distributions to approximate ( ), one needs to know enough information about symptom onsets of all cases, namely, large sample cases for . Regarding the incomplete information, one also applied the Monte-Carlo method [4] and Bayesian statistical inference [11] to estimating ( ). However, thus far, there is scant literature to discuss the potential application of the maximum entropy method (MaxEnt) [13] [14] [15] in estimating the reproduction number. Our letter fills this gap. In the statistical inference, MaxEnt is a powerful tool of predicting probability distributions. The main idea of MaxEnt is to estimate a target probability distribution by finding the probability distribution of maximum entropy, subject to a set of constraints that represent our incomplete information for the target distribution [13] .\n\nDue to the advanced predictive capacity, MaxEnt has been widely applied in thermodynamics [13] , economics [16] [17] [18] [19] , artificial intelligence [20] [21] , and ecology [22] [23] [24] [25] [26] .\n\nIn this letter, we apply the MaxEnt to determining the function shape of ( ).\n\nBefore doing so, we first introduce the relationship between and ( ). Here, we adopt Wallinga and Lipsitch's method [5] for deriving the reproduction number. By both authors' method, the number of infectious individuals at time can be written as [5] :\n\nwhere ( , ) denotes the number of cases infected by a -day infectious individual at time . Here denotes the maximum symptom duration. Wallinga and Lipsitch assumed [5] = +\u221e. To make the model more realistic, we assume that is a finite number. Thus, the reproduction number can be defined as [5] :\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\n(which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Let us order ( ) = ( , ) .\n\nSubstituting equation (7) into equation (6) yields:\n\nwhere ( ) is the probability distribution function of the generation interval [5] .\n\nUsing equation (8), the mean value of the generation interval can be written as:\n\nIf the mean value \u0305 is known, then by using equation (8) one can obtain the variance of the generation interval:\n\nSubstituting equation (7) into equation (5) we finally obtain:\n\nEquation (11) is the basic formula for calculating the reproduction number. If ( ) and ( ) are known, one can calculate the reproduction number by using equation (11) . Generally speaking, the number of infectious individuals ( ) is reported for each day, while the function shape of ( ) is unknown. Therefore, many scholars used exponential distribution [5] , normal distribution [5] , Weibull distribution [9, 10] and Gamma distribution [3, 12] to approximate ( ). To do so, one needs to collect enough information of , which requires examining a large number of cases. From a practical point of view, it is easier to collect a sample set of cases (at least 30 samples)\n\nto calculate the approximate estimates of the mean value \u0305 and the variance 2 . Given the approximate estimates of \u0305 and 2 as the prior information, we maximize the information entropy of the generation interval to infer the function shape of the probability distribution ( ). This is the basic idea of the MaxEnt, which agrees with everything that is known, but avoids assuming anything that is not known [15] . The resulting statistical inference gives the least biased predictions of the shapes of probability distributions consistent with prior knowledge [23] .\n\nNow we apply the MaxEnt to determining the probability distribution function . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint ( ). To this end, we assume that the mean value \u0305 and the variance 2 of the generation interval are known. By equation (8), we define the information entropy of the generation interval as:\n\nBecause we only know the mean value \u0305 and the variance 2 , maximizing the information entropy (12) should yield:\n\nTo solve the optimal problem (13), we construct the Lagrange function:\n\nwhere \u2032 , , and are Lagrange multipliers.\n\nPlugging equation (14) into the functional derivative \u2112[ ( )] ( ) \u2044 = 0 we get the optimal solution:\n\nwhere = exp(\u2212 \u2032 \u2212 1).\n\nTheoretically, substituting equation (15) into equations (8), (9) , and (10) one can calculate the values of , , and . However, it is difficult to obtain the analytic results of integrals (8), (9) and (10). To do numerical calculation for equations (8) , (9) , and (10), we assume that ( ) quickly tends to 0 as \u226b 1. The validity of this assumption can be justified by checking equation (15); therefore, equations (8), (9) and (10) can be written as:\n\nBased on equations (16), (17) and (18), we propose a numerical method to calculate . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint the approximate values of , , and . To this end, let us order:\n\nThe partial derivatives of equation (19) with respect to and yield:\n\nUsing equations (19), (20) and (21), equations (8), (9) and (10) can be rewritten in the form:\n\nwhere we have used the approximations (16), (17) and (18).\n\nBy solving equation (22), one can obtain the approximate values of , , and .\n\nSubstituting equation (15) into equation (19) we have\n\nwhere erfc( ) = 2 \u221a \u222b exp(\u2212 2 ) \u221e denotes the error function.\n\nBy equation (23) it is easy to get:\n\nSolving equation (22) is equivalent to minimizing the following function:\n\nHere we employ the Matlab software to depict [ , , ] as a 100 \u00d7 100 \u00d7 100\n\nlattice-point matrix, where the lattice spacing is 0.01. Given the accuracy of 0.01, by inputting the observed values of \u0305 and 2 , we calculate , , and . We first apply equation (26) to the SARS epidemic in Singapore in 2003, where \u0305 = 8.4 (days) and\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint = 3.8 (days) [9] . Substituting both observed values into equation (26), we seek the lattice-point minimizing equation (26) as below:\n\nSubstituting equation (27) into equation (15) we have:\n\nThe shape of equation (28) The latest clinical research [1] showed that the generation interval of COVID-19 is similar to that of SARS. Therefore, we assume that the generation interval of COVID-19 shares the same probability function shape as that of SARS. This assumption was also adopted by Wu et al [4] . Based on this assumption, we apply equation (28) \n\nBecause the observed data of ( ) was reported for each day, we denote the unit of time by \"day\". To calculate by using equation (29) By using equation (30) we can report the reproduction number every 14 days.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Before doing so, we first determine the starting point of each contagion period for COVID-19 in China. According to the report of China CDC [2] , January 8, 2020 was considered as the last day of a contagion period in Wuhan, China; therefore, we mark January 9, 2020 as the first day of the next contagion period. Based on this setting, the first period we report is from January 9, 2020 to January 22, 2020. In fact, this setting agrees with the date of locking down the Wuhan city, January 23, 2020. Here, we have collected the national-level data of the accumulative infected, recovered, and death cases of China's epidemic from January 10, 2020 to March 4, 2020, see Figure 2 . By using the data in Figure 2 , it is easy to calculate the number of real-time infected cases, ( ), in China for each day. This result has been shown in Figure 3 . Using the data in The results have been listed in Table 1 . The first period (from January 9, 2020 to January\n\nChinese people were aware of the outbreak of COVID-19 after January 21, 2020 and local governments did not take effective measures to control the epidemic during this period. Unfortunately, the data in the first period is very incomplete. By contrast, the reported infected cases on January 10 (41 cases) and January 22 (571 cases) can be roughly used. Consider that the first period is a free propagation stage, we use both data to approximately restore real-time data of this period by the exponential growth formula 571 = 41 \u2022 exp(12 \u2022 ), where denotes the growth rate. Using the restored data, the estimated value of the reproduction number for the first period is calculated to be 3.7069, see Therefore, the subsequent periods no longer belong to free transmission. For these periods, the results of the reproduction number have been listed in Table 1 . Due to the . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint quarantine measures, the reproduction number for the second period (from January 23, 2020 to February 5, 2020) has been reduced to 3.122 with the reduction amplitude being 15 .78%. For the third period (from February 6, 2020 to February 19, 2020), the reproduction number has remarkably been reduced to 1.2114, which is close to 1. This implies that the epidemic has been effectively controlled. It should be pointed out that the last day of the third period (February 19) is just the turning point of the epidemic, refer to Figure 3 ; therefore, the real data supports our calculations for the reproduction number. As the epidemic come to the fourth period (from February 20, 2020 to March 4, 2020), the reproduction number is eventually reduced to 0.6028, a level below 1. In this sense, China's quarantine measures have obtained a preliminary success.\n\nTo further test the validity of the reproduction numbers in Table 1 , we substitute them into the SIR model (1)-(4) for simulating the evolution of China's epidemic. To this end, let us first check the scope of application of the reproduction number formula (11) , which is derived by equation (5) . By the mean value theorem of integrals, equation (5) can be rewritten in the form:\n\nwhere 0 \u2264 \u2264 .\n\nBy equation (6) and (31) we have:\n\nOn the other hand, if we assume that is a constant (step function) for each period, by equations (1)-(4) it is easy to get:\n\nLet us order:\n\nBy using equation (34), equation (33) can be approximately written as:\n\nwhich implies\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14. Comparing equations (32) and (36), we find that the reproduction number formula (11) can be applied to the SIR model (1)-(4) if the approximation (34) holds. Equation Table 1 into the SIR model (1)-(4) to simulate the evolution of China's epidemic. The result is shown by Figure 5 , where the evolutionary track (red circles) of the epidemic is well in accordance with that (black circles) of the real incident cases in\n\nChina. The simulation result requires \u2248 8, which agrees with our previous setting = 8.4 \u00b1 3.8 [9] . Furthermore, we find that the reproduction numbers of quarantine periods in Table 1 can be fitted by an exponential function with 2 = 0.9924, see Figure 4 . Therefore, we apply this exponential function to predicting the reproduction numbers for the next seven periods (from March 5, 2020 to June 10, 2020). The results have been listed in Table 2 , where we also present the predicted values of the number of real-time infected cases for the last day in each period. These predicted values imply that China's epidemic will gradually tend to disappear by May 2020, see the blue circles in Figure 5 .\n\nIn conclusion, to estimate the reproduction number, the probability distribution function of the generation interval of an infectious disease is required to be available; however, this distribution is often unknown. In the existing literature, many scholars used exponential distribution, normal distribution, Weibull distribution, and Gamma distribution to approximate the generation interval distribution. To do so, one needs to collect enough information about symptom onsets of all cases, which requires examining a large number of cases. By contrast, the maximum entropy method has more advantage of predicting probability distributions given the incomplete information. In this letter, we argue that, given the mean value and variance of the generation interval, one can determine its probability distribution function by using maximum entropy method. Because the overall data (population) of the generation . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint interval is always absent, the maximum entropy method is a more convenient approach for estimating the probability distribution function of generation interval. By the maximum entropy method we first determine the probability distribution function of generation interval of COVID-19 and further apply it to estimating the real-time values of reproduction numbers of China's epidemic. Plugging these estimated reproduction numbers into the susceptible-infectious-removed epidemic model, we simulate the evolutionary track of the epidemic in China, which is well in accordance with that of the real incident cases.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Figure 1 . The function shape of equation (28) is showed by a blue curve. The sample data of generation interval of the SARS in Singapore (2003) is showed by a red histogram, and the data resource refers to [9] .\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Figure 2 . National-level data of the accumulative infected, recovered, and death cases of China's epidemic from January 10, 2020 to March 4, 2020. The data of January 8 and 9 is simply assumed to be same as that of January 10. Data resource: https://voice.baidu.com/act/newpneumonia/newpneumonia/?from=osari_pc_3 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\nThe copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\n(which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Table 1 are fitted by an exponential function.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\n(which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint Figure 5 . The SIR simulation result by using the reproduction numbers in Table 1 is showed by red circles and the SIR simulation result by using the reproduction numbers in Table 2 is showed by blue circles, where \u2248 1.4 \u00d7 10 9 and \u2248 8. The real-time infected cases in Figure 3 are showed by black circles.\n\n. CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.\n\n(which was not peer-reviewed) The copyright holder for this preprint . https://doi.org/10.1101/2020.03.14.20035659 doi: medRxiv preprint "}