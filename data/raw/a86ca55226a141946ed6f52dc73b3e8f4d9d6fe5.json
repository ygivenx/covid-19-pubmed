{"title": "Semiparametric Relative-risk Regression for Infectious Disease Transmission Data", "body": "Infectious diseases are an important threat to human health and commerce, and understanding the transmission of disease is crucial to the design of public health interventions. The statistical analysis of infectious disease data is complicated by the fact that infections are inherently dependent, especially when they are transmitted directly from person to person (Becker, 1989; Andersson and Britton, 2000) . Epidemiologists have dealt with this problem in three ways. The most common approach is to model susceptibility to disease using standard statistical methods such as logistic or Cox regression, ignoring disease transmission. A second approach is to use chain binomial models (Rampey et al., 1992) , which estimate the probability of escaping infectious contact from infected members SUPPLEMENTARY MATERIALS Supplementary material available online at the Journal of the American Statistical Association website includes: of groups such as households, classrooms, or hospital wards. The third approach is to model the spread of disease as a branching process where infectees are the o spring of their infectors (Wallinga and Teunis, 2004; White and Pagano, 2008) . The time between the infections of an infector and an infectee is called a generation interval. In this approach, the generation intervals are assumed to be independent and identically distributed (iid).\n\nTo understand transmission, it is crucial to separate the e ects of covariates on infectiousness and susceptibility from their association with exposure to infected people (Rhodes et al., 1996) . Regression models that ignore transmission cannot do this. When disease transmission is modeled as a branching process, uninfected people do not exist and cannot be exposed to infected people. The failure to account for uninfected person-time and competing risks of infection cause several problems with this approach (Svensson, 2007; Kenah et al., 2008) . The assumption that generation intervals are iid is di cult to relax, making estimation of covariate e ects di cult (Kenah, 2013) . Chain binomial models are a statistically sound response to the problem of dependence and can be used to estimate covariate e ects. However, their use is limited in two ways: First, they are not implemented in standard statistical software-a problem solved partially by the publicly-available package TranStat (www.epimodels.org/midas/transtat.do). Second, they use discrete time.\n\nSince infectious disease data are usually recorded by the day or week, this is not unnatural. However, continuous-time models corrected for ties may o er a more flexible modeling framework. Kenah (2011) extended parametric methods from survival analysis to infectious disease data by modeling the contact interval. In the ordered pair ij, the contact interval \u03c4 ij is the time between the onset of infectiousness in i and the first infectious contact from i to j, where infectious contact is a contact sufficient to infect a susceptible individual. It is right-censored if the infectious period of i ends before i makes infectious contact with j or if j is infected by someone other than i. These methods solve the problem of dependence by treating ordered pairs of individuals, not the individuals themselves, as the units of analysis. Kenah (2013) showed that the contact interval distribution could be estimated nonparametrically by adapting the Nelson-Aalen estimator from standard survival analysis. These methods assume a homogeneous population where the contact interval distribution is the same for all pairs ij in which transmission from i to j is possible. They are unable to estimate covariate e ects on transmission, which is a primary goal of vaccine trials, outbreak investigations, and many other studies of infectious disease.\n\nThe goal of this paper is to extend the methods of Kenah (2013) to develop a relative-risk regression model similar to that of Cox (1972) . This model will allow semiparametric estimation of the e ects of covariates on the hazard of infectious contact in pairs of individuals. For the ordered pair ij, the covariate vector can include infectiousness covariates for i, susceptibility covariates for j, and pairwise covariates. This semiparametric regression model will allow many of the most important scientific questions in infectious disease epidemiology to be addressed with greater clarity, flexibility, and rigor.\n\nConsider a closed population of n individuals assigned indices 1 . . . n. Each individual is in one of four states: susceptible (S), exposed (E), infectious (I), or removed (R). Person i moves from S to E at his or her infection time t i , with t i = \u221e if i is never infected. After infection i has a latent period of length \u03b5 i , during which he or she is infected but not infectious. At time t i + \u03b5 i , i moves from E to I, beginning an infectious period of length i . At time t i + \u03b5 i + l i , i moves from I to R. Once in R, i can no longer infect others or be infected.\n\nThe states and notation are illustrated at the top of Figure 1 . The latent period is a nonnegative random variable, the infectious period is a strictly positive random variable, and both have finite mean and variance.\n\nAn epidemic begins with one or more persons infected from outside the population, which we call imported infections. The methods in this paper require that the set of imported infections is known. For simplicity, we assume that epidemics begin with one or more imported infections at time 0 and there are no other imported infections.\n\nAfter becoming infectious at time t i + \u03b5 i , person i makes infectious contact with j \u2260 i at time , where the infectious contact interval is a strictly positive random variable with if infectious contact never occurs. Since infectious contact must occur while i is infectious or never, or . We define infectious contact to be a contact sufficient infect a susceptible person, so t j \u2264 t ij for all i \u2260 j. The infectious contact interval is illustrated at the bottom of Figure 1 .\n\nFor each ordered pair ij, let C ij = 1 if infectious contact from i to j is possible and C ij = 0 otherwise. These C ij could be the entries in an adjacency matrix for a static contact network.\n\nWe assume that the infectious contact interval is generated in the following way: A contact interval \u03c4 ij is drawn from a distribution with hazard function \u03bb ij (\u03c4). If \u03c4 ij \u2264 l i and C ij = 1, then . Otherwise, . In this paper, we assume the contact intervals in all ordered pairs ij are independent and have finite mean and variance.\n\nOur population has size n, and we observe the times of all S \u2192 E (infection), E \u2192 I (onset of infectiousness), and I \u2192 R (removal) transitions in the population between time 0 and time T . For all ordered pairs ij such that i is infected, we observe C ij . We first consider the case where who-infects-whom is observed and then consider the more realistic case where it is not.\n\nWe assume that we can observe \u03c4 ij only if j is infected by i at time t i +\u03b5 i +\u03c4 ij . Clearly, \u03c4 ij can be observed only if C ij = 1. We also have right-censoring of \u03c4 ij :\n\n1. Since infectious contact can occur only while i is infectious, \u03c4 ij can be right-censored by the infectious period l i of i. Let indicate whether i remains infectious at infectious age \u03c4.\n\n2. Since j is susceptible to infection by i only if he or she has not been infected by anyone else, \u03c4 ij can be right-censored by t i\u2032j \u2212 t i \u2212 \u03b5 i for i\u2032 \u2260 i. Let indicate whether j remains susceptible at infectious age \u03c4 of i.\n\nLet T denote the time at which observation ends. Then \u03c4 ij can be right-censored by the end of observation at infectious age T \u2212 t i \u2212 \u03b5 i of i. Let indicate whether observation is ongoing when i reaches infectious age \u03c4.\n\n, , and are left-continuous,\n\nis a left-continuous process that indicates the risk of an observed infectious contact from i to j at infectious age \u03c4 of i. The assumptions made in the stochastic S(E)IR model above ensure that and independently censor \u03c4 ij . We also require that T is a stopping time with respect to the observed data such that, for all i, independently censors \u03c4 ij for each j exposed to infectious contact from i. The possible censoring scenarios are illustrated in Figure 2 .\n\nFollowing Wallinga and Teunis (2004) , let v j denote the index of the person who infected person j, with v j = 0 for imported infections and v j = \u221e for persons not infected prior to the end of observation. The transmission tree is the directed network with an edge from v j to j for each j such that t j \u2264 T . It can be represented by a vector v = (v 1 , . . . , v n ). Let denote the set of possible infectors of person j, which we call the infectious set of j. Let denote the set of all v consistent with the observed data. A can be generated by choosing a for each non-imported infection j. Kenah (2013) described the nonparametric estimation of the contact interval distribution for a homogeneous population. Here, we consider a semiparametric relative-risk model like that of Prentice and Self (1983) . Let (2) where \u03bb 0 (\u03c4) is an unspecified baseline hazard function, is a relative risk function, \u03b2 0 is an unknown b \u00d7 1 coefficient vector, and X ij (\u03c4) is a b \u00d7 1 predictable covariate process taking values in a set . The covariates X ij (\u03c4) can include individual-level covariates predicting the infectiousness of i or the susceptibility of j as well as pairwise covariates (e.g., membership in the same household) that predict the hazard of infectious contact from i to j. that of Cox (1972) , and letting r(x) = 1 + x gives us a linear relative risk regression model. To fit these semiparametric models, we adapt the nonparametric estimators from Kenah (2013) to account for the relative risk function.\n\nLet N ij (\u03c4) = 1 \u03c4ij \u2264 \u03c4 indicate whether an observed infectious contact from i to j has occurred by infectious age \u03c4 in i, and let . Note that we must observe whoinfected-whom in order to calculate N(\u03c4).\n\n. Given \u03b2, the Breslow estimator (Breslow, 1972) \n\nThe Breslow estimator has two desirable properties. First, is an unbiased estimator of \u039b 0 (\u03c4). Let (5) Then for all \u03c4 such that Y (\u03c4) > 0, (6) is a mean-zero martingale when \u03b2 = \u03b2 0 . Second, maximizes the log likelihood (7) over all step functions \u039b(\u03c4). Substituting into l(\u03b2, \u039b) profile likelihood (8) where . The first term is similar to the log partial likelihood from Cox (1972) and the second term does not depend on \u03b2. Dropping the second term, let be the log partial likelihood for \u03b2. This derivation of the partial likelihood as a profile likelihood follows that of Johansen (1983) . Let denote the value of \u03b2 that maximizes pl(\u03b2), and let denote the corresponding Breslow estimate of the baseline cumulative hazard.\n\nWe can rewrite pl(\u03b2) as a sum of stochastic integrals: (10) The corresponding score process is (11) where (12) is the expected value of over the risk set at u when each pair is weighted by its hazard of infectious contact at u. By the Doob-Meyer decomposition, there is a mean-zero martingale M ij (u) for each ij such that (13) Expanding equation (11) using this decomposition and simplifying, we get (14) Since it is a sum of integrals of predictable processes with respect to martingales, U(\u03b2 0 , \u03c4) is a mean-zero martingale.\n\nLet for a column vector v. Since the N ij (\u03c4) do not jump simultaneously in continuous time, the predictable variation process of U(\u03b2 0 , \u03c4) is (15) where Kenah Page 6 J Am Stat Assoc. Author manuscript; available in PMC 2016 March 01.\n\nis the variance of over the risk set at u when each pair ij is weighted by its hazard of infectious contact at u.\n\nbe the observed information. Then (17) Expanding I(\u03b2 0 ) via the Doob-Meyer decomposition (13) and simplifying, we get (18) The second term has expectation zero, so I(\u03b2 0 ) is an unbiased estimate of Var(U(\u03b2 0 , \u221e)).\n\nAnother estimate Var(U(\u03b2 0 , \u221e)) is obtained by substituting the increments of the Breslow estimator (3) for \u03bb 0 (u) du in equation (15). This gives us the estimated expected information (19) Expanding using the Doob-Meyer decomposition and simplifying, we get (20) where . The second term has expectation zero, so is also an unbiased estimate of the variance of U(\u03b2 0 , \u221e). may be a better estimator of Var(U(\u03b2 0 , \u221e)) than I(\u03b2 0 ) because it is guaranteed to be positive semidefinite (Prentice and Self, 1983) and it depends only on aggregates over risk sets (Aalen et al., 2009 ).\n\nWhen r(x) = exp(x) as in the Cox model, for all \u03b2. For general r(x), I(\u03b2 0 ) and are asymptotically equivalent under weak regularity conditions (see Appendix A online).\n\nAppendix A, available online, outlines sufficient conditions for the asymptotic normality of U(\u03b2 0 , \u03c4) and as m \u2192 \u221e, where m is the number of pairs ij at risk of transmission. Under these conditions, hypothesis tests and confidence intervals for \u03b2 0 can be obtained using score, Wald, or likelihood ratio statistics. These conditions are very similar to those for the standard Cox model (Prentice and Self, 1983 ) except for the additional requirement that both the number of susceptibles and the number of pairs be large such that each susceptible is exposed to a number of infectors < < m. When a given susceptible j is infected, all pairs ij are censored. If there were many pairs but few susceptibles, each susceptible would be exposed to a very high hazard of infection and most pairs would be censored very quickly. To take an extreme case, imagine a single susceptible exposed to m infecteds. The number of pairs at risk of transmission is m but the susceptible will be infected almost immediately when m is large. After this, there are no more pairs at risk of transmission and we can learn nothing further about \u03b2 0 or \u039b 0 (\u03c4).\n\nGiven the Breslow estimator of . Its variance is consistently estimated by (21) which is derived in Appendix B.1.\n\ncan be replaced by . Using the martingale central limit theorem and a log transformation, we get the approximate pointwise 1 \u2212 \u03b1 confidence limits (22) Point and interval estimates for the baseline survival function can be obtained using the relationship S 0 (\u03c4) = exp (\u2212 \u039b 0 (\u03c4)\n\nWhen we do not observe who-infected-whom, we do not know which contact intervals are observed and which are censored. It impossible to calculate the partial likelihood pl(\u03b2) or the Breslow estimate . In this section, we show how an EM algorithm similar to that of Kenah (2013) can be used to obtain consistent and asymptotically normal estimates of \u03b2 0 and \u039b 0 (\u03c4).\n\nGiven \u03b2, \u03bb(\u03c4), and the observed information, the probability that j was infected by i is and the infectors of different infected persons can be chosen independently (Kenah et al., 2008) . The probability of a transmission network v = (v 1 , . . . , v n ) given \u03b2, \u03bb(\u03c4), and the observed data is (24) Note that the last two equations assume a continuous contact interval distribution, so simultaneous infectious contacts have probability zero.\n\nLet pl v (\u03b2) be the log partial likelihood that we would have calculated had we observed the transmission network v. Given a coefficient vector \u03b2 * and a baseline hazard function \u03bb * (\u03c4), the expected log likelihood is The marginal Breslow estimate given \u03b2 * and \u03bb * (\u03c4) is (27) where .\n\nFor the relative risk function r(x) = exp(x), the expected log partial likelihood is the log partial likelihood of a weighted Cox regression model (Therneau and Grambsch, 2000) with two copies of each pair ij: an uncensored copy with weight p ij (\u03b2 * , \u03bb * ) and a censored copy with weight 1 \u2212 p ij (\u03b2 * , \u03bb * ). The baseline hazard estimate from this model is the marginal Breslow estimate , where .\n\nWhen who-infects-whom is not observed, the semiparametric regression model can be fit using the ECM algorithm of Meng and Rubin (1993) , which is an extension of the EM algorithm of Dempster et al. (1977) . In each iteration, we first estimate \u03b2 0 using the expected log partial likelihood and then calculate the marginal Breslow estimator of \u039b 0 (\u03c4). We use these new estimates to re-weight the possible v. The entire process is described in Algorithm 1. Algorithm 1 ECM algorithm for semiparametric estimation of \u03b2 0 and \u039b 0 (\u03c4).\n\nTo show that this is an ECM algorithm, we must show that the CM1 and CM2 steps are conditional maximizations of the expected log likelihood. The CM1 step is a conditional maximization by definition, so it remains to show that the CM2 step is a conditional maximization. Given a coefficient vector \u03b2 * and a hazard function \u03bb * , the expected log likelihood is (28) Differentiating with respect to d\u039b(t j \u2212 t i \u2212 \u03b5 i ) for each i and j shows that, for a fixed \u03b2, l\u03b2 * , \u03bb * (\u03b2, \u039b) is maximized over all step functions \u039b(\u03c4) by setting (29) exactly as in the marginal Breslow estimator . Therefore, Algorithm 1 is an ECM algorithm. When it is known that \u03b2 = 0, it reduces to the EM algorithm in Kenah (2013) . Therefore, the convergence of both \u03b2 (k) and \u039b (k) (\u03c4) should be monitored.\n\nLet denote the estimate of \u03b2 0 to which the ECM algorithm converges, and let denote the corresponding estimate of \u03bb 0 (\u03c4). Let U v (\u03c4, \u03b2) and I v (\u03b2) denote the score and the observed information that we would have calculated had we observed the transmission network v. Using the methods of Louis (1982) , the observed information is (30) where denotes an expectation taken under the assumption that the true coefficient vector is \u03b2 and the true baseline hazard function is \u03bb(\u03c4). The first term in (30) is (31) where\n\n. This is the observed information matrix from a weighted regression model where each ij has an uncensored copy with weight and a censored copy with weight 1 \u2212 . To evaluate the second term in (30), let where \u00d1 .j (u) = \u03a3 i\u2260j \u00d1 .j (u). Using the martingale central limit theorem and a log transformation, we get the approximate pointswise 1 \u2212 \u03b1 confidence limits (36) Point and interval estimates for the baseline survival function can be obtained using the relationship S 0 (\u03c4) = exp (\u2212 \u039b 0 (\u03c4)\n\nThe performance of the methods from Section 2 was tested with a series of 12000 networkbased epidemic simulations. All epidemics took place on a Watts-Strogatz small-world network (Watts and Strogatz, 1998) , which mimics the high clustering and low diameter of real human contact networks. Starting with a ring of 50000 nodes, each node was connected to its 10 nearest neighbors and each edge was rewired to a randomly chosen node with probability 0.1. A new contact network was built for each simulation.\n\nAll epidemic models were written in Python 2.7 (www.python.org) using the packages NetworkX 1.6 (networkx.lanl.gov), NumPy 1.6, and SciPy 0.9 (www.scipy.org). Statistical analysis was done in in R 2.15 (www.r-project.org) via the Rpy2 2.2 package (rpy.sourceforge.net). The code for the models is available as Online Supplementary Information.\n\nThe transmission model had a latent period of zero and an exponential infectious period with mean one. The baseline contact interval distribution was Weibull(\u03b1, \u03b3), where \u03b1 is the shape parameter and \u03b3 is the rate parameter. 6000 simulations had a Weibull(0.5, 0.2) distribution, which has \u039b 0 (\u03c4) = (0.2\u03c4) 0.5 . The other 6000 had a Weibull(2, 0.6) distribution, which has \u039b 0 (\u03c4) = (0.6\u03c4) 2 . These distributions gave a basic reproduction number (expected number of infectious contacts made by a typical infectious person) R 0 \u2248 3 in a null model. In the transmission model, each person i had an infectiousness covariate and a susceptibility covariate . Each pair ij connected by an edge had a pairwise covariate . All covariates were independent Bernoulli(.5) random variables. For a connected pair ij, the hazard of infectious contact from i to j at infectious age \u03c4 of i was Each simulated epidemic began with a single person infected at time 0. Data from the next 1000 infections was used to fit two regression models, one using information on whoinfected-whom as in Section 2.1 and one using an EM algorithm as in Section 2.5. The EM algorithm used a minimum of 2 and a maximum of 25 iterations. At each iteration, a weighted Cox model was run using the last parameter estimates as the initial parameter estimates. Convergence was defined as a change less than 0.002 in the expected log likelihood (tighter convergence criteria yielded nearly identical parameter estimates). After convergence, a Cox model was run using the final weights and initial parameters \u03b2 inf = \u03b2 sus = \u03b2 pair = 0.\n\nAfter each simulation, we recorded the true value, estimate, and 95% confidence interval endpoints for each in the model and the baseline hazard at the 10 th , 25 th , 50 th , 75 th , and 90 th percentiles of all censored and observed contact intervals. We also recorded the \u03b1 and \u03b3 of the baseline hazard function and the number of EM iterations. Figure 3 shows good agreement between the estimated and true \u03b2 inf , \u03b2 sus , and \u03b2 pair for both (who-infects-whom observed) and (who-infects-whom unobserved). Table 1 shows excellent 95% confidence interval coverage probabilities for all combinations of baseline hazards and parameters. The estimates had slightly lower coverage probabilities than the estimates. The lower right panel of Figure 3 shows that this was achieved with relatively few iterations. The median number of iterations was 6, and 98% of simulations required \u2264 10 iterations. Only 2 out of 12000 simulations failed to converge within 25 iterations. (who-infects-whom observed) and (who-infects-whom unobserved). The smoothed means show almost no bias in or . Table 2 shows good 95% confidence interval coverage probabilites for both base-line hazards and all percentiles except for \u03b1 = 2 at the 10 th and 25 th percentiles. When \u03b1 = 2, the baseline hazard of infectious contact is \u03bb 0 (\u03c4) = 1.2\u03c4. At low values of \u03c4, the hazard of infectious contact is very small, so almost all of the contact intervals will be censored. Since the percentiles are calculated for all censored and observed contact intervals, there may be too few observed intervals at the 10 th and 25th percentiles when \u03b1 = 2 for the large-sample normal approximation to be valid. Figure 6 shows the widths of the confidence intervals when who-infects-whom is not observed in terms of the width of the confidence interval when who-infects-whom is observed for \u03b2 inf , \u03b2 sus , \u03b2 pair , and \u039b 0 (\u03c4). For \u03b2 inf and \u03b2 pair , the precision gained by observing who-infects-whom is roughly equivalent to a 20-40% increase in sample size. The baseline hazard plays an important role in how much precision is gained, with a larger gain for \u03b1 = 0.5 than for \u03b2 = 2. There is no gain in precision for \u03b2 sus because observing who-infectswhom does not add to our knowledge of who was infected. Seeing who-infects-whom only slightly improves the precision of baseline hazard estimates.\n\nObserving who-infects-whom allows point estimates that are closer to the truth and interval estimates with better coverage probabilities. However, the EM algorithm can recover a great deal of information when who-infects-whom is not observed, making the iterative regression model of Section 2.5 a promising tool for infectious disease epidemiology.\n\nTo show how the methods of Section 2 can be applied, we will look at the effect of antiviral prophylaxis and age on the transmission of pandemic influenza A(H1N1) in Los Angeles County in 2009. The Los Angeles County Department of Public Health (LACDPH) collected household surveillance data between April 22 and May 19 according to the following protocol (Sugimoto et al., 2011): 1. Nasopharyngeal swabs and aspirates were taken from individuals who reported to the LACDPH or other health care providers with acute febrile respiratory illness (AFRI), defined as a fever \u2265 100\u00b0F plus cough, core throat, or runny nose. These specimens were tested for influenza, and the age, gender, and symptom onset date of the AFRI patient were recorded.\n\n2. Patients whose specimens tested positive for pandemic influenza A(H1N1) or for influenza A of undetermined subtype were enrolled as index cases. Each of them was given a structured phone interview to collect the following information about his or her household contacts: age, gender, type of contact (household, intimate, in-home daycare, non-home daycare), and high risk status (pregnant, child on long-term aspirin therapy, immunosuppressed, or history of a chronic cardiac, pulmonary, renal, liver, or neurologic condition). The interviewer also recorded whether prophylactic antiviral medication was being taken by the household contacts. They were asked to report the symptom onset date of any AFRI episodes among their household contacts.\n\n3. When necessary, a follow-up interview was given 14 days after the symptom onset date of the index case to assess whether any additional AFRI episodes had occurred in the household, including their illness onset date.\n\nThere were 58 households with a total of 299 members. There were 99 infections, of which 62 were index cases (4 of the 58 households had co-primary cases) and 27 were household contacts with an AFRI. For simplicity, we assume these were all influenza A(H1N1) cases and that all household members were susceptible to infection.\n\nOur natural history assumptions were adapted from Yang et al. (2009) and are identical to those in Kenah (2013) . In the primary analysis, we assumed an incubation period of 2 days, a latent period of 0 days, and an infectious period of 6 days. Under these assumptions, a person j with symptom onset at time was infected at time and will stop being infectious at time . Under these assumptions, person j can transmit infection on days t j + 1 to t j + 6. In a sensitivity analysis, we vary the latent period from 0 to 1 days, and the infectious period from 5 to 7 days.\n\nWe modeled influenza transmission within households, not between households or from outside the observed households. In each household, infected household members who had no possible infector within the household according to our natural history assumptions were assumed to be imported infections. We assumed that any infected household member could infect any susceptible household member. We used the regression model of Section 2.5 to estimate influenza transmission hazard ratios for the following covariates:\n\n\u2022 age inf = 0 if the infectious person is < 18 years old and 1 otherwise,\n\n\u2022 age sus = 0 if the susceptible is < 18 years old and 1 otherwise,\n\n\u2022 proph sus = 0 if the susceptible is not on antiviral prophylaxis and 1 otherwise.\n\nSince antiviral prophylaxis was initiated after the initial case in each household, it was considered only as a susceptibility covariate. All statistical analysis was done in R 2.15 (www.r-project.org).\n\nThere were 114 people aged < 18 years and 185 aged \u2265 18 years, with no missing age data. There were 91 people taking antiviral prophylaxis and 152 not taking prophylaxis, with missing prophylaxis data for 56 people. When who-infects-whom is not observed, a complete-case analysis requires the removal of all rows corresponding to infectioussusceptible pairs ij where and any member of is missing data. Otherwise, the remaining members of get too much credit for the infection of j.\n\nIn the main analysis, there were 70 people infected from outside the household (i.e., no possible infector in the household), 16 with 1 possible infector, 7 with 2 possible infectors, 4 with 4 possible infectors, and 2 with 8 possible infectors, giving us 1 16 \u00d7 2 7 \u00d7 4 4 \u00d7 8 2 = 2097152 possible transmission trees. The pairwise data contains 443 infectious-susceptible pairs with a total of 2455 pair-days at risk of infection. Of these, 16 \u00d7 1 + 7 \u00d7 2 + 4 \u00d7 4 + 2 \u00d7 8 = 62 rows represent possible infection events. All models used the Efron approximation (Efron, 1977) for the partial likelihood with tied failure times.\n\nThe top panel of Table 3 shows the results of seven models. All of the models including prophylaxis suggested that antiviral prophylaxis reduced the hazard of infectious contact by about 60%, with low p-values. Hazard ratio point estimates for the main effects of age in all models suggest that adults are more infectious and less susceptible than children. However, evidence for this result is very weak. Only one of the age effects was statistically significant in univariable models, and none were significant in any multivariable model. Multivariable and stratified models with interaction terms for age and antiviral prophylaxis suggest a stronger effect of antiviral prophylaxis on transmission to and from adults than on transmission to and from children. However, the evidence for this result is also weak; these coefficients had high p-values and wide confidence intervals. The bottom panel of Table 3 shows the results of a sensitivity analysis using the multivariable model without interaction.\n\nVarying the latent and infectious periods has little effect on the results of the model. Figure 7 shows estimates of the cumulative transmission probability based on the multivariable and stratified models without interaction. The results of the two models are similar, but the stratified model showed lower probabilities of transmission from children and higher probabilities of transmission from adults. All four panels clearly show the estimated effect of antiviral prophylaxis. All curves show bigger jumps on the first four days after infection than on days 5 and 6, which is consistent with the results of Kenah (2013) .\n\nComparing the top and bottom rows shows that children are estimated to be less infectious than adults. Comparing the left and right columns shows that children are estimated to be more susceptible than adults. As noted above, these differences are not statistically significant.\n\nThis data analysis has been intended primarily to illustrate the flexibility of the regression modeling framework for analyzing transmission data. There are several important limitations of the analysis itself. With only 29 within-household transmissions, the largesample normal approximations may not hold and there is limited power to estimate the effects of age and antiviral prophylaxis. The age classification is crude, so it may not accurately capture the effects of age. The prophylaxis variable was missing for many pairs and was binary, allowing no consideration of the timing of prophylaxis relative to exposure. Analyses of the household transmission of influenza A(H3N2) found greater child-to-child than adult-to-adult transmission (Addy et al., 1991) . In our analysis of influenza A(H1N1), children appeared less infectious and more susceptible than adults, but these differences were not statistically significant. If not due to random noise, such a result could reflect a difference between the H3N2 and H1N1 subtypes of influenza A or a bias caused the failure to account for infection from outside the household. In any case, this analysis shows that the model needs to be extended to model infection from outside the household and to handle missing data.\n\nThe semiparametric relative-risk regression model proposed here has several important advantages over the chain binomial model. It can be fit using standard statistical software with parameter interpretations that resemble the Cox model. Standard software can be used to convert the results into curves representing the cumulative probability of transmission in pairs of individuals with specific characteristics. It does not make any parametric assumptions about the baseline hazard of infectious contact, and it allows many of the same extensions as the Cox model, including stratification, interaction, and time-dependent covariates. This flexibility and ease of use will make it an important tool for infectious disease epidemiology. To realize this potential, there are several limitations that remain to be addressed.\n\nWe assumed that the set of imported infections is known. The chain binomial model handles unknown imported infections by including a per-time-unit probability of escaping infection from outside the household. In the semipara-metric regression model, this could be achieved by fitting two models in each step of the EM algorithm: a pairwise contact interval model within the household and an individual-level model in absolute time for infection from outside the household. At each step, the weights would be recalculated based on covariates, coefficient estimates, the baseline hazard of the contact interval distribution, and the baseline hazard of infection from outside the household.\n\nWe assumed that infection times, latent periods, and infectious periods were all observed. We can usually observe only the clinical course of the disease, so these times must be imputed. In Section 4, we had missing data on covariates. Simple missing data (such as antiviral prophylaxis) could be handled by extending the EM algorithm to calculate the expected log likelihood over the possible values of the missing data as well as who-infectedwhom. More complex missing data (such as infection and removal times) could be handled using data augmentation in a profile sampler (Lee et al., 2005) , getting a posterior distribution for the model coefficients while treating the baseline hazards as a nuisance parameter.\n\nWe assumed that all possible infectors of each person were observed. Unobserved infectors could occur because of incomplete contact tracing or asymptomatic infection. The possible bias caused by unobserved sources of infection needs to be studied, and methods for controlling it analytically or assessing its severity in a sensitivity analysis need to be developed.\n\nSome of our assumptions must be relaxed to capture the natural history of complex diseases. We assumed an SEIR framework best suited to acute, immunizing diseases that spread directly from person to person. Many foodborne and waterborne diseases, pneumococcal and meningococcal diseases, and other infectious diseases of major public health importance do not fit easily into this framework. To extend the proposed regression model to complex diseases, we could allow individuals to experience multiple events (e.g., first infection, second infection) or to experience different types of events (e.g., colonization, infection, relapse). We assumed that contact intervals were independent of infectious periods even though both are a ected by the same host-pathogen interaction. In some cases, there may be a covariate process X(\u03c4) such that I i (\u03c4) and are conditionally independent given X(\u03c4 \u2212 ). Otherwise, infectious contact and the infectious period must be modeled as a multivariate survival process.\n\nSeveral technical issues need further attention. The smoothing step is crucial to the fitting the regression model when who-infects-whom is not observed. Here, we used cubic smoothing splines because they were convenient and worked well. However, these do not guarantee that the smoothed hazard function is monotonically increasing and lack a convenient interpretation in terms of the likelihood. A penalized likelihood estimator that guarantees monotonicity, such as that of Anderson and Senthilselvan (1980) , would be more consistent with the EM algorithm. Model diagnostics, goodness-of-fit tests, and smallsample methods for point and interval estimation need to be developed, and a more rigorous study of the model asymptotics needs to be done.\n\nDespite these limitations, the semiparametric relative-risk regression model presented here is a powerful new framework for the analysis of infectious disease transmission data. Placing statistical methods for infectious disease epidemiology on the broad and deep theoretical foundation of survival analysis will help clarify study design and causal inference for communicable diseases and allow statistical methods to develop in concert with advances in molecular biology. Ultimately, these improvements may lead to more efficient vaccine trials and a better-informed public health response to future outbreaks and epidemics. and versus true \u039b 0 (\u03c4) for the 6000 simulations with a Weibull(0.5, 0.2) baseline contact interval distribution. For each simulation and each estimator, a circle is shown for the 10 th , 25 th , 50 th , 75 th , and 90 th percentiles of all possible contact intervals. The smoothed means were calculated using cubic smoothing splines. Kenah Page 23\n\nand versus true \u039b 0 (\u03c4) for the 6000 simulations with a Weibull(2, 0.6) baseline contact interval distribution. For each simulation and each estimator, a circle is shown for the 10 th , 25 th , 50 th , 75 th , and 90 th percentiles of all possible contact intervals. The smoothed means were calculated using cubic smoothing splines. Kenah Page 24\n\nThe width of 95% confidence intervals when who-infects-whom is not observed divided by its width when who-infects-whom is observed for \u03b2 inf , \u03b2 sus , \u03b2 pair , and \u039b 0 (\u03c4). The solid gray lines show smoothed means for \u03b1 = 0.5 and dashed gray lines show smoothed means for \u03b1 = 2. The smoothed means were calculated using cubic smoothing splines. Table 1 Hazard ratio 95% confidence interval coverage probabilities in simulations. Each probability is based on the results of 1000 simulations. 95% confidence interval coverage probabilities in simulations. Each probability is based on the results of 6000 simulations.\n\nBaseline hazard Quantile \u03b1 = .5 \u03b1=2 \u039b 0 (\u03c4) \u039b 0 (\u03c4) \u039b 0 (\u03c4) \u039b 0 (\u03c4) 10% . "}