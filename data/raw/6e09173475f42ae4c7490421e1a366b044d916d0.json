{"title": "Direct RNA nanopore sequencing of full-length coronavirus genomes provides novel insights into structural variants and enables modification analysis", "body": "Sequence analyses of RNA virus genomes remain challenging owing to the exceptional genetic plasticity of these viruses. Because of high mutation and recombination rates, genome replication by viral RNA-dependent RNA polymerases leads to populations of closely related viruses, so-called \"quasispecies.\" Standard (short-read) sequencing technologies are ill-suited to reconstruct large numbers of full-length haplotypes of (1) RNA virus genomes and (2) subgenome-length (sg) RNAs composed of noncontiguous genome regions. Here, we used a full-length, direct RNA sequencing (DRS) approach based on nanopores to characterize viral RNAs produced in cells infected with a human coronavirus. By using DRS, we were able to map the longest (\u223c26-kb) contiguous read to the viral reference genome. By combining Illumina and Oxford Nanopore sequencing, we reconstructed a highly accurate consensus sequence of the human coronavirus (HCoV)-229E genome (27.3 kb). Furthermore, by using long reads that did not require an assembly step, we were able to identify, in infected cells, diverse and novel HCoV-229E sg RNAs that remain to be characterized. Also, the DRS approach, which circumvents reverse transcription and amplification of RNA, allowed us to detect methylation sites in viral RNAs. Our work paves the way for haplotype-based analyses of viral quasispecies by showing the feasibility of intra-sample haplotype separation. Even though several technical challenges remain to be addressed to exploit the potential of the nanopore technology fully, our work illustrates that DRS may significantly advance genomic studies of complex virus populations, including predictions on long-range interactions in individual full-length viral RNA haplotypes.\n\n[Supplemental material is available for this article.]\n\nCoronaviruses (subfamily Coronavirinae, family Coronaviridae, order Nidovirales) are enveloped positive-sense (+) single-stranded (ss) RNA viruses that infect a variety of mammalian and avian hosts and are of significant medical and economic importance, as illustrated by recent zoonotic transmissions from diverse animal hosts to humans (Vijay and Perlman 2016; Menachery et al. 2017) . The genome sizes of coronaviruses (\u223c30 kb) exceed those of most other RNA viruses. Coronaviruses use a special mechanism called discontinuous extension of minus strands Sawicki 1995, 1998) to produce a nested set of 5 \u2032 -and 3 \u2032 -coterminal subgenomic (sg) mRNAs that carry a common 5 \u2032 leader sequence that is identical to the 5 \u2032 -end of the viral genome (Zuniga et al. 2004; Sawicki et al. 2007 ). These sg mRNAs contain a different number of open reading frames (ORFs) that encode the viral structural proteins and several accessory proteins. With very few exceptions, only the 5 \u2032 -located ORF (which is absent from the next smaller sg mRNA) is translated into protein (Fig. 1) .\n\nIn HCoV-229E-infected cells, a total of seven major viral RNAs are produced. The viral genome is also referred to as mRNA 1 because it has an mRNA function. In its 5 \u2032 -terminal region, the genome RNA contains two large ORFs, 1a and 1b, that encode the viral replicase polyproteins 1a and 1ab. mRNAs 2, 4, 5, 6, and 7 are used to produce the S protein, accessory protein 4, E protein, M protein, and N protein, respectively. The 5 \u2032 -region of mRNA 3 contains a truncated fragment of ORF S, which is considered defective. Although this sg RNA has been consistently identified in HCoV-229E-infected cells, its mRNA function has been disputed, and there is currently no evidence that this RNA is translated into protein (Schreiber et al. 1989; Raabe et al. 1990; Thiel et al. 2003) .\n\nLike many other +RNA viruses, coronaviruses show high rates of recombination (Lai 1992; Liao and Lai 1992; Furuya et al. 1993) . In fact, the mechanism to produce 5 \u2032 leader-containing sg mRNAs represents a prime example for copy-choice RNA recombination that, in this particular case, is guided by complex RNA-RNA interactions involving the transcription-regulating sequence (TRS) core sequences and likely requires additional interactions of viral proteins with specific RNA signals. In other virus systems, RNA recombination has been shown to generate \"transcriptional units\" that control the expression of individual components of the genome (Holmes 2009 ). The mechanisms involved in viral RNA recombination are diverse and may even extend to nonreplicating systems (Gallei et al. 2004 ). In the vast majority of cases, recombination results in defective RNA (dRNA) copies that lack essential cis-active elements and thus cannot be replicated. In other cases, functional recombinant RNA with new properties, such as the ability to replicate in a new host, may emerge (Chang et al. 1994 (Chang et al. , 1996 Brown et al. 2007; Gustin et al. 2009) . In yet other cases, defective interfering RNAs (DI-RNAs) may be produced. These defective (sg-length) RNAs contain all the cis-acting elements required for efficient replication by a helper virus polymerase and, therefore, represent parasitic RNAs that compete for components of the viral replication/transcription complex with nondefective viral RNAs (Pathak and Nagy 2009) .\n\nTo elucidate the many facets of recombination and to determine full-length haplotypes of, for example, virus mutants/ variants in complex viral populations (quasispecies), long-read sequencing has become the method of choice. Short-read secondgeneration sequencing technologies-such as Ion Torrent and Illumina-are restricted by read length (200-400 nt) (H\u00f6lzer and Marz 2017) . For example, the use of highly fragmented viral RNAs considerably complicates the investigation of haplotypes (Nowak 1992; Baaijens et al. 2017) . Because the nested coronavirus mRNAs are almost identical to the original genome sequence, short-read data can usually not be unambiguously assigned to specific sg RNA species.\n\nIn this study, we performed direct RNA sequencing (DRS) on an array of nanopores, as developed by Oxford Nanopore Technologies (ONT) (Garalde et al. 2018) . Nanopore sequencing does not have a limited reading length but is limited only by fragmentation of the input material (Mikheyev and Tin 2014; Chua and Ng 2016; Jain et al. 2016) . Further, by using DRS, we avoid several drawbacks of previous sequencing methods, in particular cDNA synthesis and amplification of the input material. Thus, for example, cDNA synthesis can create artificial RNA-RNA chimerae (Karst et al. 2018 ) that are difficult to discriminate from naturally occurring chimerae (such as spliced RNAs). Also, amplification before sequencing would remove all RNA modifications from the input material, whereas the nanopore sequencing technology preserves these modifications (Smith et al. 2017; Garalde et al. 2018) .\n\nRecently, nanopore sequencing has been used for metagenomic forays into the virosphere (Warwick-Dugdale et al. 2019) and studies focusing on transmission routes Faria et al. 2017) . Furthermore, viral transcriptomes have been investigated using nanopore sequencing of cDNA (Moldov\u00e1n et al. , 2018a Tomb\u00e1cz et al. 2017) , being subject to bias from reverse transcription and amplification. Other studies used DRS to study the human poly(A) transcriptome (Workman et al. 2018 ) and the transcriptome of DNA viruses such as HSV (Depledge et al. 2018) . Furthermore, the genome of influenza A virus has been completely sequenced in its original form using DRS (Keller et al. 2018 ).\n\nIn the present study, we sequenced one of the largest known RNA genomes, that of HCoV-229E, a member of the genus Alphacoronavirus, with a genome size of \u223c27,300 nt, in order to assess the complex architectural details for viral sg RNAs produced in cells infected with recombinant HCoV-229E. By using DRS, we aim to capture complete viral mRNAs, including the full coronavirus genome, in single contiguous reads. Sequence analysis of thousands of full-length sg RNAs will allow us to determine the architectures (including leader-body junction sites) of the major viral mRNAs. In addition, this approach provides insight into the diversity of additional HCoV-229E sg RNAs, probably including DI-RNAs. Further, we aim to assess whether RNA modifications can be called directly from the raw nanopore signal of viral molecules without prior in vitro treatment, as has been shown for DNA (Stoiber et al. 2016; McIntyre et al. 2019) .\n\nWe sequenced total RNA samples obtained from Huh7 cells infected with serially passaged recombinant human coronaviruses: wild-type (WT) HCoV-229E, HCoV-229E_SL2-SARS-CoV, and HCoV-229E_SL2-BCoV, respectively. In the latter two viruses, a conserved stem-loop structure (SL2) residing in the HCoV-229E 5 \u2032 UTR was replaced with the equivalent SL2 element from SARS-CoV and BCoV, respectively (Madhugiri et al. 2018) . Total RNA samples obtained for the latter two (chimeric) viruses were pooled before sequence analysis. Hereafter, we refer to the first sample as WT RNA and to the second (pooled) sample as SL2 RNA (see Methods).\n\nWe performed two DRS runs (one per sample) on a MinION Nanopore sequencer. As shown in Table 1 , we achieved a throughput of 0.237 and 0.282 Gb with 225,000 and 181,000 reads for the WT and SL2 sample, respectively. See Supplemental Figure  S1A for an overview of the read length distribution. For the WT and SL2 samples, 33.3% and 35.9% of the reads mapped to the reference HCoV-229E sequences, respectively; 15.8% and 10.2%, respectively, mapped to the yeast enolase 2 mRNA sequence, a calibration strand added during the library preparation, whereas 47.4% and 52.7% could be attributed to human host cell RNA. Minimap2 (Li 2018) did not align the remaining 3.50% and 1.11% of reads. Using BLAST (Altschul et al. 1990 ) against the nucleotide database, 18.1% and 20.7% of these reads can be attributed again to HCoV, human or yeast. As reads that were not aligned by minimap2 were mostly very short (median \u2264200 nt), of poor basecalling quality and represented only 0.62% and 0.15% of total nucleotides, respectively, we decided to only use the higher quality reads that minimap2 could align (for detailed statistics, see Supplemental (Raabe et al. 1990; Schreiber et al. 1989 ). Translation of the 5 \u2032 -terminal ORF(s) of the respective mRNA gives rise to the various viral structural and nonstructural proteins (indicated by different colors). mRNA 3 is considered defective and unlikely to be translated into protein. Each mRNA has a 3 \u2032 poly(A) tail and carries a 5 \u2032 -leader sequence that is identical to the 5 \u2032 -end of the genome. In a process called discontinuous extension of negative strands, negative-strand RNA synthesis is attenuated at specific genomic positions. After transfer of the nascent strand to an upstream position on the template, RNA synthesis is continued by copying the 5 \u2032 -leader sequence. As a result, the 3 \u2032 -ends of coronavirus minus-strand mRNAs are equipped with the complement of the 5 \u2032leader. The latter process is guided by base-pairing interactions between the transcription-regulating sequence (TRS) located immediately downstream from the leader sequence (TRS-L) at the 5 \u2032 -end of the genome and the sequence complement of a TRS located upstream of one of the ORFs present in the 3 \u2032 -proximal genome region (TRS-B).\n\nThe visualized raw voltage signal of a nanopore read is commonly called \"squiggle\" (see Supplemental Fig. S3 ). Different from all previous sequencing technologies, nanopore sequencing preserves the information about base modifications in the raw signal (Garalde et al. 2018 ). However, one of the biggest challenges is the accurate mapping of the raw voltage signal to bases (\"basecalling\").\n\nAs expected for nanopore DRS (Garalde et al. 2018; Keller et al. 2018) , reads had a median uncorrected error rate of \u223c15% for human and virus reads, whereas basecalling errors were reduced for yeast ENO2 mRNA reads, as the basecaller was trained on this calibration strand (see Table 1 ). This included gaps but omitted discontinuous sites >6 nt because they indicated recombination. Half of all errors were deletions. In addition, we found that more than half of all single-nucleotide deletions occur in homopolymers, and most of these stretches that coincide with a deletion are \u22653 nt long (see Supplemental Fig. S4 ). A quarter of the errors were substitutions, which we argue are largely because of modified bases that impede the basecaller's ability to assign bases correctly.\n\nThe HCoV-229E genome was 99.86% covered, with a large coverage bias toward both ends (see Figs. 1, 2). The high coverage of the 3 \u2032 -end reflects the higher abundance of mRNAs produced from the 3 \u2032 -terminal genome regions and is a result of the discontinuous transcription mechanism used by coronaviruses and several other nidoviruses (Pasternak et al. 2006; Sawicki et al. 2007; Sola et al. 2015) . The 3 \u2032 -coverage is further increased by the directional sequencing that starts from the mRNA 3 \u2032 -terminal poly(A) tail. Also, the observed coverage bias for the very 5 \u2032 -end results from the coronavirus-specific transcription mechanism because all viral mRNAs are equipped with the 65-nt 5 \u2032 -leader sequence derived from the 5 \u2032 -end of the genome. The remainder of the high 5 \u2032coverage bias likely reflects the presence of high numbers of DI-RNAs in which 5 \u2032 -and 3 \u2032 -proximal genomic sequences were fused, probably resulting from illegitimate recombination events as shown previously for other coronaviruses (Liao and Lai 1992; Furuya et al. 1993; Luytjes et al. 1996) . For the WT and SL2 samples, 38.37% and 16.32% were split-mapped, respectively. Of these, only 278 and 181 had multiple splits. The considerably larger fraction of split reads in the WT sample is explained by the high abundance of potential DI-RNA molecules (see Figure 2C ).\n\nAn alignment of the longest reads from both samples to the HCoV-229E reference indicates that they represent near complete virus genomes (Supplemental Fig. S1B ). The observed peaks in the aligned reads length distribution (see Fig. 4 , below) corresponded very well with the abundances of the known mRNAs produced in HCoV-229E-infected cells (see Fig. 1 ; Schreiber et al. 1989; Raabe et al. 1990; Thiel et al. 2003) . Alignment of the reads to these canonical mRNA sequences confirmed these observed abundances (Supplemental Fig. S5 ).\n\nThe median read length for the combined set of reads from both samples was 826 nt, with a maximum of 26,210 nt, covering 99.86% of the 27,276-nt-long virus genome, missing only 21 nt at the 5 \u2032 -end, 15 nt at the 3 \u2032 -end, and those nucleotides that correspond to the skewed error distribution, with 5.7 percentage points more deletions than insertions (see Table 1 ). The median read length might sound short; however, most of the viral RNAs (including many DI-RNAs) identified in HCoV-229E-infected cells were <2000 nt in length. Furthermore, this number nearly doubles the longest read length that can be obtained with short-read sequencing methods. We observed an abundance of very short reads, representing the 3 \u2032 (poly[A]) end of the genome. This could be an artifact of RNA degradation, although we cannot estimate the exact fraction of affected transcripts. Because sequencing starts at the poly(A) tail, fragmented RNA will not be sequenced beyond any 3 \u2032 break point. It is thus best to minimize handling time during RNA extraction and library preparation. Innovations in these fields will directly translate into larger median read lengths.\n\nWe obtained 99.15% and 98.79% identity in both samples (WT, SL2), respectively, with the help of the consensus caller Ococo (Br\u01d0nda et al. 2017 ) using the reference genomes and all reads mapping to it. We attempted a standard long-read assembly using Canu (Koren et al. 2017) , which yielded unusable results (WT: 389 contigs, longest 13 kb, all other <4 kb; SL2: 517 contigs, all <6 kb). We think that current nanopore-only assembly tools are not equipped to handle special read data sets such as those originating from a small RNA virus genome. In addition, we assembled WT and SL2 consensus sequences using Nanopore and Illumina data with HG-CoLoR (Morisse et al. 2018) in an approach that uses long nanopore reads to traverse an assembly graph constructed from short Illumina reads. We thereby recovered 99.57% of the reference genome in a single contiguous sequence at 99.90% sequence identity to reference using this approach with the single longest read from the SL2 sample. This hybrid approach illustrates how short-and long-read technologies can be combined to Both samples contain mainly HCoV-229E and host (Homo sapiens) transcripts, but also Saccharomyces cerevisiae enolase 2 (ENO2) mRNA reads (which was used as a calibration standard added during library preparation). Half of the sequencing errors were deletion errors, probably resulting to a large extent from basecalling at homopolymer stretches. The S. cerevisiae enolase 2 mRNA reads display an overall reduced error rate (bold) because the Albacore basecaller was trained on this calibration strand. Note that all error rates report differences to the reference genome and thus include actual genetic variation. \n\nIn addition to the leader-to-body junctions expected for the canonical sg mRNAs 2, 4, 5, 6, and 7, we observed a high number of recombination sites (Fig. 3 ) that were consistently found in our samples but have not been described previously (Fig. 3) . In this study, we defined a recombination site as any site that flanks more than 100 consecutive gaps, as determined in a discontinuous mapping (\"spliced\" mapping). Although there is currently no consensus on how to define such sites, we believe this to be a conservative definition, as this type of pattern is unlikely to result from, for example, miscalled homopolymer runs that, in our experience, typically affect less than 10 consecutive bases. We observe all known canonical HCoV-229E mRNAs at their expected lengths, including the (presumably) noncoding mRNA 3 (Fig. 4) .\n\nThe aligned reads distribution revealed clusters for all known mRNAs which closely fit the expected molecule lengths (Fig. 4) . The cluster positions show double peaks with a consistent distance of \u223c65 nt, that is, the length of the leader sequence. We observed that the 5 \u2032 -end of reads has larger-than-average error rates and is often missing nucleotides (for detailed statistics, see Supplemental Fig. S8 ). This might be because of a bias of the basecaller toward the end of reads. This is plausible because the underlying classification algorithm is a bidirectional (i.e., forward and backward looking) long-short-term memory neural network (LSTM). The mapping algorithm was often unable to align these erroneous 5 \u2032ends, leading to soft-clipped bases. Thus, for many reads representing canonical mRNAs, the included leader sequence was not aligned, which gives rise to the secondary peak at each cluster position. We also observed additional clusters that likely correspond to highly abundant dRNAs (Fig. 4) .\n\nWe also observed several unexpected recombination sites, for example, at positions 3000-4000 (within ORF1a, see Fig. 3 ). These sites were confirmed by both Nanopore and Illumina sequencing. They had a high read support and defined margins, suggesting a specific synthesis/amplification of these sg RNAs that, most likely, represent DI-RNAs. Because DI-RNAs are byproducts of viral replication and transcription, they present a larger diversity than the canonical viral mRNAs (Penzes et al. 1994 (Penzes et al. , 1996 M\u00e9ndez et al. 1996; Brian and Spaan 1997; Izeta et al. 1999) .\n\nNanopore sequencing captures recombination events far better than Illumina, which allowed us to identify even complex sg RNAs (composed of sequences derived from more than two noncontiguous genome regions) at much higher resolution: For example, we found sg RNAs with up to four recombination sites in the 5 \u2032 -and 3 \u2032 -terminal genome regions (Fig. 3) .\n\nNanopore sequencing preserves information on nucleotide modifications. By using a trained model, DNA and RNA modifications such as 5mC methylation could be identified (Fig. 5) . To assess the false-positive rate (FPR) of the methylation calling, we used an unmethylated RNA calibration standard (RCS) as a negative control that was added in the standard library preparation protocol for DRS. We considered a position to be methylated if at least 90% of the reads showed a methylation signal for this particular position. By using this threshold, the estimated FPR was calculated to be <5%. Our experimental setup did not include a positive methylation control.\n\nWhen analyzing 5mC methylation across various RNAs, we observed consistent patterns (Fig. 5 ) that were reproducible for the corresponding genomic positions in different RNAs, suggesting that the methylation of coronavirus RNAs is sequence-specific and/or controlled by RNA structural elements. Methylated nucleotides could be identified across the genome, both in the leader sequence and in the body regions of viral mRNAs.\n\nAlthough the overall methylation pattern looks similar between sg RNAs and the negative control (see Supplemental   B A C Figure 2 . Reference genome coverage of the HCoV-229E WT sample (blue) and the SL2 sample (orange) based on alignments with minimap2. There is an inverse correlation between sg RNA abundance and length. (A) Notable vertical \"steps\" in the coverage correspond to borders expected for the canonical sg RNAs (see Fig. 1 ). (B) The presence of the leader sequence (\u223c65 nt) in canonical sg RNAs gives rise to the sharp coverage peak at the 5 \u2032 -end. (C) We also observed unexpected \"steps,\" especially in the WT sample (blue). We hypothesize that the sequences correspond to DI-RNA molecules that may arise by recombination at TRS-like sequence motifs as well as other sites displaying sequence similarities that are sufficient to support illegitimate recombination events (see Fig. 3 ). We attribute the difference in the observed (noncanonical) recombination sites between the two samples to biological factors that we either did not control for or do not know (see also legend to Fig. 3 ).\n\nCold Spring Harbor Laboratory Press on March 19, 2020 -Published by genome.cshlp.org Downloaded from Fig. S9 ), we nevertheless find consistent methylation across different sg RNA \"types\"; that is, methylated positions of mRNA 2 are mirrored in mRNA 4 etc.\n\nWe identified highly diverse sg RNAs in coronavirus-infected cells, with many sg RNAs not corresponding to the known canonical mRNAs. These \"noncanonical\" sg RNAs had abundant read support, and full-length sequences could be obtained for most of these RNAs.\n\nAs indicated above, only 12% of the sg RNAs were found to conform to our current understanding of discontinuous mRNA transcription in coronaviruses, resulting in mRNAs that (all) carry an identical 5 \u2032 -leader sequence that is fused to the 3 \u2032 -coding (\"body\") sequence of the respective mRNA. We, however, believe that 12% represents an underestimate because a large number of sg RNAs were probably omitted from the analysis: First, RNA molecules degrade rapidly under laboratory conditions, even when handled carefully. The resulting fragments will only be sequenced if they contain a poly(A) tail. Second, the high sequencing error may introduce mismappings, especially for low-quality reads. , and nanopore reads of SL2 sample (C; inner track) reveal multiple recombination sites across the whole genome. An aggregation of recombination sites can be observed in the region that encodes the viral N protein. Furthermore, clear recombination sites can be seen at intergenic boundaries and at the 5 \u2032 and 3 \u2032 UTRs, with the former corresponding to the boundary between the leader sequence and the rest of the genome. Another prominent cluster can be observed in ORF1a in the WT nanopore sample but not in SL2. This cluster is supported by the WT Illumina data, excluding sequencing bias as a potential source of error. We hypothesize that because samples WT and SL2 were obtained from nonplaque-purified serially passaged virus populations derived from in vitro transcribed genome RNAs transfected into Huh7 cells, differences in the proportion of full-length transcripts versus abortive transcripts could translate into different patterns of recombination. Generally, nanopore-based sequencing allows more detailed analysis of recombination events owing to the long read length. Even complex isoforms such as two exemplary reads, each with four discontinuous segments, can be observed (blue and pink). These reads would not be assigned to the canonical model under our assumptions because of the high number of mismatches. However, we think the associated bias is low, because minimap2 is very robust against high error rates and because the reads are very long, thus ensuring that the mapper has sufficient aggregate information on a given read to position it very reliably on a reference. Third, the library preparation protocol for DRS includes the ligation of adapters via a T4 ligase. Any ligase could potentially introduce artificial chimera, although we did not investigate this systematically. Again, we think that this does not affect our results substantially: (1) This bias is random, and it seems unlikely that we would observe the very same RNA \"isoform\" many times if it was created by random ligation; (2) many \"isoforms\" that we observed only once (e.g., those colored pink and blue in Fig. 3 ) were structured plausibly: They contained a leader sequence and had recombined at expected (self-similar) sites corresponding to putative or validated TRSs, with downstream sequences being arranged in a linear 5 \u2032 -3 \u2032 -order. Fourth, finally, it is important to note that the RNA used for DRS was isolated from cells infected with a serially passaged pool of recombinant viruses rescued after transfection of in vitro transcribed genome-length (27.3-kb) RNAs. Transfection of preparations of in vitro transcribed RNA of this large size likely included a significant proportion of abortive transcripts that lacked varying parts of the 3 \u2032 genome regions, rendering them dysfunctional. It is reasonable to suggest that the presence of replication-incompetent RNAs lacking essential 3 \u2032 -terminal genome regions may have triggered recombination events resulting in the emergence of DI-RNAs that contained all the 5 \u2032 -and 3 \u2032 -terminal cis-active elements required for RNA replication but lacked nonessential internal genome regions. Upon serial passaging of the cell culture supernatants for 21 times, DI-RNAs may have been enriched, especially in the HCoV-229E (WT) sam-ple (Fig. 3) . Comparative DRS analyses of RNA obtained from cells infected with (1) plaque-purified HCoV-229E and (2) newly rescued recombinant HCoV-229E (without prior plaque purification), respectively, would help to address the possible role of prematurely terminated in vitro transcripts produced from fulllength cDNA in triggering the large number of DI-RNAs observed in our study.\n\nAlthough, for the above reasons, the low percentage of canonical mRNAs (12%) in our samples likely represents an underestimate, our study may stimulate additional studies, for example, to revisit the production of mRNAs from noncanonical templates (Wu and Brian 2010; Sola et al. 2011) . Also, it is worth mentioning in this context that, for several other nidoviruses, such as murine hepatitis virus (MHV), bovine coronavirus (BCoV), and arteriviruses, evidence has been obtained that sg RNA transcription may also involve noncanonical TRS motifs (Joo and Makino 1992; Lai and Cavanagh 1997; Lai 1998; Ozdarendeli et al. 2001; Alonso et al. 2002) .\n\nThe majority of sg RNAs (other than mRNAs) we found in our samples likely represent DI-RNAs, which are a common occurrence in coronavirus in vitro studies (Pathak and Nagy 2009) .\n\nTo our knowledge, this study is the first to perform RNA modification calling without prior treatment of the input sample. It only relies on the raw nanopore signal. Although DNA modifications such as 5mC methylation have been explored extensively (Breiling and Lyko 2015) , less is known about RNA modifications (Roundtree et al. 2017) , the importance of which is debated (Grozhik and Jaffrey 2017) . We found consistent 5mC methylation patterns across viral RNAs when tested at a FPR <5%. We were not able to assess the sensitivity and specificity of the methylation calling owing to the absence of a positive control group, which was beyond the scope of this study. Figure 4 . Distribution of aligned read lengths up to 8000 nt for both samples based on alignments with minimap2. We observed clusters that correspond well with the transcript lengths expected for canonical mRNAs (vertical dotted lines). Alignment of the reads to these canonical mRNA sequences confirmed these observed abundances (Supplemental Fig. S5 ). The distribution shows double peaks at the cluster positions because reads corresponding to mRNAs often miss the leader sequence, possibly owing to basecalling or mapping errors. We also observed additional clusters that likely correspond to highly abundant DI-RNAs. (A) A cluster in the WT sample that represents chimeric \u223c820-nt sg RNAs composed of both 5 \u2032 -and 3 \u2032 -terminal genome regions (\u223c540 and \u223c280 nt, respectively). We propose the template switch for this transcript occurs around position 27,000 and RNA synthesis resumes at around position 540 (see corresponding peaks in Fig. 3, track B) . (B) A cluster from the SL2 sample that contains transcripts with an approximate length of 5150 nt, which represents mRNA 3 (see Fig. 1 ). These transcripts are probably formed owing to a transcription stop at a TRS motif around position 22,150 (see corresponding peak in Fig. 3 , track C).\n\nRNA is known to have many different modifications, and we expect the presence of these on coronavirus sg RNAs (Machnicka et al. 2013) too. However, to our knowledge no comprehensive data exist on prior expectations for such modifications in coronaviruses, which might or might not correspond to those observed in for example, humans.\n\nIn addition, we observed that the software used (Stoiber et al. 2016 ) will likely present high error rates in regions of low coverage or where the underlying reference assembly is erroneous. This is because the resquiggle algorithm-upon which this method is based-has to align the raw nanopore read signal to the basecalled read sequence (see Supplemental Fig. S6 ). This is necessary to test the raw signal against learned modification models, of which at the time of manuscript preparation (May 2019) only 5mC was implemented for RNA. Nevertheless, new options to call these modifications at an acceptable error rate without any RNA pretreatment is a powerful method.\n\nThe validity of the methylation signal should be confirmed in future studies using, for example, bisulfite sequencing. Ideally, this validation should start from in vitro synthetic transcripts in which modified bases have been inserted in known positions. Furthermore, RNA modification detection from single-molecule sequencing is a current bioinformatic frontier, and algorithms and tools are under active development. We showed that consistent 5mC methylation patterns were seen across different sg RNAs. However, the overall pattern of the methylation calls between sg RNAs and the negative control was very similar. At a FPR of 5%, the RNA modifications we identified are supported by their consistent occurrence. However, we cannot rule out that instead, the observed pattern might be caused by an alignment artifact. In the used methylation calling algorithm, the raw signal is aligned to the nucleotide sequence after basecalling. If there is a systematic bias in this alignment and certain sequence motifs cause a consistent mapping mismatch, this mismatch could lead to false-positive methylated sites. This is because in these positions the signal would deviate from the expected one owing to the misalignment and not owing to methylation. In future experiments, this can be decided using a positive control in the form of an RNA transcript with known 5mC methylated sites. However, even if we are in its early stages, the reading of RNA modifications from the read signal has great potential to elucidate viral biology.\n\nWe were able to reconstruct accurate consensus sequences, for both the Illumina and Nanopore data. We also showed that individual transcripts can be characterized. More problematic was the resolution of quasispecies in our experimental setup. Although DRS allowed us to confirm the presence of each of the two heterologous SL2 structures present in the SL2 sample, this was only possible for sg-length (DI-) RNAs. It appears that the high error rate of >10% was a critical limitation when analyzing the SL2 region located at the extreme 5 \u2032 -terminal end of the 27.3-kb genome RNA. This high error rate made variant calling difficult, particularly under low-coverage conditions. The current generation of long-read assemblers is not well suited to reconstruct many viral genome architectures, such as nested ones. The development of specialized assemblers would be of great help in virology projects.\n\nWe used a hybrid error correction method (HG-CoLoR) (Morisse et al. 2018 ) that uses Illumina data to correct read-level errors. However, it remains questionable whether the corrected read sequence is truly representative of the ground truth read sequence. Signal-based correction methods such as Nanopolish (Loman et al. 2015 ) may be more promising; however at the time of manuscript writing (May 2019), correction on direct RNA data has not been implemented. We expect this to become available in the near future. Combined with the ever-increasing accuracy of the nanopore technology, we think this method might be able to study quasispecies soon.\n\nThere are recombination events observed in the Illumina data that were not detected in the nanopore data. These are likely caused by misalignment of the short single-end reads (50 nt). A minimum of only 10 nt was required for mapping on either end of the gapped alignment. This was a trade-off between sensitivity to identify recombination sites and unspecific mapping.\n\nIn this work, we showed the potential of long-read data as produced by nanopore sequencing. We were able to directly sequence the RNA molecules of two different samples of one of the largest RNA virus genomes known to date. We showed how very large RNA genomes and a diverse set of sg RNAs with complex structures can be investigated at high resolution without the need for a prior assembly step and without the bias introduced by cDNA synthesis that is typically required for transcriptome studies.\n\nThe detail and quality of the available data still require significant bioinformatic expertise as the available tooling is still at an early development stage. However, the technological potential of nanopore sequencing for new insights into different aspects of viral replication and evolution is very promising.\n\nFuture studies should investigate both strands of the coronavirus transcriptome. Studies focusing on RNA modifications need The transcripts have been aligned such that corresponding genomic positions can be found in the same vertical column across facets. Both the leader sequence (including the TRS) and the nested sg sequences show consistent patterns of methylation across transcripts. Exemplary positions that display consistent methylation across all investigated transcripts are marked as red vertical lines. Note that although coronavirus recombination uses two TRSs, the resulting transcript has only one TRS, because of self-similarity-based pairing of the TRS. Positions have been labeled \"methylated\" if at least 90% of the reads show a methylation signal. Using this threshold, the estimated FPR is <5%.\n\nto use well-defined positive and negative controls to assess the error rate of the current software alternatives. Also, the DRS method will be extremely powerful if it comes to analyzing the nature and dynamics of specific haplotypes in coronavirus populations under specific selection pressures, for example, mutations and/or drugs affecting replication efficiency and others.\n\nOur work also serves as a proof of concept showing that consistent RNA modifications can be detected using nanopore DRS.\n\nTo fully exploit the potential of DRS, several improvements are needed: First and foremost, a significant reduction of the currently very high per-read error rate is crucial. This is especially problematic in studies focusing on intra-sample heterogeneity and haplotypes. Second, protocols that limit RNA degradation during library preparation would be of great value. This could be achieved by shortening the library protocol. To limit the cost of DRS, barcoded adapters would be desirable. On the bioinformatics side, the basecaller for DRS data is still at an early stage and, for example, cannot accurately call the poly(A) regions as well as the RNA-DNA-hybrid adapter sequences. Further basecalling errors likely result from RNA modifications, which need to be modeled more accurately. However, once these limitations will be fixed, the use of nanopore-based DRS can be expected to greatly advance our understanding of the genomics of virus populations and their multiple haplotypes.\n\nThe two total RNA samples used in this study for DRS (ONT MinION) and Illumina sequencing were prepared at 24 h post infection from Huh7 cells infected at an MOI of three with recombinant HCoV-229E WT, HCoV-229E_SL2-SARS-CoV, and HCoV-229E_SL2-BCoV, respectively (Madhugiri et al. 2018) . Before sequence analysis, the two RNA samples obtained from HCoV-229E_SL2-SARS-CoV-infected and HCoV-229E_SL2-BCoV-infected cells were pooled (SL2 sample) (see Supplemental Fig. S7 ).\n\nGeneration of recombinant viruses and total RNA isolation were performed as described previously (Madhugiri et al. 2018) . Briefly, full-length cDNA copies of the genomes of HCoV-229E (GenBank accession number NC_002645), HCoV-229E_SL2-SARS-CoV, and HCoV-229E_SL2-BCoV, respectively, were engineered into recombinant vaccinia viruses using previously described methods (Thiel et al. 2001; Hertzig et al. 2004; Thiel and Siddell 2005) . Next, full-length genomic RNAs of HCoV-229E, HCoV-229E_SL2-SARS-CoV, and HCoV-229E_SL2-BCoV, respectively, were transcribed in vitro using purified ClaI-digested genomic DNA of the corresponding recombinant vaccinia virus as a template; 1.5 \u00b5g of full-length viral genome RNA, along with 0.75 \u00b5g of in vitro transcribed HCoV-229E nucleocapsid protein mRNA, was used to transfect 1 \u00d7 10 6 Huh7 cells using the TransIT-mRNA transfection kit according to the manufacturer's instructions (Mirus Bio). At 72 h post transfection (p.t.), cell culture supernatants were collected and serially passaged in Huh7 cells for 21 (WT) or 12 times (HCoV-229E_SL2-SARS-CoV and HCoV-229E_SL2-BCoV), respectively.\n\nFor nanopore sequencing, 1 \u00b5g of RNA in 9 \u00b5L was carried into the library preparation with the Oxford Nanopore DRS protocol (SQK-RNA001). All steps were followed according to the manufacturer's specifications. The library was then loaded on an R9.4 flow cell and sequenced on a MinION device (ONT). The sequencing run was terminated after 48 h.\n\nThe raw signal data were basecalled using Albacore (v2.2.7; available through the Oxford Nanopore community forum).\n\nAlthough it is customary to remove adapters after DNA sequencing experiments, we did not perform this preprocessing step. The reason is that the sequenced RNA is attached to the adapter molecule via a DNA linker, effectively creating a DNA-RNA chimera. The current basecaller, being trained on RNA, is not able to reliably translate the DNA part of the sequence into base space, which makes adapter trimming based on sequence distance unreliable. However, we found that the subsequent mapping is very robust against these adapter sequences. All mappings were performed with minimap2 (v2.8-r672) (Li 2018) using the \"spliced\" preset without observing the canonical GULAG splicing motif (parameter -u n), and k-mer size set to 14 (-k 14).\n\nRaw reads coverage and sequence identity to the HCoV-229E reference genome (WT: GenBank, NC_002645.1; SL2: stem loop 2 sequence replaced with SARS-CoV SL2 sequence) were determined from mappings to the references produced by minimap2. Read origin and sequencing error statistics were assessed by mapping the reads simultaneously with minimap2 to a concatenated mock-genome consisting of HCoV-229E (WT and SL2 variants, respectively), yeast enolase 2 mRNA (calibration strand, GenBank, NP_012044.1), and the human genome (GRCh38). Identity and error rates are the number of matching nucleotides (or number of nucleotide substitutions, insertions, or deletions) divided by the total length of the alignment including gaps from indels.\n\nConsensus calling of nanopore reads was performed with Ococo (v0.1.2.6) (Br\u01d0nda et al. 2017) . The minimum required base quality was set to zero in order to avoid gaps in low coverage domains.\n\nWe used the hybrid error correction tool HG-CoLoR (Morisse et al. 2018) in conjunction with the Illumina HiSeq short-read data sets of both samples to reduce errors in all reads that exceed 20,000 nt in length. The program builds a de Bruijn graph from the near noise-free short-read data and then substitutes fragments of the noisy long reads with paths found in the graph that correspond to that same fragment of the sequence. HG-CoLoR was run with default parameters except for the maximum order of the de Bruijn graph, which was set to 50 in order to fit the length of the short reads.\n\nIllumina short-read sequencing was performed using the TruSeq RNA v2 kit to obtain RNA from species with poly(A) tails and without any strand information. The three samples (WT, SL2_SARS-CoV, SL2_BCoV) selected for this study were prepared on a HiSeq 2500 lane and sequenced with 51 cycles. After demultiplexing, 23.2, 22.0, and 23.8 million single-end reads were obtained for the WT and the two SL2 samples, respectively. The raw sequencing data were deposited at the OSF (doi:10.17605/OSF.IO/UP7B4) and ENA (PRJEB33797).\n\nWe first defined TRS as an 8-mer with a maximum Hamming distance of two from the motif UCUCAACU. We then searched the HCoV-229E reference genome (GenBank, NC_002645.1) for all matching 8-mers. We then synthesized sg RNAs in silico as follows: For each pair of complementary 8-mers (5 \u2032 -TRS, 3 \u2032 -TRS), we accepted at most one mismatch to simulate base-pairing under a stable energy state. We then joined two reference subsequences for each pair or TRS: first, the 5 \u2032 -end up to but not including the 5 \u2032 -TRS and, second, the 3 \u2032 -end of the reference genome including the 3 \u2032 -TRS and excluding the poly(A) tail.\n\nThis way we obtained about 5000 candidate sg RNAs. To validate them, we mapped the nanopore reads to these \"mock\" sg RNAs in a nondiscontinuous manner; that is, all reads had to map consecutively without large gaps. To count as a putative hit, 95% of the read length had to uniquely map to a given mock transcript, and the mock transcript could not be >5% longer than the read.\n\nWe only considered putative hits as plausible if they had a read support of at least five. With this threshold, we aim to balance the sensitivity of finding plausible novel transcripts with a need to control the number of false positives.\n\nWe used Tombo (v1.3, default parameters) (Stoiber et al. 2016 ) to identify signal level changes corresponding to 5mC methylation (see Supplemental Fig. S6) .\n\nTo assess the FPR of the methylation calling, we used an RCS as a negative control. It is added in the standard library preparation protocol for DRS. This mRNA standard is derived from the yeast enolase II (YHR174W) gene (Engel et al. 2014) and is produced using an in vitro transcription system. As a consequence, the mRNA standard is not methylated.\n\nFor a conservative resquiggle match score of 1.3 (part of the Tombo algorithm, default setting for RNA) and a methylation threshold of 0.9, the FPR was 4.67%, which met our requirement that the FPR be <5%. Our experimental setup did not include a positive methylation control.\n\nBoth the short-read cDNA (Illumina) and the basecalled long-read RNA (ONT) data from this study have been submitted to the European Nucleotide Archive (ENA; http://www.ebi.ac.uk/ena) under accession number PRJEB33797, as well as to the Open Science Framework repository UP7B4. Raw long-read data in fast5 format have also been submitted to this OSF repository. All analysis code has been submitted to the same OSF repository and is also available in Supplemental_Code.zip from the Supplemental Material."}