{"title": "A quantitative narrative on movement, disease and patch exploitation in nesting agent groups", "body": "1 Disease ecology is a rich field of study that synthesizes inter alia demographic, epidemic, 2 behavioural, movement, spatial and community processes in an ecological setting [1] [2] [3] [4] [5] [6] . 3 Thus, understanding the impact of particular diseases on wild populations in ecological 4 settings is a challenge that requires a comparison of the spatial and community structure 5 of these focal populations, as they might arise in the absence versus the presence of the 6 causative agents of the diseases of interest. One can undertake such studies in the Time. The action takes place over discrete time steps during which individuals (agents) 133 move through one or more cells, stay in a cell to exploit resources, or return to 134 their colony cell at regular intervals of time where they may reproduce. 135 Agents. Each agent has a biomass (which is a surrogate measure of its fitness), a 136 stress level, and a sex determined at birth. Females may reproduce on regular 137 returns back to their colonies by, essentially, fissioning into two (the parent retains 138 the majority of the biomass, while the offspring acquires the minority of biomass, 139 with some loss due to the cost of reproduction). limitations are assumed), provided they are sufficiently fit (i.e., large) and not too 164 stressed. Individuals die at a natural-mortality specified rate, plus an additional 165 disease-induced-mortality rate during their infectious period. 166 Fission-fusion. Individuals moving into a cell that contains a colony, will join the 167 group associated with that colony with a particular probability provided their own 168 colony is some specified ratio larger than their current colony. Epidemiology. We allow individuals to cycle through an S (susceptible), E (exposed 176 but not yet infectious), I (infectious), V (immune), S cycle at rates respectively period. Individuals in all stages are subject to a natural mortality rate, while 180 individuals in the I stage are subject to an additional disease-induced mortality 181 rate. 182 \n\nThe mathematical equations are provided in Section 6, which are placed at the end of 184 the manuscript because it is not necessary to go through these details before the 185 presentation and discussion of our simulation results (those wishing to see the equations 186 before the results should read Section 6 before starting Section 3). These equations were 187 used to code the model using the Numerus Model Builder (NMB) platform that greatly 188 facilitated rapid, accurate construction of the model through NMB's hierarchical 189 architecture and chip design. More specifically, cell equations and agent equations were 190 first constructed as individual modules, which were then used to populate a \"world\" 191 with an open-ended number of agents moving over an 18\u00d718 hexagonal cellular array 192 that contained 9 regularly spaced nest cells (Fig. 1) . A toroidal topology was used to 3.1 Base-line scenario: no disease, no colony switching 218 We ran two instances of the baseline scenario and obtained similar results with some 219 stochastic variation across runs. A plot of the number of agents N t over time (all are in 220 the susceptible disease state) for the the two runs is provided in Fig. 3 and can are seen 221 to be close in both period and amplitude. We note that our baseline scenario places us 222 at a particular point in the consumer-resource growth-rate, extraction, and interaction 223 parameter value space of our model. Table 3 ). The top left graphic panel depicts the 18 \u00d7 18 hexagonal landscape: colony nest cells are indicated using fully saturated colors and their territory cells using corresponding partially saturated colors (note \"boundary spillover\" effects due to the toroidal landscape topology). The number of individuals in each colony at time t = 1959 are plotted in the central bar graph, using matching colony nest-cell colors. decrease the mutual interference level (parameter q in Eq. 6) from 1 (resource extraction 228 inefficiencies due to self and others are proportional to the total biomass of all agents in 229 cells) to 0 (inefficiencies arise only from self) or increase it to 10 (inefficiencies increase 230 ten fold for each competitor in the cell, presumably due to territorial conflicts) then we 231 see a small decrease in the oscillation frequency in the former case (compare plots Fig. 3 232 with orange plot in Fig. 4A ), but a very different type of trajectory in the strong mutual 233 interference case (compare plots in Fig. 3 with orange plot in Fig. 4B ). \n\nWe evaluated the effects of our agents moving on the total number of agents over time 236 for the following five strategy rules (note: the rules apply to staying in the current cell 237 or moving to one of 18 the cells within a radius of 2 hexagonal rings for all times steps 238 except t mod T f when all individuals must be back in their nest cells): 3. minimize movement costs (\u03c6 1 = \u03c6 2 = 0) 243 4. maximize an equally weighted combination of the above three (\u03c6 1 = \u03c6 2 = 1/3) 244 5. maximize an equally weighted combination of all three, but allow individuals to 245 switch colonies with an 80% probability when in the nest cell of a foreign colony 246 that is no more than 30% as large as the individual's current colony (p switch = 0.8, 247\n\nThe number of agents produced by an illustrative simulation for each of movement To illustrate the impact of mortality rates on population viability, we ran our baseline 253 scenario 15 times with the natural mortality increased from \u00b5 = 0.005 to \u00b5 = 0.02. The 254 times at which the population was extirpated in these 15 runs is given in the first row of 255 Number of agents N t (i.e., the agent population trajectory) are plotted for the baseline case except for the following modifications to movement behavior. Movement is driven by: territory size maximization (blue plots, two replicates when \u03c6 1 = 0, \u03c6 2 = 1 ); available resource maximization (green plots, two replicates when \u03c6 1 = 1, \u03c6 2 = 0); movement cost minimization (orange and yellow plots, two replicates of \u03c6 1 = \u03c6 2 = 0); and equal weightings of above three (dotted grey plot-the same as blue plot in Fig. 3 where \u03c6 1 = \u03c6 2 = 1/3).\n\nindividuals persists over time) [48] . In the latter case, the bimodal distribution is 267 essentially a long-tailed distribution, given that all stochastic population processes 268 ultimately go to zero, if zero is an absorbing state (which it is in our model since no new 269 infectious individuals are recruited from outside of our metapopulation) [77] (Fig. 6 ).\n\nOur model is initially seeded for potential disease outbreaks in that one of the agents at 271 simulation initialization is in disease state E (exposed), while the remaining 349 are in 272 disease state S (susceptible). To set up potential pathogen transmission outbreak 273 scenarios requires that the transmission parameter be positive (i.e. \u03b2 > 0). To explore 274 the nature of these bimodal distributions for our model, we simulated 15 instances each 275 of disease dynamics for the cases \u03b2 = 0.01, 0.2, and 0.03. The amount of time it took 276 for the number of exposed and infected individuals to fall to zero in each of these cases 277 is represented in the histograms plotted in Fig. 6A . The agent dynamics in the 278 longest-lasting of these 45 runs is illustrated in Fig. 6B . In these simulations, we note 279 that the only effect of pathogens on host-population dynamics is through the 280 assumption that individuals in disease states E and I do not reproduce, and not through 281 disease-induced mortality (considered next).\n\nOctober 1, 2019 10/28 \n\nIn standard SIR epidemic models, the virulence of a pathogen is assumed to be 284 captured by the size of the disease-induced mortality rate parameter [14] . In our model 285 this parameter is \u00b5 I ( Table 2) . We investigated the effects of increasing the value of this 286 virulence parameter in the context of a pathogen transmission rate of \u03b2 = 0.05 (Table 2 ) 287 that leads to outbreaks that generally persist over our 2000 time step interval (cf. Lotka-Volterra-type population process iterated at a \"slow\" daily time scale. This study 340 found inter-alia that increasing predator efficiency by either increasing their perceptual 341 range or decreasing the number of prey refugia resulted in a coexistence region-an 342 equilibrium around which the prey and predatory populations oscillated-decreased for 343 both prey and predator, thereby increasing the risk of extinction. As in our model, the 344 second study included the interaction of both competition and predation. The \n\nOne thread of the quantitative narrative that emerges from simulations of our model 354 is that competition causes the period of prey-predator oscillations to increase and be 355 dampened more rapidly, with this increase and dampening accentuated as colony 356 mixing increases. A second thread is that a \"grass is greener syndrome\" (i.e., movement 357 decisions are based purely on resource considerations) leads to increased stress in \n\nA second thread of the quantitative narrative that emerges from our simulations 367 relates to the effects of disease on population dynamics, for which our model provides 368 an appropriate formulation to address the questions of interest. One of these effects is 369 the impact of increasing pathogen transmission rates on the maintenance of an endemic 370 infection. No subclass of a population (e.g., infectious individuals or even the 371 population as a whole) can persist forever-both are bounded stochastic population 372 processes that are known to go extinct in a finite amount of time [74, 75] . This is amply 373 demonstrated in our simulations that consider the impacts of increasing pathogen 374 transmission rates. In Fig. 6A , we verify that our infection process produces the 375 expected U-shaped bimodal distributions of infectious individuals, though the breadth 376 of the distribution associated with the outbreak mode (as opposed to an early-fade-out 377 mode) increases with \u03b2. Indeed, for \u03b2 = 0.05, once an outbreak occurs, it generally lasts 378 longer then 1000 time steps, as illustrated in Fig. 7 . This remains true as the virulence 379 of the pathogen increases from \u00b5 I = 0 (blue plots in Fig. 7 ) through \u00b5 I = 0.03 (orange 380 plots in Fig. 7 ) and \u00b5 ID = 0.1 (grey plots in Fig. 7 ) to \u00b5 I = 0.2 (yellow plots in Fig. 7 ). 381 What is clear from these simulations is that as virulence increases, the number of more precise than the level of the errors associated with the fit of models to data.\n\nThe model we present here has the potential to address a range of questions relating 403 to the ecology of consumer-resource interactions played out over spatially-structured 404 landscapes and impacted by movement and disease processes. Our model can also be 405 elaborated to address questions that include, for example, mating and genetic 406 structures, multispecies situations, environmental factors that exhibit seasonal variation, 407 and landscape structures, including individuals moving over real landscapes. Numerus 408 Model Builder has the facility to import landscape information from GIS databases that 409 can be easily extended to metapopulation settings [90]: thus our model can be readily 410 extended to ask questions about spatially-structured populations on real landscapes.\n\nOf course, considerable interest exists in fitting models to data, especially in the 1. The population initially consists of N 0 agents; but over time, due to births and 425 deaths this number will change and be designated N t . 426 2. The landscape is a pixelated H \u03b3 \u00d7 H \u03b4 hexagonal cellular array with a doughnut 427 topology. The index pair \u03b3, \u03b4 refers to a particular cell in this array. To emphasize 428 that these indices refer to one entity (a particular cell), we tie them together using 429 October 1, 2019 14/28\n\nAll rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint a hat notation: viz., \u03b3, \u03b4. This is particularly useful when we use multiple 430 subscripts to refer to cells in the neighborhood of the cell \u03b3, \u03b4. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint (d) a \u03b1, , = 4, 5, ... may be continuous state variables that measure the relative 475 size of individuals, their state of hunger, their state of emaciation when food 476 is in short supply, and so on. Here we only use two such variables and refer 477 to a \u03b1,4 interchangeably as the fitness or biomass variable and a \u03b1,5 as the 478 stress variable. distance any single move can be:\n\nThe total number of cells in this set is K = 1 + 6(1 + 2 + ... + r) = 1 + 3r + 3r 2 (one 497 center cell plus each hexagonal ring centered on this center cell ring has 6 cells more 498 then the its immediate inscribed ring: i.e., 1+6+12+...+6(r-1)+6r cells). We use the 499 notation \u03b3, \u03b4 i \u2261 i, i = 1, ..., K to index a renumbering of cells in BLOCK \u03b1 (r) . One 500 renumbering scheme, for example, is to label the center cell \u03b3, \u03b4, occupied by individual 501 \u03b1, as \u03b3, \u03b4 = \u03b3, \u03b4 1 , the cell to its immediate west as \u03b3, \u03b4 + 1 = \u03b3, \u03b4 2 , then going 502 counter-clockwise until the last of the cells in RING \u03b1 (1) has been labeled 7 (i.e., 503 \u03b3 \u2212 1, \u03b4 + 1 = \u03b3, \u03b4 7 and moving on to the west most cell in RING \u03b1 (2) as 8 and so on 504 until all cells in RING \u03b1 (r) have been labeled.\n\nThe decision for agent \u03b1 belonging colony to stay in its current cell or move to 506 some other cell in BLOCK \u03b1 (r) is determined using the agent movement rule below that 507 relies on the following three measures: 508 Distance measure: Closer is better 509 For some decay parameter \u03b5 > 0, distance radius \u03bd i , and maximum distance\n\nrepresent the distance between the center cell and the i th cell in BLOCK \u03b1 when this 512 cell is in RING \u03b1 (\u03bd i ). If\n\nOctober 1, 2019 16/28\n\nAll rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Comparative occupation-history measure: Prefer cells less used by other colonies 517 Under our renumbering c \u03b3,\u03b4 i ,m+1 (t) is cell i's \u03b3, \u03b4's memory state with regard to 518 the occupation history of agents from colonies m = 1, ..., M in this cell. For cells 519 i = 2, ..., K, this quantity is based on a comparison of the largest occupation 520 history value (in cell i) of c \u03b3,\u03b4 i ,m (t) for all m = 1, ..., M in comparison with the 521 occupation history value of agent \u03b1 in cell i. Recalling that agent \u03b1 is from colony 522 ) then, for i = 1, ...., K, First, we determine for all cells which individuals occupying each cell stay or move, and 531 then, we compute changes in the resource states of the cells, as well as the fitness that 532 individuals gain or lose from consuming resources due to movement activity. \n\nIf y = 0 then X(t) = 0. Specifically, the individuals' fitness states a \u03b1,4 (t \u2212 1), 548 \u03b1 = 1, ..., N , are updated for a maximum fitness value a max \u03b1,4 , a fitness decay factor 549 October 1, 2019 17/28\n\nAll rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint \u03c8, and a biomass conversion parameter 0 < \u03ba < 1 using 550 a \u03b1,4 (t) = e \u2212\u03c8 a \u03b1,4 (t \u2212 1) + \u03baX(t \u2212 1) max 0, 1 \u2212 a \u03b1,4 (t \u2212 1) a max \u03b1,4\n\nand the cell \u03b3, \u03b4 resource state for resource-intrinsic-growth-rate parameter r > 0, 551 reservoir parameter g \u2265 0 and saturation parameter s > 0 is updated, by first\n\nand then using the equation\n\nMOVE dynamics Individual fitness updating 555\n\nIf an individual \u03b1 moves out of a cell at time t \u2212 1, then the individual's fitness 556 (or biomass) decays at a rate \u03bd\u03c8 > 0, where \u03c8 is the decay rate factor introduced 557 in the STAY dynamics section and \u03bd > 0 is the fitness cost of moving relative to 558 not moving; i.e., 559 a \u03b1,4 (t) = e \u2212\u03bd\u03c8 a \u03b1,4 (t \u2212 1)\n\nStress dynamics Individual not meeting daily requirements 560 We model stress dynamics using a variables a \u03b1,5 (t) for the a = 1, ..., N agents. We 561 note that a \u03b1,5 (t) \u2265 0, such that a \u03b1,5 (t) = 0 implies the individual is unstressed 562 with stress increasing as a \u03b1,5 (t) increases. We assume that without additional 563 stress input, the a \u03b1,5 (t) relaxes back to zero at a rate c z . However, if an 564 individual is subject to an additional stress z \u03b1 (t) over the interval [t, t + 1] then 565 its new stress level at time t will be 566 a \u03b1,5 (t) = max{0, (1 \u2212 c z )a \u03b1,5 (t \u2212 1) + z \u03b1 (t \u2212 1)}\n\nTo calculate the amount of stress an individual is subject to in each time interval, 567 we assume that when it moves (i.e. does not take in any resources) then it has a 568 resource deficit of X * type (i.e., a set of input parameter values subscripted by type, 569 where \"type\" indicates that these deficits may vary by species, sex, or age, etc.). 570 In this case we assume, dropping the type designation (since we make this 571 parameter the same for both sexes, all disease states, and we have no incorporated 572 age structure), that 573 MOVES :\n\nwhere c m > 0 is a conversion constant that depends on the units used to measure 574 resources. On the other hand, if an individual gets to stay in the cell over time\n\n[t, t + 1], and there are y individuals (including itself) that stay to exploit 576 resources in the cell during this time interval, the amount of resource that the 577 individual extracts, from Eq. 6, is X(t \u2212 1)/y. We now assume that the extent to 578 which this value falls short of the resource deficit value X * is the amount of stress 579 incurred over [t, t + 1] multiplied by the conversion constant: i.e., 580 STAYS :\n\nNote the the above covers all individuals that stay whether or not they reproduce. 581\n\nOctober 1, 2019 18/28\n\nAll rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. \n\n6.4 Epidemiology and Deaths\n\nThe epidemiological component is essentially an S (susceptible), E (exposed but not yet 589 infectious), I (infectious), V (recovered with immunity) and D (dead) model [26] . We 590 use the value of a \u03b1,2 to denote this state and use the following rules to compute whether 591 or not individuals in states S, E, I, and V respectively transition to states E, I, V, S and 592 D in terms of \"transition rate parameters\" \u03b3 E > 0, \u03b3 I > 0, \u03b3 V > 0, \u03b3 S > 0 and \u03b3 D \u2265 0. 593 We assume a basic death rate over the interval [t, t + 1) \u00b5 0 > 0 that increases with 594 stress at rate that is proportional to the stress level a \u03b1,5 (t), with a constant of 595 proportionality given by c s > 0. In this case:\n\nfor all individuals in diseases states S, E, I and V. For individuals in disease state I, we 597 assume an additional disease induce mortality rate \u00b5 I c \u03b3,\u03b4,1 (t) (where for relatively high 598 mortality diseases \u00b5 I >> \u00b5 0 ) so that for individuals in I, where we add the index I to 599 distinguish it from the rate we have in Eq. 15\n\nCell Infectiousness Pathogen density in each cell \n\nIf susceptible, individuals also have a probability of dying over the same time 612 interval at a rate (or force of risk) that is proportional to their stress level a \u03b1,5 (t) 613 then, in essences, we are assuming that the transition rate out of then using a There are several ways to deal with emigration. A relatively simple approach is for 629 an individual to make a decision to join a colony, when it enters a colony cell and Here is a very simple approach that we employ in our simulation, based on the idea 634 that if a colony consists of a very few individuals, then competition for resources is less 635 intense in the neighborhood of this colony. In rule articulated below, #m refers to the 636 number of individuals in colony m:\n\nRule: An individual from colony m , currently in the nest cell of colony m, will switch to colony m with probability p switch whenever #m /#m < \u03c1 crit (20)\n\nAll individuals in colonies that do not move have an opportunity to reproduce at that 639 start of each new fast cycle (i.e., when t mod T f = 0). In particular, any individual who 640 is in disease state S or V, and whose fitness value exceeds b min will not move in the next 641 time step, but will instead give rise to a new individual. The fitness/biomass value of 642 this reproducing individual will drop (parent) and a newborn will be created with 643 updated fitnesses given by 644 If t mod T f = 0 and a \u03b1,4 (t) > b min then a \u03b1,4 (t + 1) = \u03c6 parent a \u03b1,4 (t) parent fitness a \u03b1 ,4 (t + 1) = \u03c6 newborn a \u03b1,4 (t) newborn fitness\n\nNote that the newly reproduced individual, \u03b1 , will belong to the same colony. In 645 addition, we must have \u03c6 parent + \u03c6 newborn < 1, where the shortfall of this sum from 1 is 646 a cost of reproduction. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. \n\nHere we provide some of the key details not included in previous publications [1, 2] regarding the construction, using the Numerus Model Builder platform, of the agent-based model presented in the main text. Numerus Model Builder (NMB) employs NovaScript, which is embedded in, and extends, Javascript. The NovaScript interpreter is an extension of the ECMA 1.7 Javascript standard. The full range of the Javascript language is available to the NovaScript programmer for specifying the computations required by his or her simulation. It includes facilities for specifying simulations visually, using stock and flow diagrams (familiar to programmers of Stella and Vensim) and other visual tools unique to NMB. Simulations are scoped out using such visual schematic diagrams with equation and other procedural details entered into appropriate windows [1] , or textually, via NovaScript. We will refer to the former as a diagram specification; the latter will be referred to as a code specification.\n\nNMB is highly modularized due to: 1) the creation of dynamic agent \"Capsules\" that interact with their environments through input/output interfaces (more below) and 2) allowing these agents to move over a heterogeneous resource landscape. Movement can either be on a Cartesian plane or from one cell to another on a rectangular or hexagonal array of specifiable dimension [1] . Our model moves agents over hexagonal arrays of variable and dynamic resource cells and was designed to address questions regarding agent and colony populations dynamics under different movement and disease scenarios.\n\nSimulations are built out of objects, called Components. Among the component types are Primitive Components, Simulators, Displays, and Controls. The primitive components consist of Stocks, Variables, Sequences, Flows, and Terms. Stocks, Variables and Sequences are used to represent the state of a running simulation. The Stock component may be attached to one or more Flows. Each Flow specifies some change in the current value of the Stock. A Variable is similar, only it is not attached to any Flow; rather its change is determined by a derivative contained in the Prime field. Sequences are similar to variables, except that they are discrete, and change is indicated by a Next field, directly determining the value of the sequence in the next time interval. Flows and Terms both have Exp fields containing their expressions. As mentioned above, Flows affect the value on the Stocks to which they are attached. A Term is used to compute a value using current State values (in Stella, what Numerus Model Builder calls a Term is referred to as a Converter.)\n\nThis model is formulated as a set of agents moving over a cellular array. Therefore, as described in our presentation, we require 3 Capsule types: the Cell, Agent, and sirTerrM. (Refer to Sections 3.1, 3.2, and 4 for further detail on each Capsule type.)\n\nA Numerus model is structured using elements called Simulators. Here is a description of the Simulators used in our model. 1 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Simulators. The term-of-art Simulator is used by Numerus Model Builder to describe a container of interacting components. In a running simulation, a Simulator is set to an initial state. As the simulation progresses its next state is determined by its current state and by other simulators with which it may be communicating. The Capsule is the simplest Simulator, and may contain any of the components described in the previous section. The five other Simulator types are array-like aggregators comprised of Capsule elements. Each aggregator introduces new functionalities to their constituents, as described below.\n\nCapsule. The role of the Capsule is to contain the components of a simulation and synchronize the progress of the computation. A Capsule holds instances of the primitive components, but may also contain other Capsules and other aggregator Simulators.\n\nThe top-level construct in any model is a Capsule.\n\nA CellMatrix is a spatial array of individual Capsules, or Cells laid out in either a Cartesian lattice or hexagonal grid. Each Cell has a pair of coordinates and can query the CellMatrix to determine the other Cells in its neighborhood, with which it can exchange information. A CellMatrix can also provide an environment for agents to exist when combined with an AgentVector (see below).\n\nIn our model each cell contains resources (i.e., plants, fruits, seeds), can act as a nest site associated with a specified colony of agents, and can be occupied by one or more agents who either pass through in a single time period or remain for some time during which they exploit the dynamically changing (through both growth and extraction) resources.\n\nAgentVector. An AgentVector contains a dynamic set of Capsules called Agents that can exist on some landscape. At any point in time an Agent has a location on that landscape, which will change if the Agent decides to move. Agent motion will generally either use a toroidal topology or reflect off the boundary like a billiard ball (other boundary effects can be implemented). The AgentVector helps Agents find nearby Agents with which they may interact. New Agents may be created and existing Agents may be removed during the lifetime of the simulation.\n\nIn our model each Agent has a biomass (a surrogate measure of the agent's individual fitness), a stress level, and a sex (determined at birth). Females may reproduce on regular returns back to their colonies. This works via the parent retaining the majority of the biomass, the offspring acquiring a minority of biomass, and some loss from the cost of the reproduction event itself. Our movement algorithm uses a toroidal topology in order to eliminate boundary effects.\n\nA SimWorld combines a CellMatrix with an AgentVector to create an artificial environment in which the Agents of the AgentVector range over the landscape created by the CellMatrix. Consequently, in addition to interacting with each other, Agents may determine the Cell in which they are located and interact with that or nearby Cells.\n\nPictured below is the top level Capsule of our model, sirTerrM showing the SimWorld labeled NWorld, which models a set of agents moving over a hexagonal cellular array.\n\nOther components in this Capsule are used to initialize the SimWorld and analyze and display results.\n\nNumerus Model Builder also provides 2 additional Simulators for implementing a network spatial topology and using that topology as an agent landscape.\n\nStocks, Flows and Sequences. Traditional system dynamics modeling is centered on the stock-and-flow construct, whereby a stock, representing some dynamic model value, is updated by adding or subtracting the content of one or more flows (i.e respectively \"flowing in or out\" of the stock). In the simplest case, with a single flow flowing into a stock, the flow's value is the derivative of the stock's value over time. (When multiple flows are present, the derivative is found by summing the positive and negative flow values). The stock-flow model in system dynamics is especially apt for designing networks of stocks connected by flows that move values between the stocks.\n\nNumerus fully supports the system dynamics paradigm, but adds several convenient modifications. A single Numerus Stock-Flow component may be substituted for a Stock with a single input Flow. This configuration can be particularly useful when modeling differential equations. Numerus also introduces a variation called Sequence, in which the Flow contains the Sequence's next value, rather than content to be added to or subtracted from the current value. Sequences do not offer the Runge-Kutta integration algorithms available to Stocks to reduce the error when modeling continuous processes; therefore they are most useful for discrete models.\n\nNumerus models are built using drag-and-drop gestures that place components on a design canvas. In the figures below, Stocks and Sequences respectively use lime-green and lavender-pink rectangles, and Flows are represented as yellow circles with arrows connecting to their Stocks.\n\nThe sirTerrM model uses both Stocks and Sequences in the Agent Capsule to represent continuous and discrete elements of the model. The population initially consists of N 0 agents, but over time, due to births and deaths this number will change and be designated N t . To assign this, we go to Project >> Prelude.\n\nRecall that the quantities c \u03b3,\u03b4,m (t), m = 1, ..., M , contain a fading memory of how many individuals from colony m have visited the cell c \u03b3,\u03b4 up until time t. In our implementation these data are stored in an M -element array in the Sequence Cell Memory. This array is initialized with each slot set to 0. At each point in time first the current value of each slot is aged by a factor of e \u2212\u03b7 M (where \u03b7 M is represented in the program by the parameter mem fade), and then the current population of the cell is distributed to the slots based on their nest of origin.\n\nNote that cell Memory is referenced by an agent during the process of determining its next move. This computation is contained in the agent's move comp term. 6 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint\n\nWe want the color of a cell in our visualization to reflect properties of the cell. Each nest is assigned a unique color which displays unless the nest is empty, in which case it displays in gray. Otherwise the cell's color is computed to reflect the color of the nest of origin of the most number of visitors, or a neutral color if unvisited. This computation occurs in the Cell term cellColor.\n\nUnderlying all dynamical systems modeling of epidemiological outbreaks and endemic diseases are formulations based on the concept of an SEIR progression. Susceptible individuals in disease class S enter disease class E on exposure to a pathogen (i.e., infected but not yet infectious themselves). After a period of latency, individuals in class E then transfer into the class of infectious individuals, I, only to transfer to a recovered or removed class R. However, note that once mortality is included in the model, then disease class R becomes ambiguous because removed individuals now include both recovered and dead individuals. Therefore, we use disease class V for recovered (i.e., \"V\" for naturally vaccinated individuals that have \"recovered with immunity\") and D for dead. This SEIVD notation proves useful once SEIR processes are expanded to include births, recruitment, immigration, deaths, and emigration processes.\n\ncell Infect: Each cell has a cell Infect Sequence representing the infectiousness of the cell at time t based on the number of infected individuals that have visited. We require a fade rate to account for an assumed decline in the infectiousness environment of the cell over time brought about by past visitors. If the fade rate is close to 0, this implies that an indirect transmission of pathogens via the cell's environment is of significance, whereas if the fade rate goes towards \u221e, then this implies that direct contact is increasingly important for transmission. 7 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint\n\nThe third and final Cell state value is the resources it contains for nourishing the agents that visit. The formulae for determining resource dynamics involve both natural growth and agent consumption, and are discussed fully in the paper.\n\nDisease Transition Terms: We include the 5 transition states as Terms: gamma S, gamma E, gamma I, gamma V, gamma D, all of which govern the transitions of the Disease Value State (refer to Section 3 Model Components). Note that gamma E, gamma I, and gamma V are constants derived from parameters. gamma S, which governs the transition from Susceptible to Exposed, depends on the value of cell infect (i.e. the infectiousness of the environment); and gamma D, which governs the transition to Death, depends in part on agent stress.\n\nDetermining movement is a computation that occurs in the Term move comp. Section 6.2 of the manuscript explains movement in great detail. For the purpose of the Supplementary document, we will focus on a few fundamental concepts that determined our choosing of the terms and states for this particular component.\n\nAt the start of each time interval [t, t + 1], we initially make a case for whether or not individual \u03b1 = 1, ..., N remains in its current cell or moves to some other cell in the set BLOCK \u03b1 (r), where r is some pre-selected positive integer that determines the furthest distance any single move can be.\n\nWe determined whether or not agent \u03b1 belonging to colony would stay in its current cell or move to another one, based on either Distance Measure (var dist), Comparative 8 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint Resource Measure (var myResource), and Comparative Occupation-History Measure (var otherMaxOccupancy).\n\nThere is also a stochastic trade-off with the agent movement rules, which play a role in determining cell attractiveness values. 9 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint\n\nThe Agent Color component also exists in order for us to observe distinctions between agents. It is determined by the agent Term agentColor, with each agent given the color associated with its home nest.\n\nA Fitness Sequence (defined in terms of the maximum resource extraction rate parameter) is also included in the model with the purpose of updating the stress state of individual agents. More specifically, the fitness of an individual is updated over the time interval[t\u22121, t] for the maximum fitness value, the fitness decay factor, and the biomass conversion values, all of which are broken down thoroughly in Section 6.3, Ecological Dynamics, of the manuscript. If an individual moves out of a cell at time t \u2212 1, then the fitness is reduced by a fraction that is some multiple of the decay rate.\n\nWe model Stress Dynamics through the agent's Stress Stock, which contains the quantity a \u03b1,5 (t) for a = 1, ..., N , as described in Equation 11 of Section 6.3 in the paper. We note that the Stress component is initially given a random value between 0.5 and 1.\n\nAll rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint\n\nThis model assumes nothing about mating structures and male limitations; therefore, only females reproduce, given a particular probability at regular colony-return times, provided they have sufficient fitness and sufficiently low stress values. Individuals die at naturalmortality specified rates, as well as with an additional disease-induced-mortality rate during their infectious period. Note that, as demonstrated in the figure below, Reproduction is a Command that occurs only when an agent selects \"reproduced\" as its current action. According to the rules of the model, this can occur only when the agent is in its home nest, which recurs on a cyclic basis (see the agent Term what should i do for the rules governing this selection).\n\nIn our model, we incorporate the effect of pathogens on host population dynamics; therefore, individuals in disease states E and I do not reproduce. Individuals in disease state S or V, and whose fitness value exceeds b min will not move at the next time step, but instead will give rise to a new individual. Furthermore, newly reproduced individuals will belong to the same colony as their parents.\n\n11 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint\n\nThe top-most level includes the SimWorld container NWorld to house the cells and agents defined by the latter two Capsules.\n\nThe Prelude contains the globally defined array nestPop that keeps track of the population of the 9 colonies used by the model. The Terms colony 0 through colony 8 each select a distinct slot of this array for inclusion in the bar graph Nest Population (see below). The locations of the nests are defined in the Term Nests using the Numerus Cell ID notation CY :X, where Y and X respectively indicate the row and column address of the cell. Nest locations are fed to the SimWorld through input pins to both its Agent and Cell constituents, since both need to be aware of these locations.\n\nThere are a total of 6 displays showing the state of the running model. The first is a visualization of model activity generated by the NWorld SimWorld. The second and third 12 All rights reserved. No reuse allowed without permission.\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. . https://doi.org/10.1101/791400 doi: bioRxiv preprint are, respectively, the bar graph mentioned above showing the current colony populations, and line graphs tabulating the current disease state of the agents. The final three displays provide statistical information across the agent and cell populations for Stress and Fitness (agent); and Resource (cell). The Stats plug-in is used to create graphs showing the mean and mean \u00b1 standard deviation of each of these quantities.\n\nThe tables below provide a translation between the notation used in the text and that employed in the model. "}