{"title": "Emerging Concepts of Data Integration in Pathogen Phylodynamics", "body": "In terms of the sequence evolutionary process, we make a distinction between the mode of evolution or the relative intensities by which sequence characters are exchanged in evolutionary history and the tempo of evolution which determines how this exchange process scales in units of time. The former can be modeled by different parameterizations of continuous-time Markov chain (CTMC) models and for which we refer to the general phylogenetic literature (Felsenstein 2004; Yang 2006; Lemey et al. 2009b). For the latter, time of sampling provides the most important source for calibration in phylodynamic inference.\n\nAs mentioned above, molecular clock models allow quantification of the rate of substitution, and for MEPs, their calibration is generally based on the divergence that accumulates over the sampling time range. The extent to which we expect to observe genetic changes between viral sequences sampled at different times will depend on the overall rate of substitution (and its constancy), the length of the sequences that can be obtained and the differences in time of sampling. We illustrate this for complete genome sampling from four different viral pathogens that have caused relatively recent outbreaks: pandemic influenza A (A(H1N1)pdm09), Middle East respiratory syndrome coronavirus (MERS), Chikungunya virus and Ebola virus (Fig. 1). For comparison, we also include a DNA virus (smallpox) and a bacterial pathogen (Salmonella Typhimurium DT104). These pathogens differ both in genome length and short-term rates of substitutions, which leads to different expectations for observing changes as time elapses between sequence samples (Fig. 1A). Influenza A(H1N1)pdm09 genomes are expected to accumulate more changes over time, closely followed by MERS and Ebola genomes, whereas this occurs at a considerably slower rate for Chikungunya but still faster than smallpox and Salmonella. The divergence accumulating in actual sequence data sampled during outbreaks of these viruses is largely consistent with the respective probability plots (Fig. 1B). Further in line with these expectations and empirical patterns, Hedge et al. (2013) have been able to accurately estimate evolutionary and epidemiological parameters from A(H1N1)pdm09 genomes as early as two months after the first reported case, which demonstrates a clear potential for real-time phylodynamic characterization during emerging epidemics. In general, assessing whether viral sequence samples contain sufficient temporal signal is a cautionary \u2014 if not a necessary \u2014 step prior to fitting dated-tip molecular clocks in order to extract epidemiological processes from viral sequences.\n\nAs in the general field of molecular evolution, making a molecular clock assumption serves two main purposes in phylodynamics: dating the phylogenetic history and providing a mechanistic description of the evolutionary process. The former is particularly useful to date cross-species transmissions, viral outbreaks, and the historical spread of epidemics. At a smaller scale, evolutionary estimates may also help to pinpoint the individual\u2019s infection time or assess transmission hypotheses (Vrancken et al. 2014b). Furthermore, incorporating sampling time can assist in adequately rooting pathogen phylogenies, which in turn may help in resolving the evolutionary origins of emerging viruses (e.g., for Ebola: Baize et al. (2014); Dudas and Rambaut (2014)). Coupled to tree-generative processes, time-measured genealogies also enable estimation of epidemic growth rates per unit time or basic reproduction rates, even early in a pandemic (Fraser et al. 2009; Volz et al. 2013; Hedge et al. 2013).\n\nThe nature by which the temporal information contained in the sampling times can be connected to the genetic similarities embedded in the sequences depends on the specific formulation of the molecular clock hypothesis. The original constant or \u201cstrict\u201d molecular clock model, postulating a single rate of substitution across all branches in the phylogeny, has proven to be too restrictive in many applications and can mislead divergence date estimation as well as phylogenetic inference (Yoder and Yang 2000; Ho and Jermiin 2007). This has motivated several developments to relax the strict molecular clock assumption, which can be largely subdivided into models that allow a limited number of discrete rate changes in the phylogeny (\u201clocal\u201d molecular clocks, Yoder and Yang (2000)) and models that allow the rate to change in a continuous fashion by either assuming or not assuming a relationship between the rates on ancestral and descendent branches (autocorrelated (Thorne et al. 1998) and uncorrelated (Drummond et al. 2006a) relaxed clocks respectively). Whereas the uncorrelated relaxed clock approach has gained considerable attraction as a generic clock modeling approach, it is worth noting that local molecular clock modeling also has interesting applications in pathogen phylodynamics. For example, assuming local molecular clocks for host-specific lineages can lead to more accurate reconstructions of phylogenetic history and this resulted in far more consistent evolutionary reconstructions across different segments of influenza A (Worobey et al. 2014). Host-specific rates of evolution also represent a particular scenario of local molecular clock modeling, but when such a specific hypothesis is not available a priori, a restricted number of discrete rate changes can still be identified through a random local molecular clock approach (Drummond and Suchard 2010).\n\nWhen the aim is to estimate divergence times, molecular clock specification may be considered as a nuisance and Bayesian model averaging approaches are particularly attractive in this context (Li and Drummond 2012). Accurately modeling substitution variation becomes a primary interest when the tempo of evolution is scrutinized as a mechanistic process. Understanding the sources of rate variation, and in particular determining the role of host ecology, will be the major focus of our discussion on covariates for evolutionary processes. In the next section, we first outline how additional data can be integrated with genetic data through trait evolutionary modeling, both for discrete and continuously valued traits.\n\nExamining traits associated with sequence data in an evolutionary context requires a model of how the traits evolve throughout phylogenetic history. Discrete trait modeling can take guidance from standard phylogenetics and borrow the process of exchange between sequence character states as a generic model for how traits substitute their state over tree branches. Arguably the most frequently considered traits in phylodynamics, and molecular evolution in general, are spatial locations. The interest in spatial dispersal, migration, or vicariance goes back to early naturalists studying the geographic distribution of species, even in the absence of genetic data (Haeckel 1866), and has developed into its own research field referred to as phylogeography. This field has witnessed several developments for reconstructing the geographic locations of ancestral lineages (e.g., Bloomquist et al. 2010), but here we focus on stochastic models of phylogenetic diffusion models and the structured coalescent.\n\nThe reconstruction of discrete character states on a phylogeny has traditionally relied on the principle of parsimony, which aims at minimizing the number of historical character changes required to produce the states of the trait we observe at the tree tips (e.g., (Maddison et al. 1984)). As in standard phylogenetics, maximum likelihood (ML) has been proposed as a probabilistic alternative to ancestral reconstruction. Using phylogenetic CTMC modeling, Pagel (1999b) introduced an ML approach to infer ancestral character states for binary discrete characters, which can be readily generalized to multistate characters (Pagel et al. 2004). As phylogenies are seldom known with certainty and generally represent the result of reconstruction procedures, Pagel et al. (2004) describe a general procedure for reconstructing ancestral character states across a statistically justified sample of trees estimated by a prior Bayesian phylogenetic analysis. This procedure combines information about the uncertainty of the phylogeny with uncertainty in the estimate of the ancestral state and avoids constraining the sample of trees to only those that contain the ancestral node or nodes of interest, which can lead to overconfidence in a particular reconstruction. A more efficient, simulation-free method for inferring ancestral traits is presented by Minin and Suchard (2008).\n\nIn the context of biogeography, Sanmart\u00edn et al. (2008) have also adopted Bayesian inference of discrete phylogenetic diffusion processes, this time proposing to jointly estimate the phylogeny and the trait evolutionary process (in MrBayes, Ronquist et al. (2012)). As discrete diffusion models, the authors consider the most general CTMC process with a different rate of exchange for each pair of states \u2014 akin to a General Time-Reversible (GTR) model in nucleotide space (Tavar\u00e9 1986) \u2014 and constrained versions thereof that represent specific scenarios of the island biogeography process they aim to characterize. A similar Bayesian full probabilistic connection between sequences and traits has also been implemented in BEAST, which initially focused on spatiotemporal reconstructions of viral spread (Lemey et al. 2009a). These sister approaches offer extensive modeling flexibility, but at the expense of a quadratic growth in number of instantaneous rate parameters in the CTMC matrix as a function of the state dimensionality of the trait. This is particularly problematic because the rate parameters are only informed by a single trait character observed at the tree tips.\n\nThe specific island biogeography application by Sanmart\u00edn et al. (2008) focused on a manageable problem by considering only a restricted number of spatial groups and by sharing a single rate matrix across different groups of organisms with independent phylogenies. However, Bayesian inference also offers specific ways to protect against over-parameterization. Prior specification is an obvious one that was exploited in viral epidemiology (Lemey et al. 2009a), for example, by simply proposing higher rates of diffusion between nearby locations a priori. Motivated by the argument that only a limited set of state transitions throughout evolutionary history can leave their trace in the distribution of a single character, Lemey et al. (2009a) adopted Bayesian stochastic search for variable selection (BSSVS) to reduce the number of rate parameters to a restricted set that provides the most adequate parsimonious description of the diffusion process. In the context of discrete diffusion models, BSSVS associates every pairwise rate with a binary indicator but a priori prefers to only invoke a minimal number of rates with an nonzero indicator to explain the tip trait observations. Variable selection and informative prior specification both increase statistical efficiency, which becomes even more important when drawing inference from sparse data under more complex models, for example, assuming two different rates of diffusion for each directionality between a pair of states (Edwards et al. 2011).\n\nSimultaneous inference of sequences and traits implies that both data sources can impact the phylogeny. In most cases, however, this is of little practical importance because the information contained in the multiple sites comprising the sequence alignment can swamp the information present in a single trait character. However, in the presence of very shallow sequence diversity, the tendency of taxa to cluster together by trait state may become more prominent. It is probably not unreasonable to assume that taxa with the same trait character will be more closely related, but the relative strength of such a statement may be subject of debate. It is worth noting that the simultaneous inference capability has been explicitly leveraged to obtain \u201ccombined-data\u201d trees in specific contexts, for example for morphological evolution (Nylander et al. 2004) and protein structure evolution (Scheeff and Bourne 2005).\n\nDespite the overwhelming interest in geographic spread, various traits are now the subject of ancestral reconstruction analyses. To illustrate this, we present a sample of applications of the BEAST discrete trait modeling approach in Table 1, mostly focusing on nonspatial studies. These applications range from the reconstruction of morphological characters in animals and plants to antigenicity in influenza viruses and host species in pathogens and bacteria. In phylodynamics, host traits may be of particular interest as demonstrated by a seminal study on bat rabies viruses in the Americas (Streicker et al. 2010). Bat rabies in the Americas represents an interesting multihost system, in which rabies viruses jump between different bat hosts, occasionally resulting in sustained transmission in the new host species. Over time, this process has produced a phylogenetic structure comprising lineages that are compartmentalized by a dominant bat host (Fig. 2). To study the ancestral host shifts giving rise to this pattern, Streicker et al. (2010) applied Bayesian phylogenetic inference to demonstrate that these events have the tendency to occur between more closely related bat species. We will return to this example when discussing the integration of covariates in sequence and trait evolutionary processes to test the causes and consequences of this host switching process. The study by Streicker et al. (2010) also highlights an alternative approach to discrete trait diffusion because the cross-species transmission (CST) dynamics within each host-associated lineage were quantified using a structured coalescent approach. By factoring in the diversity within each host, this approach allowed them to estimate per capita CST rates and test their association with several potential explanatory variables.\n\nThe structured coalescent also emerged in the context of spatial migration and goes back to the seminal work by Hudson (1990) and Notohara (1990). As an extension of Kingman\u2019s coalescent (Kingman 1982), the structured coalescent model builds on the standard Wright-Fisher model by specifying a number of discrete subpopulations, allowing location to explicitly affect the coalescent rate (Vaughan et al. 2014). Spatial subdivision into a number of distinct \u201cdemes\u201d represents an obvious population structure, but as illustrated by the bat rabies example, any logical categorization of individuals can be considered by this model, including for example the temporal subdivision used in compartmental epidemiological models (discussed later in this review).\n\nProbabilistic ancestral reconstruction and the structured coalescent rely on a very different set of assumptions, and have traditionally been interested in different estimates (ancestral states vs. population migration rates). Computational restrictions may have prevented the widespread adoption of structured coalescent approaches in phylodynamics. Interestingly, this is now being addressed by recent developments in Bayesian inference under the structured coalescent. Vaughan et al. (2014) introduced a new set of MCMC transition kernels in BEAST that achieve significantly faster mixing compared with previous transition kernels (Ewing et al. 2004). Further, De Maio et al. (2015) tackle the impractical computational demands when confronted with large numbers of subpopulations and migration events by introducing a new model-based approach that achieves a close approximation to the structured coalescent, while still integrating over all possible migration histories. Their Bayesian structured coalescent approximation (BASTA) combines the accuracy of methods based on the structured coalescent with computational efficiency, offering less biased estimated compared to discrete trait reconstruction approaches. De Maio et al. (2015) attribute this to specific assumptions associated with modeling migration of lineages as a mutational process.\n\nModeling evolution of continuous characters stems from the field of comparative biology that was challenged with the problem of comparing continuous traits, for example to assess their correlation, across a number of taxa. Standard correlations assume independent data, which is obviously violated for taxa traits due to their shared ancestry. Felsenstein (1985) proposed the \u201cindependent contrasts\u201d approach to deal with such nonindependence. This approach assumes that the changes in two characters follow a Brownian motion process, implying that they are drawn from a bivariate normal distribution with some degree of correlation between the characters along each branch of a phylogeny. In addition, the variance of the distribution of change along each branch is assumed to be proportional to the time elapsed on that branch. This procedure uses a phylogeny to identify a set of mutually independent comparisons between pairs of species, pairs of nodes, or a node and a species (Pagel 1997). Grafen (1989) presents a generalization of the independent contrasts approach that allows for trait adjustment by species-specific covariates. This approach connects general linear modeling to phylogenetic data and has become known as phylogenetic regression in the field of comparative biology.\n\nIn the conventional continuous random-walk model, traits evolve in each instant of time with a mean change of zero and unknown and constant variance. Originally introduced as an approximation of sequence evolution (Edwards and Cavalli-Sforza 1964), phylogenetic Brownian random walks have mostly been applied to phenotypic traits in comparative biology (see e.g., Martins (1994)). Analogous to discrete trait modeling, both maximum likelihood and Bayesian approaches have been proposed to draw inference under such models (Schluter et al. 1997; Pagel 1999a; Lemmon and Lemmon 2008). In phylodynamics, a bivariate Brownian random walk was again initially applied in a phylogeographic setting (Lemey et al. 2010). The Bayesian implementation proposed by this work not only avoids conditioning on the usual data summaries, for example a fixed tree and branch lengths, but also relaxes the constant diffusion rate assumption implied by a constant-variance random walk. Specifically, variation in diffusion rates among branches was modeled by borrowing from uncorrelated relaxed clock models (Drummond et al. 2006a), that is by rescaling the variance of the random walk (or precision in a Bayesian terminology) along each branch using a scalar drawn independently and identically from an underlying distribution. This relaxed random walk (RRW) appeared to be critical to accommodate a very high degree of heterogeneity that can underlie the spatial spread of pathogens, as was the case for the West Nile virus invasion in the United States (Pybus et al. 2012). The same analysis also challenged standard inference under these models, which initially relied on sampling internal node realizations of the bivariate locations but proved to be inefficient in this case. Analogous to efficient likelihood computation for discrete traits (Felsenstein 1981), Pybus et al. (2012) pursued an approach that integrates out internal node states in the Bayesian framework (see also Freckleton (2012)), which makes applications to large datasets more accessible.\n\nAlthough diffusion rate variation can be taken into account, a phylogeographic RRW process still relies on dispersal as a function of geographic distance (or distance in Euclidean space). This may be unrealistic for pathogens that exploit human mobility or trade (e.g., human seasonal influenza (Lemey et al. 2014) and swine influenza respectively (Nelson et al. 2015)) and modeling efforts have demonstrated that pathogen spread follows \u201ceffective distances\u201d measured along complex transportation networks (Brockmann and Helbing 2013). Due to these limitations, future applications of continuous trait modeling phylodynamics may also focus more on other traits, such as pathogen phenotypes and infection traits. A limited sample of applications of the continuous diffusion framework in BEAST (Lemey et al. 2010) (Table 2), mostly focusing on nonspatial traits, indeed highlights the general use of this approach even beyond the field of biology.\n\nFor pathogens, traits related to phenotype or infection severity, for example, will generally be measured through experimental assays. Although this does not hamper the general application of multivariate diffusion models, it can impose additional modeling challenges. One of these challenges is adequately incorporating measurement error (analogous to intraspecific variation for organismal traits), that is conditioning on the data (the repeated measures) rather than data summaries such as their mean and variance. The Bayesian multivariate diffusion approach naturally achieves this by numerically integrating the unobserved average tip trait values based on repeated measures (Vrancken et al. 2014a).\n\nAnother challenge may be that the trait is only indirectly observed through an assay. This is the case for influenza antigenic evolution, which is often assessed through pairwise measurements of cross-reactivity between influenza strains using the hemagglutination inhibition (HI) assay. The influenza virus population continually evolves in antigenic phenotype to escape host immunity in a process known as antigenic drift, which explains the continual need to update vaccine formulations. To capture this process from an incomplete table with noisy HI measurements (HI titres), Smith et al. (2004) proposed the use of multidimensional scaling (MDS) techniques to position viruses in a two-dimensional cartographic map such that the distance in the lower-dimensional space best fits the HI assay titres. More recently, Bedford et al. (2014) adopted a Bayesian formulation of MDS (Oh and Raftery 2001) that models the observed differences (HI titres) to be centered around their cartographic expectation with a Gaussian error (Fig. 3). As a prior on the unknown location parameters, their approach resorts to the phylogenetic Brownian diffusion process, which leads to an explicit connection between antigenic evolution and genetic relatedness. Bedford et al. (2014) apply this approach to HI data from all human influenza lineages, A/H3N2, A/H1N1, B/Victoria and B/Yamagata, and show that A/H3N2 evolves faster and in a more punctuated fashion than other influenza lineages. More recently, these differences in antigenic evolution, coupled to the nature of human behavior in seasonal influenza epidemiology, were shown to drive differences in migration rate and hence also epidemic success (Bedford et al. 2015).\n\nAlthough the concept of phylogenetic Brownian diffusion was adopted by the comparative approach to specifically accommodate phylogenetic dependence among traits, the question may arise as to how much dependence really needs to be taken into account. In other words, to what extent does the phylogeny explain similarity among taxa traits? In pathogen phylodynamics, this question may apply to virulence or infection traits, which can also be heavily impacted by the host environment. Specifically, for chronic infections such as HIV-1 and HCV, the comparative framework is being deployed to determine to what extent the viral genotype can control for the rate of progression or infection outcome, sometimes leading to mixed conclusions (Alizon et al. 2010; Vrancken et al. 2014a; Hartfield et al. 2014; Hodcroft et al. 2014). Among the different approaches available to test or quantify this \u201cphylogenetic signal,\u201d Pagel\u2019s \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\lambda$\\end{document} (Pagel 1999a) is commonly used. Conceptually, this parameter scales internal node heights of a tree, on which Brownian evolution of traits are being modeled, in such a way that any trait correlation scenario can be accommodated from the estimated phylogeny down to a star-like tree (completely independent taxa traits). The BEAST framework we highlight here incorporates Pagel\u2019s \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\lambda$\\end{document} estimator and therefore supports simultaneous estimation of evolutionary history and trait phylogenetic signal (Vrancken et al. 2014a).\n\nIn the framework of emerging infectious diseases, a similar question relates to host shifts and what determines the sensitivity to viral infection in the new host. Longdon et al. (2011) examined this in great detail for three host-specific sigma viruses in\nDrosophila and measured viral titres upon experimentally infecting 51 Drosophila\nspecies with each of these viruses. Using a phylogenetic mixed model (PMM), the authors found that the host phylogeny could explain most of the variation in viral replication and persistence between different host species. A PMM finds its analog in mixed modeling in quantitative genetics, where phenotypes of individuals related by a pedigree are partitioned into additive genetic (heritable) and residual (nonheritable) components (Henderson 1984; Lynch and Walsh 1998; Housworth et al. 2004). The implementations essentially differ in their specification of the correlation structure of the heritable components: a relationship matrix for pedigrees versus a matrix of shared common ancestry in a phylogeny. It is interesting to note that estimates of phylogenetic signal through Pagel\u2019s \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\lambda$\\end{document} find a similar degree of phylogenetic association of sensitivity to sigma virus infection compared to a standard phenotypic trait as wing size in Drosophila (Vrancken et al. 2014a). In addition to the sensitivity to infection following host shifts, it may also be important to predict how much harm the pathogen will cause in the new hosts. Virulence may be considered as a direct consequence of pathogen replication, but also the host may be an important determinant. To examine how virulence may vary across new host species, Longdon et al. (2015) carried out a large cross-infection experiment of Drosophila C virus in 48 species of Drosophilidae. In this case as well, PMM analyses showed that changes in virulence, which can be extremely large, were highly predictable from the host phylogeny (Longdon et al. 2015).\n\nAlthough many phylodynamic hypotheses can be addressed through the analysis of genetic data, trait data, or their combination, additional data in the form of covariates may be required to further dissect the dynamic forces that determine the diversity of epidemiological and phylogenetic patterns. Integrating such data in phylodynamic approaches can serve two purposes: better informing reconstructions and identifying which covariates explain the evolutionary or epidemiological process. In this section, we discuss a number of examples to highlight recent methodological advances to achieve these goals for sequence evolution and trait evolution (tree diffusion processes).\n\nThe rate of evolution in different viral populations may be affected by their host environment, either through varying selective dynamics or through an impact on the replication rate. Although independent rate estimates could in theory be used to investigate this, a sparse heterochronous sequence sample from each population generally leads to uncertain evolutionary estimates which complicates formal statistical testing. In the context of HIV-1 evolution in different patient groups, Edo-Matas et al. (2011) proposed the use of a Bayesian hierarchical phylogenetic model (HPM) to pool information across patients and improve estimate precision for patient-specific viral populations, while still allowing for evolutionary rate differences between the individual populations. Hierarchical modeling was first introduced in phylogenetics to share information across alignment partitions (Suchard et al. 2003). By applying independent parameters that share a hierarchical prior distribution with unknown estimable hyperparameters, HPMs hold a middle ground between independent and shared parameter estimation (Fig. 4).\n\nFollowing the terminology of ANOVA and regression models, the specification of hierarchical priors can model random effects on the evolutionary response variable. In order to test the impact of patient groups defined by disease progression and host genetic status, Edo-Matas et al. (2011) further extend the HPM approach by incorporating fixed effects for \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N$\\end{document} covariates, arriving at the following general form:\n(1)log\u03b8i=\u03b20+\u03b41\u03b21xi,1+\u2026+\u03b4N\u03b2Nxi,N+\u03f5i,\nwhere \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\theta_{i}$\\end{document} is the evolutionary response variables in patient \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$i$\\end{document}, \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\beta}_{0}$\\end{document} is an unknown grand mean, \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\beta}$\\end{document} is the estimated effect size of covariate \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$x$\\end{document}, \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\delta}$\\end{document} is a binary indicator that tracks the posterior probability of the inclusion of covariate \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$x$\\end{document} in the model and \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\epsilon_{i}$\\end{document} are independent and normally distributed random variables with mean 0 and an estimable variance. The specification of indicator variables (\\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\delta}$\\end{document}) implements a variable selection procedure analogous to the approach aimed at reducing the number of rate parameters in discrete diffusion matrices; although it was considered to be an approach for increasing statistical efficiency in the latter context, it is used here as a model averaging approach that effectively integrates over all possible combinations of covariate inclusion. For this and all other applications of variable selection we highlight, we note that covariate or fixed effect support values can be readily computed in the form of Bayes factors based on the posterior and prior odds for their inclusion. By applying this approach to within-host HIV-1 data sampled from different patient groups, Edo-Matas et al. (2011) not only demonstrate significant shrinkage of the estimator variance, but they also provide support for faster viral evolutionary rates in patients that progressed to AIDS more rapidly.\n\nA similar need for shrinkage and hypothesis testing emerged in a study on the evolutionary consequences of host switching in bat rabies viruses in the Americas (Fig. 2) (Streicker et al. 2012). Although considerable variation in rabies evolutionary rates was noticeable among lineages associated with different hosts on this longer evolutionary time scale (Streicker et al. 2012), accurate quantification remained difficult due to limited sequence samples and their variation across different host species. The authors therefore constructed an HPM over the evolutionary rate parameters at the third codon position \u2014 as a proxy for synonymous evolution \u2014 in 21 independent bat rabies virus lineages. The fixed effects in their full model included physiological (basal and torpid metabolic rate), environmental (climatic region: temperate vs. tropics/subtropics) and ecological traits (coloniality and seasonal activity). Also in this case, HPM estimates proved to be less sensitive to stochastic noise associated with sampling error, and the authors were able to show an accelerated rate of molecular evolution in subtropical and tropical bats compared with temperate species. The association between geography and the tempo of evolution was explained by climate-associated differences in seasonality in bat activity and virus transmission.\n\nThe examples above consider categorical or continuous covariates for independent intrahost or interhost viral populations, but covariates may also represent categorical branch assignments in a phylogeny (conditionally independent evolutionary lineages). Vrancken et al. (2014b) took this into account in an examination of HIV-1 evolutionary rate differences within and between hosts in a known transmission chain. In this case, fixed effects were modeled as branch assignments that distinguish the transmitted lineage from other branches within specific hosts constituting the transmission chain. Random effects \u2014 in terms of possibly different rates for each branch \u2014 were modelled according to an uncorrelated relaxed clock process (following Drummond et al. (2006a)). This mixed effects modeling approach demonstrated a significantly slower rate for the transmitted lineage, which confirms earlier observations of evolutionary rate differences within and between hosts (Alizon and Fraser 2013) and provides support for the \u201cstore-and-retrieve\u201d hypothesis in HIV transmission (Lythgoe and Fraser 2012; Fraser et al. 2014).\n\nBy extending the covariate modeling approach for a particular evolutionary parameter to a matrix of transition rate parameters defining a CTMC process, Lemey et al. (2014) developed an approach to simultaneously reconstruct spatiotemporal history and identify which combination of covariates associates with the pattern of spatial spread. This extension of the discrete phylogeographic diffusion approach (Lemey et al. 2009a) shares the generalized linear model (GLM) formulation for fixed effects introduced above, in this case by parameterizing each rate of among-location movement in the phylogeographic model \u2014 typically denoted as the \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$ij$\\end{document}-th elements (\\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\Lambda_{ij}$\\end{document}) of the transition rate matrix \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\Lambda$\\end{document} \u2014 as a log linear function of various potential covariates as following:\n(2)log\u2061\u039bij=\u03b21\u03b41xi,j,1+\u03b22\u03b42xi,j,2+\u2026+\u03b2N\u03b4Nxi,j,N,\nwhere \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\beta}$\\end{document} and \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\delta}$\\end{document} represent the same parameters as before. In this case, a single covariate, also referred to as predictors in Lemey et al. (2014), is a flattened vector of quantities corresponding to entries in the \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$i$\\end{document} to \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$j$\\end{document} rate matrix \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$\\mathbf{x}_{n} = (x_{1,2,n}, \\ldots x_{K-1,K,n})^{'}$\\end{document}. In a phylogeographic setting, these predictors may, for example, represent a matrix of pairwise geographic distances or population sizes either at the origin or destination location (Fig. 5). As pointed out above, priors and posteriors for the inclusion probabilities (\\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}${\\delta}$\\end{document}) can be used to express the support for each predictor in terms of BFs. Unlike the HPM or mixed effects modeling, the GLM parameterization does not consider random effects for the rates because of the difficulty to inform this large number of effects based on a single trait observation at the tree tips (but see (Trov\u00e3o et al. 2015) for identifying exceptional random effects). The application of this approach to the seasonal dynamics of influenza H3N2 provided consistent support for air travel governing the global migration of the virus. We note that the GLM diffusion approach achieves both goals outlined in the introduction of covariates of evolutionary and epidemiological processes: it identifies the relevant covariates in the epidemiological process, but at the same time it helps to inform the ancestral reconstructions. For the influenza example, this may lead to more accurate reconstructions of the seasonal source-sink patterns, and in predictive modeling, the combination of genetic and air transportation data also outperformed both data sources in isolation (Lemey et al. 2014).\n\nTo demonstrate its generality, Faria et al. (2013) applied the GLM diffusion approach to host switching (jumps followed by successful transmission in the new host) and cross-species transmission (CST, spill-over in a viral clade associated with a dominant host) in bat rabies viruses (Fig. 2). These dynamics were separately investigated by Streicker et al. (2010) through standard ancestral reconstruction and structured coalescent analyses respectively, the latter resulting in rate estimates that were used to test several potential covariates as potential determinants of the CST dynamics. To simultaneously infer and test both host switching and CST in a single framework, Faria et al. (2013) made use of the flexibility of phylogenetic CTMC modeling to accommodate distinct host transition processes, parameterized by independent GLM diffusion models, on external and internal branches. To a large extent, this approach discriminates between recent CSTs, of which many are likely to result in dead-end infections, and the ancestral host shifts. The same predictors as used by Streicker et al. (2010) were considered for both branch-specific GLM diffusion parameterizations: host genetic distance, geographical range overlap and similarities in roost structures, wing aspect ratio, wing loading, and body size. The latter three morphological measurements represent approximations of foraging niche overlap in bats (Streicker et al. 2010). The full Bayesian analysis revealed that host similarity was strongly predictive of host jumping intensity, both for host switching and CST, whereas a modest support for geographical range overlap was only recorded for CST.\n\nAlthough the primary purpose is likely to remain the identification of relevant covariates to integrate in tree diffusion processes, we note that the GLM diffusion model may offer the only practical solution to discrete ancestral reconstruction for traits with high-state spaces because it reduces the number of parameters to a linear function of the number of predictors rather than a quadratic function of the number of states. High-state spaces still challenge likelihood calculations, but massively parallel computations offer considerable speed-up in such cases, and practical solutions are now in place both in terms of hardware (e.g., GPU cards) and software to support phylogenetic likelihood computations on such hardware (e.g., BEAGLE) (Suchard and Rambaut 2009; Ayres et al. 2012; Baele and Lemey 2013).\n\nIn this section, we discuss how data integration is being considered to help uncover tree-generative processes in phylodynamics. We make a distinction between the reconstruction of large-scale epidemic dynamics based on a limited sample from the pathogen population and the reconstruction of transmission trees from densely sampled pathogen genetic sequences to recover the chain of transmission in extensive detail. Much of this work attempts to relate the transmission dynamics inferred from genetic data to mathematical epidemiology, or even explicitly builds a bridge between pathogen genetics and how transmission dynamics are formalized in compartmental models. As opposed to coalescent models describing the merging of lineages backward in time starting from a small sample of the population until a common ancestor has been reached, compartmental models like the susceptible-infected-removed (SIR) model describe the dynamics of an entire population going forward in time. Modeling infectious disease dynamics with compartmental models allows the description of nonlinear time series of prevalence of infection and the number of susceptible hosts, and leads to important predictions about pathogen spread, for example the prevalence and duration of the epidemic. They also offer a framework to assess the potential impact of intervention strategies on the outcome of an epidemic.\n\nUsing time-varying coalescent models, phylogenies can be used to estimate how effective population sizes (\\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document}) change through time. This \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document} represents the size of an idealized population that loses or gains genetic diversity at the same rate as the census population from which the sample has been drawn. Although frequently applied as the only source of information about past population dynamics, the dynamics of \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document} have sometimes been contrasted against other data. For example, Biek et al. (2007) demonstrated that the expansion of rabies in the North American raccoon population shows similar dynamics to an epidemiological index that reflects the size of the area newly affected by rabies during each month of the outbreak.\n\n\nBennett et al. (2010) also report a correspondence between fluctuations in \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document} and case counts for dengue serotype 4 between 1981 and 1998 in Puerto Rico. However, when formally assessing this relationship, they identify an offset of about seven months in the cyclical dynamics. Using a similar post-hoc procedure, Faria et al. (2012) also find a lag of about five years between prevalence counts and the growth in \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document} over time for HIV-1 CRF02_AG in Cameroon. Although these studies illustrate opportunities for integrating time series covariates, they also point at complications in interpreting \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document} estimates as \u201ceffective number of infections.\u201d Frost and Volz (2010) specifically address this issue and note that the rate of coalescence is primarily driven by new transmission \u2014 that is the incidence \u2014 and only indirectly by the number of infected individuals through sampling effects (Frost and Volz 2010).\n\nBy avoiding the concept of \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$N_{e}$\\end{document}, birth\u2013death modeling represents an interesting alternative that is gaining popularity as a tree-generative process. Originally introduced in phylodynamics by Stadler et al. (2012), the stochastic linear birth\u2013death process is parametrized by a rate at which infected individuals transmit and the rate at which they turn noninfectious (either by death or recovery). For a completely susceptible population, the ratio of these rates should in principle quantify the well-known \\documentclass[12pt]{minimal}\n\\usepackage{amsmath}\n\\usepackage{wasysym} \n\\usepackage{amsfonts} \n\\usepackage{amssymb} \n\\usepackage{amsbsy}\n\\usepackage{upgreek}\n\\usepackage{mathrsfs}\n\\setlength{\\oddsidemargin}{-69pt}\n\\begin{document}\n}{}$R_{0}$\\end{document} parameter from mathematical epidemiology. Unlike the coalescent, birth\u2013death models do not need to assume a small sample size from a large population because the sampling proportion is treated as a separate parameter in these models. Following the evolution in coalescent modeling, the standard birth\u2013death model has also been extended to a nonparametric version that flexibly models varying infection rates (Stadler et al. 2013). Despite the flexible parameterizations of coalescent and birth\u2013death modeling approaches, they have yet to be extended to allow the incorporation of covariates.\n\nArguably the most concrete step toward integrating covariates with tree-generative processes has been made by Rasmussen et al. (2011). The authors fitted a stochastic, nonlinear model of disease transmission to a combination of epidemiological data and phylogenetic coalescence events. This approach follows the SIR coalescent modeling by Volz et al. (2009) and resorts to particle MCMC to fit state-space models to genealogies in order to avoid the need for an analytical likelihood function. Simulations suggest that genealogical information alongside of time series data may improve the estimates if the time series data suffers from observation error or from variation in reporting practices. The ability to combine coalescent information with covariates, or contrast it against them, also offers the opportunity to investigate which ecological factors need to be considered by the coalescent model to appropriately capture pathogen population dynamics. In a study of dengue serotype I in southern Vietnam, Rasmussen et al. (2014) demonstrate that nonparameteric coalescent modeling does not reproduce the highly seasonal incidence patterns observed in hospitalization data. In this case, incorporating spatial structure was critical to recapitulate seasonal fluctuations consistent with the hospitalization data. This illustrates that the panmictic population assumption in coalescent modeling can be problematic, and that inferring temporal epidemic dynamics cannot always be divorced from population structure, which we discussed in the context of trait or structured coalescent inference. Intriguingly, the authors also show the importance of accounting for vector population, suggesting a general need to consider ecological complexities in pathogen epidemiology.\n\nIn the first section of this review, we focused on the integration of time and location with genetic data in a general phylogenetic framework, but these sources of information are sometimes also combined in different ways when the aim is to reconstruct transmission trees. Recreating individual routes of transmission in infectious disease outbreaks is a challenging problem, but one of longstanding interest in infectious disease epidemiology that essentially goes back to the famous work by John Snow who traced the source of a cholera outbreak in London in 1854 (Snow 1855). A clear break with the inference of large-scale transmission dynamics is the requirement of a dense \u2014 if not complete \u2014 sampling from the pathogen population, at least for the initial developments in this direction.\n\nPerson-to-person transmission is frequently represented as a spanning tree, and various methods have therefore been proposed to find the spanning tree between sampled sequences that is most compatible with the genetic data, for example by minimizing a set of edge weights (see e.g., Jombart et al. (2011)). Cottam et al. (2008) introduce epidemiological data by first retrieving the set of transmission trees that are consistent with the available genetic data, and then evaluating these trees using data on their relative timings to identify the most plausible transmission history. A more formal integration of epidemiological and genetic data can be found in the work of Ypma et al. (2012), who apply their Bayesian procedure to temporal, geographical, and genetic data on poultry farms infected in an epidemic of avian influenza A (H7N7) in The Netherlands in 2003. Although genetic and epidemiological data arise from the same process, this approach assumes they are independent. To address this limitation, Morelli et al. (2012) develop an MCMC approach that integrates epidemiological data and pathogen sequences from infected hosts to estimate transmission trees and infection dates in a more coherent way.\n\nGenerally, disease dynamics are only partially observed, but methods based on transmission trees are not designed to handle large numbers of missing infections, and therefore require a dense sample of infected hosts from the outbreak. To remedy this, Mollentze et al. (2014) propose a generalization of the algorithm of Morelli et al. (2012) to allow its application to any directly transmitted disease and enable reconstruction of partially observed transmission trees as well as to estimate the number of cases missing from the sample. The extension specifically allows accommodation of a wide variety of spatial transmission patterns and allows multiple unobserved cases to arise anywhere in both space and time within the set of inferred transmissions. An application to endemic rabies virus in a province of South Africa shows that the method offers a better insight into the spatial epidemiological patterns (Mollentze et al. 2014). In related work, Jombart et al. (2014) propose a Bayesian framework that does not require all cases to be observed or assume a single introduction event at the origin of an outbreak. Their framework allows for the estimation of dates of infections, mutation rates, separate introductions of the pathogen, the presence of unobserved cases and the transmission tree, as well as the effective reproduction number over time, thereby overcoming the limitations of their previous method (Jombart et al. 2011) and of the methods of Ypma et al. (2012) and Morelli et al. (2012). The authors apply their method to the 2003 Severe Acute Respiratory Syndrome (SARS) outbreak in Singapore, providing new insights into the early stage of the epidemic.\n\nIn this review, we highlighted several aspects of data integration in phylodynamics with a particular focus on the connection between sequences and traits. As mentioned in the respective sections, the initial applications of relatively simple but computationally efficient Bayesian implementations of random walk models in the field of pathogen evolution and epidemiology focused on reconstructions of spatial spread. There are, however, important caveats that need to be considered for phylogeographic applications, in particular related to sampling. First, spatial coverage may be restricted to particular geographic areas which limits comprehensive understanding of the spatial spread dynamics. For example, although large genetic datasets have become available to study the global seasonal dynamics of all human influenza lineages, the sampling remains limited for Africa, Central America, the Middle East, and Russia (Bedford et al. 2015). This complicates assessment of their specific role in the influenza source-sink dynamics. In the discrete ancestral reconstruction approach, heterogeneity in sampling among the locations that can be represented in the analysis may also bias the results. Overrepresentation of location states is likely to be associated with high rates out of, or into, these specific states, and these transition rates will influence ancestral state probabilities in the phylogenies. Although subsampling may be used to investigate the sensitivity to sampling effects, it remains difficult if not impossible to remove sampling bias in these approaches. The structured coalescent methods we discuss as alternative approaches are less sensitive to sampling bias because they take the diversity in each location or \u201cdeme\u201d into consideration, and may therefore have a more promising future in phylogeographic studies. In the continuous diffusion approach, the parameterization does not have such a direct connection with the sampling, but other restrictions are important to consider in this framework. Despite the ability to relax the assumption of a constant diffusion rate, the process still assumes a relationship between dispersal and geographic distance, which may provide a poor fit to pathogens that disperse through modern human mobility. In addition, standard Brownian diffusion considers distances in Euclidean space and therefore ignores the spherical nature of the globe (but see Bouckaert (2015)). Alternatively, Barton et al. (2013) discuss the extension of the coalescent to spatially structured populations, where populations are not disjointly subdivided, but instead are distributed across a spatial continuum. The authors point out that in such a setting, the system of stochastic ordinary differential equations known as Kimura\u2019s stepping stone model (Kimura 1953) has no solution in two spatial dimensions, as the system of coalescing random walks which describes the genealogy converges to a system of Brownian motions that will never meet.\n\nAlthough the examples we discussed generally involve a single trait, there are no particular limitations on the number of traits that can be incorporated in a single analysis. Trov\u00e3o et al. (2015) leverage this capacity to examine the contributions of different hosts to the spatial spread of avian influenza H5N1. Specifically, they jointly infer discrete host switching among members of different avian families/superorders and dispersal in continuous space underlying the H5N1 expansion across Eurasia. Although this study models the host and spatial dynamics as independent processes, it leads to host-specific summaries of spatial spread and testable differences among them. In addition to combining multiple traits, the possibility to incorporate covariates in discrete diffusion processes also prompts exploration of more detailed ecological information in pathogen evolution and epidemiology. In a spatial context, cheap and mobile global positioning systems are now widely adopted in the recording of infectious disease spread, but also the variables that are associated with geo-located disease data (e.g., environmental, infrastructural, and socio-economic) are increasingly being characterized in great detail and distributed as publicly available datasets (see e.g., http://www.worldpop.org.uk). In addition, particular forms of animal trade or human mobility are extensively documented, or they can be modeled based on proxies such as the movement of marked banknotes (Brockmann et al. 2006), and anonymized mobile phone call records (Gonz\u00e1lez et al. 2008).\n\nThe example of trait combinations (Trov\u00e3o et al. 2015) also raises the question of how correlations can be measured formally between different data types. This is a particularly pertinent question for phenotypic traits in evolutionary biology, which explains correlations as the result of genetic constraints or selective effects. The multivariate diffusion approach naturally models and estimates correlation among continuous traits, but for different data types (e.g., binary and multinomial ordered, or unordered data) additional modeling is required. Building on the phylogenetic threshold model (Felsenstein 2005), Cybis et al. (2015) demonstrate how to efficiently infer the evolution of all types of traits, and the correlations among them, through latent liability modeling in the BEAST framework. One of their applications to pathogens targeted the phenotypic correlation among the amino acid sites of the antigenic epitopes of the influenza hemagglutin surface protein, which plays an important role in antigenic drift dynamics. They find strong correlations among 11 sites in epitope A and B, including all sites that have been experimentally shown to be responsible for evolving antigenic novelty (Koel et al. 2013). Such methodologies open up new research opportunities at the interface of genotype and phenotype in pathogen evolution, and in conjunction with antigenic (Bedford et al. 2014) and integrated genetic and human mobility modeling (Lemey et al. 2014) in the same Bayesian framework, this may lead to holistic approaches in influenza phylodynamics for example. The latent liability or threshold model finds its nonphylogenetic roots in a model that goes back to Sewall Wright (Wright 1934), and has been used regularly in the pedigree analysis of discrete traits (Gianola 1982). So, in addition to the PMM we discussed in the context of trait heritability, this highlights another explicit link between phylogenetics and quantitive genetics.\n\nFurther in the phenotypic context, other assumptions than the constant variance also require attention when modeling trait evolution via Brownian motion along a phylogeny. Assuming a zero-mean displacement, for example, postulates that a single phenotypic value randomly increases or decreases each generation, which can only be expected for phenotypes undergoing random genetic drift or fluctuating directional selection. Under other forms of natural selection however, traits may evolve toward some optimal value. To model such consistent selection toward a single optimum trait value, the Ornstein-Uhlenbeck (OU) model has been proposed as a mean-reverting extension of Brownian motion (Hansen 1997). Although this has proven useful to identify stabilizing selection regimes, a central tendency model does not offer a general solution to appropriately fit the complexity in trait evolution. Further advances in Bayesian trait evolutionary modeling may provide the flexibility to model displacements in traits along tree branches as a generalized stochastic process that allows the data to inform the degree of complexity required in the process.\n\nData integration in phylodynamic modeling is also transforming the inference of transmission dynamics. Although this is still somewhat in its infancy in the analyses of large-scale transmission dynamics based on coalescent or birth\u2013death models, the possibility of using genetic data and time series data in tandem has been clearly demonstrated (Rasmussen et al. 2011), as well as the need to incorporate environmental stochasticity to accurately capture disease dynamics in some cases (Rasmussen et al. 2014). These developments are generally divorced from the sequence evolutionary process and still await their implementation in the commonly used Bayesian statistical software packages like BEAST (Drummond et al. 2012). Although BEAST implements a wide range of tree-generative processes, including time-variable coalescent and birth\u2013death models, these have not yet been connected to covariate or time series data. Related to this, however, ongoing work in coalescent modeling acknowledges that sampling times may probabilistically depend on effective population size (Karcher et al. 2015), and preferential sampling is now being taken into account by modeling the sampling times as an inhomogeneous Poisson process dependent on effective population size.\n\nDevelopments in transmission tree reconstruction have already been pursuing data integration for a longer time, and they are evolving toward methods that consider the likelihood of observing sequence and epidemiological data for a given transmission tree, and increasingly try to accommodate missing data. Many of these developments are however scattered in the field, and at least for the sequence evolutionary modeling, they could also benefit from an implementation in an integrated statistical framework. In addition, more complex relationships between phylogenies and transmission trees need to be taken into account (akin to gene/species tree modeling, Vrancken et al. (2014b)), in particular when within-host evolution plays an important role. Different aspects of within and between host evolution are not always easily reconciled, and this has been identified as one of the challenges in phylodynamic inference (Frost et al. 2015).\n\nAccounting for nonvertical evolution represents another major challenge as all the methods we have discussed rely on a strictly bifurcating evolutionary process. Nonvertical evolution can be a prominent evolutionary force in many pathogen populations, for example in the form of recombination and reassortment in viruses and horizontal gene transfer in bacteria. Recombination analyses in viruses, for example based on the identification of tree incongruence, generally aim at avoiding the impact of recombination in downstream phylogenetic inferences (Martin et al. 2011). However, an alternative approach may be to explicitly accommodate nonvertical evolution through an ancestral recombination graph, which simultaneously describes vertical and nonvertical evolutionary events (Hudson 1983). Although the graph is a well-known model in coalescent inference, it has only been recently introduced as an explicit structure for analyzing phylogenetic data in BEAST (Bloomquist and Suchard 2010), and further modeling and computational development is required to promote its widespread use."}