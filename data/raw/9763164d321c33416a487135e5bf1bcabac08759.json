{"title": "Network-based analysis of stochastic SIR epidemic models with random and proportionate mixing", "body": "In an important paper, M. E. J. Newman studied a network-based Susceptible-Infectious-Removed (SIR) epidemic model in which infection is transmitted through a network of contacts between individuals [1] . The contact network itself was a random undirected network with an arbitrary degree distribution of the form studied by Newman, Strogatz, and Watts [2] . Given the degree distribution, these networks are maximally random. Thus, they have no small loops in the limit of a large population [2] [3] [4] .\n\nIn the SIR model from [1] , the probability that an infected node i makes infectious contact with an adjacent node j is given by T ij = 1 \u2212 exp(\u2212r i \u03b2 ij ), where \u03b2 ij is the rate of infectious contact from i to j and r i is the time that i remains infectious. (In this paper, we use infectious contact to mean a contact that results in infection if and only if the recipient is susceptible.) The recovery period r i is a random variable with the cumulative distribution function (cdf) F (r) and the infectious contact rate \u03b2 ij has the cdf F (\u03b2). The infectious periods for all individuals are independent and identically distributed (iid) and the infectious contact rates for all ordered pairs of individuals are iid.\n\nThis model can be analyzed by mapping the SIR model onto a semi-directed network that we call the epidemic percolation network [5] . Since the distribution of recovery periods for all nodes and the joint distribution of contact rates for all pairs of connected nodes are defined a priori, all relevant transmission probabilities can be determined by assigning the infectious periods and contact rate pairs before an epidemic begins. Starting from the contact network, a single realization of the epidemic percolation network can be generated as follows:\n\n1. Choose a recovery period r i for every node i and choose a contact rate \u03b2 ij for every ordered pair of connected nodes i and j in the contact network.\n\nFor each pair of connected nodes i and j in the contact network, convert the undirected edge between them to a directed edge from i to j with probability The epidemic percolation network is a semi-directed network that represents a single realization of the infectious contact process for each connected pair of nodes, so 4 m possible epidemic percolation networks exist for a contact network with m edges. The probability of each network is determined by the underlying SIR model. The epidemic percolation network is very similar to the locally dependent random graph defined by Kuulasmaa [6] for an epidemic on a d-dimensional lattice, with two important differences: First, the underlying structure of the contact network is not assumed to be a lattice. Second, we replace pairs of (occupied) directed edges between two nodes with a single undirected edge. The idea of the epidemic percolation network is also similar to the idea of forward and backward branching processes, which have been used to derive the probability and final size of an epidemic, respectively, in SIR models with independent infectiousness and susceptibility [7] . The epidemic percolation network can be thought of as a simultaneous mapping of the forward and backward branching processes that generalizes to models with arbitrary joint distributions of infectiousness and susceptibility. (The relationship between epidemic percolation networks and branching processes is discussed further in Section 5.1.)\n\nIn the Appendix, we define epidemic percolation networks for a very general timehomogeneous stochastic SIR epidemic model (which includes network-based models and models with random and proportionate mixing as special cases) and prove that the size distribution of outbreaks starting from node i is identical to the distribution of its out-component sizes in the corresponding probability space of percolation networks. Because of this equality of distribution, epidemic percolation networks can be used to analyze a much more general class of epidemic models than that defined in the Introduction. In this paper, we show how they can be used to analyze stochastic SIR epidemic models with random or proportionate mixing.\n\nIn this subsection, we review the structure of directed and semi-directed networks as discussed in [3, 4, 8, 9] . Reviews of the structure and analysis of undirected and purely directed networks can be found in [10] [11] [12] [13] .\n\nThe indegree and outdegree of node i are the number of incoming and outgoing directed edges incident to i. Since each directed edge is an outgoing edge for one node and an incoming edge for another node, the mean indegree and outdegree of a semi-directed network are equal. The undirected degree of node i is the number of undirected edges incident to i.\n\nA component is a maximal group of connected nodes. The size of a component is the number of nodes it contains and its relative size is its size divided by the total size of the network. There are four types of components in a semi-directed network.\n\nThe out-component of node i includes i and all nodes that can be reached from i by following a series of edges in the proper direction (undirected edges are bidirectional). The incomponent of node i includes i and all nodes from which i can be reached by following a series of edges in the proper direction. By definition, node i is in the in-component of node j if and only if j is in the out-component of i. Therefore, the mean size of in-and out-components in any semi-directed network must be equal.\n\nThe strongly-connected component of a node i is the intersection of its in-and out-components; it is the set of all nodes that can be reached from node i and from which node i can be reached. All nodes in a strongly-connected component have the same in-component and the same outcomponent. The weakly-connected component of node i is the set of nodes that are connected to i when the direction of the edges is ignored.\n\nFor giant components, we use the definitions given in [9, 14] . Giant components are so called because they have asymptotically positive relative size in the limit of a large population. All other components are \"small\" in the sense that they have asymptotically zero relative size. There are two phase transitions in a semi-directed network: One where a unique giant weaklyconnected component (GWCC) emerges and another where unique giant in-, out-, and stronglyconnected components (GIN, GOUT, and GSCC) emerge. The GWCC contains the other three giant components. The GSCC is the intersection of the GIN and the GOUT, which are the common in-and out-components of nodes in the GSCC. Tendrils are components in the GWCC that are outside the GIN and the GOUT. Tubes are directed paths from the GIN to the GOUT that do not intersect the GSCC. All tendrils and tubes are small components. A schematic representation of these components is shown in Figure 1 .\n\nAn outbreak begins when one or more nodes are infected from outside the population. These are called imported infections. The final size of an outbreak is the number of nodes that are infected before the end of transmission, and its relative final size is its final size divided by the total size of the network. The nodes infected in the outbreak can be identified with the nodes in the out-components of the imported infections. This identification is made mathematically precise in the Appendix.\n\nWe define a self-limited outbreak to be an outbreak whose relative final size approaches zero in the limit of a large population. An epidemic is an outbreak whose relative final size is positive in the limit of a large population. For many SIR epidemic models (including the one in the Introduction), there is an epidemic threshold: The probability of an epidemic is zero below the epidemic threshold and the probability and relative final size of an epidemic are positive above the epidemic threshold [1, 7, 15, 16] .\n\nIf all out-components in the epidemic percolation network are small, then only self-limited outbreaks are possible. If the epidemic percolation network contains a GSCC, then any infection in the GIN will lead to the infection of the entire GOUT. Therefore, the epidemic threshold corresponds to the emergence of the GSCC in the epidemic percolation network. For any set of imported infections, the probability of an epidemic is equal to the probability that at least one imported infection occurs in the GIN. For any finite set of imported infections, the relative final size of an epidemic is asymptotically equal to the proportion of the network contained in the GOUT. Although some nodes outside the GOUT may be infected (e.g. tendrils and tubes), they will constitute a finite number of small components whose total relative size is asymptotically zero.\n\nThis argument can be extended to epidemic percolation networks for heterogeneous populations. The size distribution of outbreaks starting from an initial infection in any given node i is equal to the distribution of the out-component sizes of node i in the probability space of epidemic percolation networks. In the limit of a large population, the probability that the infection of node i causes an epidemic is equal to the probability that i is in the GIN and the probability that i is infected in an epidemic is equal to the probability that i is in the GOUT. Note that the size distribution of outbreaks and the probability of an epidemic can depend on the initial infection(s), but the relative final size of an epidemic does not.\n\nIn this paper, we show how epidemic percolation networks can be used to analyze stochastic SIR epidemic models with random or proportionate mixing. Methods exist to calculate the final size distribution of epidemics for such models in a population of size n, but they require solving a recursive system of n equations [15, 17] . We will show how the size distribution of outbreaks, the epidemic threshold, and the probability and relative final size of a large epidemic can be calculated in the limit of large n by solving a much simpler set of equations. These methods also generalize more easily to heterogeneous populations. We will show that these methods are equivalent to branching processes when the indegree and outdegree of the epidemic percolation network are independent, and we will use them to re-derive classical results from several areas of theoretical infectious disease epidemiology.\n\nThe rest of the paper is organized as follows: In Section 2, we find the degree distributions of the epidemic percolation networks corresponding to SIR models with random and proportionate mixing. In Section 3, we review the use of probability generating functions to analyze semi-directed networks and show how these simplify in the case of purely directed networks. In Section 4, we present a series of simulations to show that epidemic percolation networks accurately predict the mean outbreak size and the probability and final size of an epidemic for SIR models with random and proportionate mixing. In Section 5, we show that epidemic percolation networks with independent indegree and outdegree are equivalent to (forward and backward) branching processes and re-derive classical results from the epidemiology of sexually transmitted diseases, vector-borne diseases, and controlled diseases.\n\nIn the Appendix, we show that an epidemic percolation network can be defined for any timehomogeneous stochastic SIR epidemic model in a closed population and prove that the distribution of outbreaks starting from a node i is equal to the distribution of its out-component sizes in the corresponding probability space of epidemic percolation networks. We conclude that the theory of percolation on semi-directed networks provides a very general framework for the analysis of stochastic SIR epidemic models in closed populations.\n\nIn this section, we derive probability generating functions for the degree distributions of epidemic percolation networks corresponding to SIR models with random mixing and proportionate mixing. The most important difference between epidemic models with random mixing and network-based models is that the infectious contact rate between any pair of nodes is inversely proportional to the population size. [7, 15, 18] . We deal first with random mixing and introduce proportionate mixing as a generalization. To introduce random mixing, we modify the epidemic model from the Introduction in three ways:\n\n1. The contact network is always a complete graph, so infection can be transmitted between any two individuals.\n\nWe relax that assumption (from [1, 5] ) that \u03b2 ij and \u03b2 ji are iid. Instead, we let \u03b2 ij and \u03b2 ji have a joint distribution F(\u03b2 ij , \u03b2 ji ) that is symmetric in its arguments (i.e. F(\u03b2 1 , \u03b2 2 ) = F(\u03b2 2 , \u03b2 1 ) for all \u03b2 1 , \u03b2 2 ). This symmetry forces the joint distribution of contact rates between any two individuals to be independent of the indices assigned to them.\n\nIn a population of size n, the contact rate from i to j \u03b2 ij (n \u2212 1) \u22121 and the contact rate from j to i is \u03b2 ji (n \u2212 1) \u22121 , where \u03b2 ij and \u03b2 ji have the joint distribution F(\u03b2 ij , \u03b2 ji ) from above.\n\nThe epidemic percolation network for a random mixing model is defined in the same way as that for a network-based model, except that \u03b2 ij (n \u2212 1) \u22121 replaces \u03b2 ij . Let g(x, y, u|n, r i , \u03b2 ij ; r j , \u03b2 ji ) be the conditional probability generating function (pgf) for the number of incoming, outgoing, and undirected edges incident to node i that appear between i and j in the epidemic percolation network given n, r i , \u03b2 ij , r j , and \u03b2 ji . Then g(x, y, u|n, r i , \u03b2 ij ; r j , \u03b2 ji ) is exp ( \u2212 r i \u03b2 ij + r j \u03b2 ji n \u2212 1 ) + exp ( \u2212 r i \u03b2 ij n \u2212 1 ) 1 \u2212 exp ( \u2212 r j \u03b2 ji n \u2212 1 ) x + 1 \u2212 exp ( \u2212 r i \u03b2 ij n \u2212 1 ) exp ( \u2212 r j \u03b2 ji n \u2212 1 ) y + 1 \u2212 exp ( \u2212 r i \u03b2 ij n \u2212 1 ) \u2212 1exp ( \u2212 r i \u03b2 ji n \u2212 1 ) u.\n\nIn the limit of large n, g ( x, y, u | n, r i , \u03b2 ij ; r j , \u03b2 ji ) = 1 \u2212 r i \u03b2 ij + r j \u03b2 ji\n\nso undirected edges disappear in the limit of a large population. Given r i and n, the conditional pgf for the number of incoming, outgoing, and undirected edges incident to i that appear between i and a node j \u2260 i can be found by integrating over the distribution of possible (\u03b2 ij , \u03b2 ji ) and r j :\n\ng ( x, y, u | n, r i ) = \u222b 0 \u221e \u222b 0 \u221e \u222b 0 \u221e g ( x, y, u | \u03b2, r i , r j , n ) dF ( \u03b2 ij , \u03b2 ji ) dF ( r j )\n\nGiven r i and n, the conditional pgf for the total number of incoming and outgoing edges incident to i in the percolation network is\n\nIn the limit of large n, this converges to\n\n. Therefore, the pgf for the degree distribution of the percolation network in the limit of a large population is\n\nSeveral results follow immediately from inspection of this function: First, undirected edges vanish in the limit of a large population, leaving a purely directed epidemic percolation network. Second, the indegree and outdegree of nodes in the epidemic percolation network are independent. Third, the indegree has a Poisson distribution with mean E[r]E [\u03b2] . Finally, the outdegree has a conditional Poisson distribution for any given recovery period r. The mean outdegree is E[r]E[\u03b2] as required, but the outdegree distribution is not necessarily Poisson. For example, if r \u223c exponential(\u03bb), then the outdegree has a geometric ( \u03bb \u03bb + E \u03b2 ) distribution. More generally, if r \u223c gamma(\u03b1, \u03bb), then the outdegree has a negative binomial ( \u03b1, \u03bb \u03bb + E \u03b2 ) distribution.\n\nA useful generalization of the SIR model with random mixing is to allow the population to be composed of K distinct subpopulations, where each subpopulation k constitutes a proportion w k of the overall population. Let F k (r) be the cumulative distribution function for the recovery period of nodes in subpopulation k. In addition, let each subpopulation k have a relative infectiousness \u03b1 k and a relative susceptibility \u03b3 k . If nodes i and j are in subpopulations k i and k j , then the infectious contact rate from i to j is \u03b1 k i \u03b2 ij \u03b3 k j and the infectious contact rate from j to i is \u03b1 k j \u03b2 ji \u03b3 k i , where \u03b2 ij and \u03b2 ji have a joint distribution function F(\u03b2 ij , \u03b2 ji ) as before. This formulation for an epidemic model with a heterogeneous population is called proportionate mixing [7, 15] . Since the relative infectiousness and relative susceptibility are each determined only up to a multiplicative constant, we assume without loss of generality that \u03a3 k=1 K w k E r k \u03b1k = \u03a3 k=1 K w k \u03b3 k = 1.\n\nLet g k i k j (x, y, u|n, r i , \u03b2 ij ; r j , \u03b2 ji ) be the conditional pgf for the number of incoming, outgoing, and undirected edges incident to i that appear between nodes i and j in subpopulations k i and k j in the percolation network given \u03b2 ij , \u03b2 ji , r i , r j , and n. Then g k i k j (x, y, u|n, r i , \u03b2 ij ; r j , \u03b2 ji ) equals\n\nLet g k i (x, y, u|r i , n) be the conditional pgf for the number of incoming, outgoing, and undirected edges incident to i that appear between i and a node j \u2260 i given k i , r i , and n. Then\n\nThe conditional pgf for the total number of incoming, outgoing, and undirected edges incident to node i given r i and n is\n\nIn the limit of large n, this becomes\n\n.\n\nIntegrating over the distribution of infectious periods in subpopulation k i yields\n\nNote that the indegree distribution of subpopulation k i has a Poisson distribution, the outdegree distribution is a mixture of Poisson distributions, and the indegree and outdegree are independent within subpopulation k i . Finally, the pgf for the degree distribution of the epidemic percolation network in the limit of a large population is:\n\nThe proportional mixing assumption has two important consequences that enormously simplify the analysis of the epidemic percolation network: First, the probability that an edge terminates at a node in subpopulation k is proportional to the expected indegree of subpopulation k and independent of the node at which the edge began. Second, the probability that an edge originates at a node in subpopulation k is proportional to the expected outdegree of subpopulation k and independent of the node at which the edge terminates. To prove the first, we observe that the total number of directed edges to nodes in subpopulation k 0 from a node i in subpopulation k i with recovery period r i is a sum of w k 0 n iid Bernoulli random variables with mean\n\nIn the limit of large n, the number of outgoing edges from node i to nodes in subpopulation k 0 has a Poisson distribution with mean\n\nThe total number of outgoing edges from node i has a Poisson distribution with mean\n\nBy the strong law of large numbers, the proportion of these edges that terminate at nodes in subpopulation k 0 converges almost surely to w k 0 \u03b3 k0 , which is proportional to the expected indegree of subpopulation k 0 and independent of k i and r i . A similar argument shows that the proportion of incoming edges to node i that originate at nodes in subpopulation k 0 converges almost surely to w k 0 E[r k 0 ]\u03b1 k 0 , which is proportional to the expected outdegree of subpopulation k 0 and independent of k i and r i .\n\nMethods of calculating the size distribution of small components, the percolation threshold, and the proportion of a network contained in the GIN, the GOUT, and the GSCC for semidirected networks with arbitrary degree distributions have been developed by Bogu\u00f1\u00e1 and Serrano [3] and Meyers, Newman, and Pourbohloul [4] . For purely directed and purely undirected networks, these methods simplify to equations derived by Newman, Strogatz, and Watts [2, [10] [11] [12] . In this section, we outline the methods for semi-directed networks and show how they simplify in the case of purely directed networks. This discussion is adapted from our previous paper [5] and introduces notation that will be used in the rest of this paper. For readers who desire an introduction to random graphs and percolation on networks, we recommend Albert and Barab\u00e1si [10] and Newman [12] .\n\nThe networks considered here have no small loops and no two-point degree correlations (i.e. the degree of a node reached by following an edge forward or backward is independent of the degree of the node from which we start). As shown above, this is sufficient for models with random and proportionate mixing. Since these methods assume no clustering of contacts, they do not apply to epidemics on networks with spatial structure [6, 16] , small-world networks [19] , or other clustered networks [20, 21] . The development of methods for clustered networks is an area of active research [22] . Nonetheless, the isomorphism to an epidemic percolation network is valid for any time-homogeneous SIR model, including models that cannot be analyzed via the generating function formalism outlined here.\n\nIf a, b, and c are nonnegative integers, let G (a,b,c) (x, y, u) be the derivative obtained after differentiating a times with respect to x, b times with respect to y, and c times with respect to u. Then the mean indegree of the epidemic percolation network is G (1,0,0) (1, 1, 1) and the mean outdegree is G (0,1,0) (1, 1, 1). Let k d denote the common mean of the directed degrees. The mean undirected degree is k u = G (0,0,1) (1, 1, 1). For the epidemic percolation network for the homogeneous SIR model with random mixing,\n\nLet G f (x, y, u) be the pgf for the degree distribution of a node reached by going forward along a directed edge, excluding the edge used to reach the node. Since the probability of reaching any node by following a directed edge is proportional to its indegree,\n\nSimilarly, the pgf for the degree distribution of a node reached by going in reverse along a directed edge (excluding the edge used to reach it) is\n\nand the pgf for the degree distribution of a node reached by following an undirected edge (excluding the edge used to reach it) is\n\nThe above definitions require that k d > 0 and k u > 0. In a purely undirected network (i.e. k d = 0), we arbitrarily set G f (x, y, u) = G r (x, y, u) = 1 for all x, y, and u. In a purely directed network (i.e. k u = 0), we arbitrarily set G u (x, y, u) = 1 for all x, y, and u.\n\nLet H f out (z) be the pgf for the size of the out-component at the end of a directed edge and H u out (z) be the pgf for the size of the out-component at the \"end\" of an undirected edge. Then, in the limit of a large population,\n\nThe pgf for the out-component size of a randomly chosen node is H out (z) = zG ( 1, H f out (z), H u out (z) ) .\n\n(3)\n\nIn a purely directed network, H u out (z) = 1 for all z because G u (x, y, u) = 1 for all x, y, and u.\n\nThus \n\nEstimates of H f out (z) and H u out (z) can be used to obtain estimates of H out (z) with arbitrary precision.\n\nIn the limit of a large population, the probability that a node has a finite out-component is H out (1) , so the probability that a randomly chosen node is in the GIN is 1 -H out (1) . The expected size of the out-component of a randomly chosen node is H out \u2032(1). Taking derivatives in equation (3) yields\n\nTaking derivatives in equations (2a) \n\nand\n\nwhere the argument of all derivatives is (1, 1, 1). In a purely directed network, all derivatives involving G u are zero, so\n\nThe in-component size distribution of a semi-directed network can be derived using the same logic used to find the out-component size distribution, except that we consider going backwards along edges. Let In the limit of a large population, the probability that a node has a finite in-component is H in (1) , so the probability that a randomly chosen node is in the GOUT is 1 -H in (1) . The expected size of the in-component of a randomly chosen node is H in \u2032(1). Taking derivatives in equation (7c) yields\n\nTaking derivatives in equations (7a) and (7b) and using the fact that H r\n\nand\n\nwhere the argument of all derivatives is (1, 1, 1). In a purely directed network, all derivatives involving G u are zero, so \n\nThe epidemic threshold occurs when the expected size of the in-and out-components in the network becomes infinite. Equations (5) and (6) show that the mean out-component size becomes infinite when\n\nand equations (9) and (10) show that the mean in-component size becomes infinite when\n\nFrom the definitions of G f (x, y, u), G r (x, y, u) and G u (x, y, u), both conditions are equivalent to\n\nTherefore, there is a single epidemic threshold where the GSCC, the GIN, and the GOUT appear simultaneously.\n\nIn a purely directed network, the condition for this epidemic threshold is much simpler because all derivatives with respect to u and all derivatives of G u are zero: The mean out-component size becomes infinite when 1 \u2212 G f (0,1,0) = 0 and the mean in-component size becomes infinite when 1 \u2212 G r (1,0,0) = 0. Both of these conditions are equivalent to 1 \u2212 k d \u22121 G (1, 1,0) = 0.\n\nIn the limit of a large population, a node is in the GSCC if and only if its in-and out-components are both infinite. A randomly chosen node has a finite in-component with probability (1) ) and a finite out-component with probability G(1, H f out (1), H u out (1) ).\n\nThe probability that a node reached by following an undirected edge has finite in-and outcomponents is the solution to the equation v = G u ( H r in (1), H f out (1), v ) , and the probability that a randomly chosen node has finite in-and out-components is (1), v) [3] . Thus, the relative size of the GSCC is\n\nIn a purely directed network, this simplifies to (1), H f out (1) ) .\n\nThe An epidemic was defined to be an outbreak that infected more than 10% or 15% of the population. These percentages were chosen to obtain an outbreak size much larger than the expected size of self-limited outbreaks and much smaller than the expected size of an epidemic.\n\nFor R 0 near one, the mean self-limited outbreak size increases and the expected size of an epidemic decreases, leading to poor separation between self-limited outbreaks and epidemics. Since the mean size of self-limited outbreaks approaches a constant and the mean size of an epidemic scales with the population size, this separation can be restored by taking a larger population size. However, the computational time required for an exact simulation varies roughly with the square of the population size. Thus, we did not attempt simulations for R 0 below 1.25 or 1.5.\n\nIn this section and the remainder of the paper, we deal exclusively with purely directed epidemic percolation networks. To simplify notation, we drop the variable u from G(x, y, u).\n\nThe first series of homogeneous population models had a fixed recovery time, the second series had exponentially-distributed recovery times, and the third series had ten different recovery time distributions. All models had a single imported infection randomly chosen from the population, a mean recovery time of one, and a basic reproductive number of R 0 .\n\nWhen the recovery time is fixed, the pgf for the degree distribution of the epidemic percolation network is G(x, y) = e R 0 (x\u22121) e R 0 (y\u22121) , so the indegree and outdegree have independent Poisson distributions with mean R 0 . The model was run at R 0 = 1.25, 1.5, 2, 2.5, 3, 4, and 5. At each R 0 , the model was run 10, 000 times in a population of 10, 000 individuals.\n\nWhen the recovery time is exponentially distributed, the pgf for the degree distribution of the epidemic percolation network is\n\nso the indegree has a Poisson distribution and the outdegree has a geometric distribution. The mean indegree and outdegree are both R 0 . The model was run at R 0 = 1.5, 2, 2.5, 3, 4, 5, 6, 7, 8, 9, and 10. At each R 0 , the model was run 10, 000 times with a population of 10, 000 individuals.\n\nDetails of the recovery time distributions for the third series of simulations are shown in Table  1 . As in the other homogeneous population models, the indegree and outdegree are independent. The pgf for the indegree is e R 0 (x\u22121) . The pgf for the outdegree is G out (y) = \u222b 0 \u221e e R 0 (y\u22121)r dF(r).\n\nThe pgf for the degree distribution of the epidemic percolation network is G(x, y) = e R 0 (x\u22121) G out (y). For each recovery time distribution, models were run 2, 000 times with a population of 1, 000 individuals at R 0 = 1.5, 2, 2.5, 3, 4, and 5.\n\nIn all homogeneous population models, an epidemic was said to occur when more than 10% of the population was infected. As outlined in Section 3, the predicted probability of an epidemic is 1 \u2212 H out (1) and the predicted final size of an epidemic is 1 \u2212 H in (1) . The predicted final size of an epidemic for a given R 0 was the same for all recovery time distributions, but Figure 2 shows that the probability of an epidemic depends on both R 0 and the recovery time distribution. The probability and final size of an epidemic were equal only when the recovery time was fixed. For all other recovery time distributions, the probability of an epidemic was less than its final size (this inequality is proven in [5] ). Figure 3 shows a good agreement between the predicted and observed probabilities of an epidemic and Figure 4 shows a good agreement between the observed and predicted final sizes of epidemics.\n\nIn the first two series of heterogeneous population models, the population consisted of two subpopulations A and B of equal size. The average number of infectious contacts made by a member of subpopulation B during his or her recovery period is \u03bb. We assumed the following infectious contact rates from i to j in a population of size n: 8 3 \u03bb(n \u2212 1) \u22121 when i and j are both members of subpopulation A, 4 3 \u03bb(n \u2212 1) \u22121 when i and j are members of different subpopulations, and 2 3 \u03bb(n \u2212 1) \u22121 when i and j are both in subpopulation B. All models had a mean recovery time of one. With these assumptions, the mean indegree and outdegree of subpopulation A were 2\u03bb and the mean indegree and outdegree of subpopulation B were \u03bb, producing a positive correlation between susceptibility and infectiousness.\n\nWhen the recovery period is fixed, the pgf for the degree distribution of the epidemic percolation network is G(x, y) = .5e 2\u03bb(x\u22121) e 2\u03bb(y\u22121) + .5e \u03bb(x\u22121) e \u03bb(y\u22121) .\n\nWhen the recovery period is exponentially distributed, the pgf for the degree distribution of the epidemic percolation network is\n\nEach model was run at \u03bb = .65, .7, .8, .9, 1.0, 1.1, 1.2, 1.3, and 1.4. At each \u03bb, the model was run 10, 000 times. For models with \u03bb > .65, the population was 10, 000. For \u03bb = .65, the population size was 100, 000. When \u03bb = .65, epidemics occur even though the mean degree of the network is less than one. Both series of models were implemented in Berkeley Madonna.\n\nA third series of simulations was conducted in populations with various mixtures of recovery time distributions. The population had 1, 000 individuals partitioned into subpopulations A and B of 500 individuals each. Each model was run under two scenarios: In the first scenario, subpopulation A is twice as infectious per unit time and has the same mean recovery time as subpopulation B. In the second scenario, both subpopulations are equally infectious per unit time but the mean recovery period of subpopulation A is twice as long as that of B. The degree distribution of the epidemic percolation network is identical under both scenarios. In the first scenario, models were run for all nine possible combinations of the Fixed(1), Uniform(0, 2), and Exponential(1) recovery time distributions. In the second scenario, models were run for all nine possible combinations of Fixed(2), Uniform(0, 4), and Exponential(.5) in subpopulation A and Fixed(1), Uniform(0, 2), and Exponential(1) in subpopulation B. These recovery time distributions are described in Table 1 . Every model was run 5, 000 times with \u03bb = 2. An epidemic was defined as an outbreak that infected more than 15% of the population. A similar set of simulations was conducted where subpopulation A had a mean indegree of \u03bb and a mean outdegree of 2\u03bb while subpopulation B had a mean indegree of 2\u03bb and a mean outdegree of \u03bb, producing a negative correlation between infectiousness and susceptibility. All of these models were implemented in Mathematica.\n\nIn the first two series of heterogeneous models, an epidemic was defined to occur when more than 10% of the population was infected. The predicted probability and final size of an epidemic are 1 \u2212 H out (1) and 1 \u2212 H in (1), respectively, according to the epidemic percolation network.\n\nAccording to a branching process approximation, the predicted probability of an epidemic is 1 \u2212 h out (1), where h out (z) = zG ( 1, h out (z) ) , and the predicted final size of an epidemic is 1 \u2212 h in (1) , where h in (z) = zG ( h in (z), 1 ) . Figures 5 and 6 compare the epidemic percolation network and branching process predictions of the probability and final size of an epidemic. These models have a positive correlation between infectiousness and susceptibility, so persons infected through indigenous transmission are more infectious than persons randomly selected from the population. Since the branching process approximation implicitly assumes that persons infected through indigenous transmission have the same outdegree distribution as the general population, it consistently underestimates both the probability and final size of an epidemic. The epidemic percolation network consistently predicts the correct probability and final size of an epidemic. Figure 7 shows a scatterplot of observed and predicted epidemic probabilities for all heterogeneous population models. The predicted probability of an epidemic for an initial case randomly chosen from the population is 1 \u2212 H out (1). The \"combined\" points show the observed and predicted epidemic probabilities for an initial case randomly chosen from the overall population. Let G A (x, y) and G B (x, y) be the pgf of the degree distributions of nodes in subpopulations A and B respectively. The predicted probability of an epidemic for an initial case chosen randomly from subpopulation A is 1 \u2212 G A (1, H f out (1) ), and the predicted probability of an epidemic for an initial case chosen randomly from subpopulation B is (1) ). The \"subpopulation A\" points show the observed and predicted epidemic probabilities for an initial case randomly chosen from subpopulation A, and the \"subpopulation B\" points show the observed and predicted epidemic probabilities for an initial case randomly chosen from subpopulation B. All three sets of points are close to the diagonal, showing that epidemic percolation networks accurately predicted the probability of an epidemic. The predicted cumulative hazard of infection in an epidemic is -ln(H in (1)). Figure 8 shows a scatterplot of the observed and predicted cumulative hazard of infection in an epidemic for all heterogeneous population models. All points are close to the diagonal, showing that epidemic percolation networks accurately predicted the final size of epidemics. Figure 9 shows a scatterplot of the observed and predicted mean size of outbreaks in the third series of heterogeneous population models. The mean size of an outbreak started by a single, randomly chosen imported infection is H out \u2032(1). The \"combined\" points show the observed and predicted mean outbreak size for an initial case randomly chosen from the overall population. The mean size of an outbreak started by an imported infection randomly chosen from subpopulation A is\n\nThe \"subpopulation A\" points show the observed and predicted mean outbreak size for an initial case randomly chosen from subpopulation A, and the \"subpopulation B\" points show the observed and predicted mean outbreak size for an initial case randomly chosen from subpopulation B. All three sets of points are close to the diagonal, showing that epidemic percolation networks accurately predicted the mean sizes of finite epidemics in these models. Models with higher epidemic probabilities tend to have smaller outbreak sizes because large outbreaks are more likely to \"explode\" and become epidemics.\n\nIn this section, we show that epidemic percolation networks can reproduce much of the standard theory of epidemics. When the indegree and outdegree are independent, the epidemic percolation networks predict the same distribution of outbreak sizes, epidemic threshold, and probability and final size of an epidemic as the forward and backward branching process approximations. Epidemic percolation networks can also reproduce results from models developed specifically for special topics within infectious disease epidemiology. Below, we give examples of the derivation of results from the epidemiology of sexually transmitted diseases, controlled diseases, and vector-borne diseases.\n\nMuch of the mathematical theory of epidemics has been derived using a branching process as an approximation to the initial spread of disease, where the \"offspring\" of an individual are the persons he or she infects [7, 15, 18] . The branching process approximation remains accurate until the first time at which an infectious individual transmits infection to a person who has already been infected, which happens after an arbitrarily long interval in the limit of a large population [15] . We will call this the \"forward\" branching process approximation to the initial spread of disease, to distinguish it from the \"backward\" branching process discussed later.\n\nIf the offspring distribution of a branching process has the pgf g(x), then the probability that the branching process goes extinct is the smallest solution in [0, 1] of the equation x = g(x) . If h(z) is the pgf for the total number of individuals generated by the branching process (including the initial individual), then h(z) = zg(h(z)) [23] .\n\nTheorem 1-When an epidemic percolation network has independent indegree and outdegree, it predicts exactly the same outbreak size distribution, epidemic threshold, and probability of an epidemic (given the infection of a single randomly chosen node) as a forward branching process approximation to the initial spread of disease. G(1, y) . The number of secondary infections produced by persons infected through indigenous transmission has the pgf where the second equality follows from the independence of the indegree and outdegree. Therefore, the initial spread of disease behaves like a branching process whose offspring distribution has the pgf g f (y) = G(1, y) . The probability of a self-limited outbreak (i.e. no epidemic) given the infection of a randomly chosen individual is the smallest solution in [0, 1] of y = G (1, y) , which is equivalent y = g f (y). Similarly, H f out (z) = H out (z) and the pgf for outbreak sizes is H out (z) = zG(1, H out (z)), which is equivalent to h(z) = zg f (h(z)).\n\nAnother important application of branching processes to SIR models with random mixing is the use of a \"backward\" branching process to predict the relative final size of an epidemic, in which the \"offspring\" for each individual i are the people who would make infectious contact with i if they were infectious. The relative final size of the epidemic is equal to the probability that the backward branching process never goes extinct [7] .\n\nTheorem 2-When an epidemic percolation network has independent indegree and outdegree, it predicts exactly the same relative final size of an epidemic as a backward branching process.\n\nProof-In the epidemic percolation network, the number of offspring in the backwards branching process for a randomly chosen individual has the pgf G(x, 1). The pgf for the number of offspring of persons reached by going in reverse along a directed edge is\n\nwhere the final equality follows from the independence of the indegree and outdegree. Therefore, the process of moving backwards along edges in the epidemic percolation network is a branching process whose offspring distribution has the pgf g b (x) = G(x, 1) . The probability that a node is not infected in an epidemic is the smallest solution in [0, 1] of x = G(x, 1), which equivalent to x = g b (x). Therefore, the epidemic percolation network and the branching process predict the same relative final size of an epidemic.\n\nIn an SIR model whose epidemic percolation network has independent indegree and outdegree, the epidemic percolation network is a simultaneous mapping of the forward and backward branching processes. However, a branching process assumes that the offspring distribution is the same in each generation of infection (because the same pgf g(x) is used for each generation). This assumption fails in an epidemic percolation network in which the indegree and outdegree are not independent.\n\nEpidemic percolation networks generalize to models with arbitrary joint degree distributions because they allow the offspring distribution of the initial node to be different from the offspring distribution of all subsequent generations in the forward and backward branching processes. If we go forward along edges starting from a randomly chosen node, the offspring distribution of the initial node has the pgf G(1, y) and the offspring distribution of nodes in all subsequent generations has the pgf G f (1, y) . If we go backward starting from a randomly chosen node, then the offspring distribution of the initial node has the pgf G(x, 1) and all subsequent generations have the pgf G r (x, 1). When the indegree and outdegree are not independent, G(1, y) \u2260 G f (1, y) and G(x, 1) \u2260 G r (x, 1), so both branching process approximations break down. We find it useful to think of the equations for the component size distributions in Section 3 as describing (forward or backward) branching processes in which the initial node is allowed to have a different offspring distribution from all subsequent generations.\n\nBy mapping the forward and backward infectious contact processes simultaneously, the crucial role of the GSCC in the emergence of epidemics becomes clear. In a forthcoming manuscript, we analyze a proportionate mixing model with three subpopulations: One with the greatest probability of being in the GIN, one with the greatest probability of being in the GOUT, and one with the greatest probability of being in the GSCC. Vaccinating nodes in the subpopulation most likely to be in the GSCC is shown to be the most efficient strategy for reducing both the probability and final size of an epidemic despite the fact that such nodes were of average infectiousness and susceptibility. We have obtained similar results with network-based models. Nodes with a high probability of being in the GSCC are the \"core group\" that sustains transmission of infection in the population. If the forward and backward infectious contact processes are treated separately, the notion of the GSCC is lost.\n\nThe use of probability generating functions on epidemic percolation networks allows many classical results from the theory of epidemics to be re-derived very easily. Below, we give derivations of results from three different areas of infectious disease epidemiology. The ability of epidemic percolation networks to encompass these results in a single conceptual framework is a striking demonstration of their utility and generality.\n\nExample 1 (Sexually transmitted diseases)-For many sexually transmitted diseases, variation in levels of sexual activity affect the dynamics of disease transmission. One important result is that R 0 for sexually transmitted diseases depends on both the mean and the variance of the number of sexual partners [18] . Let I be a random variable representing the expected number of sexual partners a person has during his or her recovery period. If the hazard of infection is proportional to I, then\n\nwhere \u03bc I and \u03c3 I 2 are the mean and variance of the number of sexual partners and T is the probability of transmission for each partnership [7, 18] .\n\nWe first partition the population into subpopulations 1, 2, \u2026 such that subpopulation i consists of all persons with I = i. The proportion of the population in subpopulation i is equal to P(I = i). Since there is a constant probability T of transmission for each partnership and I = i is the expected number of partners during the recovery period, the mean outdegree of subpopulation i is Ti. Since the hazard of infection in subpopulation i is also proportional to i, the mean indegree of subpopulation i must also be Ti. The indegree and outdegree of each individual are conditionally independent given I, so the pgf for the degree distribution of nodes in subpopulation i can be written\n\nThe pgf of the degree distribution of the epidemic percolation network is\n\nThe overall mean degree is T \u03bc I , and the epidemic threshold is Therefore, the epidemic percolation network correctly predicts the epidemic threshold for this model. However, it can also predict the size distribution of outbreaks and the probability and final size of an epidemic. Epidemic percolation networks can also be used to analyze SIR models with more complex relationships between sexual activity, infectiousness, and susceptibility.\n\nExample 2 (Outbreaks of controlled diseases)-For diseases that have been eliminated within a specific country but are not eradicated worldwide (such as measles in the United States), imported cases and cases secondary to importation can still occur. To evaluate the success of a disease elimination program, it is important to determine whether the observed pattern of outbreaks is consistent with sustained indigenous transmission. This can be inferred from the final size distribution of outbreaks. If infectiousness and susceptibility are independent and cases generate secondary cases according to a Poisson distribution with mean R 0 < 1, all epidemics are finite and epidemic sizes follow a Borel-Tanner distribution [24, 25] . The probability that an outbreak has a final size of k is\n\nThe pgf for the Borel-Tanner distribution is the unique solution to the equation\n\n. (12) Below the phase transition, the pgf for the distribution of outbreak sizes in the epidemic percolation network is H out (z). Since the incoming and outgoing degree are independent and the outgoing degree is Poisson distributed with mean R 0 , G f (1, y) = G(1, y) = e R 0 (y\u22121)\n\nBut then H f out (z) = H out (z) = ze R 0 ( H out (z)\u22121 ) , (13) which is identical to equation (12) . Therefore, H out (z) = h(z), so the outcomponent sizes in the epidemic percolation network have a Borel-Tanner distribution. Using the fact that the probability of having an outbreak of size one is e \u2212R 0 , it is easy to check that the first few iterations of equation (13) produce coefficients of the form in equation (11) .\n\nMacdonald consists of humans and mosquitoes. Infected humans recover from malaria at a constant rate \u03b3, so the average recovery period is \u03b3 \u22121 . There are m susceptible mosquitoes that bite with a rate a and are infected with probability c when they bite an infectious human, so each infectious human infects an average of (amc) \u03b3 \u22121 susceptible mosquitoes. The mortality rate of mosquitoes is \u03bc, so they survive for an average of \u03bc \u22121 time units after being infected. When an infectious mosquito bites a susceptible human, the human is infected with probability b, so each infectious mosquito infects an average of (ab)\u03bc \u22121 humans. The epidemic threshold in this model is defined by\n\nThis was one of the earliest applications of the basic reproductive number [18] .\n\nThe full epidemic percolation network for a vector-borne disease would include nodes representing humans and vectors. Humans infect vectors and vectors infect humans, so every edge in this epidemic percolation network links nodes of different types. Such a network is called a bipartite network. Probability generating functions can be used to analyze undirected bipartite networks [2] , and these methods can be adapted to directed bipartite graphs. Using the subscript h for host and v for vector, let G h (x, y) be the pgf for the degree distribution among humans and let G v (x, y) be the pgf for the degree distribution among vectors. The epidemic percolation network among humans can then be constructed by drawing an edge from person i to person j if there is a vector that transfers infection from i to j. The pgf for the degree distribution in the human-human epidemic percolation network is\n\nwhere p jk h is the probability that a human node in the human-vector epidemic percolation network has j incoming edges and k outgoing edges, G vr (x, y) is the pgf for the degree of a vector reached by going backwards along an edge, and G vf (x, y) is the pgf for the degree of a vector reached by going forward along an edge. The outbreak size distribution, the epidemic threshold, and the probability and final size of an epidemic among humans can be predicted using G H (x, y).\n\nIn the Ross-Macdonald model, infectiousness and susceptibility are independent among both humans and mosquitoes. Therefore, G hf (1, y) = G h (1, y) and G vf (1, y) = G v (1, y) . The pgf for the out-degree of human nodes is \n\nFor the epidemic models considered in this paper, methods of finding the exact distribution of outbreak sizes for a homogeneous population of any fixed size n exist [7, 15, 17] . However, these methods involve solving a recursive system of n equations. By performing these calculations in the limit of a large population, the methods presented in this paper allow a much simpler derivation of the distribution of self-limited outbreak sizes, the epidemic threshold, and the probability and final size of an epidemic. Our methods also generalize much more easily to heterogeneous populations.\n\nAs proven in the Appendix, the problem of analyzing the final outcomes of any timehomogeneous stochastic SIR model can be reduced to the problem of analyzing the components of an epidemic percolation network. In [5] , we showed how epidemic percolation networks can be used to analyze network-based models of the type studied by Newman [1] . In this paper, we showed that epidemic percolation networks can be used to analyze stochastic SIR models with random and proportionate mixing. In the limit of a large population, the epidemic percolation network for these models is purely directed. Using the probability generating function for its degree distribution, we accurately predicted the mean size of outbreaks and the probability and final size of epidemics for a variety of models in homogeneous and heterogeneous populations.\n\nThe ability of epidemic percolation networks to analyze both network-based and fully-mixed epidemic models makes them a simple but powerful generalization of earlier methods of analyzing stochastic SIR models. We showed that epidemic percolation networks with independent indegree and outdegree are equivalent to forward and backward branching processes, and we used epidemic percolation networks to re-derive classical results from sexually transmitted diseases, vector-borne diseases, and controlled diseases. Epidemic percolation networks may also provide a novel and useful qualitative insight into the control of epidemics. The emergence of epidemics corresponds to the emergence of the GSCC in the epidemic percolation network, so nodes with a high probability of being in the GSCC may be important targets for interventions designed to reduce the probability and final size of an epidemic.\n\nIt is possible to define epidemic percolation networks for a much wider range of stochastic epidemic models than that from the Introduction. First, we specify an SIR epidemic model using probability distributions for infectious periods in individuals and times from infection to infectious contact in ordered pairs of individuals. Second, we outline time-homogeneity assumptions under which the epidemic percolation network is defined. Finally, we define infection networks and use them to show that the final outcome of the epidemic model depends only on the set of initial infections and the epidemic percolation network. This discussion is adapted from that of our previous paper [5] .\n\nSuppose there is a closed population in which every susceptible person is assigned an index i \u2208 {1, \u2026, n}. A susceptible person is infected upon infectious contact, and infection leads to recovery with immunity or death. Each person i is infected at his or her infection time t i , with t i = \u221e if i is never infected. Person i is removed (i.e. recovers from infectiousness or dies) at time t i + r i , where the recovery period r i is a random variable with the cumulative distribution function (cdf) F i (r). The recovery period r i may be the sum of a latent period, when i is infected but not yet infectious, and an infectious period, when i can transmit infection. We assume that all infected persons have a finite recovery period. Let S(t) = {i : t i > t} be the set of susceptible individuals at time t. Let t (1) \u2264 t (2) \u2264 \u2026 \u2264 t (n) be the order statistics of t 1 , \u2026, t n , and let i k be the index of the k th person infected.\n\nWhen person i is infected, he or she makes infectious contact with person j \u2260 i after an infectious contact interval \u03c4 ij . Given r i , each \u03c4 ij has a conditional cdf F ij (\u03c4|r i ). Let \u03c4 ij = \u221e if person i never makes infectious contact with person j, so F ij (\u03c4|r i ) may have a probability mass concentrated at infinity. Person i cannot transmit disease before being infected or after recovering from infectiousness, so F ij (\u03c4|r i ) = 0 for all \u03c4 \u2264 0 and F ij (\u03c4|r i ) is equal to the conditional probability of transmission from i to j given r i for all \u03c4 \u2208 [r i , \u221e). The infectious contact time t ij = t i + \u03c4 ij is the time at which person i makes infectious contact with person j. If person j is susceptible at time t ij , then i infects j and t j = t ij . If t ij < \u221e, then we must have t j \u2264 t ij because person j avoids infection at t ij only if he or she has already been infected.\n\nFor each person i, let his or her importation time t 0i be the first time at which he or she experiences infectious contact from outside the population, with t 0i = \u221e if this never occurs. Let F 0 (t 0 ) be the cdf of the importation time vector t 0 = (t 01 , t 02 , \u2026, t 0n ).\n\nBefore an epidemic begins, an importation time vector t 0 is chosen. The epidemic begins with the introduction of infection at time t (1) = min i (t 0i ). Person i 1 is assigned an recovery period r i 1 . Every person j \u2208 S(t (1) ) is assigned an infectious contact time t i 1 j = t (1) + \u03c4 i 1 j . We assume that there are no tied infectious contact times less than infinity. The second infection occurs at t (2) = min j\u2208S(t (1) ) min(t 0j , t i 1 j ), which is the time of the first infectious contact after person i 1 is infected. Person i 2 is assigned an recovery period r i2 . After the second infection, each of the remaining susceptibles is assigned an infectious contact time t i 2 j = t (2) + \u03c4 i 2 j . The third infection occurs at t (3) = min j\u2208S(t (2) ) min(t 0j , t i 1 j , t i 2 j ), and so on. After k infections, the next infection occurs at t (k+1) = min j\u2208S(t (k) ) min(t 0j , t i 1 j , \u2026, t i k j ). The epidemic stops after m infections if and only if t (m+1) = \u221e.\n\nIn principle, the above epidemic algorithm could allow the distributions of the recovery period and outgoing infectious contact intervals for individual i to depend on all information about the epidemic available up to time t i . In order to generate an epidemic percolation network, we must ensure that the joint distribution of recovery periods and conditional transmission probabilities for all ordered pairs of individuals are defined a priori. In order to do this, we place the following restrictions on the model:\n\nWe assume that the distribution of the recovery period vector r = (r 1 , r 2 , \u2026, r n ) does not depend on the importation time vector t 0 , the contact interval matrix \u03c4 = [\u03c4 ij ], or the history of the epidemic.\n\nWe assume that the distribution of the infectious contact interval matrix \u03c4 does not depend on t 0 or on the history of the epidemic.\n\nWith these time-homogeneity assumptions, the cumulative distribution functions F(r) of recovery periods and F(\u03c4|r) of infectious contact intervals are defined a priori. Given r and \u03c4, the epidemic percolation network is a semi-directed network in which there is a directed edge from i to j iff \u03c4 ij < \u221e and \u03c4 ji = \u221e, a directed edge from j to i iff \u03c4 ij = \u221e and \u03c4 ji < \u221e, and an undirected edge between i and j iff \u03c4 ij < \u221e and \u03c4 ji < \u221e. The entire time course of the epidemic is determined by r, \u03c4, and t 0 . However, its final size depends only on the set {i : t 0i < \u221e} of imported infections and the epidemic percolation network. In order to prove this, we first define the infection network, which records the chain of infection from a single realization of the epidemic model.\n\nLet v i be the index of the person who infected person i, with v i = 0 for imported infections and v i = \u221e for uninfected nodes. If tied finite infectious contact times have probability zero, then v i is the unique j such that t ji = t i . If tied finite infectious contact times are possible, then choose v i from all j such that t ji = t i . The infection network is a network with an edge set {v i i : 0 < v i < \u221e}. It is a subgraph of the epidemic percolation network because \u03c4 v i i < \u221e for every edge v i i. Since each node has at most one incoming edge, all components of the infection network are trees. Every imported case is either the root node of a tree or an isolated node.\n\nThe infection network can be represented by a vector v = (v 1 , .., v n ), which is identical to the \"infection network\" defined by Wallinga and Teunis [26] . If v j = 0, then its infection time is specified by t 0 . If j was infected through transmission within the population, then it is connected to an imported infection imp j in the infection network and its infection time is where the edges e 1 * , \u2026, e m * form a directed path from imp j to j. This path is unique because all nontrivial components of the infection network are trees. The infection times of all other nodes are infinite. The removal time of each node i is t i + r i . Therefore, the entire time course of the epidemic is determined by the importation time vector t 0 , the recovery period vector r, the infectious contact interval matrix \u03c4.\n\nIn an epidemic with recovery period vector r and infectious contact interval matrix \u03c4, a node is infected if and only if it is in the out-component of a node i with t 0i < \u221e in the epidemic percolation network. Equivalently, a node is infected if and only if its in-component includes a node i with t 0i < \u221e.\n\nSuppose that person j is in the out-component of a node i with t 0i < \u221e in the epidemic percolation network. Then there is a series of edges e 1 , \u2026e m such that the initial node of e 1 is i, the terminal node of e m is j, and \u03c4 e k < \u221e for all 1 \u2264 k \u2264 m. Person j receives an infectious contact at or before t j * = t 0i + \u03a3 k=1 m \u03c4 e k < \u221e, so t j \u2265 t j * < \u221e and j must be infected during the epidemic. To prove the converse, suppose that t j < \u221e. Then there exists an imported case i and a directed path with edges e 1 , \u2026, e m from i to j such that \"Bowtie\" diagram showing the giant components, tendrils, and tubes of a supercritical semidirected network. Adapted from Broder et al. [8] and Dorogovtsev et al. [9] . Probability of an epidemic in a homogeneous population as a function of R 0 for recovery time distributions from Table 1 . Predicted and observed final sizes of epidemics as a function of R 0 for all homogeneous population models. The predicted final size was the same for all recovery time distributions. Predicted and observed probabilities of an epidemic as a function of \u03bb for the first two series of heterogeneous population models. Predicted and observed final sizes of an epidemic as a function of \u03bb for the first two series of heterogeneous population models. The final sizes of epidemics are the same for both fixed and exponentially-distributed recovery times. Scatterplot of observed and predicted epidemic probabilities in the third series of heterogeneous population models. The \"subpopulation A\" and \"subpopulation B\" points show conditional epidemic probabilities given an initial case in subpopulation A and B respectively. The \"combined\" points show the epidemic probability when the initial case is randomly chosen from the entire population. The linear regression equation and R 2 are shown separately for all three sets of points. Scatterplot of the observed and predicted cumulative hazard of infection in an epidemic. Linear regression equations and R 2 are shown separately for homogeneous and heterogeneous population models. Scatterplot of observed and predicted mean sizes of outbreaks in the third series of heterogeneous population models. Linear regression equations and R 2 are shown separately for an initial case randomly chosen from subpopulation A, subpopulation B, and from the overall population. "}