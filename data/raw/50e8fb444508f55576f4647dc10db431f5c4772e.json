{"title": "New Approach for Phylogenetic Tree Recovery Based on Genome-Scale Metabolic Networks", "body": "M etabolic models at the genome scale are one of the prerequisites for obtaining insight into the operation and regulation of metabolism as a whole (Barrett et al., 2006; Morange, 2009; Patil et al., 2004; Stephanopoulos et al., 1998) . Uses of metabolic models embrace all aspects of biotechnology, from food (Nielsen, 2001) to pharmaceutical (Boghigian et al., 2010) and biofuels (Montagud et al., 2010 (Montagud et al., , 2011a . Genome-scale metabolic network reconstruction is, in essence, a systematic assembly and organization of all reactions that build up the metabolism of a given organism. It usually starts with genome sequences to identify reactions and network topology. This methodology also offers an opportunity to systematically analyze omics datasets in the context of cellular metabolic phenotype.\n\nReconstructions have now been built for a wide variety of organisms and have been used toward five major ends (Oberhardt et al., 2009 ): contextualization of high-throughput data (Stephanopoulos et al., 1998; Montagud et al., 2010; Edwards et al., 1999) , guidance of metabolic engineering (Angermayr et al., 2009) , directing hypothesis-driven discovery (Nevoigt, 2008) , interrogation of multi-species relationships (Stolyar et al., 2007) , and network property discovery (Guimera and Nunes Amaral, 2005) .\n\nNowadays, phylogeny has become so popular that it's being used in almost every branch of biology (Yang and Rannala, 2012) . Beyond representing the relationships among species in the tree of life, phylogeny is used to describe relationships between paralogues in a gene family (Maser et al., 2001) , histories of populations (Edwards, 2009) , the evolutionary and epidemiological dynamics of pathogens (Marra et al., 2003; Grenfell et al., 2004) , the genealogical relationship of somatic cells during differentiation and cancer development (Salipante and Horwitz, 2006) , and even the evolution of language (Gray et al., 2009 ). More recently, molecular phylogenetics has become an indispensable tool for genome comparisons (Brady and Salzberg, 2011; Kellis et al., 2003; Green et al., 2010) .\n\nA phylogeny is a tree containing vertices that are connected by branches. Each branch represents the persistence of a genetic lineage through time, and each vertex represents the birth of a new lineage. If the tree represents the relationships among a group of species, then the vertices represent speciation events. Phylogenetic trees are not directly observed and are instead inferred from sequence or other data. Phylogeny reconstruction methods are either distance-based or character-based. In distance matrix methods, the distance between every pair of sequences is calculated, and the resulting distance matrix is used for tree reconstruction. For a very instructive review, please refer to Yang and Rannala (2012) .\n\nThis work is organized as follows. In the next section, we explain the genome-scale models with which we work, how we define a parameter for comparing two models, and how we recover the phylogenetic tree from the comparison matrix obtained for many metabolic models. Additionally, we will account for the minimum spanning tree of a nondirected, connected, weighted network associated with these metabolic models. In the subsequent section, we present the results, a brief study of the sensibility of the comparison parameter, and a summary and overview.\n\nIn a recent article (Reyes et al., 2012) , a method has been presented for automatically generating genome-scale metabolic models from data contained in the KEGG database (Kanehisa and Goto, 2000) . The method consists of searching the database for genes and pathways present in an organism and downloading the corresponding set of chemical reactions. The algorithm filters isosenzymes, or other repeated reactions, and may add missing reactions to a given pathway using a probabilistic criterion based on the comparison of the organism's pathway with the same pathway in other organisms. In this work, we use data obtained from this platform, but the method described can, in principle, be used with any set of metabolic models given that the compound names in the models follow the same standard (the same compound has the same name in all models).\n\nThe methodology we are about to describe will make use of two fundamentally different networks. One is the metabolic network build-up from the chemical reactions contained in an organism's metabolism. In this network, each metabolite represents a node (or vertex), and each link (or edge) is associated with a pair of nodes if their respective metabolites are connected as a substrate and product by some reaction. The second kind of network is the complete weighted network where each vertex represents an organism and each edge connecting two nodes is weighted by the parameter measuring the metabolic distance between the organisms' metabolism (note that this will be a complete network, where all vertices are connected to all others). In order to distinguish clearly the two networks in the text, we will talk about nodes and links for the metabolic network while for the organisms' network we will use the terms vertices and edges. As for the notation, we use capital letters (N, V, E) for the network, nodes, and links in the metabolic networks and curly letters (N \u201a V\u201a E) for the network, vertices, and edges in the organisms' network. In the metabolic network we will use roman lowercase letters for indices representing single metabolites in sums, while for the organisms network we use Greek letters for the indices representing single organisms.\n\nThe first step in our work is to construct for every metabolic model A a nondirected connected network N A = (V A , E A ) from the information contained in it. Here, V A stands for the set of nodes of A, and E A stands for its set of links. A metabolic model comprises a set of chemical reactions. Each chemical reaction associates a set of substrates with a set of products. For constructing the network, first we define the set of nodes V A as the set of compounds in A (metabolites present in the model), assigning a node to each metabolite. The chemical reactions in the model will define the links of the network. If two metabolites appear as a substrate and as a product, respectively, in a chemical reaction, a link connecting the correspondent nodes is added to the network. A typical metabolic model of a prokaryote, with around 1000 metabolites and the same number of chemical reactions, becomes through this process a nondirected connected network with 1000 nodes and approximately 3000 links.\n\nThe problem at hand is to elaborate a method to systematically compare and quantify the differences between two metabolic networks. For this purpose, we define a parameter that scales between zero and infinity, zero meaning identical networks and infinity for networks that either share no node or no link in common. The definition of this parameter is based on the identity of the nodes (the compounds) but not directly on the chemical reactions of the metabolic models, only indirectly through the links of the network.\n\nHere we start with the metabolic networks of two organisms A = (V A , E A ) and B = (V B , E B ). The set of all metabolites in between the two organisms\n\ncan be divided into a partition of three disjoint sets: the set of metabolites only present in A, the set of metabolites only present in B, and the set of metabolites common to both organisms:\n\n(1)\n\nwhere y stands for the difference of sets. A representation of this situation is shown in Figure 1 . As it is represented there, each metabolite may have connections to metabolites within its set and connections to metabolites in the other sets.\n\nWe can consider its degree in A [ B, that is, the total number of connections of v i to the rest of the metabolites of V A [ V B , that we denote by deg(v i ). We can also consider the degree of v i when we restrict ourselves to the subnetwork generated by the node in (V A yV B ), which we will call deg AyB (v i ). Similarly, we can also define deg A\\B (v i ) and deg ByA (v i ). With these degrees we can define, for each metabolite v i 2 V A [ V B , the rate p AyB,i of connections of v i to metabolites inside A and not in B with respect to the total number of connections of v i , that is:\n\nAnalogously, we can define\n\nThe following weighted sum of the rates p AyB,i provides a parameter of the differentiation of A [ B with respect to A:\n\nOn the one hand, the rates p AyB,i are multiplied by the inverse of the total number of connections of v i to give more importance to the metabolites with fewer connections. The reason to do this is that metabolic networks of all organisms usually share their hubs (metabolites with many connections), so in order to establish differences and similitude for different networks, one should focus on specific metabolites particular to only some organisms sharing common features. This weighting of p AyB,i with the inverse of deg(v i ) will reduce the importance of very connected metabolites (hubs) that are common to most organisms and adds weight to specific metabolites that might be particular for a branch in the tree of life, helping in this way to differentiate the branches. Removing this inverse weighting results in a very mild difference between the organisms, which makes the second step in the reconstruction very hard, because the differences will appear as a small noise in the parameters. On the other hand, the factor 1\n\ngives an average of the number of connections of the metabolites only present in A with respect to the whole network. This is done in order to rescale the size \n\nGAMERMANN ET AL.\n\nof the network and normalize (balance) the parameter after the inverse weighting done by the factor deg(v i ) for each metabolite in the set. Analogously, we can define b and c from the metabolites in the other two sets.\n\nFor illustrating the process, let's consider three organisms, the Synechocystis sp. PCC 6803 (which we refer to as syn), Synechococcus elongatus PCC7942 (referred to as syf), and the Escherichia coli K-12 MG1655 (referred to as eco). In Table 1 , you can see the number of metabolites and links in the networks of these organisms, and in Table 2 , we show the number of elements in each one of the three sets of the partition in which we split the set of nodes of the network obtained from each pair of these three organisms. Now let's focus on a few metabolites to see their contribution to the differentiation parameters (i.e., to the parameters a, b, and c). For this, we chose pyruvate (PYR), glyoxylate (GXL), and 2-dehydro-3deoxy-6-phospho-D-gluconate (6PDG), which are respectively very, medium, and poorly connected metabolites present in these three organisms. In Table 3 , we show the contribution of these metabolites to the parameters a, b, and c. Column d i of Table 3 shows, for each one of these metabolites, the value of\n\nwhich is the weight proportion associated with the metabolite (with respect to all others) discussed above in the text. Note that this weight for PYR is very small, since pyruvate has many connections and is a very common metabolite in the metabolism of virtually any organism, and therefore is not a good candidate to help differentiate branches in the tree of life. On the other hand, 6PDG has few connections and they are different in cyanobacteria than in the E. Coli, potentially helping, in this way, to differentiate these two branches. Finally, the comparison between the networks A and B, namely f A,B , is defined as:\n\nThe parameters a and b are balanced since some organisms have much smaller metabolic networks than others. If this is not corrected, it results in a disproportionate size between subnetworks generated by V AyB and V ByA . In order to weaken this difference, the parameter factors jV B j jV A j and jV A j jV B j are introduced. For two identical networks, a and b are zero, and so that f = 0. For two networks that do not have a single metabolite in common we have c = 0 and so f = N.\n\nGiven a set of n organisms fA 1 \u201a A 2 \u201a. . . \u201a A n g, we will see how to construct their phylogenetic tree taking into account the degrees of similarity between every pair of metabolic models. Firstly, let N = (V\u201a E\u201a w) be a nondirected, connected, complete weighted network, where V = fA 1 \u201a A 2 \u201a . . . \u201a A n g is the set of vertices that represent the metabolic models of the aforementioned organisms, E is the set of edges (A l \u201a A )\u201a 1 l\u201a n\u201a l 6 \u00bc , and w : E ! R is a function that assigns to every edge (A l \u201a A )\u201a the amount w l\u201a = f A l \u201a A . Looking at the definition of f, we observe that this network N must be symmetric. In particular, all the weights in our study are strictly positive.\n\nSecondly, we will compute a minimum spanning tree of N , that is, a tree that has V as the set of vertices, and such that the sum of the weights associated with the edges of this tree is minimum. In these trees, every vertex A l 2 V is connected with at least one of the other vertex of VyfA l g by an edge that has minimum weight among all the edges incident to A l . The well-known Kruskal algorithm gives us a procedure for finding these trees (see, for instance, Gross and Yellen, 2005) . We just have to follow the trace of the Kruskal algorithm in order to recover the phylogenetic tree of the organisms represented by the models\n\nIn order to compute the phylogenetic tree of the models fA 1 \u201a A 2 \u201a . . . \u201a A n g, consider the minimum spanning tree of N , namely T = (V\u201a E 0 \u201a wj E 0 ), where E 0 E and wj E 0 denotes the restriction of the function w to the elements in E 0 . Let us take all the elements of E 0 in decreasing order of weights, that is, E 0 = fe 0 1 \u201a e 0 2 \u201a . . . \u201a e 0 n -1 g with w(e 0 1 ) w(e 0 2 ). . . w(e 0 n -1 ). We are going to remove edges from T following this order. Every time an edge is removed, the number of connected components of the resulting graph is increased in one respect to the previous one. We can represent this division of connected components by a binary tree. The phylogenetic tree is generated taking into account how we divide T .\n\nThere are two different situations depending on the size of the (new) connected components (if any of them consists on a single vertex or not). Let us start with the edge with maximum weight in T which we have denoted as e 0 1 . Suppose that e 0 1 is adjacent to two vertices A l0 and A m0 , with 1 l 0 \u201a 0 n\u201a l 6 \u00bc . Then two possibilities can occur:\n\n(a) One of these vertices, for instance A l0 , is a leaf (vertex of degree 1), \n\nMetabolites in the three sets of the partition when comparing three organisms. Contributions of different metabolites to the differentiation parameter (f) between two networks. The column d i shows the weight of the metabolite in the calculation of p AXB,i , which is the inverse of the degree of the metabolite divided by the sum of the inverses of the degrees of all metabolites contributing to the parameter.\n\nGAMERMANN ET AL.\n\n(b) Neither of these two vertices is a leaf (each vertex is still connected with the other vertex). This happens only if the former connected component has three or more vertices.\n\nWe point out that our phylogenetic tree will have two types of vertices: the leaves, which represent metabolic models, and the inner vertices, which represent two branches that each have more than one vertex.\n\nWe start our phylogenetic tree with a vertex v 0 that will be its root. Then two vertices v 1 , v 2 are hanged from v 0 . Each one of these vertices represents one of the two connected components of the network Tyfe 0 1 g. Let us see what to do with v 1 and v 2 according to the case. If we are in case (a), one of these two vertices, for instance v 1 , represents the vertex A l0 , and v 2 represents the other connected component of T which is a subgraph of T generated by the vertex of VyfA l 0 g. If we are in case (b), one of the vertices, for instance v 1 , represents the connected component of T yfe 0 1 g that contains A l0 , and the other vertex, v 2 , represents the connected component of T yfe 0 1 g that contains A m0 . This procedure is repeated again with v 1 and v 2 and by removing e 0 2 from Tyfe 0 1 g. When we remove e 0 2 , then either the connected component that represents v 1 or v 2 is split into two smaller ones, and the vertex associated with this component plays again the role of v 0 . This process is repeated until we remove all the edges.\n\nLet us see with two examples how it works:\n\n1. In Table 4 , we have the weights associated with a set of 10 organisms. We can represent them by a complete weighted network in which every organism is connected with the others. This is a weighted network, so that we can apply the Kruskal algorithm in order to get a minimum spanning tree of this network, which is represented in Figure 2 . Following the aforementioned \n\nA minimum spanning tree associated with 10 organisms.\n\nnotation, e 0 1 corresponds to the edge that connects mge with tma, weighting 0.1159. We can see in Figure 3 that two vertices are hanging from the root of the tree. The one on the left represents the mge; the one on the right represents the subgraph associated with the rest of vertices, where tma can be found. 2. In the case of 38 organisms, when we remove from the minimum spanning tree the edge with maximum weight, we split this tree into two connected components: the one associated with the pair mge and mpm, and the one associated to the other vertices.\n\nFinally, the vertices in the phylogenetic tree can keep more information concerning the aforementioned minimum spanning tree. Suppose that the height of our phylogenic tree is w(e 0 1 ), which represents the maximum weight in the minimum spanning tree (i.e., the weight associated with e 0 1 ). We place the root of our phylogenetic tree at height y = w(e 0 1 ). Now, two vertex are hanged from the root. If one is associated with a single vertex, for instance, v 1 in case (a), then we place this vertex at height y = 0. We remember that this vertex represents the organism A l0 . If not, for instance, v 2 in case (a) and either v 1 or v 2 in case (b), each one of these vertices represents a connected component with more than one vertex in which the minimum spanning tree is split. In order to know at which height we should put these vertices, we have to continue removing edges from the former tree. After removing e 0 2 , one of these connected components, for instance, the one represented by v 2 , is split again into two smaller connected components. So we place the vertex v 2 at height w(e 0 2 ). We repeat this process recursively until the initial tree is just reduced to isolated vertices.\n\nWe have reconstructed two phylogenetic trees, one with 10 bacteria and another one with both prokaryotes and eukaryotes. In Table 4 we show the parameter f for the pairwise comparison of the 10 prokaryotes in the first tree. The data for the comparison of the 33 organisms in the second tree is given in the Supplementary Material (available online at www.liebertonline.com/cmb).\n\nThe organisms in each comparison are:\n\n10 organisms tree / Mycoplasma genitalium (mge), Lactobacillus plantarum WCFS1 (lpl), Synechocystis sp. PCC 6803 (syn), Synechococcus elongatus PCC7942 (syf), Synechococcus elongatus PCC6301 (syc), Clostridium beijerinckii (cbe), Burkhoderia cenocepacia J2315 (bcj), Escherichia coli K-12 MG1655 (eco), Thermotoga maritima (tma), and Yersinia pestis KIM10 (ypk). In Figures 3 and 4 we present the two phylogenetic trees that we have constructed. In the first tree, the only organism displaced in relation to what is expected from standard methods of phylogenetic tree reconstruction is the tma. In both trees mge (and mpm in the second one) diverges from other organisms at the beginning of the tree. This happens because of their minimalistic genomes, with only a couple hundred metabolites in their metabolomes. As a result, when compared with an organism without a reduced genome with almost a thousand metabolites, several hundred metabolites will not have a correspondent one, increasing hugely the value of a in the calculation of the parameter f, and therefore distancing these organisms from the rest. The problem with these parasitic organisms has been noticed elsewhere (Fukami-Kobayashi et al., 2007) , but unfortunately the solution found in this article did not yield better results in our present study. One should keep in mind that the present approach only considers genes (and proteins) associated with metabolic reactions and moreover, considers only the existence/absence of the enzymes (reactions). Our work yields results that are very close to the tree of life, in spite of using only a subset of all genome's information. It was not our intention to build trees that would address properly minimal organisms' phylogenies, but to prove the feasibility of building those trees using only reactome data. In any case, for the second study we used organisms from very different origins in the evolutionary history, and we found that the method is able to separate bacteria, archea, and eukaryotes. Different strains of the same species also appear closely related and share branches with organisms from the same family and order.\n\nWe have also studied the sensibility of the parameter f. For this we performed a Monte Carlo analysis of f. The procedure for this analysis is explained as follows. Given two organisms, one of them remains the wild type while, with the other, one builds an ensemble with N t elements, where each element is the result Sensibility calculation for N t = 500 and n K = 5. Each element in the table is the average of the parameter f in an ensemble plus (minus) its standard deviation ( f -r f ).\n\nGAMERMANN ET AL.\n\nof n K knock-outs (removal of n K randomly selected reactions from the metabolic model) in the organism.\n\nThen the calculation of f is performed between the wild-type organism and each organism in the knock-out ensemble. From this process one obtains an ensemble of N t values of f for the comparison (one from each version of the organism in the knock-out ensemble), from which one calculates its average and standard deviation. This standard deviation is treated as an indicator of the sensibility of the parameter (as a function of the number of knock-outs). We performed this sensibility analysis for four organisms (syn, syf, eco, and mge) with ensembles of sizes N t = 500 for n K = 5, 10, 50, and 100. The results are shown in Tables 5 through 8. These four organisms have been chosen to observe the sensibility in the comparison between very similar organisms (syn and syf), more distant ones (syn and eco), and very different ones (syn and mge).\n\nThis sensibility analysis mainly reflects the uncertainties in the calculation of the metabolic distances. Since the distance parameter is based on metabolic models, one relies in the genome annotations for each organism and any annotation is usually faulty. One may miss enzymes or wrongly annotate existing ones. The models used in this study have been automatically generated from a database constructed from information downloaded from the KEGG database (Kanehisa and Goto, 2000) , and since the beginning of this study the databases have been updated and most models have to be changed as well. The ''knockedout'' models used for the sensibility parameter analysis simulate such imperfect annotations: one might consider the situation with n K = 5 as the model constructed from a well-annotated genome, while the case with n K = 100 is the model resulting from a very poor annotation. One can see that when only a few enzymes might be missing from the annotation, the error in the parameter can be expected to be less than 1%, except for the case of the minimalistic genomes like the parasitic mge, that has an error more than five times bigger than the other organisms. This error increases as the number of knock-outs increase, but it keeps below 5% even for 100 knockouts (or missing enzymes), except again in the case of the mge, but even for the mge it is below 10%. This shows that the methodology is robust and that one works here with an uncertainty of less than 5% in most of the cases.\n\nIn this work, we have developed a methodology for comparing organisms based on their metabolic networks. This methodology has been successfully applied for the reconstruction of phylogenic trees for several organisms from a broad range of families and kingdoms. Resulting trees stand up well to their comparison with the so-called ''tree of life.'' The great majority of the branches in the tree fit their expected Sensibility calculation for N t = 500 and n K = 50. Each element in the table is the average of the parameter f in an ensemble plus (minus) its standard deviation ( f -r f ). positions well and their distance is in good correlation with evolutionary distances. The discrepancies found can be explained by particularities in these very few organisms not fitting the tree, such as tremendous genome reductions that caused reduced metabolisms.\n\nOur methodology is innovative for it is not directly based on the structure and evolution of proteins or DNA but on the metabolism and the organisms' components and metabolic capabilities, allowing one to compare organisms very distant from the evolutionary point of view or organisms for which orthologs' comparison is difficult. In order to accomplish this, we make use of the correlation between evolutionary distances and metabolic network likelihood and propose our methodology as a starting point to study it.\n\nMetabolism information is retrieved as a subset of the whole genome information. We hereby show that metabolic network connectivity can be used to build phylogenetic trees that are in accordance with genedirected trees. It can be argued whether the selected construction parameter (f) is the optimal one for this purpose (or even if there is an optimal one), but it stands clear that this is an innovative application for metabolic models, their curation, and cross-species evolutionary studies.\n\nWe have also performed a sensibility study in which we show that the methodology is robust even if the annotation information used to construct the metabolic models is faulty. This study also suggests an upperbound for the uncertainty in the distance parameter of approximately 5%."}