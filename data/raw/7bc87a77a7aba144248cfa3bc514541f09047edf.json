{"title": "A new phylogenetic protocol: Dealing with model misspecification and confirmation bias in molecular phylogenetics", "body": "Molecular phylogenetics plays a pivotal role in the analysis of genomic data and has already had a significant, wide-reaching impact in science, industry, government, public health, and society (Table 1 (1-41)). Although the science and methodology behind applied phylogenetics is increasingly well understood within parts of the scientific community (42), there is still a worryingly large body of research where the phylogenetic analysis was done with little attention to the consequences of a statistical misfit between the phylogenetic data and the assumptions that underpin the phylogenetic methods.\n\nOne reason for this is that phylogenetics relies extensively on statistics, mathematics, and computer science, and many users of phylogenetic methods find the relevant sections of these disciplines challenging to comprehend. Another reason is that methods and software often are chosen because they already are popular or easy to use, rather than because they are the most appropriate for the scientific questions and phylogenetic data at hand. A third reason is that much of the phylogenetic research done so far has relied on phylogenetic protocols (43-48), which have evolved to become a standard to which it seems sensible to adhere. Although these protocols vary, they have, at their core, a common set of sensible features that are linked in a seemingly logical manner (see below).\n\nHere we posit that, although the current phylogenetic protocol has many useful features, it is missing two crucial components whereby the quality of fit between the data and models applied is assessed. This means that using the phylogenetic protocol in its current form may lead to biased conclusions. We suggest a modification to the protocol that will make it more robust and reliable.\n\nPhylogenetic analysis of alignments of nucleotides or amino acids usually follows a protocol like that in Figure 1 . Initially, the phylogenetic data are chosen on the assumption that they will allow the researchers to solve a particular scientific problem. This choice of sequences data is often based on prior knowledge, developed locally or extracted from the literature.\n\nThen, a multiple sequence alignment (MSA) method is chosen, often on the basis of prior experience with a specific method. The sequences are then aligned, the aim being to obtain an MSA, wherein homologous characters (i.e., nucleotides or amino acids) are identified and aligned. In practice, it is often necessary to insert gaps between some of the characters of these sequences to obtain an optimal MSA-in some cases, there may be sections of the MSA that cannot be aligned reliably.\n\nThen follows the task of selecting sites that will be used to infer the phylogenetic tree. The rationale behind doing so is to maximize the signal-to-noise ratio in the MSA. By omitting poorly-aligned and highly-variable sections of the MSA, which are thought to create noise due to the difficulty of establishing true homology for each site (defined as similarity due to historical relationships by descent (49)), it is hoped that the resulting sub-MSA will retain a strong historical signal (defined as the order and timing of divergence events (50)) that will allow users to obtain an accurate phylogeny. The choice of sites to retain is made by visual inspection of the MSA or by using purpose-built software (51-61). The automated ways of filtering MSAs have been questioned (62).\n\nHaving obtained a sub-MSA, the next step in the protocol is to select a phylogenetic method.\n\nThe choice of phylogenetic method implies accepting the assumptions on which the method rests. For example, it is often assumed that the sequences evolved along a single bifurcating tree and that the evolutionary processes operating at the variable sites in the sequences are independent and identically-distributed processes. If model-based molecular phylogenetic methods are chosen, the underlying assumption usually is that the evolutionary processes operating at the variable sites can be approximated accurately by using Markov models that are stationary, reversible, and homogeneous (63-65) over time (the assumption of evolution under SRH conditions). In practice, the choice is one between methods assuming that the underlying evolutionary processes can be modelled using a Markov model of nucleotide or amino-acid substitutions (i.e., distance methods (66-71), likelihood methods (66,68,70-76), analysis. However, if a researcher's expectations are met by the phylogenetic results, it is more likely that a report will be written without a further assessment of what might have gone wrong during the analysis. This tendency-allow prior expectations to influence the interpretation of phylogenetic estimates-is called confirmation bias. Confirmation bias is not discussed in phylogenetics, even though it is well recognized as a critical factor in other disciplines (e.g., psychology and social science (121)), so it is timely that the phylogenetic community takes onboard the serious implications of this.\n\nAlthough the current phylogenetic protocol has many shortcomings, it also has many good attributes, including that it is easy to apply and implement as a pipeline. But to mitigate its limitations, it will be necessary to redesign the protocol to accommodate well-established, but largely-ignored, procedures as well as new feedback loops. Figure 2 shows a proposal for new phylogenetic protocol. It shares many features found in the current protocol (e.g., the first four steps). However, the fifth step (assess phylogenetic assumptions) will be novel to many researchers. As all phylogenetic methods are based on assumptions, it is sensible to validate these assumptions at this point in the protocol. Since many phylogenetic methods assume that the data (e.g., different genes) have evolved over the same tree, and that the chosen data partitions have evolved independently under the same time-reversible Markovian conditions, it is wise to survey the sub-MSA for evidence that the sequences actually have evolved under these conditions. If the data violate these phylogenetic assumptions, then it will be wise to avoid these phylogenetic methods and to employ other such methods. Alternatively, it may be worth following the relevant feedback loops in Figure 2 -perhaps something led to a biased sub-MSA? The relevance and benefits of this step are illustrated using a case study (Box 1), which focuses on determining whether a data set is consistent with the phylogenetic assumption of evolution under time-reversible conditions. Assessments of other phylogenetic assumptions require other types of tests and Next follows the choice of phylogenetic method, but now this choice is made on the basis of the previous step, rather than on cultural or computational reasons. If the sequences have evolved on a single tree under time-reversible Markovian conditions, there is a large set of phylogenetic methods to choose from (66-85). On the other hand, if these data have evolved under more complex Markovian conditions, the number of suitable phylogenetic methods is, frustratingly, rather limited (5,64,146-171), and most of these methods are aimed at finding the optimal model of sequence evolution for a given tree rather than finding the optimal set of trees. Users of phylogenetic methods therefore are sometimes confronted by a dilemma:\n\nDo they abandon their data set because it has evolved under non-time-reversible conditions and because there are no appropriate phylogenetic methods for such data, or do they take the risk and employ the phylogenetic methods that assume evolution under time-reversible conditions? Fortunately, there may be a way around this dilemma.\n\nHaving inferred the phylogeny using model-based phylogenetic methods, it is possible to test the fit between tree, model and data (step 10 of the new protocol). A suitable test of goodness-of fit was proposed in 1993 (172) (Fig. 4) . In brief, using the inferred optimal tree, including the edge lengths, it is possible to simulate data sets under the null model (i.e., the inferred optimal model of sequence evolution with its parameter values included). This is called a parametric bootstrap. Given this tree and this model of sequence evolution, several sequence-generating programs (5,160,173-175) facilitate procurement of pseudo-data.\n\nHaving generated, say, = 1,000 pseudo-data, the next step involves finding the difference (\u03b4) between the unconstrained (i.e., without assuming a tree and a model) and constrained (i.e., assuming a tree and a model) log-likelihoods (i.e., \u03b4 = ( ) \u2212 ( | , ), where is the data, is the tree, and is the model of sequence evolution). If the estimate of \u03b4 is greater for the real data than for the pseudo-data, then that result reveals a poor fit between tree, model, and data (136). The approach described here works well for likelihoodbased phylogenetic analysis and a similar approach is available for Bayesian-based phylogenetic analysis (176). Parametric bootstrapping is computationally expensive and\n\nResults emerging from studies that rely on the new phylogenetic protocol might well call into question published phylogenetic research, but there is also a chance that research might gain stronger support. This is good for everyone concerned, especially since it will become easier to defend the notion that the research was done without prejudice or preference for a particular result. Objectivity should be restored in phylogenetics-it is no longer reasonable to defend phylogenetic results on the basis that they were obtained using the best available tools; if these tools do not model the evolutionary processes accurately, then that should be reported rather than be hidden away. This is critical as it increases transparency and aids other researchers to understand the nature of the challenges encountered.\n\nNotwithstanding the likely benefits offered by the new phylogenetic protocol and the methods supporting it, it would be unwise to assume that further development of phylogenetic methods will no longer be needed. On the contrary, there is a lot of evidence that method development will be needed in different areas: \u2022 Analysis of Residuals -Although goodness-of-fit tests can tell you whether or not the lack of fit observed is potentially due to chance, they do not answer the more useful question of whether or not that lack of fit matters or how the lack of fit arises (180,181). For this reason, residual diagnostic tools that can inform the user about the way in which their model fails to fit the data would be very useful.\n\nIn summary, while calls for better phylogenetic methods and more careful considerations of the data have occurred (119), we posit there is a need for a comprehensive overhaul of the current phylogenetic protocol. The proposed new phylogenetic protocol is unlikely to be a final product; rather, it is probably a first, but important step towards a more scientifically sound phylogenetic protocol, which not only should result in more accurate phylogenetic estimates and but also to a reduction in the likelihood of confirmation bias.\n\n. CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/400648 doi: bioRxiv preprint\n\nThe Holy Grail in molecular phylogenetics is being able to obtain accurate, reproducible, transparent, and trustworthy phylogenetic estimates from the phylogenetic data. We are not there yet, but encouraging progress is being made in not only in the design of the phylogenetic protocol but also in phylogenetic methodology based on the likelihood and Bayesian optimality criteria.\n\nNotwithstanding this progress, a quantum shift in attitudes and habits is needed within the phylogenetic community-it is no longer enough to infer an optimal phylogenetic estimate.\n\nThe fit between trees, models, and data must be evaluated before phylogenetic estimates can be considered newsworthy. We owe it to the scientific community and wider public to be as rigorous as we can-the attitude \"She'll be alright, mate\" is no longer appropriate in this discipline.\n\nTo illustrate the relevance and benefits of the fifth step in the new phylogenetic protocol, we examined the phylogenetic data used to infer the evolution of insects(3). The tetrahedral plots in Figure 3a -3c reveal that the nucleotide composition at the three codon positions is heterogeneous, implying that the evolutionary processes that operated at these positions are unlikely to have been time-reversible. However, the plots are deceptive because the presence of constant sites (i.e., sites with the same nucleotide or amino acid) in the data can mask how compositionally dissimilar the sequences actually are. To learn how to resolve this issue, it is necessary to focus on the evolution of two sequences on a tree (Fig. 3d ) and the corresponding divergence matrix at time 0 (Fig. 3e) and at time (Fig. 3f) . At time 0, the two sequences are beginning to diverge from one another, so the off-diagonal elements of the divergence matrix are all zero. Later, the divergence matrix may look like that in Figure 3f . All the off-diagonal elements are now greater than zero, and the so-called matching offdiagonal elements of the divergence matrix might differ (i.e., 23 \u2260 32 ). The degree of divergence between the two sequences can be inferred by comparing the off-diagonal elements to the diagonal elements, while the degree of difference between the two evolutionary processes can be inferred by comparing the above-diagonal elements to the below-diagonal elements. If the two evolutionary processes were the same, the matching off-diagonal elements in Figure 3f would be similar. A lack of symmetry (i.e., 23 \u2260 32 ) implies that the evolutionary processes along the two descendant lineages may be different. Because the dots in these plots do not fall along the diagonal line in the plots (showing that a lack of symmetry is not statistically significant), there is an overwhelming evidence that the evolutionary processes at these positions do not match a time-reversible Markovian process.\n\nThe same is the case for the corresponding amino acid alignment (not shown). Therefore, it would be unwise to assume that the data evolved under time-reversible conditions. A more complex evolutionary process is likely to explain these data, so the time-reversible Questions and methods pertaining to pre-phylogenetic surveys of phylogenetic data Are evolutionary processes Markovian (122-124)?\n\nAre evolutionary processes independent and identically distributed (125-128)?\n\nAre evolutionary processes stationary, reversible, and homogeneous (50,129-138)?\n\nAre evolutionary processes heterotachous (139)?\n\nIs the phylogenetic signal in phylogenetic data tree-like (140,141)?\n\nIs the historical signal in phylogenetic data decayed (142)?\n\nIs the compositional signal in phylogenetic data stronger than expected (142)?\n\nHow phylogenetically informative are phylogenetic data (143-145)?\n\n. CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/400648 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/400648 doi: bioRxiv preprint"}