{"title": "Original papers", "body": "Newcastle Disease (ND) is a contagious bird disease, which is prevalent in both domestic and wild species and was first diagnosed in Newcastle, England, in 1926 (Morgan, 1946 . It is characterized by respiratory and nervous signs, bleeding lesions in the digestive system and mild infections in the respiratory system. Newcastle Disease is a single-stranded RNA virus that threatens poultry health and causes great economic losses (Nidzworski et al., 2013) . Newcastle Disease causes a very fatal disease in chickens classified under a single avian paramyxo virus serotype 1 (APMV-1). NDV shows a spectrum of virulence, with strains in NDV, causing infection (lentogenic strains). It shows moderate virulence (mesogenic strains), and exhibits very high virulence (velogenic strains), and the velogenic strains cause 100% mortality (Alexander, 2001; Capua and Alexander, 2009 ).\n\nBronchitis Virus (BV) is the type of species of the genus coronavirus of the family coronaviridae. It is an acute and highly contagious viral disease causing severe economic losses for those involved in the chicken industry (Cook and Mockett, 1995; Malik et al., 2004) . BV was first reported in the United States as a new respiratory disease for baby chicks in 1931 (Schalk and Hawn, 1931) . Confirmation of a diagnosis of infectious bronchitis relies on laboratory findings involving serology (Ganapathy, 2009) . BV is a hard to diagnosed and this disease may be mistaken for other diseases such as avian influenza, and avian Newcastle Disease (Ganapathy, 2009) .\n\nAvian Influenza (AI) is also one the contagious avian respiratory disease. AI is caused by a type an orthomyxovirus. The influenza virus has two major surface glycoproteins-hemagglutinin (HA) and neuraminidase (NA), and 16 HA and 9 NA subtypes are recognized (Abdoshah et al., 2012) . Many species of birds, domesticated or wild, can be infected with the virus (Stallknecht and Shane, 1988) . Clinical signs; are swelling of the periorbital tissues and sinuses, nasal and ocular discharge, and respiratory distress (Nili and Asasi, 2002) . AI has also caused disease in human (Lin et al., 2000; Naeem et al., 1999; Peiris et al., 1999) , subtypes such as H5N1, H7N7, and H9N2 have also infected the human life (Guo et al., 1999; Haryanto et al., 2013) .\n\nAlthough the clinical signs such as diarrhea and nasal discharge are variable and influenced by other factors, none can be regarded as pathognomonic. Also, avian Paramyxo virus infections have usually been diagnosed by serology virus isolation (Alexander, 2000) . Additionally, diarrhea, nasal discharge and other complications are symptoms not only of Newcastle Disease but may be mistaken for other diseases such as Avian Influenza or fowl cholera. (Hinrichs et al., 2006) . ND, BV and AI cannot only be diagnosed by clinical signs with certainty, and their rapid diagnosis is essential for reducing losses and preventing their spread (Rahimian et al., 2011) .\n\nThere are some certain diagnostic ways available for detecting Newcastle Disease, Bronchitis Virus and Avian Influenza. Several tests are available to detect these diseases, including RT-PCR, real-time RT-PCR, ELISA tests (Corman et al., 2013; Haryanto et al., 2013 Haryanto et al., , 2015 Nidzworski et al., 2013) . The viral genome amplification using RT-PCR method for diagnosing poultry diseases is common. RT-PCR can detect only a single virus at a time and the multiplex RT-PCR technique was developed to detect more than one virus.\n\nAlthough rapid detection of viral diseases is an important aspect of the economics of poultry production, current methods such as ELISA are time consuming (Kataria et al., 1998) and other methods need expert personnel and expensive equipment to confirm the presence of the pathogen (Soltan et al., 2016) . As a result, by applying an automatic device with an alarm for key avian diseases, farmers could be given the opportunity to undertake the necessary actions in order to prevent the disease occurring.\n\nThere are several studies in the literature where artificial intelligence has been applied in animals. Acevedo et al. (2009) designed an automated system to detect and classify calls of nine frogs and three bird species (Acevedo et al., 2009) . Gutierrez et al. (2010) classified porcine wasting diseases of pigs using sound analysis and labeling method. Pig's cough were recorded by microphone and the sound's feature like intensity, duration and pitch were extracted. They could detect and classify circovirus type 2 (PVC2), porcine reproductive, respiratory syndrome (PRRS) virus, and Mycoplasma hyopneumoniae (MH) diseases using sound's pitch-and-intensity analysis. Furthermore, cough duration was excluded because it couldn't find statistical difference between treatments (Gutierrez et al., 2010) . Kasten et al. (2010) classified the bird species based on bird sound. Different feature functions of the signals were extracted to classify the bird sounds. They found that bird gender and species can be identified based on their sounds (Kasten et al., 2010) . Lee et al. (2015) detected pig-wasting disease by using support vector machine (SVM) and acoustic features. In their research, 60 statistical parameters were extracted as signal indexes and the best features (RMS, Max Pitch, PSD, Peak frequency) were selected by using acoustic feature subset selection algorithm (AFSSA) method, which were used as inputs of the classifier (Lee et al., 2015) . Since it is possible to detect sound signal features, different types of analyses can be performed. Analysis of chicken's vocalization is a powerful tool to study about animal behavior and welfare (Exadaktylos et al., 2014) . Numerous factors such as diseases, weakness and species can change bird-generated sound signals. Sadeghi et al. (2015) designed an intelligent procedure for detecting chickens infected by Clostridium perfringens based on their vocalization. Chicken's vocalization was analyzed in time domain, and 25 statistical features were extracted from sound signals and the best features were selected using FDA method to be ANN's input data (Sadeghi et al., 2015) .\n\nAlthough these studies have concentrated on sound analysis of animals, no specific sound processing for different diseases detec-tion were investigated in chickens. Therefore, the main aim of this study was to develop an artificial intelligence methodology based on signal processing to diagnose Newcastle Disease, Bronchitis Virus and Avian Influenza for rapid, efficient and simultaneous amplification. The Dempster-Shafer evidence theory (D-S) was used for decision fusion of sensors and the outputs of the SVM were considered as the inputs of D-S.\n\nThe study experiments were carried out in the Agricultural School of Tarbiat Modares University, Tehran, on a brood of chickens. The strain name of NDV was IR/IRK 1 /2013, and its molecularand-pathological characterization was carried out in RAZI institute, Karaj, Iran. Virulence type of the NDV in this study was velogenic strains and NDV tropism was viscerotropism, which mainly affects the respiratory system. The Avian Influenza virus in this study was H9N2. Fourteen-day old Ross 308 chickens were divided into four groups of 60 and each group was kept in a separate room. The first group was considered as control samples. The second, third and fourth group were infected by using Newcastle Disease, Bronchitis Virus and Avian Influenza, respectively by eye drops (0.1 cc for each eye). Fig. 1 shows the chickens and virus infection.\n\nND, BV and AI infection were verified using the RT-PCR test and virus isolation from infected tissues simultaneous with clinical signs. In this paper, RT-PCR was done using protocol 2 which has been described by Capua and Alexander for Avian Influenza and Newcastle Disease (Capua and Alexander, 2009 ).\n\nThe first five minutes of recordings were not taken into account during the sound analysis because the behavior of the chickens might have been effected by the operator during the holding them inside of 50 cm 3 cubes. In order to obtain sound features of chickens and detecting disease without any surrounding noises all samples (chickens) put in the box. (Microphone specifications: 9.7 \u00c2 6.7 mm diameter, less than 2.2 kX impedance, 100-16 kHz frequency, and \u00c058 dB \u00b1 3 dB sensitivity). Recordings were saved in the ''wav\" format and signals in time domain were transformed into the frequency and time-frequency domains and analyzed in Matlab \u00d2 2015a (the Mathworks Inc., Natick, MA, USA). A total number of 720 sound signals were collected from 240 samples in two consecutive days after virus infection. Fig. 2 represents the proposed algorithm for diagnosing the avian Newcastle Disease, Bronchitis Virus and Avian Influenza based on their sound signals. Based on Fig. 2 , the chicken's sound signals are firstly transferred to frequency and time-frequency domain using Fast Fourier Transform and Discrete Wavelet Transform. The next stage is Data-Mining part, which is consists of feature extraction and feature selection. After Data-mining stage, the SVM classifier will be trained and evaluated in diagnosing the diseases. The outputs of SVM based on frequency and time-frequency signals were considered as evidences of the Dempster-Shafer evidence theory, and finally the disease will be detected by the model.\n\nThe first advantage of signal processing is to obtain useful and necessary information out of a signal that normally is not available in the unprocessed signal. Other advantages of signal processing are removing and reducing noise effects, accessing the signal's hidden contents, extracting frequency and time-frequency information, and producing a better signal for effective Data-mining (Wang et al., 2010; Zhan and Makis, 2006) . There are many techniques for signal processing i.e. Wavelet analysis, Fast Fourier Transform (FFT), Short Time Fourier Transform (STFT).\n\nIn the present study, FFT and Discrete Wavelet Transform (DWT) were used to transform data from time domain into frequency and time-frequency domain, respectively. FFT is the most common method in frequency domain, which is defined as followings (Zhu et al., 2009) \n\nwhere ''t\" and ''f\" are time and frequency, respectively, and x(f) is the Fourier transform of the time-domain signal x(t). Frequency information of the signals can be identified by using FFT method. Discrete wavelet transform is a 2-dimensional signal analysis used for achieving simultaneous time and frequency transparencies. Wavelet transform does not treat all frequency components of a signal similarly. While, WT presents an accurate time-transparency for rapid variations, and an accurate frequency transparency for slow-ing variations (Banakar and Azeem, 2008; Misiti et al., 1996) . An advantage of WT is denoising, therefor it is suitable for analyzing noisy signals (Marchant, 2003) . DWT is defined as (2) (Khanam et al., 2014) :\n\nIn Eq.\n\n(2), w is a function characterized by a determined length, an average of zero and a cyclic behavior, which is transient and responsible for signal windowing. In fact, w, known as mother wavelet, is a model for reconstructing the primary signal. In DWT, each signal is divided into two components of high and low frequencies. The low and high frequencies are known as approximation (A j ) and details (D j ), respectively (Yan et al., 2014) . There are several reports of successful applications of DWT in fault location and biological systems (Abbasion et al., 2007; Gupta et al., 2007) . The original signal can be defined as: \n\nThe first-order Daubechies mother wavelet to process signals up to two levels was used in this study. The level of wavelet was selected by trial and error (Gawali et al., 2015) .\n\nThe outputs of any signal processors might not be used as inputs of classifier because the processed signals contain a large number of groups of raw data, therefore some statistical functions should be extracted to define a signal state and to prepare information. Table 1 illustrates all 25 statistical features used in this study to extract statistical information from Frequency domain signals, approximation and details coefficient of DWT (Khazaee et al., 2013; Lei et al., 2008) . In this table, x(n) is a time domain signal for n data points (n = 1, 2, . . ., N).\n\nQualitative and quantitative aspects of the features should be considered during feature selection stage. The bigger number of feature functions means that the more complex classification result, and the feature quality mostly used in recognizing of a signal is an important parameter. The improved distance evaluation method has been used for selecting the best extracted features. The aim of IDE is to collect the best feature with highest difference between the groups and the lowest difference within the groups (Lei et al., 2008) . Features that have these conditions will be selected as the best ones. The method's parameters were defined as: fq m;c;j ; m \u00bc 1; 2; . . . ; Mc; c \u00bc 1; 2; . . . ; C; j \u00bc 1; 2; . . . Jg \u00f0 4\u00de\n\nwhere q m,c,j is the eigenvalue of the jth feature from the mth sample of class c. M c represents the number of samples in the cth class, and J stands for the number of features in each class. Using the abovementioned parameters, IDE relations are defined as following steps (Lei et al., 2008) :\n\nStep 1: Computing the mean distance between samples in a given class:\n\nFinding the mean distance values of a feature for each class:\n\nSmaller mean feature distances within a class show that the feature is less scattered in that class; in other words, the smaller the parameter for a feature, the more suitable that feature is for recognizing a signal related to that class.\n\nStep 2: Defining the variance corresponding to d j (w) based on the\n\nStep 3: This step involves computing the intra-class mean distance values of features. Before this, the mean feature value of each class is defined as follows:\n\nThen, the mean distance between intra-class features is determined:\n\nThis step, in fact, determines the distance between the feature values of two classes. Larger distances present better criteria for distinguishing between two classes.\n\nStep 4: Defining the variance corresponding to d j (b) based on the following equation:\n\nv \u00f0b\u00de j \u00bc max ju e;j \u00c0 u c;j j \u00c0 \u00c1 min ju e;j \u00c0 u c;j j \u00c0 \u00c1 \u00f010\u00de\n\nStep 5: Defining and computing the reward factor:\n\nStep 6: Features are scored based on the d j (b) to d j (w) ratio, with regard to the reward function described below:\n\nEq. (12) implies that the highest score is given to the feature with the largest intra-class and the lowest inter-class differences.\n\nStep 7: Finally, the following equation was used to normalize the score of each feature, and the best feature was selected based on an arbitrary threshold:\n\nSVM is a robust classifier first introduced by Cortes and Vapnik in 1995 which was based on the Statistical Learning Theory (Cortes and Vapnik, 1995) . Separating classes using a hypothetical hyper plane is the main idea of it. SVM models were originally introduced Table 1 Features extracted from chicken's sound signals.\n\nFeature's formula\n\nfor the classification of linearly separable classes of objects. Fig. 3 shows the maximum separation hyper plane for a twodimensional object belonging to two classes (class +1 and class \u00c01). For any particular set of two-class objects, SVM finds a unique hyper plane having the maximum margin (Ivancius, 2007) .\n\nThis classifier intends to maximize the margin between two classes. Although SVM was originally designed for binary (2classes) classification (Cortes and Vapnik, 1995) , it has been applied to solve multiclass problems. Currently, there are three main methods for using SVM to solve multiclass issues. One builds a multiclass SVM by combining several 2-class SVMs, including one-against-one (OAO) and one-against-all (OAA). The third method considers all classes at once, called all-together. A good review of SVM and its equations has been presented by (Widodo and Yang, 2007) . In the present study, OAO multiclass method was used to make multiclass SVM. The performance of the classifier can be calculated by computing SVM's statistical parameter like Sensitivity, Specificity and the total classification accuracy, as followings (\u00dcbeyli, 2008) : \n\nD-S evidence theory was produced by Shafer, in 1976 as a powerful tool for representing uncertain knowledge (Al-Ani and Deriche, 2002) . D-S evidence theory has been established based on combining measures of evidence. In this method, the outputs of the classifier are considered as the evidence and are also used as the inputs of D-S. This theory has inspired many researchers to investigate different aspects connected with uncertainty and lack of knowledge and their applications in real life problem (Zhu, 2002; Ruhm, 2007) . Each feature was scored based on the IDE method, and the data with the highest scores were adopted as the best features, which were considered as SVM inputs.\n\nFigs. 4 and 5 show the feature scores extracted from the frequency domain signals and the second level of the wavelet coefficients, respectively. According to Fig. 4 , there is a significant distance between F 5 and F 1 , so the threshold was set at 0.5. Therefore, 5 features were selected as the best sound features in frequency domain.\n\nAccording to Fig. 5 , there is a significant distance between F 9 and F 34 , so the threshold was 0.6. Accordingly, 5 features were selected as the best sound features (F 33 , F 7 , F 32 , F 2 , and F 9 ). These features were considered to diagnose Newcastle Disease, Bronchitis Virus and Avian Influenza based on chicken's sound. Features 1-25 belong to the approximation coefficients, features 26-50 and 27-75 refer to the first and second levels of the detail coefficients, respectively. As can be seen from the selected features, F 7 , F 2 and F 9 are approximation coefficients, F 33 and F 32 are firstlevel of detail coefficients, and no features were considered from the second-level of the detail coefficients. Therefore, the most important information of the sound signal was hidden in the approximation coefficients and in the first level of the detail coefficients.\n\nTime domain of the chicken's sound signals of the four classes of healthy, Newcastle Disease, Bronchitis Virus and Avian Influenza are shown in Fig. 6 .\n\nTime domain of the sound signals were transferred to frequency and time-frequency domains using fast Fourier transform and wavelet transform. Fig. 7 shows healthy, Newcastle Disease, Bronchitis Virus and Avian Influenza sound signals in time-frequency domain. The approximation (a2) and details (d2 and d1) of the four classes have some differences, which should be identified.\n\nThe selected features in the feature selection stage were used as SVM inputs. The data included a total of 720 sound signal samples, 180 recordings for healthy, ND, BV and AI. 75% of the samples (540 sound signal samples) were selected randomly and used for SVM training purposes. The rest of the samples (25% or 180 sound samples) were used for testing SVM to determine its diagnosis accuracy.\n\nSVM parameters (C and Sigma) were determined by trial and error and classification results of SVM were displayed by a confusion matrix. For model generalization, the data were randomly selected 10 times and the average performance was reported. Table 2 shows the confusion matrix of the second day after virus infected on testing data based and frequency domain. Based on Table 2 , maximum classifier accuracy in the frequency domain was obtained 41.35%. Each of Sensitivity and Specificity has a special characteristic. Sensitivity introduces the accuracy of the diagnostic system for detecting each chicken's state, while Specificity presents the accuracy of the diagnostic system to reject other chicken's state. In the frequency domain, Sensitivity of the SVM to classify healthy, ND, BV and AI was obtained 40, 42.10, 46.87 and 36.36%, respectively. To obtain information of the chicken's sound, the signals were transferred to time-frequency domain. Table 3 shows the performance of SVM based on wavelet transform in time-frequency domain. As it is shown in the table, the SVM accuracy increases when the signals are transferred to timefrequency domain. The maximum accuracy of SVM was calculated 83.33% based on wavelet transform. Other literature have also confirmed that the performance of WT is better than FFT (Akin, 2002; Peng et al., 2005) . Table 3 , Sensitivity of the SVM to detect the AI is higher than other diseases. So it can be inferred that the classifier was more sensitive to detect the Avian Influenza than other diseases.\n\nAs mentioned in the material and methods section, to have a better estimation about the reality, measures of evidence should be combined. So the outputs of SVM in frequency and timefrequency domains were used as inputs of Dempster-Shafer evidence theory to have a good estimation about the diseases. Table 4 shows the results of combining the outputs of SVM as evidence of this theory. Based on the table, the total classification accuracy has increased to 91.15% after using D-S evidence theory. It also confirmed by (Ai et al., 2008) for the role of D-S evidence in increasing of accuracy. Khazaee et al. (2012) represented data fusion approach to vibration condition monitoring of planetary gears by using ANN and SVM classifiers. They confirmed that the accuracy of the classifier increase more than 14% by using D-S evidence theory and data fusion (Khazaee et al., 2012) . Maximum Sensitivity of the D-S evidence theory was obtained based on AI among other diseases and it can be inferred that detection of AI based on chicken's sound signals was much easier than ND and BV. Since the Sensitivity of D-S to detect the healthy, ND, BV and AI was obtained 95.8, 88.5, 88 and 92.3%, respectively, it can be said that sound of the infected chickens have completely affected by the viruses. pig wasting disease by using SVM and acoustic features with 98.4% accuracy (Lee et al., 2015) . Sadeghi et al. (2015) designed an intelligent procedure for detecting and classifying of chickens infected by Clostridium perfringens based on their vocalization using artificial neural network (Sadeghi et al., 2015) . In these researches, special sort of diseases have been considered and sick and normal animals were detected biased on the sound analysis. While, in the present study, D-S evidence theory not only can distinguish sick and normal chickens but may also able to detect a specific virus infection.\n\nThe proposed method in this study was implemented on a sound card (Fig. 8) . In Fig. 8 , the structure of intelligence diagnosing avian diseases was programmed by using Code Composer Studio v.5 and C programming language. As shown in Fig. 9 , the chicken's sound is processed using DWT and FFT. In the next step, 5 features, which were selected in feature selection part, will be extracted from the sound signal in frequency and time-frequency domains. Sequentially, the classes of the sound were determined by using SVM and finally, the outputs of SVM in frequency and time-frequency were combined by using D-S evidence theory.\n\nIn this study, a method with high enough performance was proposed for intelligent diagnosing of Avian Diseases based on chicken's sound signals. For this purpose, an electronic device was developed and ND, BV and AI were diagnosed with high accuracy. This is a nondestructive, fast and automatic instrument in diagno-sis avian diseases. For further application of this method, other common diseases also should be evaluated and the method needs to be tested in farm condition which may have different noises. The Table 2 The results of classification in frequency domain. Table 3 The results of classification in time-frequency domain. Table 4 The results of data fusion. results suggest that this intelligent technique performed successfully in diagnosing ND, BV and AI from the chicken's sound signals which could be as a fast technique in order to decline the number of disease spreading and mortality in chicken's farm. The results also offer the use of intelligent methods for diagnosing diseases in other species of poultry."}