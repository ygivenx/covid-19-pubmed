{"title": "Characterizing the dynamics underlying global spread of epidemics", "body": "Since the 1980s, metapopulation epidemic models built with worldwide air-transportation network (WAN) data have been the main tool for studying global spread of epidemics, such as pandemic influenza1\u20134, SARS5,6, MERS-CoV7, Ebola8, and Zika9,10. The complexity of these models has substantially grown over the past few decades, advancing from 55 populations in the Rvachev\u2013Longini model in 19851 to more than 3500 populations in the state-of-the-art simulator GLEAM powered by supercomputer11,12. Despite the long history and widespread use of these models13\u201317, most studies on global spread of epidemics have relied on computationally intensive simulations that provide limited epidemiologic insights, whereas an analytical understanding of the underlying epidemic dynamics has only been partially elucidated in recent years18\u201320. Here, we build on these recent advancements and develop a novel framework for analytically characterizing how epidemic arrivals for different populations around the world depend on the epidemiologic parameters and structure of the WAN. We first validate this framework using global epidemic simulations. We then illustrate its potential to enhance our ability to nowcast and forecast epidemics by applying it retrospectively to the 2009 influenza A/H1N1 pandemic and the 2014 West African Ebola epidemic in Liberia.\n\nThroughout this paper, we consider only global spread of epidemics with relatively fast timescales in which epidemics in each population peak within 300 days after establishment (e.g., pandemic influenza, MERS, Ebola) such that changes in demographics (e.g., births, aging) is negligible. In metapopulation epidemic models, populations (e.g., cities) around the world are connected through the travel of individuals via the WAN (see WAN metapopulation epidemic model in Methods for details). We designate population i as the epidemic origin which is seeded with si infections at time 0. For any given population j, we denote its population size by Nj and initial epidemic growth rate by \u03bbj. If populations j and k are directly connected in the WAN, the mobility rate from population j to k is defined as wjk = Fjk/Nj, where Fjk is the direct air-traffic (passengers per day) and wjk ranges mostly between 10\u20136 and 10\u20133 per day in the WAN (Supplementary Fig. 1). Let \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^n$$\\end{document}Tijn be the time at which population j receives its nth imported infection. The epidemic arrival time (EAT) for population j is defined as \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1. Our framework is built upon the following assumption19,21.\n\nAssumption 1: Suppose populations j and k are directly connected in the WAN and only population j is infected. Exportation of infections from population j to k is a nonhomogeneous Poisson process (NPP)22 with intensity function wjkIj(t) where Ij(t) is the disease prevalence (number of infectives) in population j at time t (see Details on assumption 1 in Methods for details).\n\nSupplementary Figure  2 shows that assumption 1 is very accurate for a wide range of plausible epidemic scenarios. We will show that the dynamics of global spread is largely analytically tractable because the following assumption is also accurate across these same scenarios.\n\nAssumption 2: After the epidemic has established in a given population j, the first few exportations occur while disease prevalence is still growing exponentially, i.e., \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$I_{j}\\left( t \\right) = s_{j}\\exp \\left( {\\lambda _{j}t} \\right)$$\\end{document}Ijt=sj exp\u03bbjt.\n\nTo this end, we progressively build up our framework by characterizing the probability distribution of EATs for all populations in three metapopulation networks with increasingly complex structure: (i) The two-population network which has the simplest metapopulation structure; (ii) the shortest-path-tree of the WAN (WAN-SPT hereafter) which is the dominant subnetwork driving global spread of epidemics as described by the seminal study by Brockmann and Helbing20; and (iii) the WAN.\n\nIn the two-population network, the origin population i is only connected to population j. Under assumption 2, the probability density function (pdf) of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^n$$\\end{document}Tijn can be expressed in closed-form:1\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$f_n(t|\\lambda _i,\\alpha _{ij}) = \\left( {\\frac{{\\exp \\left( {\\lambda _it} \\right) - 1}}{{\\lambda _i}}} \\right)^{n - 1}\\frac{{\\alpha _{ij}^n}}{{\\left( {n - 1} \\right)!}}\\\\ \\exp \\left[ {\\lambda _it - \\frac{{\\alpha _{ij}}}{{\\lambda _i}}\\left( {\\exp \\left( {\\lambda _it} \\right) - 1} \\right)} \\right],$$\\end{document}fn(t\u2223\u03bbi,\u03b1ij)=exp\u03bbit-1\u03bbin-1\u03b1ijnn-1!exp\u03bbit-\u03b1ij\u03bbiexp\u03bbit-1,where \u03b1ij = wijsi, which we term adjusted mobility rate. Figure 1 shows that if n is smaller than 10, Eq. 1 is accurate across a wide range of realistic scenarios (e.g., the percent error in expected EAT is uniformly below 2%), which correspond to epidemics ranging from pandemic influenza (with doubling time around 4\u22125 days) to Ebola (with doubling time longer than 20 days). This result leads to the following corollaries for the WAN-SPT and WAN analysis: (i) Exportation of the first n infections is essentially an NPP with intensity function \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\alpha _{ij}\\exp \\left( {\\lambda _it} \\right)$$\\end{document}\u03b1ij exp\u03bbit; and (ii) the expected time of the nth exportation is given by \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E\\left[ {T_{ij}^n} \\right] = \\frac{1}{{\\lambda _i}}\\exp \\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right)\\mathop {\\sum}\\limits_{m = 1}^n {{E}_m\\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right)}$$\\end{document}ETijn=1\u03bbi exp\u03b1ij\u03bbi \u2211m=1nEm\u03b1ij\u03bbi, where Em(x) is the exponential integral. Hence,2\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E\\left[ {T_{ij}^n\\left| {T_{ij}^1} \\right.} \\right] = T_{ij}^1 + \\frac{1}{{\\lambda _i}}\\exp \\left( {\\frac{{\\alpha _{ij}\\exp \\left( {\\lambda _iT_{ij}^1} \\right)}}{{\\lambda _i}}} \\right)\\\\ \\mathop {\\sum}\\limits_{m = 1}^{n - 1} {{E}_m\\left( {\\frac{{\\alpha _{ij}\\exp \\left( {\\lambda _iT_{ij}^1} \\right)}}{{\\lambda _i}}} \\right)},$$\\end{document}ETijnTij1=Tij1+1\u03bbi exp\u03b1ij exp\u03bbiTij1\u03bbi \u2211m=1n-1Em\u03b1ij exp\u03bbiTij1\u03bbi,which corresponds to the (n\u22121)th exportation for an epidemic that starts at time \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1 with seed size \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$s_i\\exp \\left( {\\lambda _iT_{ij}^1} \\right)$$\\end{document}si exp\u03bbiTij1.\n\nThese analytics can be used to formulate closed-form likelihood functions for inferring parameters from disease surveillance and global spread data (see Methods).\n\nFor the WAN-SPT and WAN analysis, we use the worldwide passenger booking data from the Official Airline Guide (OAG) and the Gridded Population of the World data set (Version 4) from the NASA Socioeconomic Data and Applications Center at Columbia University to build a stochastic metapopulation global epidemic simulator with 2309 populations and 54,106 connections (see The global epidemic simulator in Methods). This simulator is similar to GLEAM but without the effect of local commuting which has negligible impact on global spread23. Brockmann and Helbing20 suggested that global spread of epidemics is primarily driven by the WAN-SPT subnetwork in which each population is connected to the epidemic origin via only one path. We will show that for each population k in the WAN-SPT, the time at which the nth importation occurs, namely \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn, can be well characterized by fn(t|\u03bb,\u03b1) (Eq. 1), where \u03bb and \u03b1 are specifically parameterized to account for the hub-effect and continuous seeding (explained in the next two sections and Fig. 2a, b). This provides a profound insight: the epidemic arrival process for each population k in the WAN-SPT can be approximated as an NPP with intensity function in the form of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\alpha \\exp \\left( {\\lambda t} \\right)$$\\end{document}\u03b1exp\u03bbt.\n\nHub-effect: Hubs are populations that have direct connections to many populations in the WAN, e.g., Hong Kong, Beijing, New York. If the epidemic origin is a hub, the growth of local disease prevalence can be substantially reduced if a significant proportion of infections travel outward as the epidemic unfolds18. Let Di,c be the set of populations that are c degrees of separation from the epidemic origin in the WAN-SPT24. From the perspective of the importation process for a given population j \u2208 Di,1 (i.e., directly connected to the epidemic origin), the prevalence in population i grows exponentially at rate \u03bbij = \u03bbi \u2212 \u2211k \u2260 jwik (see Fig. 2a and The WAN-SPT analysis in Methods for details). Figure 2d and Supplementary Fig. 3 show that with this hub-effect adjustment, fn(t|\u03bbij,\u03b1ij) accurately characterizes the probability distribution of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^n$$\\end{document}Tijn for all populations in Di,1 (e.g., the percent error in expected EAT is uniformly below 4%).\n\nContinuous seeding: Unlike the epidemic origin which has a single seeding event at time 0, all the other populations in the WAN-SPT are continuously seeded by infections coming from their upstream populations. Suppose population k \u2208 Di,2 is connected to the epidemic origin via population j along the path \u03c8: i \u2192 j \u2192 k. After the epidemic has arrived at population j at time \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, population i continues to export infections to population j before the epidemic arrives at population k at time \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^1$$\\end{document}Tik1 (illustrated in Fig. 2b). Under assumption 2, each imported infection in population j (arriving at times \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^2$$\\end{document}Tij2, \u2026) spawns an infection tree that grows exponentially at the hub-adjusted rate \u03bbjk. Therefore, the prevalence in population j, namely Ij(t), is simply the sum of the prevalence for all these infection trees. As such, assumption 1 warrants that the exportation of infections from population j to k is an NPP with intensity function wjkIj(t), which is itself a stochastic process because of its dependence on the random variables \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^2$$\\end{document}Tij2, \u2026 (see The WAN-SPT analysis in Methods). We conjecture that this highly complex stochastic process can be greatly simplified with little loss of accuracy by assuming that conditional on \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1 (the EAT for population j), \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^m \\approx E\\left[ {T_{ij}^m|T_{ij}^1} \\right]$$\\end{document}Tijm\u2248ETijm\u2223Tij1 for all m > 1 (see Eq. 2). In other words, the major source of stochasticity in Ij(t) comes from \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, which is characterized by f1(t|\u03bbij,\u03b1ij) (Eq. 1). Figure 2e and Supplementary Fig. 4 show that our conjecture is valid. The resulting approximate pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn is accurate for Di,2 populations for all realistic epidemic scenarios. Furthermore, this pdf can in turn be well approximated with f1(t|\u03bb\u03c8,\u03b1\u03c8), where \u03bb\u03c8 and \u03b1\u03c8 are obtained by minimizing the relative entropy25 (see The WAN-SPT analysis in Methods). This implies that the spread of epidemics from the origin to any population k \u2208 Di,2 can be regarded as a two-population model, in which the adjusted mobility rate is \u03b1\u03c8 and the epidemic in the origin grows exponentially at rate \u03bb\u03c8. We term this procedure path reduction. By induction, we can recursively apply path reduction to characterize the EATs with comparable accuracy for all populations in Di,3, Di,4, etc. Figure 2f and Supplementary Fig. 5 verify this claim (e.g., the percent error in expected EAT is uniformly below 4%).\n\nThe accuracy of our framework for the WAN-SPT implies that for each (acyclic) path \u03c8 connecting an arbitrary population k to the epidemic origin, the epidemic arrival process for population k along this path can be approximated as an NPP with intensity function \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\alpha _\\psi \\exp \\left( {\\lambda _\\psi t} \\right)$$\\end{document}\u03b1\u03c8 exp\u03bb\u03c8t. In the entire WAN, each population may be connected to the epidemic origin via multiple paths (hence the difference in EATs between WAN-SPT and WAN, as shown in Supplementary Fig. 6), some of which may intersect and are therefore dependent. We conjecture that the dependence among such paths is sufficiently weak such that the overall epidemic arrival process for any population k is well approximated by the superposition of the NPPs22 that correspond to these pseudo-independent paths. That is, if \u03a8ik is the set of all acyclic paths connecting population k to the epidemic origin, the epidemic arrival process for population k can be well approximated by an NPP with intensity function \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\mathop {\\sum}\\nolimits_{\\psi \\in \\Psi _{ik}} {\\alpha _\\psi \\exp \\left( {\\lambda _\\psi t} \\right)} $$\\end{document} \u2211\u03c8\u2208\u03a8ik\u03b1\u03c8 exp\u03bb\u03c8t. Figure 3 and Supplementary Fig. 7 show that our framework is accurate for all populations and epidemic scenarios.\n\nOur framework provides both analytical and computational advancements for studying global spread of epidemics. First, not only can our framework be easily used to forecast EATs for all populations in the WAN, but it also analytically elucidates the dependence of EATs on the epidemiologic parameters (growth rate and seed size) and the network properties of the WAN (air-traffic volume and connectivity). Second, our framework provides closed-form probability distributions (Eq. 1) to support likelihood-based inference of key epidemiologic parameters from surveillance data on global and local spread. We exemplify the public health applications of our framework by retrospectively applying it to the 2009 influenza pandemic and the 2014 Ebola epidemic as follows.\n\nIn our first case study, we infer the transmissibility of the 2009 pandemic influenza A/H1N1 virus in Greater Mexico City following the formulation in Balcan et al.26 Shortly after the pandemic influenza A/H1N1 virus was first detected in the USA and Mexico in April 2009, many countries enhanced their surveillance to monitor importations of pandemic infections. As such, data on EATs for these countries were deemed more reliable than epidemic curve data, which are typically confounded by reporting behavior and surveillance capacity26\u201328. Using GLEAM simulations powered by supercomputers to perform maximum-likelihood analyses of EATs for 12 countries seeded by Mexico, Balcan et al.26 estimated that if the 2009 influenza pandemic started in La Gloria on 11, 18, or 25 February 2009, the basic reproductive number R0 would be 1.65 (1.54\u20131.77), 1.75 (1.64\u20131.88), or 1.89 (1.77\u20132.01), respectively (Fig. 4a). Integrating our framework into their inference formulation, we can express the likelihood as a simple analytical function of R0 (see case study on the 2009 influenza A/H1N1 pandemic in Methods) and obtain essentially the same R0 estimates without the need for supercomputing (Fig. 4a). Specifically, our point estimate of R0 would be the same as that in Balcan et al. if the epidemic in Greater Mexico City began with a single seed on 22 February, 1 March, or 9 March 2009, respectively, which are all consistent with range of the epidemic start times documented in surveillance reports29 and other studies27,28,30,31. The reduction in computational complexity and requirement provided by our framework translates into substantial improvement for timeliness and efficiency in situational awareness.\n\nIn our second case study, we analyze the 2014 West African Ebola epidemic in Montserrado and Margibi, Liberia (Montserrado henceforth for brevity). Specifically, we apply our framework to retrospectively nowcast the reporting proportion of Ebola cases (and hence the total number of cases) in Montserrado, and forecast the time to the next international case exportation from Montserrado assuming that the local epidemic would continue to grow exponentially at the nowcasted growth rate and the forward air-traffic would remain constant.\n\nThe Montserrado Ebola epidemic started in May 201432,33. By September 2014, two indigenous Ebola cases had been exported from Montserrado to other nations via commercial air travel: The first to Lagos, Nigeria, on 20 July 201434; and the second to Dallas, USA, on 19 September 201435. By combining these global spread data with the World Health Organization patient database33 on the weekly number of confirmed and probable cases in Montserrado and accounting for the effect of the opening of new Ebola treatment units in August36,37, we can use our framework to express the likelihood function in simple analytical form (see case study on the 2014 Liberian Ebola outbreak in Methods). We estimate that the reporting proportion (and hence the total number of cases) would have been statistically identifiable starting from 6 July 2014 onwards. We estimate that by 6 July 2014, the confirmed and probable cases only accounted for 18% (95% credible interval 7\u221233%) of all Ebola cases in Montserrado. The opening of new treatment units during August increased the reporting proportion to 30% (15\u221248%) by 17 August 2014, which is congruent with an independent estimate38 based on capture\u2013recapture sampling of raw patient records over a similar time horizon (34%; 95% confidence interval 26\u221250%). Retrospective real-time forecasts of the time to next exportation are consistent with the observed exportation times (namely 20 July and 19 September) except on 21\u221228 July during which the next exportation occurred later than predicted. The prediction errors on 21\u221228 July could be attributed to travel restrictions started in August8, the effect of which could not be included in the forecasts until they have actually occurred during August. If travel restrictions could have been foreseen on 21\u221228 July and incorporated into the forecasts (as a counterfactual scenario for illustration), the observed case exportation on 19 September 2014 would be consistent with the forecast range (Fig. 4b). These conclusions are robust against temporal variations in epidemic growth rate (see case study on the 2014 Liberian Ebola outbreak in Methods).\n\nIn summary, our framework for characterizing the dynamics underlying global spread of epidemics comprises five approximations: (i) a closed-form pdf for EAT for any two directly connected populations (Eq. 1); (ii) adjustment for hub-effects; (iii) adjustment for continuous seeding; (iv) path reduction; and (v) path superposition. Approximation (i) is the indispensable centerpiece of our framework, whereas the necessity of approximations (ii)\u2013(v) would depend on the specific application. Hub-effect adjustment is necessary when estimating the times of case exportation for populations that are directly connected to multiple populations and have relatively high outbound mobility rates. Continuous-seeding adjustment is necessary when estimating the times of case exportation for all populations except the epidemic origin (for which seeding is assumed to occur only at time 0). Path reduction and superposition are developed for simplifying computation as well as generating insights regarding global spread dynamics. In terms of computation, path reduction is required for populations that are three or more degrees of separation from the epidemic origin in a given acyclic path (which typically account for <20% of all populations), whereas path superposition is used for all populations (however, path superposition may not be necessary for populations that are directly connected to the epidemic origin with high mobility rates because the indirect paths have only minor impact on their EATs; see Supplementary Fig. 6). In terms of insights, the accuracy of path reduction implies that the epidemic arrival process from the epidemic origin to any given population along any given acyclic path \u03c8 can be accurately approximated as an NPP with intensity function \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\alpha _\\psi \\exp \\left( {\\lambda _\\psi t} \\right)$$\\end{document}\u03b1\u03c8 exp\u03bb\u03c8t, whereas the accuracy of path superposition implies that the dependence of multiple paths connecting a given population to the epidemic origin is relatively weak for the purpose of estimating EAT.\n\nAlthough approximation (ii)\u2013(v) are all necessary for estimating EAT in the WAN (Figs. 1\u20133), they are not needed in our case studies on inference of transmission parameters: In the 2009 pandemic influenza A/H1N1 case study, we follow the inference formulation in Balcan et al.26 which included only populations that are directly connected to Mexico City in the WAN. In the 2014 Ebola case study, the inference formulation tracks the timing of only two case exportations without the need to stratify them by outbound populations (see Case study on the 2014 Liberian Ebola outbreak in Methods).\n\nOur study has several limitations. First, we did not consider age structure because the OAG air-traffic data do not have age information. If data are available for stratifying mobility rates and incidence by age, our framework should remain valid if the mobility rates wij are calculated as the cross-product of age-specific mobility rates and age distribution of the disease. Second, we have assumed that each imported case spawns an exponentially growing infection tree with probability 1, whereas if we account for stochasticity in transmission dynamics, each imported case will fail to spawn an exponentially growing infection tree with probability p = 1/R016. Because this effect is similar to that of border control19, we conjecture that our framework can be extended to account for such stochasticity in transmission dynamics by discounting wij with 1 \u2212 p. Third, we present our framework in the context of the classic SIR model. Nonetheless, our results can be generalized to all SEmInR models39 (see Generalizing to SEmInR models in Methods). Fourth, we have not accounted for seasonality effects which may be strong and geographically heterogeneous for diseases such as seasonal influenza40,41. Although the epidemic dynamics will certainly be less analytically tractable in the presence of seasonality (e.g., the pdf of the EAT can no longer be well approximated by simple closed-form expressions as Eq. 1), we conjecture that the new analytics introduced here, namely adjustments for the hub-effect and continuous seeding as well as path reduction and superposition, will be useful for building a more general framework for global spread of epidemics. Finally, in our case studies, we have implicitly assumed that surveillance data were available in near real-time for nowcasting and forecasting, whereas in reality the availability of reliable data would likely incur longer lead times, and hence the timeliness of situational awareness implied here should be interpreted within such context.\n\nIn summary, we have developed a novel framework that can accurately characterize how global spread of epidemics depends on the infectious disease epidemiology and network properties of the WAN. Together with state-of-the-art global epidemic simulators such as GLEAM, our framework advances the frontiers of the next-generation informatics for pandemic preparedness and responses.\n\nLet Sj(t), Ij(t), and Rj(t) be the number of susceptible, infected and removed individuals in population j at time t. Suppose R0,j is the basic reproductive number and Tg,j is the mean generation time in population j. Let \u03b2j = R0,j/Tg,j be the disease transmission rate in population j, and wjk be the mobility rate from population j to k. The stochastic metapopulation model with G populations is specified by the following equations where \u0394t is a very small time interval:\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\begin{array}{l}S_j(t + \\Delta t) = S_j(t) - \\underbrace {U_j(t)}_{\\begin{array}{c}{\\mathrm{No.}}\\ {\\mathrm of}\\ {\\mathrm infections}\\ {\\mathrm in}\\\\ {{\\mathrm{population }}\\ j\\ {\\mathrm{ between}}}\\\\ {{\\mathrm{time }}\\ t\\ {\\mathrm{ and }}\\ t + \\Delta t}\\end{array}} + \\mathop {\\sum}\\limits_k {\\underbrace {X_{kj}(t)}_{\\begin{array}{c}{\\mathrm{No.}}\\ {\\hbox{of susceptibles who}}\\\\ {\\hbox{travel from population }}k\\\\ {\\hbox{to population }}j{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}}}\\\\ - \\mathop {\\sum}\\limits_k {\\underbrace {X_{jk}(t)}_{\\begin{array}{c}{\\hbox{No}}{\\hbox{. of susceptibles who}}\\\\ {\\hbox{travel from population }}j\\\\ {\\hbox{to population }}k{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}}} \\\\ I_j(t + \\Delta t) = I_j(t) + \\underbrace {U_j(t)}_{\\begin{array}{c}\\scriptstyle {\\hbox{No.}}\\ {\\hbox{ of infections in}}\\\\ {\\scriptstyle {\\hbox{population }}j{\\hbox{ between}}}\\\\ {\\scriptstyle {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t}\\end{array}} - \\underbrace {V_j(t)}_{\\begin{array}{c}\\scriptstyle {\\hbox{No}}{\\hbox{. of infected cases who}}\\\\ {\\scriptstyle {\\hbox{recover or die in population }}}j\\\\ {\\scriptstyle {\\hbox{between time }}t{\\hbox{ and }}t + \\Delta t}\\end{array}}\\\\ + \\mathop {\\sum}\\limits_k {\\underbrace {Y_{kj}(t)}_{\\begin{array}{c}{\\hbox{No}}{\\hbox{. of infected cases who}}\\\\ {\\hbox{travel from population }}k\\\\ {\\hbox{to population }}j{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}}} - \\mathop {\\sum}\\limits_k {\\underbrace {Y_{jk}(t)}_{\\begin{array}{c}{\\hbox{No}}{\\hbox{. of infected cases who}}\\\\ {\\hbox{travel from population }}j\\\\ {\\hbox{to population }}k{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}}} \\\\ R_j(t + \\Delta t) = R_j(t) + \\underbrace {V_j(t)}_{\\begin{array}{c}\\scriptstyle {\\hbox{No}}{\\hbox{. of infected cases who}}\\\\ {\\scriptstyle {\\hbox{recover or die in population }}j}\\\\ {\\scriptstyle {\\hbox{between time }}t{\\hbox{ and }}t + \\Delta t}\\end{array}} \\\\ + \\mathop {\\sum}\\limits_k {\\underbrace {Z_{kj}(t)}_{\\begin{array}{c}{\\hbox{No}}{\\hbox{. of recovered cases who}}\\\\ {\\hbox{travel from population }}k\\\\ {\\hbox{to population }}j{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}}} - \\mathop {\\sum}\\limits_k {\\underbrace {Z_{jk}(t)}_{\\begin{array}{c}{\\hbox{No}}{\\hbox{. of recovered cases who}}\\\\ {\\hbox{travel from population }}j\\\\ {\\hbox{to population }}k{\\hbox{ between}}\\\\ {\\hbox{time }}t{\\hbox{ and }}t + \\Delta t\\end{array}} }\\end{array}$$\\end{document}Sj(t+\u0394t)=Sj(t)-Uj(t)\u23dfNo.ofinfectionsinpopulationjbetweentimetandt+\u0394t+ \u2211kXkj(t)\u23dfNo.ofsusceptibleswhotravelfrompopulationktopopulationjbetweentimetandt+\u0394t-\u2211kXjk(t)\u23dfNo.ofsusceptibleswhotravelfrompopulationjtopopulationkbetweentimetandt+\u0394tIj(t+\u0394t)=Ij(t)+Uj(t)\u23dfNo.ofinfectionsinpopulationjbetweentimetandt+\u0394t-Vj(t)\u23dfNo.ofinfectedcaseswhorecoverordieinpopulationjbetweentimetandt+\u0394t+ \u2211kYkj(t)\u23dfNo.ofinfectedcaseswhotravelfrompopulationktopopulationjbetweentimetandt+\u0394t-\u2211kYjk(t)\u23dfNo.ofinfectedcaseswhotravelfrompopulationjtopopulationkbetweentimetandt+\u0394tRj(t+\u0394t)=Rj(t)+Vj(t)\u23dfNo.ofinfectedcaseswhorecoverordieinpopulationjbetweentimetandt+\u0394t+ \u2211kZkj(t)\u23dfNo.ofrecoveredcaseswhotravelfrompopulationktopopulationjbetweentimetandt+\u0394t-\u2211kZjk(t)\u23dfNo.ofrecoveredcaseswhotravelfrompopulationjtopopulationkbetweentimetandt+\u0394t\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$U_j(t) = \\beta _jS_j(t)I_j(t)\\Delta t/N_j$$\\end{document}Uj(t)=\u03b2jSj(t)Ij(t)\u0394t\u2215Nj\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$V_j(t) = I_j(t)\\Delta t/T_{g,j}$$\\end{document}Vj(t)=Ij(t)\u0394t\u2215Tg,j\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$X_j(t)\\,\\sim \\,{\\rm {Multinomial}}\\left( {\\left\\lfloor {S_j(t)} \\right\\rfloor ,w_{j1}\\Delta t,\\ldots,w_{jG}\\Delta t} \\right)$$\\end{document}Xj(t)~MultinomialSj(t),wj1\u0394t,\u2026,wjG\u0394t\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$Y_j(t)\\,\\sim \\,{\\rm {Multinomial}}\\left( {\\left\\lfloor {I_j(t)} \\right\\rfloor ,w_{j1}\\Delta t,\\ldots,w_{jG}\\Delta t} \\right)$$\\end{document}Yj(t)~MultinomialIj(t),wj1\u0394t,\u2026,wjG\u0394t\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$Z_j(t)\\,\\sim \\,{\\rm {Multinomial}}\\left( {\\left\\lfloor {R_j(t)} \\right\\rfloor ,w_{j1}\\Delta t,\\ldots,w_{jG}\\Delta t} \\right),$$\\end{document}Zj(t)~MultinomialRj(t),wj1\u0394t,\u2026,wjG\u0394t,where Xjk(t),Yjk(t), and Zjk(t) are the kth component of Xj(t), Yj(t), and Zj(t), respectively. Multinomial(n, p1,...,pG) denotes a multinomial random variable with n trials and probabilities p1,...,pG. We use \u0394t = 0.05 days in all of our simulations.\n\nWe build the global simulator using 2015 worldwide flight booking data from the Official Airline Guide (OAG, https://www.oag.com/) and the Gridded Population of the World Version 4 (GPWv4, http://sedac.ciesin.columbia.edu/data/collection/gpw-v4/) data set from the NASA Socioeconomic Data and Applications Center (SEDAC) at Columbia University.\n\nWorldwide air-transportation data: Our OAG worldwide flight booking data set contains all air bookings that have taken place in all commercial airports worldwide during 2015. Each data record contains the following information for a flight route: (i) origin airport, (ii) destination airport, (iii) connecting airports (if any), and (iv) passenger bookings for each month. The city and country served by each airport and the coordinates of each airport are known. The raw data comprises 0.947 million records. Parameterizing the WAN using these raw data would therefore generate 0.947 million connections in the network, which is beyond our computational capacity and unnecessary for an accurate description of global spread (because the WAN is densely connected)3\u20136,12,42\u201344. As such, we perform the following steps to exclude flight routes with weak traffic from the WAN without compromising the realism of the global epidemic simulator:We exclude all routes with no bookings for one or more months during 2015.We exclude all routes in which the origin or destination is a remote area with very small population size (e.g., hamlets, settlements, or communities in Alaska and Northern Canada).We exclude all routes with strong seasonality as measured by normalized information entropy11: \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$H_{ij} = - \\frac{1}{{\\log (12)}}\\mathop {\\sum}\\nolimits_{m = 1}^{12} {\\rho _{ijm}} \\log \\rho _{ijm}$$\\end{document}Hij=-1log(12) \u2211m=112\u03c1ijm log\u03c1ijm, where \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\rho _{ijm} = F_{ijm}/\\mathop {\\sum}\\nolimits_{m = 1}^{12} {F_{ijm}} $$\\end{document}\u03c1ijm=Fijm\u2215\u2211m=112Fijm and Fijm denotes the number of air bookings from origin airport i to destination airport j in month m. The measure Hij ranges between 0 and 1, and decreases as temporal variation in air-traffic increases (e.g., if air-traffic is the same across all months, then Hij = 1). On the basis of the distribution of Hij in our OAG raw data, we exclude all routes with Hij < 0.8 (Supplementary Fig. 8a).\n\nGlobal population data: The GPWv4 data set integrates the highest resolution census data from the 2010 round of Population and Housing Censuses collected from hundreds of national statistics departments and organizations45,46. GPWv4 provides eight different data sets, most of which are specialized geospatial metadata that partition the global population into a grid of cells with resolution of 30 arc-second (~1 km at the equator). We use the vector data set \u201cAdministrative Unit Center Points with Population Estimates, v4 (2000, 2005, 2010, 2015, 2020)\u201d47, because it provides all the information that we need to build the global epidemic model, e.g., the coordinates of centroid are available for each of the ~12.5 million administrative census units (ACUs).\n\nThe WAN model: We combine our OAG data with the GPWv4 data to calculate the population size of the catchment area of each airport as follows:We use the coordinates of the centroids of all ACUs and airports to calculate the great circle distance for all possible combinations of ACUs and airports within the same country. We use a Voronoi-like tessellation algorithm proposed by Balcan et al.23 to link each ACU to its serving airport (i.e., the closest airport in its country). In this algorithm, we impose the constraint that the great circle distance between any pair of ACU and airport cannot exceed 200 km, according to the distribution of great circle distance for all combinations of ACUs and airports (Supplementary Fig. 8b). This reflects a reasonable upper bound on the distance of land transportation for reaching an airport23. Without this constraint, the algorithm may generate unreasonably large catchment areas for airports located in sparsely populated regions. Among the 7,995,985 ACUs with human habitats, only 45,692 are excluded from our model because of this constraint. The total population size served by an airport is the sum of populations for all ACUs assigned to that airport.To strike a balance between computational requirement (within our capacity) and realism of our global epidemic simulator, we exclude all routes having less than 3000 air passengers throughout the year (Fig. S8c\u2012f). This simplification is in line with the passenger threshold reported by Khan et al.48 and hence has little impact on the accuracy of global spread dynamics.In our OAG data set, some metropolitans (e.g., London, New York City, and Shanghai) and tourist locations (e.g., Hawaii and Canary Islands) have multiple airports. We model each of these locations as a single population by merging its serving airports and the corresponding catchment areas.The daily air-traffic of each connection Fij is the average number of air passengers per day for that connection during the year of 2015. The ensemble of all connections shows a high degree of statistical symmetry, Fij \u2248 Fji (R2 = 0.9981), as in refs. 3\u20137,11,18,20,42\u201344. As such, we symmetrize the air-traffic between each pair of populations by setting Fij = Fji = (Fij + Fji)/2.\n\nIn summary, the WAN in our global metapopulation epidemic model comprises 54,106 connections and 2309 populations and preserves more than 92% of the global air bookings.\n\nAssumption 1 is stated as follows: suppose populations j and k are directly connected in the WAN and only population j is infected. Exportation of infections from population j to k is an NPP22 with intensity function wjkIj(t) where Ij(t) is the disease prevalence in population j at time t.\n\nPrevious studies19,21 on global spread have made similar assumptions.\n\nA counting process {A(t),t \u2265 0}, where A(t) is the number of events by time t, is an NPP22 with intensity function \u03bc(t) for some small time interval \u0394t if:A(0) = 0.Non-overlapping increments are independent, i.e., A(T2) \u2212 A(T1) and A(T4) \u2212 A(T3) are independent if the time intervals [T1,T2] and [T3,T4] do not overlap.P(A(t + \u0394t) \u2212 A(t) = 1) = \u03bc(t)\u0394t + o(\u0394t) and P(A(t + \u0394t) \u2212 A(t)>1) = o(\u0394t) for all t and o(\u0394t)/\u0394t \u2192 0 as \u0394t \u2192 0.\n\nFor populations j and k mentioned above, the exportation process of infections from population j to population k clearly satisfies conditions 1 with intensity function wjkIj(t). If the mobility rate wjk is sufficiently small, the number of exportations is only a very small proportion of the disease prevalence in population j, and hence conditions 2 and 3 are also satisfied.\n\nPopulation i is the epidemic origin and only connected to population j. Let si and \u03bbi be the seed size and the initial epidemic growth rate. Let Xij be the total number of infections imported by population j over the course of the epidemic. We denote the Poisson pdf at value x with mean M by fPoisson(x,M). Under assumption 1:Xij is Poisson distributed with mean AiTgFij, where Tg is the mean generation time, Ai is the final attack rate in population i and Fij is the daily average number of passengers traveling from population i to j. That is, P(Xij = n) = fPoisson(n,AiTgFij).Applying the framework of NPP22, we express the pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^n$$\\end{document}Tijn conditional on Xij \u2265 n as\n\nS1\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{{f_{\\rm {Poisson}}\\left( {n - 1,w_{ij}{\\int}_0^t {I_i\\left( u \\right)du} } \\right)}}{{P\\left( {X_{ij} \\ge n} \\right)}}w_{ij}I_i\\left( t \\right).$$\\end{document}fPoissonn-1,wij\u222b0tIiuduPXij\u2265nwijIit.Supplementary Figure 2 shows that the pdf in Eq. S1 is very accurate for all realistic epidemic scenarios. If assumption 2 is also valid, i.e., \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$I_i(t) = s_i\\exp \\left( {\\lambda _it} \\right)$$\\end{document}Ii(t)=si exp\u03bbit, then P(Xij \u2265 n) = 1 and Eq. S1 can be simplified to\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$f_n(t|\\lambda _i,\\alpha _{ij}) = \\left( {\\frac{{\\exp \\left( {\\lambda _it} \\right) - 1}}{{\\lambda _i}}} \\right)^{n - 1}\\frac{{\\alpha _{ij}^n}}{{\\left( {n - 1} \\right)!}}\\exp \\left[ {\\lambda _it - \\frac{{\\alpha _{ij}}}{{\\lambda _i}}\\left( {\\exp \\left( {\\lambda _it} \\right) - 1} \\right)} \\right]{\\mathrm{ }},$$\\end{document}fn(t\u2223\u03bbi,\u03b1ij)=exp\u03bbit-1\u03bbin-1\u03b1ijnn-1!exp\u03bbit-\u03b1ij\u03bbiexp\u03bbit-1,which is Eq. 1 in the main text with \u03b1ij = siwij. The corresponding cumulative distribution function (cdf) is given by\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$F_n\\left( {t|\\lambda _i,\\alpha _{ij}} \\right) = \\Gamma \\left( {n,\\frac{{\\alpha _{ij}}}{{\\lambda _i}}\\left( {\\exp \\left( {\\lambda _it} \\right) - 1} \\right)} \\right),$$\\end{document}Fnt\u2223\u03bbi,\u03b1ij=\u0393n,\u03b1ij\u03bbiexp\u03bbit-1,where \u0393 is the lower incomplete gamma function. The expected EAT is given by\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E\\left[ {T_{ij}^1} \\right] = \\frac{1}{{\\lambda _i}}\\exp \\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right){E}_1\\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right),$$\\end{document}ETij1=1\u03bbi exp\u03b1ij\u03bbiE1\u03b1ij\u03bbi,where \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${{E}}_m\\left( x \\right) = x^{m - 1}\\mathop {\\int}\\limits_x^\\infty {\\frac{{\\exp \\left( { - u} \\right)}}{{u^m}}du} $$\\end{document}Emx=xm-1 \u222bx\u221eexp-uumdu is the exponential integral.\n\nIf \u03b1ij \u226a \u03bbi and \u03b3 denotes the Euler constant, we obtain the following approximation\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E\\left[ {T_{ij}^1} \\right] \\approx \\frac{1}{{\\lambda _i}}\\left[ {\\ln \\left( {\\frac{{\\lambda _i}}{{\\alpha _{ij}}}} \\right) - \\gamma } \\right],$$\\end{document}ETij1\u22481\u03bbiln\u03bbi\u03b1ij-\u03b3,which is congruent with the EAT statistic in Gautreau et al.18 for estimating the order of epidemic arrival across different populations.\n\nThe expected time of the nth exportation is given by\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E[T_{ij}^n] = \\frac{1}{{\\lambda _i}}\\exp \\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right)\\mathop {\\sum}\\limits_{m = 1}^n {{E}_m\\left( {\\frac{{\\alpha _{ij}}}{{\\lambda _i}}} \\right)}.$$\\end{document}E[Tijn]=1\u03bbi exp\u03b1ij\u03bbi \u2211m=1nEm\u03b1ij\u03bbi.For any positive integers m and n such that m < n, the pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^n - T_{ij}^m$$\\end{document}Tijn-Tijm conditional on \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^m$$\\end{document}Tijm is simply \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$f_{n - m}\\left( {t|\\lambda _i,\\alpha _{ij}\\exp \\left( {\\lambda _iT_{ij}^m} \\right)} \\right)$$\\end{document}fn-mt\u2223\u03bbi,\u03b1ij exp\u03bbiTijm which corresponds to the time of the (n \u2212 m)th exportation for an epidemic with seed size \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$s_i\\exp \\left( {\\lambda _iT_{ij}^m} \\right)$$\\end{document}si exp\u03bbiTijm. Using this relation recursively, we deduce that the joint pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1 = t_1,\\ldots,T_{ij}^n = t_n$$\\end{document}Tij1=t1,\u2026,Tijn=tn is simplyS2\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\mathop {\\prod}\\nolimits_{m = 1}^n {f_1\\left( {t_m|\\lambda _i,\\alpha _{ij}\\exp \\left( {\\lambda _it_{m - 1}} \\right)} \\right)}\\ {\\mathrm for}\\, {\\mathrm all}\\ 0 = t_0 < {\\mathrm{ }}t_1 < t_2 < \\ldots < t_{n - 1} < t_n,$$\\end{document}\u220fm=1nf1tm\u2223\u03bbi,\u03b1ij exp\u03bbitm-1forall0=t0<t1<t2<\u2026<tn-1<tn,which is the basis that supports our likelihood-based inference framework. By the same token,\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E[T_{ij}^n|T_{ij}^1] = T_{ij}^1 + \\frac{1}{{\\lambda _i}}\\exp \\left( {\\frac{{\\alpha _{ij}\\exp \\left( {\\lambda _iT_{ij}^1} \\right)}}{{\\lambda _i}}} \\right)\\mathop {\\sum}\\limits_{m = 1}^{n - 1} {{\\mathrm{E}}_m\\left( {\\frac{{\\alpha _{ij}\\exp \\left( {\\lambda _iT_{ij}^1} \\right)}}{{\\lambda _i}}} \\right)} $$\\end{document}E[Tijn\u2223Tij1]=Tij1+1\u03bbi exp\u03b1ij exp\u03bbiTij1\u03bbi \u2211m=1n-1Em\u03b1ij exp\u03bbiTij1\u03bbiwhich is Eq. 2 in the main text.\n\nHub-effect: Suppose the epidemic origin (population i) is directly connected to one or more populations, one of which is population j (as illustrated in Fig. 2a). In the deterministic version of our metapopulation epidemic model (see WAN metapopulation epidemic model in Methods), the disease prevalence in population i during the exponential growth phase is well approximated by the differential equation\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{{{\\rm {d}}I_i}}{{{\\rm {d}}t}} = \\lambda _iI_i - \\mathop {\\sum}\\limits_k^{} {w_{ik}I_i} = \\left( {\\lambda _i - \\mathop {\\sum}\\limits_{k \\ne j}^{} {w_{ik}} } \\right)I_i - w_{ij}I_i,$$\\end{document}dIidt=\u03bbiIi-\u2211kwikIi=\u03bbi-\u2211k\u2260jwikIi-wijIi,where the actual growth rate of the disease prevalence in population i is \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda _i - \\mathop {\\sum}\\nolimits_k^{} {w_{ik}} $$\\end{document}\u03bbi-\u2211kwik. This differential equation leads us to make the following conjecture: In our original stochastic model, in which the epidemic arrival process for population j is essentially an NPP with intensity function being the second term of the above equation (i.e., wijIi), we can estimate the EAT for population j using the results from the two-population model (The two-population model analysis in Methods) in which population i is exporting cases to population j at mobility rate wij (viewed as a stochastic process) and the disease prevalence in population i is growing exponentially at rate \u03bbij = \u03bbi \u2212 \u2211k \u2260 jwik (viewed as a deterministic process). The hub-adjusted growth rate \u03bbij can be interpreted as the rate at which disease prevalence in population i is growing exponentially before population j imports its first case from population i. Note that the hub-adjusted rate \u03bbij = \u03bbi \u2212 \u2211k \u2260 jwik is not the same as the actual growth rate, namely \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda _i - \\mathop {\\sum}\\nolimits_k^{} {w_{ik}} $$\\end{document}\u03bbi-\u2211kwik. To see this, consider the two-population model in which population i is only connected to population j. In this case, the EAT distribution is given by Eq. 1, which requires \u03bbij to be the hub-adjusted rate \u03bbi \u2212 \u2211k \u2260 jwik = \u03bbi but not the actual growth rate \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda _i - \\mathop {\\sum}\\nolimits_k^{} {w_{ik}} = \\lambda _i - w_{ij}$$\\end{document}\u03bbi-\u2211kwik=\u03bbi-wij.\n\nContinuous seeding: Consider the path connecting the epidemic origin to population k via population j, i.e., \u03c8 : i \u2192 j \u2192 k. Let \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda _{ij}^{}$$\\end{document}\u03bbij and \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda _{jk}^{}$$\\end{document}\u03bbjk be the hub-adjusted growth rate in populations i and j for this path. Under assumption 2, the prevalence in population j at time t that are spawned by the mth infection imported from population i is \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${\\mathbf{I}}\\left\\{ {t  >T_{ij}^m} \\right\\}\\exp \\left( {\\lambda _{jk}\\left( {t - T_{ij}^m} \\right)} \\right)$$\\end{document}It>Tijm exp\u03bbjkt-Tijm where I{ \u22c5 } is the indicator function. Therefore, the total prevalence in population j at time t is \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$I_j\\left( t \\right) = \\mathop {\\sum}\\nolimits_{m = 1}^\\infty {{\\mathbf{I}}\\left\\{ {t  >T_{ij}^m} \\right\\}\\exp \\left( {\\lambda _{jk}\\left( {t - T_{ij}^m} \\right)} \\right)} $$\\end{document}Ijt= \u2211m=1\u221eIt>Tijm exp\u03bbjkt-Tijm. The NPP intensity function for the exportation of infections from population j to population k is wjkIj(t). Conditional on Ij and hence \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^2$$\\end{document}Tij2,\u2026, the pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn is \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$g_n\\left( {t|w_{jk}I_j} \\right) = f_{\\rm {Poisson}}\\left( {n - 1,w_{jk}{\\int}_0^t {I_j\\left( u \\right){\\rm d}u} } \\right)w_{jk}I_j\\left( t \\right)$$\\end{document}gnt\u2223wjkIj=fPoissonn-1,wjk\u222b0tIjuduwjkIjt for n = 1, 2,\u2026. The unconditional pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn is thus \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E_{T_{ij}^1,T_{ij}^2,\\ldots}\\left[ {g_n\\left( {t|w_{jk}I_j} \\right)} \\right]$$\\end{document}ETij1,Tij2,\u2026gnt\u2223wjkIj where the joint pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1 = t_1$$\\end{document}Tij1=t1,\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^2 = t_2$$\\end{document}Tij2=t2,\u2026, is simply the product of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$f_1\\left( {t_m|\\lambda _{ij},w_{ij}s_i\\exp \\left( {\\lambda _{ij}t_{m - 1}} \\right)} \\right)$$\\end{document}f1tm\u2223\u03bbij,wijsi exp\u03bbijtm-1 for m = 1, 2, \u2026 (see Eq. S2). As described in the main text, we make the certainty equivalent assumption (CEA) that conditional on \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^m = E\\left[ {T_{ij}^m|T_{ij}^1} \\right]$$\\end{document}Tijm=ETijm\u2223Tij1 for all m > 1. As such, conditional on \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1, we approximate Ij with\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\begin{array}{c}I_j^{CEA}\\left( t \\right) = \\mathop {\\sum}\\nolimits_{m = 1}^\\infty {{\\mathbf{I}}\\left\\{ {t  >E\\left[ {T_{ij}^m|T_{ij}^1} \\right]} \\right\\}\\exp \\left( {\\lambda _{jk}\\left( {t - E\\left[ {T_{ij}^m|T_{ij}^1} \\right]} \\right)} \\right)} \\\\ = \\mathop {\\sum}\\nolimits_{m = 1}^\\infty {{\\mathbf{I}}\\left\\{ {t  >T_{ij}^1 + \\Delta T_{ij}^m} \\right\\}\\exp \\left( {\\lambda _{jk}\\left( {t - T_{ij}^1 - \\Delta T_{ij}^m} \\right)} \\right)} \\\\ = \\exp \\left( {\\lambda _{jk}\\left( {t - T_{ij}^1} \\right)} \\right)\\mathop {\\sum}\\nolimits_{m = 1}^\\infty {{\\mathbf{I}}\\left\\{ {t  >T_{ij}^1 + \\Delta T_{ij}^m} \\right\\}\\exp \\left( { - \\lambda _{jk}\\Delta T_{ij}^m} \\right)} \\end{array}$$\\end{document}IjCEAt= \u2211m=1\u221eIt>ETijm\u2223Tij1 exp\u03bbjkt-ETijm\u2223Tij1= \u2211m=1\u221eIt>Tij1+\u0394Tijm exp\u03bbjkt-Tij1-\u0394Tijm= exp\u03bbjkt-Tij1 \u2211m=1\u221eIt>Tij1+\u0394Tijm exp-\u03bbjk\u0394Tijmwhere \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Delta T_{ij}^m = E\\left[ {T_{ij}^m\\left| {T_{ij}^1} \\right.} \\right] - T_{ij}^1 = \\frac{1}{{\\lambda _{ij}}}\\exp \\left( {\\frac{{w_{ij}s_i\\exp \\left( {\\lambda _{ij}T_{ij}^1} \\right)}}{{\\lambda _{ij}}}} \\right)\\mathop {\\sum}\\limits_{q = 1}^{m - 1} {{\\mathrm{E}}_q\\left( {\\frac{{w_{ij}s_i\\exp \\left( {\\lambda _{ij}T_{ij}^1} \\right)}}{{\\lambda _{ij}}}} \\right)} $$\\end{document}\u0394Tijm=ETijmTij1-Tij1=1\u03bbij expwijsi exp\u03bbijTij1\u03bbij \u2211q=1m-1Eqwijsi exp\u03bbijTij1\u03bbij (see Eq. 2 and the previous section).\n\nThe resulting unconditional pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn is \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E_{T_{ij}^1}\\left[ {g_n\\left( {t|w_{jk}I_j^{CEA}} \\right)} \\right]$$\\end{document}ETij1gnt\u2223wjkIjCEA where the pdf of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ij}^1$$\\end{document}Tij1 is f1(\u22c5|\u03bbij,siwij).\n\nPath reduction: Consider the path \u03c8: i \u2192 j \u2192 k in the previous section. We can approximate the pdf \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E_{T_{ij}^1}\\left[ {g_n\\left( {t|w_{jk}I_j^{CEA}} \\right)} \\right]$$\\end{document}ETij1gnt\u2223wjkIjCEA for \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{ik}^n$$\\end{document}Tikn with fn(t|\u03bb\u03c8,\u03b1\u03c8), where \u03bb\u03c8 and \u03b1\u03c8 are obtained by minimizing the relative entropy25 for n = 1 (the first exportation)\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\mathop {\\int}\\limits_0^\\infty {E_{T_{ij}^1}\\left[ {g_1\\left( {t|w_{jk}I_j^{\\rm {CEA}}} \\right)} \\right]\\ln \\left( {\\frac{{E_{T_{ij}^1}\\left[ {g_1\\left( {t|w_{jk}I_j^{\\rm {CEA}}} \\right)} \\right]}}{{f_1\\left( {t\\left| {\\lambda _\\psi ,\\alpha _\\psi } \\right.} \\right)}}} \\right)} {\\rm d}t.$$\\end{document}\u222b0\u221eETij1g1t\u2223wjkIjCEA lnETij1g1t\u2223wjkIjCEAf1t\u03bb\u03c8,\u03b1\u03c8dt.This is a simple two-dimensional optimization problem. The accuracy of such path reduction (Fig. 2f and Supplementary Fig. 5) implies that the spread of epidemics from the origin to any population k \u2208 Di,2 can be regarded as a two-population model, in which (i) the adjusted mobility rate is \u03b1\u03c8 and (ii) the epidemic in the origin grows exponentially at rate \u03bb\u03c8. Next, consider the path \u03d5: i \u2192 j \u2192 k \u2192 m, i.e. m \u2208 Di,3. Using path reduction, we can approximate \u03d5 with \u03d5': i \u2192 k \u2192 m where the adjusted mobility rate and epidemic growth rate in the origin for the i \u2192 k leg are \u03b1\u03c8 and \u03bb\u03c8, respectively. The arrival times of imported cases in population m \u2208 Di,3(i.e., \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T_{im}^n$$\\end{document}Timn, n = 1, 2, \u2026) can then be estimated using the tools (i.e., adjustments for hub-effect and continuous seeding) that we have developed for Di,2 populations. The arrival times of imported cases for population Di,c, c = 4, 5, \u2026, can be estimated analogously.\n\nSuperposition of paths: Let population i be the epidemic origin and consider population k \u2208 Di,c, i.e., population k is c degrees of separation from the epidemic origin24. Superposition of NPPs for paths connecting population i to k is implemented as follows. As in the main text, let \u03a8ik be the set of all acyclic paths connecting the epidemic origin to population k. Enumeration of all paths in \u03a8ik for every population in the WAN is computationally prohibitive49 (and unnecessary). Instead, we approximate \u03a8ik with the 25 \u201cfastest\u201d paths from population i to k that are identified using the following algorithm:Use the depth-first search algorithm49 to identify the set of acyclic paths from the epidemic origin to population k that have at most c + 2 connections. We denote this set by \u03a9ik and assume that all the paths not in \u03a9ik have negligible contribution to the EAT for population k.Define the distance between any two directly connected populations a and b as \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$ - \\ln \\left( {w_{ab}} \\right)$$\\end{document}- lnwab, which is analogous to the distance metric in Brockmann and Helbing20, namely \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$1 - \\ln \\left( {w_{ab}/\\mathop {\\sum}\\nolimits_b {w_{ab}} } \\right)$$\\end{document}1- lnwab\u2215\u2211bwab. We choose to use this distance metric because (as described in The two-population model analysis in Methods) if population j is directly connected to population i, then \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E\\left[ {T_{ij}^1} \\right] \\approx \\frac{1}{{\\lambda _i}}\\left[ {\\ln \\left( {\\lambda _i/\\alpha _{ij}} \\right) - \\gamma } \\right]$$\\end{document}ETij1\u22481\u03bbiln\u03bbi\u2215\u03b1ij-\u03b3 given \u03b1ij \u226a \u03bbi, where \u03b3 denotes the Euler constant and \u03b1ij = siwij. This indicates that the expected EAT is proportional to \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$ - \\ln \\left( {w_{ij}} \\right)$$\\end{document}- lnwij.Based on our distance metric in step 2, identify the 100 shortest paths in \u03a9ik by sorting in an ascending order. Denote the resulting set by \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Omega _{ik}^S$$\\end{document}\u03a9ikS.For each path \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\psi \\in \\Omega _{ik}^S$$\\end{document}\u03c8\u2208\u03a9ikS, use hub-effect adjustment, continuous-seeding adjustment and path reduction developed in the WAN-SPT analysis to calculate \u03bb\u03c8 and \u03b1\u03c8 and the corresponding expected EAT, namely\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{1}{{\\lambda _\\psi }}\\exp \\left( {\\frac{{\\alpha _\\psi }}{{\\lambda _\\psi }}} \\right){\\mathrm{E}}_1\\left( {\\frac{{\\alpha _\\psi }}{{\\lambda _\\psi }}} \\right)$$\\end{document}1\u03bb\u03c8 exp\u03b1\u03c8\u03bb\u03c8E1\u03b1\u03c8\u03bb\u03c8.Approximate \u03a8ik with the 25 paths in \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Omega _{ik}^S$$\\end{document}\u03a9ikS that have the smallest expected EATs computed in step 4 (i.e. the 25 \u201cfastest\u201d paths). We choose to use the 25 fastest paths in \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Omega _{ik}^S$$\\end{document}\u03a9ikS to approximate \u03a8ik because Supplementary Fig. 9 shows that the accuracy of EAT estimates would slightly worsen if we use only the 10 fastest paths in \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Omega _{ik}^S$$\\end{document}\u03a9ikS while there is little improvement in performance if we use the 50 fastest or all paths in \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\Omega _{ik}^S$$\\end{document}\u03a9ikS.\n\nIn the main text, our framework is built using the SIR model within each population. In this section, we describe how to generalize our framework to SEmInR models39 in which:The duration of latency is gamma distributed with mean DE and m subclasses (i.e., with shape m and rate bE = m/DE);The duration of infectiousness is gamma distributed with mean DI and n subclasses (i.e., with shape n and rate bI = n/DI).\n\nFor any given population, let S(t) be the number of susceptible individuals, Ei(t) the number of individuals in the ith latent subclass, and Ij(t) the number of individuals in the jth infectious subclass. The SEmInR system is described by the following differential equations:\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\begin{array}{l}\\frac{{{\\rm d}S(t)}}{{{\\rm d}t}} = - \\beta \\frac{{S(t)}}{N}\\mathop {\\sum}\\limits_{j = 1}^n {I_j(t)} \\\\ \\frac{{{\\rm d}E_1(t)}}{{{\\rm d}t}} = \\beta \\frac{{S(t)}}{N}\\mathop {\\sum}\\limits_{j = 1}^n {I_j(t)} - b_EE_1(t)\\\\ \\frac{{{\\rm d}E_i(t)}}{{{\\rm d}t}} = b_E\\left( {E_{i - 1}(t) - E_i(t)} \\right)\\ {\\mathrm{ for }}\\ i = 2,...,m\\\\ \\frac{{{\\rm d}I_1(t)}}{{{\\rm d}t}} = b_EE_m(t) - b_II_1(t)\\\\ \\frac{{{\\rm d}I_j(t)}}{{{\\rm d}t}} = b_I\\left( {I_{j - 1}(t) - I_j(t)} \\right)\\ {\\mathrm{ for }}\\ j = 2,...,n\\end{array}.$$\\end{document}dS(t)dt=-\u03b2S(t)N \u2211j=1nIj(t)dE1(t)dt=\u03b2S(t)N \u2211j=1nIj(t)-bEE1(t)dEi(t)dt=bEEi-1(t)-Ei(t)fori=2,...,mdI1(t)dt=bEEm(t)-bII1(t)dIj(t)dt=bIIj-1(t)-Ij(t)forj=2,...,n.During the early stage of the epidemic (such that S(t) \u2248 N), the prevalence of latent and infectious individuals both grows exponentially at rate \u03bb which is the solution to the following equation39:\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\lambda \\left( {\\lambda + \\frac{m}{{D_E}}} \\right)^m - \\beta \\left( {\\frac{m}{{D_E}}} \\right)^m\\left( {1 - \\left( {\\frac{{\\lambda D_I}}{n} + 1} \\right)^{ - n}} \\right) = 0.$$\\end{document}\u03bb\u03bb+mDEm-\u03b2mDEm1-\u03bbDIn+1-n=0.That is, the prevalence of latent and infectious individuals are well approximated by \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar E\\exp \\left( {\\lambda t} \\right)$$\\end{document}\u0112exp\u03bbt and \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar I\\exp \\left( {\\lambda t} \\right)$$\\end{document}\u012aexp\u03bbt, respectively, where \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar E$$\\end{document}\u0112 and \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar I$$\\end{document}\u012a depend on the initial conditions and parameters of the differential equation systems (the analytical expressions of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar E$$\\end{document}\u0112 and \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar I$$\\end{document}\u012a can be obtained by solving the linearized system with S(t) = N). As such, if a proportion 1 \u2212 pE and 1 \u2212 pl of the latent and infectious individuals refrain from air travel because of their infections, then the seed size s0 in the main text is simply \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$p_E\\bar E + p_I\\bar I$$\\end{document}pE\u0112+pI\u012a.\n\nAs described in the main text, by integrating our framework into the inference formulation in Balcan et al.26, we express the likelihood function for the EATs for the 12 countries seeded by Mexico (see Supplementary Table 1) as\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$L(R_0) = \\mathop {\\prod}\\limits_{j \\in A}^{} {f_1(t_j|\\lambda _{ij},\\alpha _{ij})} \\mathop {\\prod}\\limits_{j \\in B}^{} {F_1(t_j|\\lambda _{ij},\\alpha _{ij})} $$\\end{document}L(R0)= \u220fj\u2208Af1(tj\u2223\u03bbij,\u03b1ij)\u220fj\u2208BF1(tj\u2223\u03bbij,\u03b1ij)in which population i (the epidemic origin) is Greater Mexico City50 where the epidemic began in mid-February to early-March 200927,30, tj is the observed EAT for population j which can be exact (A) or left-censored (B), \u03bbij = \u03bbi \u2212 \u2211k \u2260 jwik is the hub-adjusted growth rate, \u03b1ij is the adjusted mobility rate. Because the air travel data were not reported in Balcan et al.26, we use the air travel data published in Fraser et al.27 in which the basic reproductive number R0 was estimated from the number of confirmed cases in different countries seeded by Mexico during March\u2013April 2009. Supplementary Table 1 shows the EAT data from Balcan et al.26 and the air-passenger data from Fraser et al.27 The population size of Greater Mexico City in 2009 was 17.6 million27. We assume that the epidemic started with a single infected individual (i.e., si = 1) in Greater Mexico City between 18 February and 14 March 2009 based on the documentation in surveillance reports29 and other studies27,28,30,31 (Fig. 4a). We adopt the natural history model described in Balcan et al.26: (i) the mean generation time is Tg = 3.6 days with mean latent duration of 1.1 days; (ii) the latent and infectious duration are exponentially distributed (regardless of symptoms). Under these assumptions, the basic reproductive number is R0 = (1 + \u03bbi \u00d7 mean latent period)(1 + \u03bbi \u00d7 mean infectious period)51. Balcan et al. assumed that 67% of infections are symptomatic and 50% of symptomatic infections refrained from traveling by air. As such, we discount the mobility rates by multiplying wij with 0.5 \u00d7 0.67 = 0.335.\n\nIn this case study, R0 is the only parameter subject to inference. We assume non-informative flat prior and use the Metropolis\u2013Hasting algorithm52,53 to estimate the posterior distributions of R0. We use five MCMC chains and initialize each chain with an R0 value randomly chosen between 1 and 10. The trace plot and Geweke diagnostic indicate that each MCMC chain converges within 5000 iterations and the autocorrelation of the samples in the MCMC chain is essentially 0 when the lag is larger than 10 steps. As such, we estimate the posterior distribution of R0 by running the Metropolis\u2013Hasting algorithm for 110,000 iterations with a burn-in of 10,000 iterations and a thinning interval of 10. The Gelman\u2013Rubin diagnostic indicates that all five chains converge to the same posterior distribution.\n\nIn 2014, the first laboratory confirmed Ebola case in Montserrado, Liberia, developed symptoms during the week of 5 May 201432,33. During this Ebola epidemic, two Ebola cases were exported from Montserrado to the following populations via international commercial air travel34,35:Lagos, Nigeria on 20 July 2014 (t1);Dallas, USA on 19 September 2014 (t2).\n\nMontserrado and Margibi were the major epicenter in Liberia during the 2014 West African Ebola epidemic32,33,54, and they are served by the two contiguous Liberian commercial airports that have international flights (i.e., Roberts International Airport and Spriggs Payne Airport). In this case study, we apply our framework to estimate the reporting proportion and the total number of Ebola cases in Montserrado and Margibi (Montserrado hererafter for brevity) between 5 May 2014 (the approximate start time of this epidemic) and 21 September 2014 (the last day of the week during which the last exportation occurred). Based on ref. 54, we assume that the latent period and the incubation period were the same. We assume that infectious cases did not travel by air (due to their symptoms), and exportations comprised only air travel of latent individuals (who had not yet developed symptoms). We note that there was some evidence55 that the case exported to Lagos had already developed symptoms when he boarded the flight. Therefore, we include this case in our main analysis but exclude him in the sensitivity analysis. Results from both analyses are essentially the same (Supplementary Fig. 10).\n\nLet time 0 be 5 May 2014 and T be 21 September 2014. We denote May, June, July, August and September 2014 by months 1 to 5, respectively. Denote the last day of month k since time 0 by \u03c4k, and the two observed times of case exportations since time 0 by t1 and t2, respectively. We assume that the incidence rate was (i) 0 before 5 May 2014, (ii) i0 on 5 May 2014, and (iii) \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$i_0\\exp \\left( {\\lambda t} \\right)$$\\end{document}i0 exp\u03bbt thereafter, i.e., this epidemic grew exponentially at rate \u03bb between 5 May and 21 September 2014. The incubation period has been estimated to be gamma distributed with shape m = 1.41 and rate bE = 0.154 (which correspond to mean 9.2 days and standard deviation 7.7 days)54. Hence, symptomatic cases occurred at rate\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${\\rm {inc}}_{\\rm {sym}}(t) = \\mathop {\\int}\\limits_0^t {i_0\\exp \\left( {\\lambda u} \\right)g\\left( {t - u} \\right)du} = i_0\\exp \\left( {\\lambda t} \\right)\\left( {\\frac{{b_E}}{{\\lambda + b_E}}} \\right)^m\\Gamma \\left( {\\left( {\\lambda + b_E} \\right)t,m} \\right),$$\\end{document}incsym(t)= \u222b0ti0 exp\u03bbugt-udu=i0 exp\u03bbtbE\u03bb+bEm\u0393\u03bb+bEt,m,where g is the pdf of the incubation period, and \u0393 is the lower incomplete gamma function. Accordingly, the number of new symptomatic Ebola cases in the kth week since time 0 was\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$Y_k(\\lambda ,i_0) = \\mathop {\\int}\\limits_{7(k - 1)}^{7k} {{\\rm{inc}}_{\\rm {sym}}(t)} {\\rm{d}}t.$$\\end{document}Yk(\u03bb,i0)= \u222b7(k-1)7kincsym(t)dt.Let \u03b8k be the probability that a true case with onset in week k was reported as confirmed or probable cases. New Ebola treatment units were established in Montserrado in early August 201436,37. As such, we assume that \u03b8k = \u03b8before if week k ended before 4 August 2014, and \u03b8k = \u03b8after otherwise. The likelihood for the observed number of confirmed and probable cases is\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$L_{\\rm {inc}}\\left( {\\lambda ,i_0,\\theta _{\\rm {before}},\\theta _{\\rm {after}}} \\right) = \\mathop {\\prod}\\limits_k {f_{\\rm {binomial}}\\left( {y_k|Y_k(\\lambda ,i_0),\\theta _k} \\right)},$$\\end{document}Linc\u03bb,i0,\u03b8before,\u03b8after= \u220fkfbinomialyk\u2223Yk(\u03bb,i0),\u03b8k,where yk is the observed number of confirmed and probable cases with onset in week k and fbinomial is the binomial pdf. The observed weekly number of confirmed and probable Ebola cases in Montserrado is obtained from the World Health Organization (WHO) patient database33.\n\nOur OAG data set also contains the monthly number of flight bookings in 2014. Supplementary Table 2 shows the monthly outbound mobility rates from Montserrado during May\u2013September 2014 in this OAG database. We denote the outbound mobility rate from population i during month k by Wk (i.e., Wk = \u2211jwijk, where wijk is the daily mobility rate from population i to j during month k). Air travel restrictions were implemented starting in August8, which presumably resulted in a substantial proportion of canceled flight bookings (in particular for August 2014, see Supplementary Table 2). These abnormal cancellations were not registered in the OAG database. Therefore, as an approximation, we assume that the actual mobility rate in August 2014 was the same as that in September 2014.\n\nAccording to our framework, if population i has seed size s, epidemic growth rate \u03bb, and outbound mobility rate w, the probability that population i has no exportation up to time t is\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$1 - F_1\\left( {t|\\lambda ,sw} \\right) = \\exp \\left( { - \\frac{{sw}}{\\lambda }\\left( {\\exp \\left( {\\lambda t} \\right) - 1} \\right)} \\right)$$\\end{document}1-F1t\u2223\u03bb,sw= exp-sw\u03bbexp\u03bbt-1and the probability density that population i has its first exportation at time t is\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$f_1(t|\\lambda ,sw) = sw\\exp \\left( {\\lambda t} \\right) \\cdot \\left( {1 - F_1(t|\\lambda ,sw)} \\right).$$\\end{document}f1(t\u2223\u03bb,sw)=swexp\u03bbt\u22c51-F1(t\u2223\u03bb,sw).Given the incidence rate \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$i_0\\exp \\left( {\\lambda _it} \\right)$$\\end{document}i0 exp\u03bbit, the seed size of latent infections was effectively \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar E = \\frac{{i_0}}{{\\lambda _i}}\\left( {1 - \\left( {1 + \\lambda _i/b_E} \\right)^{ - m}} \\right)$$\\end{document}\u0112=i0\u03bbi1-1+\u03bbi\u2215bE-m. To see this, consider an SEmInR system during the exponential growth phase with incidence rate \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$i_0\\exp \\left( {\\lambda _it} \\right)$$\\end{document}i0 exp\u03bbit. The prevalence of latent individuals during this phase is well approximated by the following system:\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\begin{array}{l}\\frac{{{\\rm {d}}E_1\\left( t \\right)}}{{{\\rm {d}}t}} = i_0\\exp \\left( {\\lambda t} \\right) - b_EE_1\\left( t \\right)\\\\ \\frac{{{\\rm {d}}E_i\\left( t \\right)}}{{{\\rm {d}}t}} = b_E\\left( {E_{i - 1}\\left( t \\right) - E_i\\left( t \\right)} \\right){\\mathrm{ for }}\\, i = 2,\\ldots,m\\end{array}.$$\\end{document}dE1tdt=i0 exp\u03bbt-bEE1tdEitdt=bEEi-1t-Eitfori=2,\u2026,m.Solving these differential equations gives\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$E_i\\left( t \\right) = \\frac{{i_0\\exp \\left( {\\lambda t} \\right)}}{{b_E\\left( {1 + \\lambda /b_E} \\right)^i}} + \\exp \\left( { - b_Et} \\right) \\cdot O\\left( {t^{j - 1}} \\right){\\mathrm{, for }}\\,i = 1,\\ldots,m,$$\\end{document}Eit=i0 exp\u03bbtbE1+\u03bb\u2215bEi+ exp-bEt\u22c5Otj-1,fori=1,\u2026,m,and hence the prevalence of latent individuals, namely \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\mathop {\\sum}\\nolimits_{i = 1}^m {E_i(t)} $$\\end{document} \u2211i=1mEi(t), is well approximated by \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar Ee^{\\lambda t}$$\\end{document}\u0112e\u03bbt, where \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\bar E = \\left( {i_0/\\lambda _i} \\right)\\left( {1 - \\left( {1 + \\lambda _i/b_E} \\right)^{ - m}} \\right)$$\\end{document}\u0112=i0\u2215\u03bbi1-1+\u03bbi\u2215bE-m.\n\nTaken together, the likelihood for all observed times of case exportations is\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\begin{array}{c}L_{export}\\left( {\\lambda ,i_0} \\right)\\hfill\\\\ = \\underbrace {\\left( {1 - F_1\\left( {\\tau _1|\\lambda ,\\bar EW_1} \\right)} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{No exportation up to }}\\\\ \\scriptstyle {\\hbox{31 May 2014}}\\end{array}}\\underbrace {\\left( {1 - F_1\\left( {\\tau _2 - \\tau _1|\\lambda ,\\bar Ee^{\\lambda \\tau _1}W_2} \\right)} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{No exportation up to }}\\\\ \\scriptstyle {\\hbox{30 June 2014}}\\end{array}}\\underbrace {f_1\\left( {t_1 - \\tau _2|\\lambda ,\\bar Ee^{\\lambda \\tau _2}W_3} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{The first exportation in }}\\\\ \\scriptstyle {\\hbox{July 2014 occurred on }}\\\\ \\scriptstyle {\\hbox{20 July 2014}}\\end{array}}\\\\ \\underbrace {\\left( {1 - F_1\\left( {\\tau _3 - t_1|\\lambda ,\\bar Ee^{\\lambda t_1}W_3} \\right)} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{No exportation between 21 July 2014}}\\\\ \\scriptstyle {\\hbox{and 31 July 2014}}\\end{array}} {\\mathrm{ }} \\times \\underbrace {\\left( {1 - F_1\\left( {\\tau _4 - \\tau _3|\\lambda ,\\bar Ee^{\\lambda \\tau _3}W_4} \\right)} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{No exportation during }}\\\\ \\scriptstyle {\\hbox{August 2014}}\\end{array}} \\\\ \\underbrace {f_1\\left( {t_2 - \\tau _4|\\lambda ,\\bar Ee^{\\lambda \\tau _4}W_5} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{The first exportation in September 2014}}\\\\ \\scriptstyle {\\hbox{occurred on 19 September 2014}}\\end{array}}\\underbrace {\\left( {1 - F_1\\left( {T - t_2|\\lambda ,\\bar Ee^{\\lambda t_2}W_5} \\right)} \\right)}_{\\begin{array}{l}\\scriptstyle {\\hbox{No exportation between }}\\\\ \\scriptstyle {\\hbox{19 September 2014 and }}\\\\ \\scriptstyle {\\hbox{21 September 2014}}\\end{array}}\\end{array}$$\\end{document}Lexport\u03bb,i0=1-F1\u03c41\u2223\u03bb,\u0112W1\u23dfNoexportationupto31May20141-F1\u03c42-\u03c41\u2223\u03bb,\u0112e\u03bb\u03c41W2\u23dfNoexportationupto30June2014f1t1-\u03c42\u2223\u03bb,\u0112e\u03bb\u03c42W3\u23dfThefirstexportationinJuly2014occurredon20July20141-F1\u03c43-t1\u2223\u03bb,\u0112e\u03bbt1W3\u23dfNoexportationbetween21July2014and31July2014\u00d71-F1\u03c44-\u03c43\u2223\u03bb,\u0112e\u03bb\u03c43W4\u23dfNoexportationduringAugust2014f1t2-\u03c44\u2223\u03bb,\u0112e\u03bb\u03c44W5\u23dfThefirstexportationinSeptember2014occurredon19September20141-F1T-t2\u2223\u03bb,\u0112e\u03bbt2W5\u23dfNoexportationbetween19September2014and21September2014In summary, we infer (\u03bb,i0,\u03b8before,\u03b8after) using the likelihood\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$L\\left( {\\lambda ,i_0,\\theta _{\\rm{before}},\\theta _{\\rm{after}}} \\right) = L_{inc}\\left( {\\lambda ,i_0,\\theta _{\\rm{before}},\\theta _{\\rm{after}}} \\right)L_{\\rm{export}}\\left( {\\lambda ,i_0} \\right).$$\\end{document}L\u03bb,i0,\u03b8before,\u03b8after=Linc\u03bb,i0,\u03b8before,\u03b8afterLexport\u03bb,i0.Note that \u03b8after is defined only after 3 August 2014 and hence not inferred until then. We assume non-informative flat priors for all parameters and use Gibbs sampling52 to estimate the posterior distributions of (\u03bb, i0, \u03b8before, \u03b8after). We use five MCMC chains and initialize each chain with a starting point randomly generated from the following ranges: \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\ln (2)/\\lambda $$\\end{document} ln(2)\u2215\u03bb (i.e., the doubling time) between 1 and 100 days, i0 between 1 and 100, \u03b8before between 0 and 1, and \u03b8after between 0 and 1. The trace plot and Geweke diagnostic indicate that each MCMC chain converges within 100,000 iterations and the autocorrelation of the samples in the MCMC chain drops below 0.05 when the lag is larger than 2000 steps. As such, we estimate the posterior distribution of (\u03bb, i0, \u03b8before, \u03b8after) by running the Gibbs sampling for 5.5 million iterations with a burn-in of 0.5 million iterations and a thinning interval of 5000. The Gelman\u2013Rubin diagnostic indicates that all five chains converge to the same posterior distribution.\n\nGiven an estimate of (\u03bb, i0, \u03b8before, \u03b8after), the cumulative number of symptomatic Ebola cases up to time t was:\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$C\\left( t \\right) = i_0\\mathop {\\int}\\limits_0^t {e^{\\lambda t}\\left( {\\frac{{b_E}}{{\\lambda _i + b_E}}} \\right)^m} \\Gamma \\left( {(\\lambda _i + b_E)t,m} \\right){\\rm{d}}t$$\\end{document}Ct=i0 \u222b0te\u03bbtbE\u03bbi+bEm\u0393(\u03bbi+bE)t,mdtand the reporting proportion up to the end of week K was\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\mathop {\\sum}\\nolimits_{k = 1}^K {y_k} /C(7K).$$\\end{document}\u2211k=1Kyk\u2215C(7K).The nowcasted posterior estimates of the epidemic doubling time (which is simply ln(2)/\u03bb) and initial incidence rate (i0) are temporally consistent until mid-August after which both began to increase significantly. This suggests that the epidemic growth rate might have dropped since mid-August, which is plausible in view of substantial increase in mitigation efforts and resources starting in early August36,37. As such, we perform a sensitivity analysis by assuming that the epidemic doubling time changed from D1 to D2 starting on 4 August 2014. Supplementary Figure 10 shows that our main result, namely the estimates of reporting proportion, remain essentially the same.\n\nFor the scenario unadjusted for travel restrictions (Fig. 4b, bottom panel), the retrospective real-time forecasts of the time to next international exportation are obtained by (i) assuming that mobility rates during the forecasted time period were the same as the most current mobility rates and (ii) sampling (\u03bb, i0, \u03b8before, \u03b8after) from their posterior distributions.\n\nCode is available on request from the authors.\n\nGlobal population data (raw data) that support the findings of this study are available from the Gridded Population of the World Version 4 (GPWv4) database at http://sedac.ciesin.columbia.edu/data/collection/gpw-v4. Restrictions apply to the availability of the worldwide air-traffic data set from the Official Airline Guide (https://www.oag.com/), which were used under license for the current study. Source data for case studies (Fig. 4; Supplementary Fig. 10) are tabulated in Supplementary Tables 1 and 2."}