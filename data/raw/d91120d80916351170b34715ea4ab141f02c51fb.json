{"title": "Prophage genomics reveals patterns in phage genome organization and replication", "body": "Phages are major drivers in global biogeochemical cycles through the control they exert on bacterial populations. Despite their abundance in the environment they are under-represented in sequence databases and knowledge-bases. Phages' two life cycles, the lytic and lysogenic cycles, provide a unique window into phage genomics. During the lysogenic cycle, temperate phages integrate their genomes into their host's genome in a non-lethal fashion to generate a region of DNA known as a prophage -either as a plasmid (1) or by directly recombining with the host's genome (2, 3) . The phage replicates in the host genome until external signals promote a transition to the lytic cycle, at which point the phage hijacks the host's cellular DNA replication machinery in order to replicate the phage genome, and adopts the host's protein synthesis machinery to create new phage particles. Eventually the phage lyse releases infective particles to find new hosts to attack.\n\nThe activation and movement of a prophage from one host to another enables phages to act as mediators of horizontal gene transfer, via either generalized or specialized transduction (4) . This phagemediated horizontal gene transfer may account for up to 10 15 transduction events per second (5, 6) .\n\nPhage-mediated horizontal gene transfer events are responsible for the spread of novel functions including the development of pathogenicity in bacterial strains such as Escherichia coli O157:H7 (5), Vibrio cholerae El Tor N16961 (7) , Streptococcus pyogenes (8) and many Staphylococcus aureus strains (9) . Phages may mediate the spread of antibiotic resistance in the mammalian intestine (10) , and also transfer more benign genes such as those involved in photosynthesis (11) .\n\nWe recently proposed a new model for phage host interactions that suggests at higher host densities ecological considerations favor the temperate lifestyle (12). The increased energy available at high host densities allows bacteria to support the replication of prophages, which in turn provide beneficial protection to the host via super-infection exclusion. The phages are using their host for replication, but are also providing protection for their host from other invading phages.\n\nIdentification of prophages in bacterial genomes is complicated by the problem that many phage genes do not share sequence homology with other proteins. In some cases a newly discovered phage does not carry any genes that share sequence similarity to any other gene in the available databases, highlighting how little we know about these viruses (13) . The underrepresentation of wellannotated phage genes in available databases makes it difficult to assign functions to newly sequenced genomes. This is exacerbated as genome sequencing increases at a near-exponential rate, requiring reliance on automated annotation software that is dependent on primary sequence similarity to assign functions to new genes (14, 15) . Most prophage identification algorithms rely on sequence similarity to known phage genes to identify prophage regions (16) (17) (18) (19) (20) . This leads to a paradoxical problem of not being able to identify a prophage that does not contain any regions homologous to known phage proteins. Our prophage-finding program, PhiSpy, uses a novel algorithm that is capable of identifying a prophage even if there is no similarity to any of the proteins in the databases by analyzing a suite of genomic characteristics that separate phage-encoding regions from the bacterial core of the genome (21) .\n\nHere we present an analysis of over 11,000 bacterial genomes from which we identified 36, 488 prophages. We used this data to identify a core phage genome organizational profile and demonstrate that a significant fraction of phage genomes adhere to this model. This genome structure allows us to predict the function of genes with no known homology solely based on their location in the genome.\n\nWe identified the integrase genes in 15,162 prophages, and aligned those genes to infer phylogenetic relationships between prophages. Furthermore, we explored the connection between phage and host genomic characteristics to enable predictions of the bacteria that phages are infecting.\n\nSeveral improvements were made to the PhiSpy program, and we have released a new version of the software and a web site to provide an accessible interface to the program. The most important change we made was to allow PhiSpy to process genomes that were composed of multiple contigs, as the original version of PhiSpy would treat proteins from different contigs as adjoining proteins. The previous version of PhiSpy used a scanning window that looked 40 proteins ahead of the current protein being classified, but to remove the inherent direction bias, we changed the window to be 20 proteins on either side of the protein being classified. For proteins near the edges of contigs, which had fewer than 20 proteins on a side, we included all possible proteins. To update the list of prophage protein annotation keywords, all the phage genomes from PhAnToMe (http://www.phantome.org), and all the complete prokaryotic genomes from GenBank were downloaded. We compared the annotations of each set, and found 12 keywords unique to phage protein annotations: endolysin, terminase, baseplate, base plate, virion, antirepressor, excisionase, Cro-like repressor, cI-like repressor, rIIIA lysis, rI lysis, and rIIB lysis. These keywords were incorporated into PhiSpy for protein classification. In addition to these major changes, many other minor bug fixes were applied. A website was also built so that users can run PhiSpy online, without having to download and install the program and its dependencies: http://edwards.sdsu.edu/PhiSpy/. The source code for the updated version of PhiSpy is available from that website and from GitHub: https://github.com/linsalrob/PhiSpy.\n\nAll bacterial genomes were extracted from the SEED database, which contains both sequence and annotation information that is used by PhiSpy in making prophage designations (14, 15) . The bacterial genomes contained a representative of every genus currently known. The updated version of PhiSpy (version 3.2) was run on all bacterial genomes using the generic bacterial training set option, and the outputs were parsed to identify all predicted prophage regions ( Fig. 1 ). All PhiSpy predictions are available from https://edwards.sdsu.edu/PhiSpy and https://figshare.com/articles/PhiSpy_prophage_predictions/3146656.\n\nProphage coordinates from PhiSpy were used to extract nucleotide sequence data from the original bacterial genome. The nucleotide sequences are available as FASTA files from https://edwards.sdsu.edu/PhiSpy and https://figshare.com/articles/PhiSpy_prophage_predictions/3146656. Putative tRNA-encoding genes were identified from those genomes using tRNAscan-SE (22) . Modal codon usage was calculated from both the predicted prophage and the host genomes as described previously (23) , and tRNA use and modal codon use were compared using the \u03c7 2 -test. The G+C content of the phage and host nucleotide sequences were calculated using custom-written Python scripts.\n\nHigh-quality prophage genome predictions were defined as those where at least one protein was annotated as an integrase, a capsid, a portal, a terminase, and a tail protein. The annotated genes in all\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint the prophages were tabulated to identify a suite of genes that occur frequently in phage genome annotations (integrase, portal, tail, holin, transposase, terminase, endonuclease, capsid, antitermination, Holliday junction resolvase, baseplate assembly protein, primosomal protein, protease-like, lysin, toxin-encoding, and lysozyme).\n\nTo generate the genome alignment, each gene was assigned a unique letter indicating its function. A modified Clustal Omega alignment algorithm that scores +1 for matches and 0 for mismatches was used to align the annotated genomes.\n\nA total of 24,936 integrase (Int) gene sequences were extracted from the high-quality manually curated dataset and clustered using CD-HIT (24) at a 90% 24,936 similarity threshold (an approximate virus \"species\" demarcation (16, 18) to produce 8,536 protein clusters. A representative of each cluster was used in the phylogenetic assessment of the 24,936 genes. In addition, short motifs were identified in the Int genes by using k-mer profiles for k from 4 to 7 amino acids long.\n\nThis approach allowed us to identify shared amino acid motifs including the eight-residue motif at the active site of the tyrosine recombinases. One hundred randomly selected integrases were aligned using Clustal Omega (25, 26) and visualized using FigTree (27). To compare the evolution of phage and bacterial proteins, all 24,936 phage Int proteins were aligned in a pair-wise fashion using the Smith-Waterman algorithm and the percent identity between each pair of proteins was calculated.\n\nBacterial taxonomy was taken from the NCBI taxonomy database (28) .\n\nComputational work was conducted on the Edwards Bioinformatics Lab compute cluster.\n\nStandard Python libraries were used for file parsing and Biopython version 1.65 was used to parse GenBank files. Scripts written for file parsing and data analysis are available in the github repository: https://github.com/hkang408/ProphageGenomics and from https://github.com/EdwardsLab.\n\nProphage genometrics\n\nThe copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint At the time of analysis, the SEED contained 11,941 bacterial genomes spanning 34 different phyla of Archaea and Bacteria (Fig. 2) . A total of 36,465 prophages were identified in 9,883 bacterial hosts (82.76% of the bacteria have at least one prophage). Slightly fewer than one half of the prophages that were identified (15, 765 prophages) contained an annotated Int protein, suggesting that they are phages with the potential to integrate. The mechanism of integration of the remaining phages could not be easily identified (see below). A total of 1,511,644 prophage ORFs were identified -of these, 45.7% or 798,235 ORFs had no known function. In addition, 567 genomic regions had no similarity to any of the proteins in the SEED non-redundant database (15) although these putative prophages had many other hallmarks of prophages such as shorter genes, many consecutive genes on the same DNA strand, and %GC compositional skews. A total of 7,341 portal genes, 6,228 holin genes, 14,771 capsid genes, and 59,010 tail-related genes were identified in the prophage dataset ( Table 1) .\n\nAs we have shown previously, some families of genes are easier to identify than others, and gaps remain in our understanding of families of core phage proteins that we cannot readily identify from sequence homology alone (29) (30) (31) .\n\nAcross the most highly represented phyla, there were an average of between 2.7 (Actinobacteria) and 3.8 (Proteobacteria) prophages found per genome. Within phyla there were also differences (although not statistically significant) in the prophage genome content. For example, Sodalis glossinidius, a proteobacterium, had the most prophages at 29, while several phyla (Caldiserica, Deinococcus-Thermus, Dictyoglomi, Elusimicrobia, and Fibrobacteres) had no prophages, Spirochetes had the shortest prophage genomes on average (25,595 bp), and Bacteroidetes had the longest (46,059 bp) (Fig. 3) . Across all of the prophages, the mean and median prophage genome length was 36,804 bp and 32,352 bp, respectively. Shorter prophage genomes may indicate that the phage is no longer viable and is in the process of being degraded or removed from the host's genome (32) . Alternatively, different genome lengths may represent different packaging strategies used by prophages associated with different phyla (33) .\n\nSeveral prophage genome characteristics correlate with the host's characteristics (34) . For example, the prophage's and host's GC content correlated strongly (R 2 = 0.95; Fig. 4 ). As we have shown previously, the GC content of phage genomes can be accurately used to predict the phyla of the host associated with a phage (to >95% accuracy), however GC content can not be accurately used to predict the phages' host at lower taxonomic levels (35) . Even though %GC content correlates at the 7 . CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint phyla level, there are not enough degrees of freedom in %GC calculations to separate thousands of phages and their hosts. Percent GC is basically a k-mer DNA profile with k = 1. Higher k-mer DNA profiles increase the correlation between phage and host, but when k exceeds 7 nucleotides the data become sparse and over fit the predictions (35) .\n\nPhage integrases are responsible for catalyzing the site-specific recombination event that inserts the phages into the hosts' genome (36) (37) (38) (39) (40) (41) , as well as during replication to help in phage and plasmid genome maintenance. A total of 18,352 prophages (43%) contained an integrase-like protein from one of the two main families -the tyrosine and serine recombinases -named after the catalytic residue involved in recombination. The tyrosine recombinases include the well-studied integrase employed by phage \u03bb to insert its own genome into the bacterial chromosome (2), while the serine recombinases are exemplified by the integrases of Streptomyces phage phiC31 (42) and Mycobacteria phage Bxb1 (43) .\n\nThe 24,936 integrase sequences were clustered at a 90% sequence identity threshold using CD-HIT, which resulted in 8,536 clusters. Representatives from each cluster were used to generate a smaller dataset with which to work.\n\nFive-mer profiles of the amino acid sequences were used to identify an eight-residue motif in one of the catalytic region of tyrosine recombinases with a consensus sequence of HDLRHTFA (Fig. 5A) . The very strong conservation of five of the amino acids (bolded) suggests that they participate in the catalytic activity of these recombinases. Several of these amino acids were identified earlier as invariant among tyrosine integrases or nearly so (44) (45) (46) , and both of the histidines, the leucine, and the arginine have been experimentally demonstrated to participate in DNA recognition, binding, and/or catalysis (41) . Alignment of one hundred randomly selected tyrosine integrases from the condensed integrase set shows that the proteins that contained the motif were grouped together (Fig. 5B) , offering a potential route to identify tyrosine recombinases.\n\nMany phages encode tRNA genes, which enhance phage fecundity (47, 48) . Several hypotheses have been proposed to explain the presence of tRNA genes in phage genomes, including providing The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint tRNAs to compensate for missing or weakly expressed genes in the host (49) . A previous study of 37 phage genomes from 15 bacterial genomes demonstrated that phage tRNA genes compensate for codon bias between host and phage, especially when a codon is common in the phage and rare in the host (50) . In addition, tRNA genes carried by the phage may replace those interrupted during phage insertion into the genome at tRNA genes (51, 52) . It is also possible that encoding multiple tRNA genes provides the phage genome alternative attachment sites to integrate into the host's genome in case the preferred attachment site is mutated and/or occupied by another phage.\n\nA set of 17,539 tRNA genes were identified from the phages in our total dataset and condensed to a subset of 3,833 tRNA genes (as described for the integrase genes). As expected, the tRNA gene profiles in the phages reflect the number of synonymous codons for each tRNA (Fig. 6) . However, we found that tRNA-Met is one of the most commonly carried tRNA genes among the prophages we studied. Phages often encode a peptide deformylase enzyme that removes the formyl group from newly synthesized proteins (53, 54) . We propose that the methionine tRNA genes encoded by the prophages are included to increase the overall rate of translation when the phage enters the lytic cycle. Together, the peptide deformylase and tRNA-Met suggest that phage protein synthesis saturates the host's protein synthesis machinery and that, in many cases, optimal production of phage progeny requires protein translation capacity which exceeds that provided by the host.\n\nWe explored the hypothesis that the tRNA genes compensate for codon bias between the host and the phage. For a tRNA gene found in a prophage, the anticodon was converted to the genomic DNA codon it's associated with. This codon's modal usage was calculated for the prophage's genome, as well as for the host's genome without the prophage sequence. The codon's modal usage in the phage and host was compared using the \u03c7 2 -test. We found that 41.3% of the codons associated with the tRNA found in a prophage had statistically higher modal usage in the phage than in the host (Fig. 6) .\n\nWe applied the same approach to compare the phage's modal usage of the same codon with an expected usage assuming an even distribution given the number of synonymous codons available. This comparison revealed that 31% of the codon associated with the tRNA found in a prophage had a higher usage in the phage than expected by chance. Together, these results suggest that phage-encoded tRNA are supplementing limitations in the hosts translational machinery to ensure that phage particles are produced with high efficiency upon induction.\n\n. CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint Phages have a mosaic genome architecture (55, 56) , in which the genome is organized into groups or clusters of genes. Mosaicism has been proposed to be driven by illegitimate recombination, but it is not clear from previous genomic analyses whether the mosaic boundaries are between clusters of related genes or between individual genes (32, 53, 57) .\n\nWe identified the fourteen most commonly occurring and well-annotated genes within the prophage dataset (Table 1 ). The majority (66.9%; 10,542/15,765) of these predicted prophages had the integrase gene located near one of the ends of the prophage genome. We generated a genome data set where all the genomes were organized with the integrase at the same end of the genome, in some cases by reverse-complementing the genome to place the integrase gene consistently at the left end of every genome, and in other cases by recircularizing the genome in silico and introducing a break that placed the integrase at the left end.\n\nThe resulting alignment allowed us to compare genome architecture across all of the prophages, and revealed that gene order is conserved across phage genomes (Fig. 7a) , suggesting that there is an advantageous order of clusters of related function within the genomes of prophages. To highlight the clusters, we used a modified Smith-Waterman approach, essentially ascribing a single letter to each of the functions and then aligning the genomes based on the order of the functions with a +1 score for a match and no penalty for a mismatch (Fig. 7b) . This shows that the gene order across 1,537 phage genomes is highly conserved, reminiscent of the early-middle-late gene organization of many well characterized phages and eukaryotic viruses (58) (59) (60) . We also visualized the presence of each gene at its location in the genome using a gene density plot (Fig. 8) , which highlights the separation of the genes based on location in the genome. The combined results from these alignments strongly indicate that the mosaicism in phage genomes occurs at the gene-cluster level, and that phage genomes are not comprised of random hybrids of many genomes. Instead, recombination (illegitimate or otherwise) appears to be constrained to result in a highly conserved gene order where the early genes, including those encoding entry and DNA replication functions, precede those encoding packaging functions, which in turn precede tail formation and host lysis functions.\n\nThe phage genome is therefore not a collection of genes that have been acquired at random by recombination, but rather analogous to a computer motherboard, where modules may be replaced provided they are slotted into the appropriate gene expression framework. Thus, a viable phage is more likely to be produced if genes are placed in the appropriate modules. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint (B) Phage gene heatmap aligned using a modified Clustal alignment algorithm, as described in Materials and Methods. Fig. 8 . Gene density plots of the occurrence of phage marker genes along the genomes of 1,537 phage genomes. The genomes were rearranged as described in the text to place the integrase gene at the 5' end of the phage genome, and then genes were displayed as ordered by the modal frequency of each gene.\n\n14 .\n\nCC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint \n\n. CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint \n\n. CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint \n\n. CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint Fig. 8 .\n\n. CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint . CC-BY 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/114819 doi: bioRxiv preprint"}