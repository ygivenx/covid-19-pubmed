{"title": "Modeling and analysis of epidemic spreading on community networks with heterogeneity", "body": "With the development of network science, many common characteristics of real networks have been revealed, where one of the important characteristics is that a wide range of biological and social systems contains community structure [5, 9, 15, 17, [24] [25] [26] . Different individuals may form a community because of the same attributes, such as interest, age, profession and so on. As the large-scale outbreaks of epidemic diseases have occurred many times in different regions and different races in history, it can be said that the history of human history is a history of the struggle against different epidemic diseases. And with the progress of science and technology, the convenient transportation has also promoted the spread of the epidemic diseases to a great extent, for community links. They found that the existence of community makes the degree distribution get broader, and the epidemic threshold decreases with the increase of community strength (p/q) [11] . Huang and Li studied the SI dynamics on scale-free network with community structure, they found that the community structure makes the growth of the infection slow and the epidemic prevalence reduce [7] . Salath\u00e9 and Jones investigated the epidemic spread in empirical and artificial networks with community structure, and got the similar conclusion: the community structure has inhibiting effect on epidemic spreading, and the peak value of epidemic prevalence decreases with the increase of community strength. Moreover, they found that immunizing bridge nodes is more effective than simply immunizing highly connected nodes in networks with strong community structure [20] . To understand the influences of community structure and clustering coefficient on SIR (susceptible-infected-removed) dynamical processes, Wu and Liu presented a network model with adjustable clustering coefficient and adjustable community strength, and found that for a fixed community strength, the efficiency of epidemic spreading will decrease with increase of the clustering coefficient [27] . Chu et al. investigated the epidemic spreading on weighted scale-free networks with community structure, and found that compared to the internal weighting exponent, the external weighting exponent has higher impact on slowing the epidemic spreading [3] . On this basis, Min et al. further studied the spread of disease on weighted scale-free community network with two mixing styles [13] : a dense-weak style and a sparse-strong style. In [2] , the authors studied the epidemic dynamics on a network with overlapping community structure and found that the epidemic prevalence increases with the increase of overlapping region. Some scholars constructed a random network composed of a sparse community and a dense community, and they studied the phenomenon that the disease persists throughout the dense community, while the outbreak and extinction states occur periodically in the sparse community [18] . Shao et al. studied the epidemic dynamics in a small-world community structure network with consideration of a traffic-driven SIS epidemic model [21] , and found that the community structure can accelerate the epidemic spreading in the traffic-driven model. Stegehuis et al. studied two random network models that create a network with similar community structure [4] , and found that the community structure can both enforce as well as inhibit diffusion processes, and the exact internal structures of communities barely influence the behavior of spreading processes. Based on the SI (susceptible-infected) epidemic model, Shu et al. numerically studied how weak ties (connect pairs of nodes belonging to different communities) influence epidemic dynamics [23] . Some scholars studied the SEAIR (susceptibleexposed-asymptomatically infected-symptomatically infectedrecovered) [32] and the stochastic SIR [31] epidemic model on scale-free networks with community structure. Bonaccorsi et al. analyzed a continuous-time SIS model on a community structure network in which individuals that belong to different communities have different infecting probabilities [1] . Ren et al. investigated SIS epidemic spreading processes on a time-varying community structure network [19] . Xia et al. presented a new epidemic SIS model to investigate the spreading behavior on community structure networks with dynamical topology. They found that the epidemic threshold is only related with the population density within the community, and the long-range motion will make the original disease-free community become the endemic state [28] .\n\nIn most existing community network models, the researchers often ignored the heterogeneity among different communities. However, in the real social networks, the physical contacts among individuals in some communities are more closer than in other communities, which reflects the heterogeneity among communities. For example, in real social networks, young students community interact with each other more frequently than elderly people community. Furthermore, studies have suggested that heterogeneity in contact patterns among individuals in heterogeneity communities has an important effect on the epidemic spreading [10] . In addition, many scholars are concerned about finding ways to suppress the spread of the virus, such as looking for more effective immune strategies and raising awareness of the individuals. While some scholars hope to find the source of epidemic spreading and control the epidemic spreading in the early stage of epidemic spreading [6, 8, 22, 33] . When there exists heterogeneity among the communities in the network, we are curious about whether the difference in the location of the source of infection will affect the spread of the virus, and want to study the transmission rule of epidemic on the community structure network with heterogeneity among communities, which is helpful for us to find an effective control strategy for epidemic spreading.\n\nMathematical modeling of the dynamics of infectious diseases, as a quantitative research method, has been widely used in the field of the epidemic spreading. In this paper, we firstly construct a new community structure network model with adjustable heterogeneity among communities. Then we establish a novel epidemic spreading model based on this network model and calculate the epidemic threshold. And we analyze the impacts of heterogeneity among different communities and modularity coefficient on epidemic spreading either. The rest of this paper is organized as follows. In Section 2, we introduce in detail our network model, and the network characteristics are discussed either. In Section 3, we define the epidemic model and introduce the mean field equations. Then we give some numerical and simulations which support the theoretical analysis in Section 4. Finally, this paper ends with concluding remarks in Section 5.\n\nThe possible mechanisms of constructing a community structure network have been revealed by many models [2] [3] [4] 7, 11, 13, [18] [19] [20] [21] 27, 28] , and these network models also take into account different actual features of the real networks, like clustering coefficient [27] and edge weight [3, 13] . Most of the models ignore the heterogeneity among communities, and how it affects the spread of epidemic is a practical and meaningful problem. In [10] , by observing the real populations in the populated city Hong Kong, the researchers find out that the heterogeneity of contact patterns of individuals within and between different age groups is an important impacting factor in the transmission of infectious diseases, so they take into account the age structure of a population and the different contact patterns among individuals in different age groups and propose an age-structured model. When the groups of different ages mentioned in Ref. [10] are regarded as different communities, the whole population in the city can be viewed as a community structure network with heterogeneity. In this section, we construct a new community structure network model with heterogeneity among communities based on random network, in which the average degree of each community may be different.\n\nAssuming that there are m different communities, each community has n i ( i = 1, 2, . . . , m) individuals. The generating algorithm of the new community network with heterogeneity can be described as follows:\n\n(1) Each node is assigned to a single community in accordance with the communities' size.\n\n(2) At each time step, each pair of unconnected nodes in i-th community can be connected with probability p in i . It should be noted that the inter-community connection probability of each community (p in i ) may be different. (3) At each time step, randomly chose two nodes which are not neighbors and belong to different communities, then connect them with probability p ex to create an inter-community link where p ex \u226a min(p in i ) , which makes the community network has a strong community strength.\n\nThrough the above process, a community network with heterogeneity can be generated, in which the heterogeneity among communities is manifested in the difference of the average degree of each community \u27e8k i \u27e9. We can get community networks with different heterogeneity by adjusting p in i . When given a set of different networks, to measure the strength of heterogeneity among communities for each network, we set a heterogeneity strength function H and its expression is:\n\nAssume that these networks all have m communities. In Eq. (1), the numerator D (\u27e8k i \u27e9) denotes the variance of the communities' average degree of a network, it can be expressed as:\n\nwhere the sub item \u27e8k\u27e9 in Eq. Suppose that the total number of edges is E, we obtain:\n\nAs an important measurement for the community strength of community networks, modularity coefficient [15] is defined as follows :\n\nwhere e ij denotes the proportion of edges between community i and j in the entire network. So e ii and \u2211 j e ij can be described as follows:\n\nwhere E represents the total edge number, which is the same as shown in Eq. (3). Thus, the modularity coefficient of our model is:\n\nTherefore, from Eqs. (3) and (7), we can get the relationship between the modularity coefficient Q and other parameters, such as n i , \u27e8k i \u27e9 , p in i and p ex . The values of p in i and p ex can be adjusted to get community structure networks with given modularity Q, n i and \u27e8k i \u27e9 .\n\nThe existence of heterogeneity among communities in the network may lead to a novel phenomenon on the epidemic spreading. So in this section, different from the previous mathematical model, we will describe the spreading process by a novel SIR (susceptibleinfected-recovered) mathematical model, which is based on each community and considers both of the inter-and intra-community epidemiological processes of all nodes in a community.\n\nIn the initial stage of epidemic transmission, there are only a small number of infected individuals in the network, and the rest of them are susceptible individuals. At each time step, an susceptible individual can be infected by one of its infected neighbors with probability \u03bb , and an infected individual can be recovered with probability \u03b3 . The infection process contains two parts for each community in general: intra-community infection and intercommunity infection. Let \u27e8k i \u27e9 denote the average degree of intra-community within communities i , and \u27e8 k ij \u27e9 denote that of inter-community between community i and j . As p in i and p ex are the inner-community and inter-community connection rates, thus\n\ncan be expressed as follows:\n\nand\n\nLet parameters S, I and R respectively represent the density of susceptible, infected and recovered individuals in the entire network. Similarly, S i , I i and R i represent the proportion of healthy, infected and recovered individuals of the i-th community. Then the new epidemic model for each community can be constructed as:\n\nAs the communities of the network have different average degrees, each community has its own epidemic threshold which is called community threshold in this paper. The following question naturally arises. What is the relation between community thresholds and entire network threshold? In the following, we will derive community thresholds and entire network threshold.\n\nLet n S i and n I i denote the numbers of susceptible and infected individuals within i-th community, so S i and I i in Eq. (10) \n\nBecause of the complex structure of community network, theoretical analysis of the epidemic threshold is very difficult. For simplicity, we assume that each community has the same size n, namely, n i = n (i = 1, 2, . . . , m). We substitute Eqs. (8) and (9) into Eq. (10), then the simplified equations are as follows:\n\nCombining\n\nand Eq. (11), we can accurately estimate the threshold. For a community network, if the modularity coefficient Q is large enough, the impact of spread through the inter-community edges on the epidemic prevalence within a community almost can be ignored. Thus, we can approximately estimate the epidemic threshold of a community. The calculation process is as follows. Firstly, the first and third equations in Eq. (11) can be approximated:\n\nwhere the initial condition S i (0) \u2248 1/m . From Eq. (12), we can eliminate the term of I i (t) , namely,\n\nThen compute the integral:\n\nThus, we get\n\nthere will be no infected nodes in the community network, namely, S i (\u221e) + R i (\u221e) = 1/m . Thus, we get:\n\nwhere R i (\u221e) = 0 is a trivial solution of Eq. (15) , and this equation has other nonzero solutions when d\n\nIt is possible that part/one of the communities in the network are/is endemic, while the epidemic do not erupt throughout the network. So the theoretical threshold of the entire network \u03bb c is between the maximum and the minimum of the community thresholds.\n\nIn this section, to discuss the influence of various factors on the dynamics of epidemic spreading, we give a set of simulations on different kinds of community networks with heterogeneity among communities and examine how the outbreak of epidemic is affected by both the heterogeneity among communities and modularity coefficient. In addition, we compare the effects of the infectious source locations on epidemic spreading either. In the following simulations, there is a small fraction of infected nodes in one of the communities initially, while the remaining individuals of the entire network are susceptible.\n\nNext, we make simulations and comparisons based on the homogeneous community structure network with heterogeneity among communities. It is well known that, in real networks, the outbreak of each epidemic is caused by a small number of infected individuals of a local area in the network. Since there are differences among communities, did the location of the initial infection node/nodes has effect on the epidemic spreading? To obtain a definitive answer, we do some simulations on three community structure networks, where each network is constructed based on ER random network model and has three communities with different heterogeneity. Figs. 1-3 show the time evolution curves of epidemic size of three different networks, where the average degrees of three networks are the same, but with different average degrees in each the seed node locations, we assume that the network models have the same average degree of the entire network ( \u27e8k\u27e9 = 20 ) and the community sizes are n 1 = n 2 = n 3 = 500 . We find that, for each network, the location of the infection source affects only the propagation velocity rather than the epidemic prevalence. We also observe that the time duration to reach the steady state is inversely proportional to the heterogeneity among communities. In each simulation, an initial infected node is randomly chosen from a specified community. And for each network, 5000 simulations are taken with a randomly chosen seed node initially. The other simulation parameters are: the infection rate \u03bb = 0.1 and the modularity coefficient Q = 0.6. Fig. 4 shows the effects of heterogeneity among communities on epidemic threshold and prevalence. In the simulations, there are three communities within the network and the communities sizes are n 1 = n 2 = n 3 = 500. We keep the degree of entire network to be constant at \u27e8k\u27e9 = 20 . The graph contains three sets of data, which compare the thresholds and prevalence of epidemic of these community networks. The lines with red dots, black circle and blue asterisk respectively correspond to the networks with intra-community degrees \u27e8k i \u27e9 = {10, 20, 30} , \u27e8k i \u27e9 = {15, 20, 25} and \u27e8k i \u27e9 = {20, 20, 20} . From Fig. 4 , we find that the increase of heterogeneity among communities makes the infectious diseases easier to break out, namely the heterogeneity among communities has negative relation with the epidemic threshold. And the epidemic prevalence of a network with greater heterogeneity among communities is larger than others, whereas the converse situation holds when the infection rate is much greater than the epidemic threshold.\n\nIn Fig. 5 , we study the effect of modularity coefficient Q on the epidemic threshold \u03bb c in three networks with different modularity coefficients (equal to 0.4, 0.5 and 0.6 respectively). In the simulations, there are three communities within each network and the average degrees of three communities are all \u27e8k i \u27e9 = {15, 20, 25} , i = 1, 2, 3 . The degrees of these networks are all \u27e8k\u27e9 = 20 and the communities sizes are n 1 = n 2 = n 3 = 500. It is found that the epidemic threshold decreases with the increase of the modularity coefficient of the network, and the epidemic size of the network with higher modularity coefficient is larger around the epidemic threshold, while the inverse situation occurs when the infection rate is far greater than the threshold. It is necessary to explain that although the threshold values obtained through simulations cannot completely correspond to the threshold deduced theoretically, the relationship between the parameters of the network (especially the heterogeneity among communities H and the modularity coefficient Q ) and the propagation threshold is in accordance with the theoretical deduction. As the existence of heterogeneity among communities, the network models with same average degree of the entire network may show different modularity coefficients, and we cannot be sure whether the results of above simulations are only affected by the heterogeneity. So, we firstly investigate the relationship between heterogeneity and modularity of the community networks that was used before. In the following simulations, there are three communities in each network, and the community sizes are the same. Let the average degree of all networks be \u27e8k\u27e9 = 20. From Eq. (7), we can get the parameters (inter-and intra-community linking rate) that were used to construct the network model with given network configurations. As shown in Fig. 6 , the vertical and horizontal axes in the graph stand for heterogeneity H (see Section 2) and modularity Q respectively. The curve is obtained with heterogeneity. So we can conclude that the results of above simulations in Figs. 1-5 are only affected by the heterogeneity.\n\nThe above simulations aim at the single source of infection. However, in real life people often move and contact to make virus appear in many regions at the same time, leading to multiple sources of infection. In the following, we will do some simulations on how the process of epidemic spreading is affected when multiple sources of infection are distributed among different communities in the community structure network with heterogeneity. In Figs. 7-9, we show the time evolution curves of epidemic size of three different networks, where the average degrees of three networks are the same, but with different average degrees in each community. We assume there are two sources of infection in the network, and that these two seed nodes are located in two communities. The parameters of the three networks used in the simulations are consistent with the previous single source of infection. The other simulation parameters are: the infection rate \u03bb = 0.05 and the modularity coefficient Q = 0.6. For each network, 2000 simulations are taken with two randomly chosen seed nodes initially.\n\nFrom Figs. 7-9, we find that the speed and prevalence of the epidemic spreading change with the locations of the sources of infection. Looking at each figure, we can see that the propagation speed is the fastest and the ultimate prevalence of epidemic spreading is the largest when two seed nodes are located in the two communities with largest average degree, and the opposite situation appears when the two seed nodes are located in the two communities with minimal average degree. And the larger the heterogeneity among communities, the greater the difference between curves. It should be noted that the difference between the three curves is not so large, which means that the locations of multiple sources of infection have little influence on the prevalence of epidemic spreading. Comparing these three figures, we find that the epidemic prevalence decreases with the increase of the heterogeneity among communities.\n\nAs the small world network is a kind of homogeneous network, the WS small world community structure network also belongs to the homogeneous networks homogeneous community networks, namely, the epidemic spreading mathematical model proposed before is still applicable to it. What is to be explained here is that we also do the same simulations in the WS small world community structure networks, and the simulation results are very similar to those obtained based on the ER random community structure networks. Therefore, we will no longer show these simulation curves here. In the last part of this section, we will compare and analyze how the epidemic spreading process is influenced by the topology of three kinds of community structure networks (the community networks respectively constructed based on the ER random network, the WS small world network and the BA scalefree network).\n\nIt is difficult to build an epidemic dynamic model based on the heterogeneous community networks with heterogeneity among communities. In the third section, some conclusions are obtained for homogeneous community network by analyzing the proposed epidemic dynamics model and verified by some Monte Carlo simulations. Next, we construct a heterogeneous community network model considering the heterogeneity among communities, and do Monte Carlo simulations to analyze the dynamics of epidemic spreading. In the following simulations, each network contains three communities, and the community sizes are n 1 = n 2 = 0.1 and the modularity coefficient Q = 0.6 . In order to find out the impact of the location of infection source on the epidemic spreading process, we randomly chose an initial infected node from a specified community in each simulation. From these three figures, we find that the location of the infection source only affects the propagation velocity. The average degrees for three communities are shown in each figure. From Fig. 10 to Fig. 12 , the heterogeneity among communities decreases, while the corresponding epidemic prevalence increases. This is because with the increase of the heterogeneity among communities, the links between nodes become closer in some communities, while the edges of the nodes in other communities are thinning which is analogous to the situation that deleting the inner edges of most communities and adding edges only in a small number of communities, so the epidemic will be suppressed when the virus spreads to the sparse community. Fig. 13 shows the curves of epidemic threshold for each community in a heterogeneous community networks with heterogeneity among communities where the average degrees for three communities are \u27e8k i \u27e9 = {14, 26, 20} , i = 1, 2, 3, and the community coefficient Q = 0.6. Communities with larger average degree of intra-community have smaller epidemic threshold. From Fig. 14 , we can get the global epidemic threshold, and its value indeed between the maximum and the minimum of the communities' thresholds. Fig. 14 shows the curves of epidemic thresholds for three networks with different heterogeneity. And Fig. 15 shows the curves , we find that the heterogeneity among communities has negative relation with the epidemic threshold, namely, the infectious diseases become easier to break out with the increase of heterogeneity among communities. And the epidemic prevalence of a network with greater heterogeneity among communities is larger than others, whereas the converse situation holds when the infection rate is much greater than the epidemic threshold. From Fig. 15 , we find that the epidemic threshold decreases with the increase of the modularity coefficient of the network, and the epidemic size of the network with higher modularity coefficient is larger around the epidemic threshold, while the inverse situation occurs when the infection rate is far greater than the threshold. These conclusions are consistent with those obtained from homogeneous community networks with heterogeneity among communities.\n\nThe networks in real life is more complex, for example, the internal topology of some groups in the network tends to the scalefree network, and some groups are closer to the small world or random networks, that is, several mixing style groups form a large network, we called it the mixing style community network. It is another kind of community network with heterogeneity among communities, which is more consistent with the actual network. However, its mathematical epidemic spreading dynamics model is more difficult to build. Next, we construct the mixing style community structure network based on scale-free network and random network, and analyze the epidemiology through Monte Carlo simulations.\n\nWe first try to see whether the location of the infection source of the mixed mode community structure network will have an impact on the propagation speed and the final transmission scale. Let the average degree in each community be the same, namely, 26, 20} , i = 1, 2, 3. From Fig. 16 , we find that, only the speed of epidemic spreading is affected by the location of the infection source.\n\nFrom Figs. 17 and 18, we find that the value of the global epidemic threshold is indeed between the maximum and the minimum of the communities thresholds. We mainly verify the formal conclusions, and more in-depth studies will be carried out later. \n\nNext, according to ER random network model algorithm, WS Small World Network model algorithm and BA scale-free network model algorithm, we generate three kinds of community structure networks with different community heterogeneity among communities. Using the SIR propagation dynamics model, the epidemic spreading dynamics of infectious diseases in different network topologies are analyzed and compared by simulations. The network and related network parameters in simulation are as follows. There are three communities within each network and the communities sizes are n 1 = n 2 = n 3 = 500, the node degree of the entire network \u27e8k\u27e9 is constant at 20. The graph contains three sets of data, which compare the thresholds and prevalence of epidemic of these community networks. Let the intra-community average degree \u27e8k i \u27e9 respectively be 10, 20 and 30 to generate community networks with larger heterogeneity among communities, and let \u27e8k i \u27e9 respectively be 14, 20 and 26 to generate community networks with smaller heterogeneity among communities.\n\nFigs. 19 and 20 show the time evolution comparison curves of epidemic prevalence with single source of the infection in the BA scale-free community network, the ER random community network and WS small world community network, where the infection rate \u03bb = 0.025. Here, the modularity coefficient Q is set to 0.6 for these three kinds of community networks, and For the propagation velocity of epidemic spreading, from these two figures, we can find that BA>ER>WS, which is consistent with the situation in the networks without community structure. And the peak value of the epidemic prevalence in the BA scale-free community network is obviously far greater than the other two, while the other two networks' peak values are basically the same.\n\nFrom Fig. 21 , we can find that, for these three community structure network models, the change trend of the epidemic threshold of the entire network is in order of WS>ER>BA, which is also consistent with the situation in the networks without community structure. In addition, when the infection rate is near the critical value, with the increase of transmission rate, the growth rate of epidemic prevalence of each network from large to small is BA>ER>WS, and when the rate of infection increases to a certain value, the situation reverses. Finally, the ultimate epidemic prevalence on the WS small world community network is the largest.\n\nTo summarize, we have proposed a modified community network model considering the heterogeneity among communities, which is more close to real networks. Based on this network with heterogeneity among communities, we have presented a mathematical epidemic model for each community and studied the epidemic dynamics in this network model. It has been found that community networks with different heterogeneities but the same average degree have different epidemic thresholds, and the epidemic threshold value of the entire network is between the maximum and minimum values of communities epidemic threshold. And when there is only one seed node in the network, the location of the initial infected individuals affects only the propagation velocity rather than the epidemic prevalence, while when there are multiple sources of infection in the network, the location of the sources of infection will have some influences on both the speed and prevalence of the epidemic spreading. In addition, the epidemic threshold is inversely proportional to the heterogeneity among communities. The study results are helpful to predict epidemic spreading trend more accurately and find useful strategies for controlling disease spreading."}