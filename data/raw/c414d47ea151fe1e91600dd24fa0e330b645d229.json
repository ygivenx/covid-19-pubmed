{"title": "Detection and analysis system for hybridization images of lab-in-a-tube microarray", "body": "Hybridization images of most microarrays are achieved by using fluorescence-labeling technology. The common commercial microarray scanners perform two-dimensional scanning with an X-Y stage and detect fluorescence signal with a photomultiplier tube (PMT). These scanners are widely used with the high-density microarray for gene expression profiling and SNPs genotyping [4] [5] [6] [7] . Some of the new scanner systems broaden the detecting optical spectral range. For example, Sinclair et al. reported a newly designed scanner which was capable of collecting fluorescent spectrum from 490 to 900 nm with 3-30 \u03bcm spectral step [8] . By using confocal scanning mode, image-capturing can be performed during DNA fragment hybridizing process to distinguish the hybridization and non-hybridization sequences [9, 10] . However, microarray scanners with confocal technique need a long scan time when they adopt the high resolution detection mode.\n\nKeywords: lab-in-a-tube microarray, respiration virus detection, image processing.\n\nMicroarrays, which are suitable for high-throughput detection, have attracted more and more attention in the research of cell differentiation, tumor generation, toxicology and the development of new medicines. In a microarray, DNA probes are immobilized on a planar surface. By exposing a microarray to a fluorescence-labeled sample, DNA hybridization and gene information can be obtained [1, 2] . Various microarray platforms have been established in the past decade. Affymetrix's DNA microarrays were patterned with photolithographic technology to achieve high probe density. It is usually used in the gene expression and single nucleotide polymorphism (SNP) researches. Bead array is liquid array platform especially in the SNP scanning research area [3] . Most of the microarrays use confocal fluorescence detection systems for hybridization signal capture. Microarray technology is now becoming a more and more important tool in biological researches.\n\nThe most common microarray substrate materials are based on glass slides or silicon wafers. The technology of microarray fabrication is relatively simple and mature. However, most of the microarray systems are open processing platform; that is, the hybridization and signal detection processes are not conducted in a sealed area, the amplicon could leak out easily, leading to false positive results due to sample contaminations. This limits the use of microarrays in clinical applications.\n\nGenerally, the confocal microarray scanners are used for the microarray made of glass slides or silicon wafers. Most of commercial microarray scanners are designed for the slide microarray, such as the scanners developed by Cartician et al. In China, the National Engineering Research Center of Beijing Biochip Technology and The Institute of Optics and Electronics, the Chinese Academy of Sciences, independently developed such a kind of commercial microarray scanners. Some other commercial scanners were designed for the special microarray, such as the scanners developed by Affymetrix [11, 12] and Illumina.\n\nIn the present work, an integrated microarray system named lab-in-a-tube microarray was developed. Within the system, a new-type cap with a transparent window, and a set of detection probes were immobilized at the inner surface of the cap. All the biochemical and detection processes including gene amplification, amplicon labeling, hybridization, washing and fluorescence detection were carried out in the sealed tube. The cap-microarray substrate is made of plastic other than glass. A small vessel was placed in an Eppendorf tube to hold the hybridization solution for modifying ionic intensity. This technique may cancel out the false results associated with PCR product contamination. The lab-in-a-tube microarray is characterized by easy operation and good repeatability. Eppendorf tube. Good sealing was achieved between the cap and the tube, which prevented the leakage of liquid samples. A DNA microarray consisting of many detection probes was immobilized on the cap inside surface of a 200 \u03bcL Eppendorf tube. A small vessel for liquid sample storage was fabricated and placed inside the Eppendorf tube. Fig. 1 shows the schematic pictures of a new Eppendorf tube. (i) Detection system. The detection system (Fig. 2) consists of sub-systems of hardware and software. The hardware includes three parts: optical, signal collection and signal transfer unit. The software system can be classified into several units: image collection, image correction, semi-auto grid generation, effectiveness verification, intensity calculation, and data analysis.\n\nThe working principle of image collection unit is as follows: light from mercury lamp is focused through light filters, and directed onto the cap of the Eppendorf tube; the fluorescent groups of the detection sample on the tube cap are excited by the incident light to emit light signal with specific wavelength; a digital camera then captures the signals, and stores them in a computer.\n\n(ii) Optical components. A Nikon E200 microscope with a Nikon10 objective lens was chosen due to its stability, reliability and simplicity. As shown in Fig. 1 (b), the system included lamp source, light filters and focus lenses. A 100 W mercury lamp functioned as the light source. The light filters included 488 and 520 nm bandpass filters. A CCD camera served to capture the images.\n\nThe X-Y stage of the system was designed to allow the inspection of multiple Eppendorf tubes without moving the tubes. The signals were collected for each tube sample. An Olympus digital camera was used for image capturing. Each image was collected with 2592x1944 pixels. The image resolution provided sufficient information for data analysis.\n\nThe position deflection of both camera position and sample tube position may cause rotation offset in input images. In the system, image rotation offset is corrected manually. The rule grids shown in the LMAS are designed to help users do the image offset calibration.\n\nInput images were pre-processed in order to reduce background noise and improve image quality. The image pre-processing was done in the present system to obtain high signal-noise ratio and prevent actual sample signal from being filtered out.\n\n(i) Selection of information image. In view of the fact that specific sample features exist only in certain area of collected raw images, to increase processing speed, only information areas are selected for further processing and other regions are removed.\n\n(ii) Background noise process. Background noise (e.g. from light source) was filtered out to increase signal-to-noise ratio.\n\n(iii) Point noise elimination. Two types of image filtration methods are used: smooth filtration and median filtration. In smooth filtration, the average value of signal intensity is calculated and the signal intensity f(x, y) in each pixel is compared with the average intensity of surrounding pixels. If the signal intensity f(x, y) is significantly different from the average of the all pixels, the signal intensity g(x, y) is set at the average value; that is, f(x, y) equals g(x, y).\n\nothers.\n\nx y s x y S g x y\n\n(1) Here, S is the area of smooth window with a size of N by N; T is signal threshold. The effectiveness of this method is dependent on the window size. For a small window, only the interference from sharp peaks can be eliminated, while for a large window, the influence from broad peaks can be reduced at the expense of a reduction in signal intensity in an overall image signal.\n\nIn median filtration, the light density at the center of a window is replaced with the median light intensity of all the pixels in the window, that is,\n\nMedian filtration is a nonlinear filter. In comparison with linear filters (e.g. smooth filtration), the use of median value in replacement of local average improves image quality under certain conditions. The median filter is better for chip image process because of its ability to reduce random noise, which is created by the noise of hybridization. The limitation with median filtration is the possibility of filtering-out of some useful signal if many bright points (information signal) stay closely.\n\nFor most microarrays, the targets on images are arranged in circular or rectangular shapes. Grids are generated in terms of microarray parameters (row, column, and corners), target shape, brightness, and orientation sensitivity. The parameters of a microarray are: row i and column j, upper left corner (LeftTopX, LeftTopY), upper right corner (RightTopX, RightTopY), and lower left corner (LeftBottomX, LeftBottomY). The center position (X, Y) of a target point can be depicted as\n\nStep (RightTop LefTopt )/(Column 1),\n\nStep\n\nwhere StepX and StepY are step lengths of row and column, respectively. MinStepX and MinStepY are fineadjustment step lengths in row and column directions. The triangle method overcomes the position error due to target position deviation by rotation. However, the triangle method is not applicable if all the three target points are dark. To overcome this limitation, the point-line method is used to determine grid position: the step lengths in both X and Y directions are measured with a rule, and the center position of a target is calculated with eqs. (9)- (12) . Assume the step lengths in X and Y directions are SpaceX and SpaceY, the height and width of the image are Im-ageHeight and ImageWidth. Then the center point (X, Y) of a target is Start Space , Once the grid points are determined, the developed software will define a search region (circular or rectangular area), and then find the target. Since the auto-search is sensitive to noise, it is important to define the search region.\n\nWhether the calculation of light intensity is reliable or not depends strongly on the selection of calculation method: the average value method or the median value method. The average value method is a widely used statistic approach and defines the light intensity as the average light intensity subtracted by background intensity. Assume S j is the jth signal region, N is the total pixel in the same region, f(n) is the light intensity of the n-th pixel, and B j is background intensity of the jth signal. The light intensity of the jth signal can be calculated If the I is equal to 1, the nth pixel is then considered as true signal. Otherwise, it is the background noise. In the selection of the three rules, one needs to take into consideration the image features from different microarrays.\n\nIn practice, false signal may appear due to various factors (such as sample purification efficiency, RT-PCR expiration, and poor probe immobilization). In this case, threshold and signal/noise ratio are checked to avoid false results.\n\nThe average value method is simple to use, and applicable to the cases where signal intensity distribution is either uniform or nonuniform. The drawback of the method is relatively high background noise.\n\nThe median value method ranks the pixels in terms of light density and selects a median light intensity. Signal light intensity is defined as the median subtracted by background noise\n\nA microarray with 12 detection probes for 10 different viruses (including SARS) was designed and embedded onto the inner surface of a cap for an Eppendorf tube (Table 1). The microarray was fabricated on agarose that closely adhered to the inner surface of the cap. The inner vessel was placed in the Eppendorf tube to hold the hybridization solution. SARS, entrovirus and influenza A virus samples were mixed with a gene-amplification solution (the concentration is 2 times that of standard test solutions) in the Eppendorf tube. The tube was covered with the microarray-containing tube cap. After biochemical processing of gene fragment amplification with an MJ PCT200 PCR instrument, the Eppendorf tube was put upside down, and the sample solution mixed with the hybridization solution to hybridize at the inner surface of the cap. The lab-in-a-tube system was incubated at 37\u2103 in an oven for 30 min. After centrifugation at 500 rpm for 5 min, the mixed solution was removed from the tube cap.\n\nBecause the median value method is based on the ranking of pixels in terms of light intensity, it may be affected by nonuniform light intensity distribution, and thus may not be applicable to nonuniform light-intensity signals.\n\nTo reduce the influence of background noise, a double-filtration method is developed to calculate light intensity. With this method, true signals are based on the average methods and three justification rules:\n\n(1) The light intensity of a signal in a pixel is larger than that of background.\n\n(2) The light intensity of a signal in a pixel is higher than a threshold. The threshold is defined as the product of the average of all pixels in the signal region and a control factor (k) adjusted for images detected from different microarrays.\n\nThe hybridization results of the microarray inside the Eppendorf tube cap was then characterized with the detection system described above. After signal collection, image correction, noise filtration, intensity calculation, and effectiveness verification, the three virus samples (SARS, entrovirus and influenza) were positive (Fig. 5) . There are three different types of probes for SARS virus detection in the microarray. Two probes showed positive results and the other probe showed negative results on SARS virus (3) Assume S j is the jth signal region, N is the pixel number in the region, f(n) is the light density of the nth pixel, M is the average light intensity of all pixels in the region, and k is the control factor. Then the justification rule is defined as (for probes design, please refer to the related papers [9, 10] ), which was in agreement with the SARS detection guidance from the Chinese Center for Disease Control and Prevention (ChinaCDC) and from United States Center for Disease Control and Prevention (USCDC).\n\nA lab-in-a-tube microarray system for virus detection was developed successfully. The system which consists of a modified Eppendorf tube and a tube cap embedded with capturing probes could enable us to carry out the full experimental processes including PCR process, hybridization and fluorescence detection within the encapsulated tube without opening the cap. The microarray system has been demonstrated to have ability to detect multiple viruses. With the lab-in-a-tube microarray system and conventions biochemical instruments, the present system has been proved to be accurate and fast in sample analysis, cheap and simple to operate, and thus has great potentials for practical applications.\n\nAlthough there are many commercial microarray scanners, they are not designed for the lab-in-a-tube microarray detection. The lab-in-a-tube microarray was modified from the Eppendorf tube. We designed the system for the Lab-in-a-tube microarray detection. Light from mercury lamp is focused on the inner surface of the cap through light filters. The hybridization images from a fluorescence microscope were captured by a CCD, which does not need X-Y stage. The lab-in-a-tube microarray detection system has software for capturing and analyzing the hybridization signals, playing an important role in the image capture, storage and processing. The system can inspect the fault results due to the different factors, such as reagents, sample purification and gene amplification ac-cording to a set of the reference probes. In the mean time, the system records the operator code, image of the hybridization, sample data and detection date. We also provide the web data interface which could give a link to the digital hospital. It is cost saving, convenient for operation, and may find uses in pathogen detection and clinical diagnosis."}