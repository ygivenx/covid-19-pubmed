{"title": "A Markov chain model for predicting transient particle transport in enclosed environments", "body": "In recent decades, outbreaks of airborne infectious diseases, including influenza [1] , measles [2] , tuberculosis [3] , and severe acute respiratory syndrome (SARS) [4] , have occurred indoors. All of these outbreaks have been proven to be associated with the airflow patterns in indoor environments [5] . An infected person can exhale particles carrying pathogens through the activities of breathing, coughing, talking, and sneezing, which are transient in nature. These particles can cause the transmission of infectious diseases to other occupants in the same enclosed environment [6, 7] . Hence, it is essential to predict transient particle transport in the enclosed environment in order to improve air distribution design and reduce the risk of infection.\n\nAs a powerful airflow and contaminant modeling tool, computational fluid dynamics (CFD) has been widely used in predicting transient particle transport in enclosed environments. For particle modeling, the Eulerian and Lagrangian methods are popular. For instance, Li et al. [8] , Seepana and Lai [9] , and Chen et al. [10] studied the effects of ventilation parameters on personto-person particle transport using an Eulerian drift flux model. Li et al. [11] and Chen et al. [12] investigated the effectiveness of covering a cough on reducing the receptor's exposure using an Eulerian method. Hang et al. [13] used an Eulerian model to assess the influence of human walking on the transmission of airborne infectious diseases in a six-bed isolation room. Chen et al. [14] , Gao et al. [15] , and Zhang and Li [16] applied the RNG k-\u03b5 model with a Lagrangian method to calculate the transport of exhaled droplets in a dental clinic, an office, and a fully-occupied highspeed rail cabin. Zhang and Chen [17] compared the Eulerian and Lagrangian methods for predicting transient particle transport from a cough in a four-row aircraft cabin. Wang et al. [18] systematically compared the Eulerian and Lagrangian methods with various turbulence models and found that the Eulerian method was faster than the Lagrangian method. Both the Eulerian and Lagrangian methods can provide detailed information about transient particle concentration distributions. However, even with the Eulerian method, the unsteady-state calculation with iterations in each time step is considerably time-consuming. For instance, Wang et al. [18] reported that the computing times of the Eulerian and Lagrangian methods for calculating transient particle transport in a typical room were 62.2 and 84.9 h, respectively, on an eight-core cluster with two 2.5 GHz AMD quad-core processors.\n\nSeveral studies have demonstrated the ability of the Markov chain technique to quickly predict spatial and temporal particle concentrations. For instance, Nicas [19] and Jones and Nicas [20, 21] applied the Markov chain technique in a multi-zone model. However, this model does not inform users about particle movements between zones with respect to the required input values. Chen et al. [22] further used the CFD approach with Lagrangian particle tracking to obtain such information in order to complete the method. Since Lagrangian particle tracking is highly timeconsuming, this method is suitable only for an extremely coarse grid. Therefore, a new model that not only works on a fine grid, as do the Eulerian and Lagrangian methods, but also runs faster than these two methods, is desirable. This investigation aimed to develop a Markov chain model for quickly predicting detailed transient particle concentration distributions in enclosed environments.\n\nThis study used the renormalization group (RNG) k-\u03b5 model to calculate airflow and turbulence. This model has the best overall performance among all Reynolds-averaged NaviereStokes (RANS) models for enclosed environments [23] . The equations for the RNG k-\u03b5 model can be found in the Fluent manual [24] .\n\nThis investigation assumed that the airflow field was fixed. It could be problematic if the source was able to change the airflow pattern, as in the case of a powerful cough without covering the mouth. Therefore, this study assumed that the mouth was effectively covered when a person was coughing and that, as a result, the influence of the initial momentum from the cough on the receptor's exposure was minimized [12] . Thus, the assumption of a fixed airflow field should be valid in most cases.\n\nThis study used the first-order homogenous Markov chain technique [25] to calculate transient particle transport. This Markov chain technique is effective for particles with a diameter smaller than 3 mm, which have negligible inertial effects [22] . Assuming that the CFD grid has n-1 cells, the additional cell n can be assigned to represent the space to which the particles are removed. Then the probabilities of the state's changing of a particle can form an n \u00c2 n transition probability matrix, p ij :\n\np 1;1 p 1;2 \u2026 p 1;n p 2;1 p 2;2 \u2026 p 2;n \u00ab \u00ab \u00ab p n;1 p n;2 \u2026 p n;n\n\nwhere p i,j is the probability of a particle's moving from cell i to cell j in a certain time step, Dt. The transition probability matrix has the following property:\n\nThis property can be regarded as the constraint of mass balance for the whole domain. Since the movement of the particles normally does not have a major impact on the airflow field, the transition probability matrix is fixed.\n\nThe particle number vector at the present time (state k) is assumed to be:\n\nwhere N k,i represents the number of particles in cell i at time k. Then, after one time step (time k\u00fe1), the number of particles in cell i can be calculated by:\n\nThus, the particle number vector at time k\u00fe1 can be calculated by:\n\nIf one calculates the particle transport from time zero, the particle number vector at time k can be calculated by:\n\nwhere N int is the initial particle number vector. The particle number concentration in cell i at time k can be calculated by:\n\nwhere V i is the volume of the cell. The transition probability matrix can require a considerably large storage memory for a normal CFD grid. To reduce the size of the matrix, Eq. (4) was rewritten as:\n\nwhere the subscript nb represents the neighboring cells or boundaries. Eq. (8) shows that the Markov chain model does not require iterations in each time step. Therefore, this model has the potential to reduce the computing cost.\n\nThe key operation in applying the Markov chain technique to the calculation of transient particle transport is to obtain the transition probabilities, p ij . Again, p ij is the probability of a particle's moving from cell i to cell j in a certain time step, Dt. The first step is to calculate the probability of a particle's remaining in the current cell in Dt, p ii . It is assumed that there are N 0 particles present in cell i at time zero and that these particles can be removed only by the flow of air. The particle mass balance equation for this cell is [19] :\n\nwhere Q i,nb is the airflow rate from cell i to the neighboring cell. Solving Eq. (9) leads to the following equation [19] :\n\nTherefore, after a certain time step, Dt, N(Dt) particles remain in this cell. Thus, the probability of a particle's remaining in the current cell in Dt can be expressed as [19] :\n\nIf cell j is one of the neighboring cells, the probability of a particle's moving from cell i to cell j in Dt can be calculated by Ref. [19] :\n\nwhere Q i,nb consists of the mean airflow rate (Q mean,i,nb ) and the turbulent fluctuating airflow rate (Q fluctuating,i,nb ) from cell i to the neighboring cell:\n\nThe mean airflow rate from cell i to the neighboring cell can be obtained from the CFD simulation results. The turbulent fluctuating airflow rate from cell i to the neighboring cell is determined on the basis of the discrete random walk (DRW) model [26] . The turbulent fluctuating velocity in cell i can be calculated by:\n\nwhere x is a standard normal random number and k i is the turbulent kinetic energy in cell i. This study estimated the turbulent fluctuating airflow rate from cell i to the neighboring cell as:\n\nwhere A i,nb is the area of the connecting face between cell i and the neighboring cell The coefficient a i,nb is calculated by:\n\nwhere Ds i,nb is the distance between the centroid of cell i and that of the neighboring cell. The function F() is the cumulative distribution function for a standard normal distribution:\n\nwhere erf() is the error function. The coefficient a i,nb considers the effects of the distance between the cell centroids and the time step size on the turbulent dispersion of particles. For instance, when the distance between the cell centroids, Ds i,nb , is extremely small, its effect is negligible, and the coefficient a i,nb should be equal to 1.\n\nHowever, when the distance between the cell centroids is extremely large, a particle originally at the center of the cell has almost no chance of moving to the neighboring cell in one time step, and the coefficient should be equal to 0. This investigation used the CFD code ANSYS Fluent 12.1 [26] to calculate the airflow field. A user-defined function (UDF) was implemented in order to realize the Markov chain model.\n\nThis investigation used two cases, transient particle transport in an isothermal ventilated chamber [27] and a chamber with displacement ventilation [28] , to validate the Markov chain model. This section discusses the validation results.\n\nThe first study was the case of transient particle transport in an isothermal ventilated chamber as addressed by Zhang et al. [27] . ward. Particles with a size of 1 mm were injected through the inlet into the chamber. Transient particle concentrations were measured at two locations on a vertical line in the z-directional center-cutting plane and 1 m away from the inlet. The measurement locations were 0.9 and 1.8 m from the floor. Two optical particle counters were used to measure the transient particle concentrations at the inlet and one of the measurement locations simultaneously. Therefore, the experiment was conducted twice in order to obtain the results at the two locations.\n\nNote that the current Markov chain model can only calculate transient particle transport from a pulse source. However, the measurement results show that there was an initial peak in the particle concentration, and then the concentration decreased significantly to a stable level. Thus, this study first divided the inlet concentration into various pulse sources with duration of one time step (Dt). The Markov chain model was then used to calculate the transient particle concentrations from a pulse source, C MC , with an inlet particle number concentration of 1 per m 3 . The total particle concentration can be calculated using the superimposition method [29] :\n\nC in \u00f0n$Dt\u00de$C MC \u00f0\u00f0m \u00c0 n \u00fe 1\u00de$Dt\u00de (18) where Dt is the time step size, m is the number of calculation steps, C in (n$Dt) is the inlet particle concentration at time n$Dt, and C MC ((m-n\u00fe1)$Dt) is the particle concentration from a pulse source with an inlet particle number concentration of 1 per m 3 at time (m-n\u00fe1)$Dt. Three grid resolutions (4,934, 18,009, and 134,090) were tested for CFD grid independence. The resolution of 18,009 was sufficiently fine to capture the turbulent flow in the chamber. The time step size was set at 0.01 s. The independence test showed that this time step size was sufficiently fine to capture the transient features. Particle deposition and resuspension are negligible at a particle size of 1 mm [30, 31] . Fig. 2 compares the numerical results for transient particle concentration with the experimental data. Note that two sets of simulations were performed on the basis of the corresponding inlet particle concentrations, as shown in Fig. 5 of Zhang et al. [27] . In Fig. 2(a) , both the Markov chain model and the experimental data exhibit an initial peak in particle concentration. In Fig. 2(b) , the model and the experimental data both display smaller peaks in particle concentration than those in Fig. 2(a) . Furthermore, the Markov chain model can capture the fact that the peak at this location was delayed in time. In general, the trends in transient particle transport predicted by the Markov chain model agree well with the experimental data.\n\nThe second case was a chamber with displacement ventilation, as shown in Fig. 3 and used by Bolster and Linden [28] This study first used the Markov chain model to calculate C MC and then applied the superimposition method (Eq. (18)) to calculate the total particle concentration. This investigation tested three grid resolutions (19, 100, 53, 740 , and 383,120) for CFD grid independence. The resolution of 53,740 was sufficiently fine to capture the turbulent flow in the chamber. The time step size was set at 0.01 s. The independence test showed that this time step size was sufficiently fine to capture the transient features. Particle deposition and resuspension at a particle size of 2 mm were neglected [30, 31] . Fig. 4 compares the numerical results for transient particle concentration with the experimental data. All the particle concentrations were normalized by the concentration at the source. The Markov chain model and experimental data display similar particle concentration profiles at the locations with heights of 1.7 and 1.4 m. At the location with a height of 1.1 m, the peak in the particle concentration was delayed in comparison with the peaks at the 1.7 and 1.4 m locations, and this delay was correctly captured by the Markov chain model. Furthermore, the model correctly predicted much lower particle concentrations (almost zero) at the location with a height of 0.2 and 0.6 m than at the other locations. To keep this paper concise, the results at these two locations are not presented here. Generally speaking, the trends in the normalized particle concentration distributions predicted by the Markov chain model again agreed reasonably well with the experimental data.\n\nThis study used the validated Markov chain model to predict person-to-person particle transport in a ventilated room. This \n\nThis case was person-to-person particle transport in a ventilated room, as shown in Fig. 5 and studied by Chen et al. [12] . Two persons, represented by heated manikins, were seated face to face in the room, with a distance of about 1.0 m between their noses. The person on the left was assumed to be the index person, while the one on the right was the receptor. The room was ventilated by a mixing ventilation system with an air change rate of 3 ACH. The forced air and thermal plumes generated by the heated manikins formed a mixed convection airflow pattern. The index person was assumed to have a release of particles with zero velocity at time zero. The particle release duration was 0.15 s. A particle size of 1 mm was assumed in order to represent fine particles. Obviously, this case is more complicated than the previously discussed validation cases because of the complicated manikin geometry with unstructured tetrahedral grids. This study used the case to further assess the performance of the Markov chain model in a realistic scenario.\n\nSince no experimental data was available for this case, this study used the Lagrangian and Eulerian models as benchmarks to assess the performance of the Markov chain model. This investigation used a grid resolution of 1,446,790 in the simulation, which was sufficiently fine to capture the turbulent flow in the room [12] . The evaporative process is almost instantaneous for droplets with a diameter of 1 mm [32] . The time step size was 0.1 s. The independence test showed that this time step size was sufficiently fine to capture the transient features. The calculations for this case were performed over a time period of 5 room time constants. For the Lagrangian model, the particle number injected from the source was 2.29 \u00c2 10 6 , which was calculated using the method proposed by Chen et al. [33] . Fig. 6 compares the time-varying particle concentration distributions predicted by the Markov chain model with those predicted by the Lagrangian and Eulerian models in the first 100 s. All three models show that the exhaled particles initially moved upward with the thermal plume generated by the index person. The particles then dispersed throughout the room and reached the receptor. It can be seen in Fig. 6 that the Markov chain and Lagrangian models both predicted slower particle dispersion than did the Eulerian model. Note that both the Markov chain and Lagrangian models use the principle of the random walk model (Eq. (14)) to calculate the turbulent diffusion, while the Eulerian model includes the turbulent diffusion term in the particle governing equation. The numerical diffusion introduced by the Eulerian model may be an important reason for its more dispersive characteristics. Generally speaking, the trends in transient particle transport predicted by the Markov chain model agree well with both the Largangian and Eulerian models. For the calculation as a whole in this case, the Markov chain model was 8.0 times faster than the Lagrangian model and 6.3 times faster than the Eulerian model.\n\nThere are a number of limitations to the present study, beginning with the assumption of a steady-state airflow field. For instance, some sources could change the airflow pattern, such as a powerful cough or sneeze from an uncovered mouth. In these cases, the probability transition matrix would also change. Therefore, the Markov chain model developed in this study is suitable only for those scenarios in which the mouth is effectively covered or the influence of the exhaled air is negligible. In the future, we intend to develop an improved Markov chain model for transient particle transport under unsteady-state airflow conditions. Note that, when combining with the superimposition method, the Markov chain model can also be used for predicting steady-state particle concentrations with a continuous source. However, when compared with the steady-state Eulerian model, the Markov chain model is more time-consuming because it needs to be performed under a transient condition. Therefore, the Markov chain model is not superior for steady-state particle concentration predictions. The Markov chain model that was developed considers the dispersion of particles by the mechanisms of advection and turbulence diffusion. For particles with a diameter smaller than 3 mm, as were used in this study, these are the only important mechanisms in typical indoor environments [30] . If only these two mechanisms are considered, this model can also be used for tracer gas simulations. However, for particle transport, there are other mechanisms, such as gravitational settling, thermophoresis, particle fluctuation due to turbulence, and particle acceleration. Zhao et al. [30] indicated that gravitational settling could significantly affect the particle concentration distribution for particles with a diameter larger than 5 mm. Thus, to model the transient transport of coarse particles, the effect of gravitational settling should be further considered. Furthermore, for coarse and ultrafine particles in a room with a low air change rate, the influence of particle deposition on the particle concentration distribution may be considerable. Therefore, the implementation of particle deposition into the current Markov chain model deserves further study.\n\nThis investigation developed a Markov chain model for quickly predicting transient particle transport in enclosed environments. Within the scope of this research, the following conclusions can be drawn:\n\n(1) The proposed Markov chain model can be used for predicting detailed information about transient particle transport in enclosed environments. (2) The Markov chain model increased the speed of calculation by 8.0 and 6.3 times in comparison with the Lagrangian and Eulerian models, respectively, for the case that was studied."}