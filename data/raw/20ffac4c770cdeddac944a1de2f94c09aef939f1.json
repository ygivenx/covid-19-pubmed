{"title": "Spatial approximations of network-based individual level infectious disease models", "body": "Having the ability to produce accurate mathematical models of infectious disease spread can help provide researchers and government officials with the knowledge needed for making policy decisions directed toward containment of disease spread. Quick and accurate disease models may answer critical questions that can potentially save lives and protect economies. For example, severe acute respiratory syndrome (SARS) in 2003 had a drastic affect on tourism, food and travel, costing China 8.5 and Canada 4.3 billion US dollars (Beutels et al., 2009) . Another example is given by Meltzer et al. (1999) who estimated the economic impact of a future influenza pandemic in the United States at 71.3 to 166.5 billion US dollars.\n\nGenerally, infectious diseases propagate via complex individual-level interactions, or contacts, between infected and susceptible individuals in the population. Combining all individual contact information into a contact network enables researchers to analyze disease spread through the population. There is a substantial amount of literature on network based epidemiology in diseases such as footand-mouth disease and avian influenza, e.g. (Cauchemez et al., 2011; Dub\u00e9, 2009; Jewell et al., 2009; Marchbanks et al., 2011; Streftaris and Gibson, 2004; Zhen et al., 2011) .\n\nHowever, network data that we may wish to use to model the spread of various diseases is often difficult to obtain. Collection of such data is expensive and there are issues regarding recall and privacy encroachment. A connection, or a contact between two individuals, is usually deemed to be any contact between individuals by which the disease can spread from an infected individual to a susceptible individual. The connections themselves can be hard to describe, as researchers must quantify the type of relationship or contact needed for infection to transfer (Keeling and Eames, 2005) . The networks may be social in nature, spatial proximity based, or demographic (Kolaczyk et al., 2009) . For example, a network may be defined by sexual activity between two individuals in the case of a sexually transmitted disease. Alternatively, if trying to model the spread of the Norwalk virus in people, we might use knowledge about which individuals live together in the same house, attend the same schools, or work together, etc. If modeling a livestock disease at the level of individual farms, say, we may want data on the trade networks, supply networks, and even social networks of farmers and farm workers.\n\nDue to the complexity of, and difficulties in obtaining accurate information about, such networks, simplifications are sometimes made in the model being used. For example, we may use a spatial network, rather than a more desirable trade network. Examples of such spatial simplification can be found in a number of models of the UK 2001 foot-andmouth disease epidemic (Chis Ster and Ferguson, 2007; Chis Ster et al., 2009; Deardon et al., 2010; Keeling et al., 2001) . Plant epidemiologists often make such simplifications as their subjects are generally stationary thus allowing infective pressures to decrease exponentially with distance (exponential decay), with a power of distance (geometric decay) or with a nearest neighbor effect (Beutels et al., 2009; Filipe and Maule, 2004) . A piecewise function, similar in concept to the nearest neighbor effect only with a given probability of infection from a long distance source, has also been used in modeling wildlife infectious diseases in which a physical barrier (such as a river) reduces mixing within the population . The simplest assumption to make for any infectious disease model is to assume homogeneous mixing within the population thereby, with no other covariate information, assuming equal infective pressure on all individuals within the population. Bansal et al., 2007 provides insight into the ability of homogeneous-mixing compartmental model's ability to predict the characteristics of network-based epidemics.\n\nDeardon et al., 2010 define a class of individual-level models (ILMs) that can be used to model the spread of disease when its spread depends on various individual-level risk factors. Spatio-temporal aspects of the infectious disease can easily be incorporated into such ILMs, enabling researchers to incorporate spatial proximity to infectious individuals in the model. Similarly, network information can be included in such models. The statistical process of fitting the model to observed data is one key aspect of analyzing epidemic data. ILMs, and similar models, can be fit to data within a Bayesian statistical framework using Markov chain Monte Carlo (MCMC).\n\nThe purpose of this paper is to examine the effect of using spatial information as a proxy to more complex network information when fitting ILMs to epidemic data. Our intention with this paper is to present generic insights into the cost of using a spatial model when the underlying population is connected by a spatially-based network. This is carried out via two simulation studies. These studies involve simulating epidemics, propagated through networks of varying complexity, and comparing the results obtained when both network-based, and spatial-based, ILMs are fit to the simulated data.\n\nThe paper is laid out as follows. The general ILM framework and specific ILMs used in the paper will be outlined in Section 2. Epidemic study and model assessment criteria will also be discussed. Section 3 presents the results of the simulation studies via the use of our chosen model assessment criteria. Conclusions that are made from the results as well as a list of possible future work will be given in Section 4.\n\nThe general framework of individual-level models (ILMs) for infectious disease is presented in Deardon et al. (2010) . Here, we briefly review this framework in the context of a susceptible-infectious-removed (SIR) compartmental class of models.\n\nIn a discrete time SIR model each individual i can be in one of three states at any time point: i 2 S implies that the individual is susceptible to the disease; i 2 I implies that the individual is infected and is infectious; i 2 R implies that the individual is removed from the population and no longer able to be infected or infect other individuals (e.g. by recovering and gaining immunity to the disease or dying). An individual i in one of these states at time t is denoted to be in the set S\u00f0t\u00de; I\u00f0t\u00de, or R\u00f0t\u00de, respectively. The epidemic history comprises S\u00f0t\u00de; I\u00f0t\u00de; R\u00f0t\u00de for t \u00bc 1; . . . ; t max where, t max is the time at which the last infectious individual enters the removed state. Individuals within the epidemic may only move from S ! I and I ! R. Individuals are defined as discrete points in space and time with the probability of a susceptible individual i becoming infected with the disease at time t equal to P it \u00bc 1 \u00c0 exp f\u00c0n\u00f0i\u00de X j2I\u00f0t\u00de q\u00f0j\u00dej\u00f0i; j\u00deg \u00c0 e\u00f0i; t\u00de\n\nwhere n\u00f0i\u00de is a function representing potential risk factors associated with susceptible individual i contracting the disease; q\u00f0j\u00de is a function representing potential risk factors associated with infectious individual j transmitting the disease; j\u00f0i; j\u00de is an infection kernel representing potential risk factors involving both infected and susceptible individuals j and i, respectively; e\u00f0i; t\u00de is a function that accounts for some random behavior within the epidemic that cannot be explained by the other terms in the model (e.g. infection of a susceptible individual by an infectious individual from outside the observed population). For the purpose of this paper e\u00f0i; t\u00de is set to zero.\n\nWe define the epidemic history as fS\u00f0t\u00de; I\u00f0t\u00de; R\u00f0t\u00deg tmax t\u00bc0 . Given the complete epidemic history the likelihood can be computed as:\n\nwhere, y is the observed epidemic data; h is a vector of parameters; I\u00f0t \u00fe 1\u00de n I\u00f0t\u00de is the set of newly infected individuals at time t \u00fe 1; and S\u00f0t \u00fe 1\u00de is the set of susceptible individuals at time t \u00fe 1.\n\nWe now introduce the specific forms of the general ILM, given in (1), used in this paper. Here, if the infection kernel j\u00f0i; j\u00de \u00bc j\u00f0d ij \u00de, where d ij is the Euclidean distance between individuals i and j, then we refer to the infection kernel as a distance kernel.\n\nThe primary epidemic-driving characteristic of the network ILM is the existence (or not) of an edge in a contact network representing the existence of a link between two individuals through which disease can potentially transfer. The probability that individual i is infected at time t under the network ILM is given by:\n\nwhere, a is an infectivity parameter, and c ij \u00bc 1 if a connection exists between individuals i and j 0 otherwise:\n\nThe contact network remains constant over time and is utilized when allowing the epidemic to spread within the population and fitting the network ILM model.\n\nThe geometric ILM is based upon a geometric distance kernel where j\u00f0d ij \u00de \u00bc d \u00c0d ij characterizes the risk of infection depending on the distance. Here, the probability that individual i is infected at time t is given by:\n\nwhere, c is an infectivity parameter for contracting the disease, d is the spatial parameter, and d ij is the Euclidean distance between individuals i and j.\n\nThe exponential kernel model is based upon a distance\n\nwhere g is an infectivity parameter for contracting the disease and k is the spatial parameter.\n\nThe constant piecewise model is characterized by a distance kernel that is based on a piecewise constant infectivity dependant on a single change-point. The probability that individual i is infected at time t is given by:\n\nwhere,\n\nThe homogeneous mixing model is the simplest model among all models being tested. Probabilities of infection are based purely on the number of infected individuals in the population at a given time. The probability that individual i is infected at time t is defined by:\n\nwhere, x is a constant transmissibility parameter. Thus, at any given time t each susceptible individual has an equal chance of being infected.\n\nHere we consider two studies, the purpose of which is to answer the question, how far can the spatial proxy to the true underlying network be relied on to provide reasonable model fit.\n\nThe epidemic population consists of 625 individuals, positioned on a 25 \u00c2 25 grid such that each individual, i, is located spatially at the coordinates \u00f0x; y\u00de for all combinations of x; y \u00bc 1; . . . ; 25. Simulated contact networks produced for this study are based on three parameters, e in ; e out , and radius r. The probability of an undirected connection between two individuals within distance r of each other is equal to e in , while the probability of a connection for distances greater than r is e out . A contact network for a given population can be generated for given e in ; e out , and r parameters. A total of 27 combinations of parameter values are used to generate epidemics. The values of the parameters used are: e in \u00bc \u00f00:3; 0:5; 0:7\u00de; e out \u00bc \u00f00:0; 0:05; 0:2\u00de, and r \u00bc \u00f03; 5; 7\u00de. Epidemics are then simulated using the contact network generated and the net- \n\nThe population for this study contains the same number of individuals, grid layout and size as study one. However, contact networks used in this study incorporate the existence of super-spreaders in a population in which the underlying probability of contact decays continuously over distance. This underlying probability of an undirected connection between two individuals follows a geometric spatial decay according to\n\nAdditionally, super-spreaders are superimposed on the network. These super-spreaders are randomly chosen individuals that are forced to have a relatively large number of connections with other individuals selected completely randomly from within the population. In this study, the spatial decay parameter, D, is either set at ''high'' or ''low'' rates of 1.1 and 0.75, respectively. The number of super-spreaders is set at either 10 or 40. The number of random connections for each super-spreader is simulated from a Poisson distribution with a mean of either 20 or 50. Therefore, eight parameter combinations are used to generate contact networks. Epidemics are then simulated in the same procedure and according to the same network model (3) as in study one.\n\nThe algorithms for both contact networks were chosen and created to provide broad yet sensible examples of possible networks. The piecewise function for generating contact information within study one is simple with a clear change-point spatial relationship. An example of this system could be seen in developing countries where travel distance is localized. The super-spreader concept of study two increases the randomness and connectivity within the contact network. Lloyd- Smith et al. (2005) postulate that super-spreading is inherent within many epidemics, this concept drove the methodology behind this contact network. In both cases the underlying network generators were chosen with the view that they would generate a wide range of networks, some of which a spatial ILM might be able to model well, and some of which not.\n\nThe networks produced under these schemes will also be applicable to a wide range of disease systems, from systems in which spread is very local (eg. soil borne plant pathogens causing root rot), local with longer distance transmission (eg. domestic animal disease spread via animal contact such as porcine reproductive and respiratory syndrome) with or without super-spreaders (eg. markets in the case of a farming system), and very random (less spatial) systems such as influenza in humans.\n\nModels are fit within a Bayesian framework which uses the likelihood, l\u00f0y j h\u00de, to update prior information, p\u00f0h\u00de, to attain the posterior distribution: p\u00f0h j y\u00de / l\u00f0y j h\u00dep\u00f0h\u00de: Each of the models described (network ILM, geometric ILM, exponential ILM, constant piecewise and homogeneous mixing models) are fitted to the simulated epidemic via Metropolis-Hastings Markov chain Monte Carlo with uniform random walk proposals for each parameter. All priors used, except for that of the constant piecewise radius parameter, are vague, consisting of independent positive half-normal distributions with a mode of zero and variance of 1000. A uniform distribution with bounds of one and ten was used for the radius parameter of the constant piecewise model. This was done to force the fitting of a piecewise kernel and to not allow s ! 0 or s ! 1, which essentially results in the homogeneous mixing model (see Section 4). MH-MCMC chains are run for 50,000 iterations with a burn-in period of 5000. Convergence is confirmed through visual inspection. Posterior means values for each model parameter were calculated individually for all.\n\nModel fit was evaluated at the individual and population level via several assessment techniques. The first criterion is carried out by a comparison of the one-step ahead probability of infection under the posterior mean of each of the fitted models with that of the true model. This is carried out as follows for a given fitted model. In an otherwise susceptible population, six individuals are randomly infected in an area within the centre of the population, corners of the area being given by coordinates (10,10) \n\nwhere c ij is the true contact network. Infection probabilities for the susceptible individuals, D S , are then calculated under the various models using their respective posterior mean estimates (and the true contact network for the network ILM). The posterior mean value used is based only on the individual epidemic replication under consideration. Let P F i be the probability of infection of individual i 2 D S under the fitted model. Given P F i and P T i we define\n\nwhere, jC F j and jD S j are the number of individuals in sets C F and D S , respectively. Thus, H \u00f0F\u00de is the proportion of absolute differences between the fitted probabilities of susceptible individuals being infected under the true model and other considered models that exceed the cutoff value of 0.1. The final H \u00f0F\u00de reported is an average over all ten epidemic replicates. A model which has a smaller H \u00f0F\u00de is considered to be a better fitting model. This model assessment technique allows for the evaluation of model fit at the individual level and is an effective assessment criterion as it provides an overall measure of predictive power for each model at the individual level. The probability of a susceptible individual i becoming infected by a single infectious individual j plotted against the distance between the individuals d ij under the true model and posterior means of the fitted model for each network parameter combination for study one was also used to determined model fit at the individual level. These plots present how each model's spatial characteristics change the probability of infection, this can be compared to the true contact network's model change.\n\nEvaluation of model fit at the population level involved analyzing the posterior predictive distribution of the epidemic timeline. The epidemic timeline is defined as the number of newly infected individuals at each time point. Every posterior predicted epidemic timeline is estimated by drawing a value at random from the respective model parameter's posterior distribution and allowing the epidemic to spread according to the model and its posterior value(s) within the same population for which the posterior information is based on. This procedure is repeated one hundred times for each epidemic. The resulting plot presents a posterior predictive distribution of the epidemic timeline which can be compared to the true epidemic timeline of the original data. Precision and bias of the epidemic timeline posterior predictive distribution can then be analyzed and assessed for each model at the qualitative level. Quantitate information about the posterior predictive distribution of the epidemic timeline was obtained by calculating the mean predicted squared error, MPSE.\n\n1 2500\n\nwhere,n i;t is the predicted number of newly infected individuals at time t for a given posterior predictive epidemic timeline i and n t is the true number of newly infected individuals of the original epidemic. The MPSE, quantifies the variance and bias of each model's posterior predictive distribution for the epidemic timeline. The MPSEs of the ten replicates for each contact network parameter are then averaged and compared, with lower values indicating better results.\n\nThe mean H \u00f0F\u00de for study one and two with a \u00bc 0:4 and infectious period equal to two time units are displayed in Fig. 1 and Fig. 2 , respectively. The posterior mean values of each parameter are the averages over 10 replicates for each fitted model. They are listed within the Supplementary material along with all remaining MPSE and H \u00f0F\u00de data tables for study one and two with a \u00bc 0:1 and infectious period equal to six time units.\n\nThe network ILM was the model for which the best results were expected since the observed epidemic was simulated using a network ILM. Further, the true underlying contact network over which the observed epidemic was generated was used in the fitted model. For all 27 parameter combinations of study one and all 8 parameter combinations of study two, H \u00f0F\u00de are zero for the network ILM.\n\nResults of the MPSE for the network ILM were generally favorable compared to the other models tested.\n\nThe non-network models fit were the geometric ILM, exponential ILM, constant piecewise model and the homogeneous mixing model. There seem to be no obvious simple relationships between H \u00f0F\u00de and either e in or r. However, with a \u00bc 0:1 and infectious period equal to six time units there was an apparent increase in H \u00f0F\u00de with increasing e in . The network parameter that had by far the greatest effect on H \u00f0F\u00de was e out . All non-network models produced the lowest H \u00f0F\u00de values for parameter combinations involving e out \u00bc 0:0. The H \u00f0F\u00de values for all non-network models were substantially higher than the H \u00f0F\u00de values for the network ILM. Non-network model H \u00f0F\u00de values ranked on average from lowest to highest were given by constant piecewise model, geometric ILM, exponential ILM, and finally the homogeneous mixing model. Results between the geometric ILM and exponential ILM were often similar.\n\nPlots of the fitted probability of a susceptible individual becoming infected by an infectious individual against the distance between the two individuals for each of the fitted models under the posterior means, along with the true model, for study one can be seen in Fig. 3 for various combinations of the network parameters.\n\nSimilar to the H \u00f0F\u00de results, MPSE values were highly related to the e out value, with the lowest MPSEs from e out \u00bc 0:0. Model performance for the MPSE depended on the e out value. In all cases the network ILM had the lowest MPSE values followed by homogeneous mixing model, constant piecewise model, exponential ILM, and geometric ILM for e out \u00bc 0:05 and 0:2 however, for e out \u00bc 0:0 the homogeneous mixing model performed the poorest.\n\nIncreases in the number of super-spreaders, the number of connections for each super-spreader and the spatial de- \n\n3.4.1. Geometric model Fig. 3 shows that the geometric ILM predicts the probability of a susceptible individual becoming infected by an infectious individual against distance from the infectious individual for study one fairly well. However, susceptible individuals with small distances from a infectious individ-ual have infection probabilities under the fitted model which are highly inflated; similarly the right tail approaches zero which underestimates the probability of an infection of susceptible individuals that are far from the infectious individual. The geometric ILM's posterior predictive distribution of the epidemic timeline for e out \u00bc 0:05; 0:2 is consistent with reference to the original distribution but have the highest variance about the true epidemic timeline. Additionally, a faster spreading epidemic is predicted for the geometric ILM posterior predictive distributions of the epidemic timeline for e out \u00bc 0:0, an example of which can be seen in Fig. 4 . \n\nThe exponential ILM tended to result in H \u00f0F\u00de values similar to the geometric ILM, however, the geometric ILM on average was slightly better. Fig. 3 shows that the exponential ILM underestimates the probability of a susceptible individual becoming infected against distance from the infectious individual for study one. The exponential ILM posterior predictive distribution of the epidemic timeline for all e out is consistent with the original distribution but has high variance about the true epidemic timeline (see Figs. 5 and 6).\n\nThe constant piecewise model produced the best results under the H \u00f0F\u00de criterion and favorable results using the MPSE criteria. Fig. 3 shows that the constant piecewise model predicts the probability of a susceptible individual becoming infected by a infectious individual against distance between the two individuals well for study one, but did underestimate infection probability for susceptible individuals and improperly estimate the radius. The constant piecewise model posterior predictive distribution of the epidemic timeline for all e out is consistent with the original distribution. The variance is lowest in the class of spatial models and has only slightly higher variance than the homogeneous mixing model for the e out \u00bc 0:05; 0:2 cases.\n\nThe homogeneous mixing model predicts the probability of a susceptible individual becoming infected by an infectious individual using the distance between the two individuals very poorly, for study one. The average H \u00f0F\u00de results were also poor for both studies one and two. Results at the individual level were poor because the homogeneous mixing model does not take into account the distance factor, as all susceptible individuals have the same infection probability at any given time. This notion is an advantage, however, when contact networks contain a large amount of super-spreaders and/or an increased number of connections per super-spreader. As such, the results for the MPSE were favorable as the overall population, with increased connectivity, can be well modeled by a homogeneous mixing model. The homogeneous mixing model's posterior predictive distributions of the epidemic timeline for e out \u00bc 0:05; 0:2 are consistent with reference to the original distribution. The variance is lowest in comparison to all spatial model at these e out levels. The posterior predictive distribution of the epidemic timeline for e out \u00bc 0:0 is severely inconsistent with the true epidemic occurring earlier than predicted, this can be seen in Fig. 4 .\n\nThe purpose of this paper, as stated in Section 1, was to examine the effects of using a spatial kernel based ILM to model disease spread actually propagated through a con-tact network. This was carried out by simulating epidemics propagated through two types of random networks. The first type specified the probability of an edge existing between two individuals as depending on the distance between two individuals being greater, or less than, some constant. Spatial distance within the second study was also used to determine the probability of an edge between two individuals, but was based on a continuously spatiallydecaying probability. The second study added complexity through the inclusion of super-spreaders. Various ILMs were then fit to the resulting data. Model fit at the individual level was assessed by considering the one-step ahead predictive probability of infection based on the posterior mean values of the parameters for the fitted models with that of the true model. At the population-level model fit was assessed my analyzing the posterior predictive distribution of the epidemic timeline through a mean predicted squared error calculation.\n\nWe have seen that in situations where there are only contacts between individuals within a relatively short distance of each other (i.e. e out \u00bc 0 in study one) or are less likely to have contacts over long distances (D \u00bc 1:1 in study two), there is relatively little difference between the performance of each of the spatial models as they all tend to fit reasonably well, in terms of predicting infection probability. However, when contacts occur over longer distances, the spatial models tend to perform poorly. If the probability of a long-distance contact is relatively high (i.e. e out \u00bc 0:2 in study one, or n and/or SS are high in study two), it seems that each of the spatial models performed roughly as poorly as each other, with perhaps a slight preference for the constant piecewise model. Model fit results were not surprising given the mechanics of the simulation. Essentially in the first study, a piecewise function was used for the contact network generation and as such the constant piecewise model would be expected to approximate this aspect well. In the case of the second study, the homogeneous mixing model showed improved results when the super-spreader information overpowered the underlying spatial decay. The super-spreader aspect of the contact network is random and therefore would be best approximated by the homogeneous mixing model. The homogeneous mixing model is a special case of the constant piecewise model. When the radius parameter (s) of the piecewise kernel is outside the bounds of the possible infection distances observed (i.e. s ! 0 or s ! 1). Preliminary model fit of the constant piecewise model utilized a vague prior of a positive half-normal distributions with a mode of zero and variance of 1000 for s. The resulting MCMC chain would often converge to a homogeneous mixing model case. For the purpose of this simulation study we wanted to force the constant piecewise model to be fitted and thus restrict the radius (s) parameter from extremely low or high values. The use of an informative prior, as described in Section 2.9, applied this restriction. Of course, such MCMC convergence issues are indicative of model uncertainty. In the case of a real data analysis, researchers may want to explore this model uncertainty and could do so using techniques such as reversible jump MCMC to explore the joint parameter and model space (Richardson and Green, 1997) .\n\nThere are numerous avenues for further work potentially open to us. Only two types of contact network generators have been studied in this paper. It would be interesting to analyze the results of using the various spatial ILMs for different types of more complex networks. For example, contact structure could be a function of several sub-networks. An example of this might be given by considering influenza for human populations in which different networks describe contacts from living in the same household, attending the same school/workplace, visiting the same general practitioners, and so on.\n\nIn this paper, we assumed a known and fixed infectious period for each individual. Obviously, it would be more realistic to have a situation where the infectious period, and possibly a latent period, are generated from some distribution. The infectious periods and latent periods for individuals could then be estimated as part of a data-augmented MCMC scheme, along with the distribution of those periods. This was not done here, to avoid the substantial, additional computational burden that would result from such a scheme and to avoid extra uncertainty which could confuse results.\n\nAs previously stated, obtaining complete contact network information is exceedingly challenging. Studies into the amount of uncertainty about the network information that could be incorporated into a Bayesian analysis, in which the network itself is treated as an unknown parameter, before conclusions drawn from the model becomes unreliable, would also be of interest.\n\nThe intention of this paper was to present generic insights into the cost of using a spatial model when the underlying population is connected by a spatially-based network. We therefore purposefully avoided using a specific application. Of course, when modeling a real life outbreak and specific disease system, the model to be fit will need to be tailored to the data collected, as well as the underlying disease system. We have seen that the performance of the simple spatial disease transmission models can break down easily under various scenarios when the underlying contact structure is more complex. Optimal model fit is achieved when the structure of the model incorporates the characteristics of the disease spread; this includes the contact network. If modeling a wildlife epidemic, steps must be taken to determine how the mixing is occurring. At a spatial level this may mean incorporating aspects describing within herd dynamics, immigration and emigration rates, physical barriers to movement, and peak times of activity. With airborne pathogens spread to plants, models highlighting the spatial decay may indeed be adequate but could be improved upon if windspeed and other weather characteristics were also taken into account. Perhaps the overriding lesson to be drawn from the results shown here is the importance of putting in place a policy of procedures to collect high quality network (and other) data from the system of interest.\n\nSupplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/ j.sste.2013.07.001."}