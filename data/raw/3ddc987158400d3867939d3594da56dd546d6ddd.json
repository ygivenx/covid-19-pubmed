{"title": "A novel framework for inferring parameters of transmission 1 from viral sequence data", "body": "Straightforward statistics describing a population may generate misleading inferences of population bottleneck size. In the illustrated case, the genetic structure of a population is changed by a population bottleneck during transmission, but the frequency of each allele within the population does not change; an inference of bottleneck size derived from single-locus statistics would incorrectly be very large. C. Noise arising from the process of collecting and sequencing data is likely to produce differences between the observed populations, even in the event that the composition of the viral population was entirely unchanged during transmission.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. Here we used simulated data to evaluate the performance of our model under different circumstances. is likely to result from noise. Here we note failures in the inferred bottleneck size even with very high 170 C; these occur due to the finite read depth in our simulations, which averaged around 12,000. In these 171 calculations a neutral method, in which selection was assumed to have no effect on the population, was 172 used to make inferences from neutral simulations. A consistent value of C was used for simulation and 173 inference purposes.\n\nIn a real dataset, the extent of noise may be unknown. Further investigation showed bottleneck 176 estimation to be relatively robust to an incorrect estimate of the extent of noise in a dataset, except 177 where the extent of noise was substantially overestimated (Supplementary Figure S1) In contrast to measures of diversity, which attempt to associate selection with a gene or segment of a virus, 226 our method was able to correctly identify specific variants conferring increased transmissibility. Success 227 was more often achieved in cases for which selection was relatively strong and the transmission bottleneck in one direction or another by more than the expectation; this leads to false inferences of selection.\n\nGenuine changes resulting from selection become easier to identify when the changes are themselves 242 larger (stronger selection) or where the magnitude of the stochastic effect is reduced (higher N T ). In The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint . True positives were defined as inferences for which selection was inferred for the selected locus in a system; false positives were defined as inferences for which selection was inferred at any neutral locus or for multiple neutral loci in the system. Supplementary Table S1 . We have here presented an approach for jointly inferring a population bottleneck size and selection for dif-307 ferential transmissibility from viral sequence data describing a transmission event. While basic sampling 308 approaches to bottleneck inference have been improved by an accounting for drift during within-host viral 309 growth [7, 12-14], our approach additionally accounts for noise in genome sequence data, exploits partial 310 haplotype data available from short-read sequencing, and separates the influence of a finite bottleneck 311 from that induced by selection for increased transmissibility. In multiple studies, the transmission bot-312 tleneck has been found to be narrow during natural viral spread between hosts [59]. While we do not 313 explicitly question these results, we note that both selection and noise in the measurement of sequence 314 data can decrease the inferred bottleneck where sequence data is used for inference. Our approach is The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure 8 . Inferred fitness landscape for within-host growth using data from the HA190D225D dataset. Viral haplotypes for which the inferred frequency rose above 1% in at least one animal are shown. Lines show haplotypes separated by a single mutation. Figure 9 . Histograms of bottleneck inferences for HA190D225D and Mut transmission pairs from 100 analysis seeds. A replicate inference method was employed for the Mut transmission pairs such that a common fitness landscape was imposed. The Mut transmission pairs may take different bottleneck values and have been plotted as an overlapping histogram. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint\n\nApplied to the analysis of data from a recent evolutionary experiment, our approach provides a 321 greater precision in the inference of evolutionary statistics, leading to an alternative explanation for the 322 data observed. Where data have previously been interpreted as implying differential transmission bottle-323 necks between strains, our approach infers bottlenecks of similar sizes. Furthermore, where evidence has 324 been interpreted to suggest a differing extent of transmissibility between strains, our approach attributes 325 changes in allele frequencies either to stochastic effects or to selection for increased host adaptation. Our 326 result does not definitively prove the absence of differential transmissibility among the viruses involved 327 in this study, but implies that data which might suggest differential transmissibility can be more parsi- to assess viral transmissibility, steps taken to increase the number of particles transmitted would increase 338 the power to infer differential transmissibility. We note that, unlike more general inferences of selection 339 from changes in viral diversity, our approach evaluates selection in terms of specific variants conveying In the light of our study, we propose that the term used in some analyses of viral transmission, of a 345 'selective bottleneck' is ambiguous, failing on the one hand to distinguish changes in a population arising 346 from selection and those occurring through stochastic change in the population, and on the other to 347 distinguish between selection for more rapid within-host selection or for inherent viral transmissibility.\n\nWhile selection may act differently for these latter two phenotypes [54], their respective influences are 349 intrinsically hard to separate from data. In this case, the completeness of the collected data, covering 350 both within-host adaptation and between-host transmission, was necessary to evaluate the cause of evo-351 lutionary change. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint such information could prove powerful for the study of viral transmission. During the process of growth between q F and q A , the population may be influenced by selection 409 for within-host growth; this acts independently of selection for transmissibility [70], and is described by 410 the function S G (q), which changes the frequencies of haplotypes according to their relative within-host 411 growth rates. Selection for within-host growth is challenging to separate from selection for transmissibil-412 ity; we here estimate this parameter independently from the transmission event itself. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Likelihood framework 415 As the observations x B and x A are conditionally independent given q B , the joint probability of the 416 system may be written as a product of individual probabilities\n\nwhere \u03b8 represents the remaining variables in the system upon which only x A depends.\n\nAs an approximation to this likelihood, we split the inference into two calculations, first calculating \n\nThe first component of this likelihood, corresponding to the initial observation of the system, x B , 427 represents a straightforward sampling of the system, drawing from a collection of viral haplotypes. Such 428 a process can be modelled using a multinomial distribution. However, as is well known [53], next-429 generation sequence data is error-prone, such that less information is contained within the sample than 430 would be contained in a multinomial sample of equivalent depth to the sample. A Dirichlet multinomial 431 distribution may be used to capture this reduction of information, such that\n\nwhere C, which alters the variance of the distribution, characterises the extent of noise in the data. The \n\nThe fitness of a haplotype h i is then given as\n\nwhere the sum is calculated over all fitness parameters k. To give an example, a single-locus fitness Selection is incorporated into the transmission event from donor to recipient by representing this event as 466 a biased sampling process. As we are not considering data here, noise is not an issue. We therefore model 467 the population q F as arising via a multinomial sampling process of depth N T from a set of genotypes 468 with frequencies S T (q B ), where S T represents the role of selection in the transmission event. We write The haplotype frequency vector q B is unknown and must be determined from the available data. We :\n\nand\n\nwhere \u03b2 = N B +C\n\n, M (q) = Diag(q) \u2212 qq \u2020 and \u2020 indicates the transpose function. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint\n\nand its variance by\n\narising from a multinomial sample of depth N T and the selectively shifted frequencies S T q B . \n\nand variance\n\nis defined for notational convenience. \n\nThese expressions characterise the x B component of the likelihood from Eq. 2 in terms of a normal dis-530 tribution. We identify values of \u00b5 B and \u03a3 B maximising this likelihood. As the covariance matrix \u03a3 B 531 may contain a large number of elements, we make the approximation that its off-diagonal elements are 532 zero.\n\nMoving on to the post-transmission process, the marginalisation over q B results in a mean of\n\nwhere in the penultimate step we used the first-order second-moment approximation to a vector function 536 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint acting on a random variable. The law of total variance yields\n\nNote that (DS) j i = \u2202Si \u2202qj is the Jacobian matrix arising from the first-order second-moment approximation.\n\nMarginalisation over q F yields a mean of\n\nand variance\n\nwhere in the last step we defined \u03b3 = N T +N G \u22121\n\nTreating the integral over q A in a similar manner, we obtain by the law of total expectation\n\nAnalogously, the law of total variance yields 545 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint\n\nThe above expressions represent mean and covariance matrices of multivariate normal distributions or more explicitly, \n\nData from multiple genes 588\n\nThe mathematical framework outlined above utilises the haplotype information inherent to the data, and 589 accounts for the effect of noise in the sequencing process ( Figure 1B,C) . However, in order to discriminate 590 between changes in viral diversity arising from bottlenecking and selection ( Figure 1A ) it is necessary 591 to consider data from different regions of the genome at which genetic diversity is nominally statistially where the subscript m denotes information particular to a specific genomic region. \n\nwhere the subscript r denotes information particular to a specific replicate.\n\nApplication to data 605 Our method was applied to both simulated sequence data, and data from an evolutionary experiment 606 conducted in ferrets [24] .\n\nGeneration of simulated data 608 Simulated data were generated in order to nominally reflect data from an influenza transmission event. . The specific data examined here describes two sets of viral transmissions. In the 637 first, denoted HA190D220D, a viral population was given to three ferrets, transmission to a recipient host 638 being observed in one of three cases, giving time-resolved sequence data from four ferrets. In the second, 639 denoted Mut, a viral population arising from the first experiment was given to three ferrets, transmission 640 to two recipient hosts being observed, giving data from five ferrets.\n\nProcessing of sequence data 642 Genome sequence data was processed using the SAMFIRE software package, according to default set- Figure S13B) . Finally, linear and decay exponential models were fitted to this data via 749 regression, selecting the BIC penalty model which minimised the error in the inferred bottlenecks from 750 the simulation data. We note that our penalty is a function of the inferred population bottleneck, higher 751 penalties being inferred for tight bottlenecks and lower penalties being inferred for looser bottlenecks.\n\nThirdly, the inferred data was reinterpreted to derive a BIC penalty optimal for the inference of The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Table S1 . Inferred fitness coefficients for the within-host evolution of the virus within each experiment. Parameters were inferred across all index and contact ferrets within each experiment and are reported to a single decimal place. Only polymorphisms at which within-host selection was identified are listed. The parameter \u03c7 denotes an epistatic interaction between variant alleles. We note that our method infers the approximate shape of a fitness landscape based upon a reconstruction of whole viral segments; individual selection coefficients may be subject to variance between similar fitness landscapes.\n\nMut HA190D220D PB2 Figure S2 . Median inferred bottleneck size from data simulating neutral transmission and transmission with a single locus under selection of magnitude \u03c3 \u2208 {0, 0.5, 0.75, 1.0, 2.0}. Inferences were made using either a neutral model, in which the effect of selection was assumed to be zero, or a selection model, which allowed scenarios involving selection to be identified. Median inferences are shown from 100 simulations, each involving three replicate transmission events, for each datapoint.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure S3 . Inferred bottleneck sizes N T for a range of true bottleneck sizes. Results were generated by applying a neutral inference model to selected simulated data. Results are shown for 200 simulations at each bottleneck size.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure S4 . Inferred bottleneck sizes N T for a range of true bottleneck sizes. Results were generated by applying an inference model accounting for selection to selected simulated data. Results are shown for 200 simulations at each bottleneck size.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure S5 . Inferred bottleneck sizes N T for a range of true bottleneck sizes. Results were generated by applying a neutral inference model to selected simulated data. Results are shown for 200 simulations at each bottleneck size, each simulation describing three replicate transmission events.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure S6 . Inferred bottleneck sizes N T for a range of true bottleneck sizes. Results were generated by applying an inference model accounting for selection to selected simulated data. Results are shown for 200 simulations at each bottleneck size, each simulation describing three replicate transmission events.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint Figure S10 . Histograms of selection inferences for the Mut transmission pairs from 100 random seeds using an allele frequency cut-off of 2%. A replicate inference method was employed such that a common fitness landscape was imposed. Selection inferences that resulted in at least 10% non-zero inferences are here reported by the nucleotide position of the variant site.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. Figure S11 . Histograms of bottleneck inferences for HA190D225D and Mut transmission pairs from 100 random seeds using allele frequency cut-offs of q cut \u2208 {0.03, 0.04}. A replicate inference method was employed for the Mut transmission pairs such that a common fitness landscape was imposed. The Mut transmission pairs may take different bottleneck values and have been plotted as an overlapping histogram.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. Figure S13 . Determining BIC penalty function for bottleneck inference under simulated data. A) The ratio of the median inferred bottleneck to the true bottleneck is plotted against the true bottleneck size. As shown in Figure 3 , as the bottleneck increases, our ability to infer it correctly decreases due to noise. In order to account for this phenomenon, a straight line is fitted to the data aiming to capture the general trend. B) Heat map of the bottleneck-specific statistic plotted against BIC penalty and bottleneck size. The plot was generated for three datasets with selection coefficients s = {0, 1, 2} and a simple statistic based on bottleneck differences was employed. More specifically, the median bottleneck was computed across 200 seeds and the bottleneck-statistic was defined as the absolute value of the difference between the median inferred bottleneck and the true bottleneck multiplied by the baseline determined in A). By considering bottlenecks in the range [5, 100] and BIC penalty values in the range [10, 200], a heat map was produced and linear and decay exponential regression were conducted seeking to minimise the sum of the statistic across the values of N T that were considered.\n\n. CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint"}