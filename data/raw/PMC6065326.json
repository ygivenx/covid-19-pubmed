{"title": "A network pharmacology-based approach to analyse potential targets of traditional herbal formulas: An example of Yu Ping Feng decoction", "body": "Understanding the scientific basis and therapeutic mechanisms of herbal formulas from traditional Chinese medicines (TCMs) is essential since they play a vital role in complementary and alternative therapies in clinical practice to cure diseases or restore the whole-body balance; additionally, they provide a rich source for drug discovery. Owing to the complexity of the constituents in TCMs, reductionism, which individually considers each ingredient, cannot adequately explain the effects generated by an entire formula, and therefore faces several challenges comprehending and illustrating the mechanisms of herbal formulas. With the rapid development of bioinformatics, a combined attempt based on system/network biology and polypharmacology has created a new paradigm called network pharmacology (NP).\n\nIn recent years, NP has been proposed as a promising approach for understanding herbal formulas1,2 and predicting potential new drugs or targets3\u20135. To some extent, NP-based research on the underlying therapeutic mechanisms of herbal formulas has been well-accepted6,7 and accounts for the strong compatibility of different scales of systems. A distinct advantage of network analysis is that it can excavate underlying information from multilevel interactions, especially when dealing with big data.\n\nYu Ping Feng (YPF) decoction, a classic herbal formula, has been used in clinics to treat various diseases, such as respiratory tract infection8,9, nosocomial pneumonia10, chronic bronchitis11, and perennial allergic rhinitis12,13. As a safe and effective formula, it has been reported to relieve idiopathic sweating and augment appetite in end-stage cancer patients14, prevent viral infections, such as severe acute respiratory syndrome15,16, and have immunoregulatory or beneficial effects in asthma17,18, hepatic-fibrosis19, pulmonary-fibrosis20\u201322, and dermatitis models23. Since explanations for the clinical application of YPF decoction have not yet been illustrated by the conventional method (such as the in vitro activity assays of selected compounds) due to difficulties in the experimental design of complex systems, its underlying mechanism remains to be explored.\n\nThus, this study aimed to develop an NP-based method for identifying potential therapeutic targets of traditional herbal formulas by taking YPF decoction as an example. This method gathered relevant bioinformatics information about YPF decoction to identify its underlying therapeutic targets and shed light on the NP-based mechanism of herbal formulas\u2019 traditional clinical applications. The workflow of the NP-based approach and its application in YPF decoction is shown in below (Fig. 1).\n\nIn this study, first, the putative targets of compounds from YPF decoction were enriched to pathways to create the targets\u2013pathways interaction, and the diseases related to these pathways were collected to create the pathways\u2013diseases interactions. Next, the targets\u2013pathways interactions were used to generate a \u201ctargets\u2013(pathways)\u2013targets\u201d (TPT) network with partitioned modules (clusters), in the TPT network, targets act as nodes, and they are connected by relevant pathways (edges). Based on the TPT network, we hypothesised that if a group of protein targets were gathered to form a module naturally, they might share a functional similarity. Herein, a contribution score (CS) was calculated to evaluate the contribution of each module to different diseases based on the network modules\u2019 partition and pathways\u2013diseases interactions. Further, the module with the highest CS to relevant diseases of YPF as well as the notable targets within the module were identified to explore potential therapeutic targets of YPF. The detailed procedures are more fully described in the methods section.\n\nYPF decoction consists of three herbs and a total of 352 compounds, which were collected with PubChem CID and they belonged to flavonoids, saponins, saccharides, and volatile components (including phenylpropanoids, monoterpenes, sesquiterpenes, diterpenes, and triterpenes). The rapid development of bioinformatics and computational sciences has provided a wide range of approaches for targets prediction of small molecules24. In this study, the putative targets of compounds were identified based on the similarity ensemble approach (SEA: http://sea.bkslab.org/)25. The potential targets of 250 compounds were successfully predicted by the SEA, with a total of 968 protein targets. (A worth-mentioning issue is about the high amount of 968 potential \u201ctargets\u201d of YPF decoction, especially in terms of the relative small target pool of SEA. We tried to narrow the scope of potential \u201ctargets\u201d of YPF decoction by setting up a pre-enrichment filter based on Tc threshold value. In this way, the number of \u201ctargets\u201d for enrichment analysis sharply decreases from 968 to 304. However, the results of the most-important potential therapeutic targets and potential active compounds of YPF have no obvious changes. Thus, we still chose the post-enrichment filtering strategy, considering the advantage of this strategy with more informative reference to alternative targets. Throughout this paper, the term \u201ctargets\u201d refers to the putative proteins to which the ingredients from YPF decoction directly bind, according to SEA predictions; however, it is not known whether targets are responsible for the therapeutic effect of YPF decoction. The term \u201ctherapeutic targets\u201d refers to partial proteins from targets that have been identified to be responsible for the therapeutic effect of YPF decoction by our novel NP-based method.) Then, the target\u2013pathway interactions were generated to elucidate the biological pathways that YPF decoction might impact; moreover, the overrepresented KEGG pathways of the predicted 968 protein targets of YPF were identified from enrichment analysis. A total of 132 highly related pathways with 549 relevant protein targets were obtained. Please refer to supplementary dataset for more detailed information about the compounds (Supplementary Table S1), putative targets (Supplementary Table S2) and relevant pathways (Supplementary Table S3).\n\nTo understand what role the enriched pathways might play from a therapeutic angle, the Kyoto Encyclopedia of Genes and Genomes26 (KEGG; http://www.genome.jp/kegg/pathway.html) was used to identify the diseases with which each pathway might be involved. Since each pathway might participate in various bioprocesses in vivo, it is also possible that each pathway could be relevant to multi-diseases, and that each disease might be contributed to by multi-pathways. Next, a total of 43 diseases that the 132 pathways might impact were retrieved from the KEGG database to create the pathways\u2013diseases interaction. Finally, the targets\u2013pathways\u2013diseases interaction profile of YPF decoction was generated. (Throughout this paper, the term \u201cdiseases\u201d refers to the disease category of the diseases relevant to the pathways. Please refer to Supplementary Table S4 for detailed information about the pathways-diseases relationship.)\n\nNetwork modules (clusters or communities) refer to subnetworks whose nodes are more strongly connected to one another than to the rest of the network. That is to say, modules are sets of highly interconnected nodes. The identification of these modules is of crucial importance as they might help to uncover the hidden structural information within a network. Network modules have been utilised in NP-based TCM studies to uncover the combinations rule of herbal medicines27, chemical modules with similar structures28, and proteins with similar functions29\u201331. Especially in the context of TCMs as a typical complex system of multi-components and multi-targets, network modularity based of the Law of Like Attracts Like was considered to be a powerful way to sketch the complexity of TCMs.\n\nThe complicated targets\u2013pathways\u2013diseases interaction of YPF in Fig. 2(a) showed a preliminary NP-based bioinformatics profile of YPF decoction, by employing the most frequently used network analysis method in research on traditional remedies for therapeutic targets\u2019 prediction. The nodes represent putative targets of YPF (orange), relevant pathways (light blue), and diseases (deep purple). From Fig. 2(a), it is difficult to determine which targets might be most relevant to the therapeutic effect that YPF exerts; therefore, the novel TPT network was established to realise the recognition of therapeutic-based targets of YPF decoction, as shown in Fig. 2(b). Eight modules (modules 1\u20138) were detected and divided by the Louvain algorithm incorporated in the Gephi software at a resolution of 1.032,33. According to graph theory, the TPT network shown in Fig. 2(b) suggests some significant structural information, especially when considering the relatively separated modules with dense internal connections. Then, the inner interactions (edges representing the common pathways between every two nodes) of each target module were further investigated.\n\nThe targets in module 1, module 2, and module 3 were connected by the \u201cproteasome\u201d (hsa03050), \u201clysine degradation\u201d (hsa00310), and \u201caminoacyl-tRNA biosynthesis\u201d (hsa00970) pathways, respectively; the inner connection of the targets in module 6 was \u201cprotein digestion and absorption\u201d (hsa04974) and in module 8, it was the \u201cinsulin signaling pathway\u201d (hsa04910).\n\nThree major modules (module 4, module 5 and module 7) could be easily identified from the network in Fig. 2(b). In addition, the inner connection of the targets in module 4 was the \u201cneuroactive ligand-receptor interaction\u201d (hsa04080) pathway. The connections between targets in module 5 were almost metabolism-related pathways, and the pathways in module 7 were pathways that immune-related, which was the most complicated. The results are shown in Table 1. From the results, we inferred that the target modules in the TPT network might represent the module shares\u2019 different functional propensities. Thus, a contribution score (CS) was calculated from the newly established contribution-scoring algorithm to assess the relationship between each module and relevant diseases in the following study by integrating the modularity partition of the TPT network, target\u2013pathway interactions, and pathway\u2013disease interactions. The contribution-scoring algorithm is presented in the Method section in detail.\n\nFollowing the partition of the modules, the CS was calculated to evaluate the contribution of each module to each disease by the contribution scoring algorithm, the results of which are shown in a heat map (Fig. 3); the modules are listed in a row and the diseases in a column. The gradually changing colours, from deep blue to white, represent the highest to the lowest CS, respectively.\n\nThe result which was presented in Fig. 3 implies that each module might contribute differently to the 43 diseases, while the statistical results of the chi-square (\u03c72) test (p-value < 0.001) further indicate the significant association of modules 1\u20138 to these diseases. The contribution propensity of each module to diseases was further discussed as follows.\n\nIt could be found from Fig. 3 that module 1, module 2, module 3, module 6, and module 8 commonly show a slight propensity toward diseases, but module 1 shows a notable contribution (CS = 1.000) to autism, compared with the other modules. In addition, it has been mentioned above that the targets in module 2 were connected by the \u201clysine degradation\u201d pathway (hsa00310). Herein, the targets in module 2 might interfere with autism through lysine degradation, which has been already implicated in autism by previous studies34\u201336.\n\nCompared to other modules, the targets in module 4, which were connected by the neuro-relevant \u201cneuroactive ligand-receptor interaction\u201d pathway (hsa04080), contribute to hypopituitarism (CS = 1.000) and mental disorders (CS = 0.667) most. Though hypopituitarism is a chronic endocrine illness, it is still regulated by the nervous system37,38. Thus, we inferred that the targets in module 4 would exert neuro-relevant function when affected by compounds.\n\nThe targets in module 5 were mainly connected by metabolism-relevant pathways, and they contribute to congenital developmental disorders (CS = 1.000), mental retardation (CS = 0.625), and inherited metabolic disease (CS = 0.503). Module 7 contributes to various diseases, including infectious disease (CS = 0.856), immune system disease (CS = 0.844), primary immunodeficiency (CS = 0.803), cancer (CS = 0.780), gastrointestinal disease (CS = 0.759), and autoimmune disease (CS = 0.750). Thus, it was inferred that the targets in module 7 would possess a higher possibility of exerting an immune-relevant function when affected by compounds, compared with other modules.\n\nTo ensure the reliability of the results, targets in the network that are associated with the drugs approved for the market are used to validate the association between diseases and network modules. The approved drug information and drug\u2013target interactions were extracted from the Drugbank database39 and DrugCentral database40. The therapeutic area of the drugs was determined by the Anatomical Therapeutic Chemical Classification System code (ATC code), which is attributed to a drug by the WHO Collaborating Centre (WHOCC) for Drug Statistics Methodology41. The ATC code classifies drugs according to the following five levels: level 1, the organ or anatomical system on which they act; level 2, the pharmacological action; levels 3 and 4, the chemical, pharmacological, and therapeutic subgroups; and level 5, the specific single drug or drug combination. In this study, the ATC code of the approved drugs was abbreviated to level 1 to understand the organ or anatomical system on which they act.\n\nFor example, the ABL1 (tyrosine-protein kinase ABL1) has been reported to be targeted by the drug \u201cdasatinib\u201d, whose ATC code is L01XE06, and the connotation is shown as follows:\n\nLevel 1 (L): antineoplastic and immunomodulating agents\n\nLevel 2 (L01): antineoplastic agents\n\nLevel 3 (L01X): other antineoplastic agents\n\nLevel 4 (L01XE): protein kinase inhibitors\n\nLevel 5 (L01XE06): dasatinib\n\nThe level 1 abbreviation of the ATC code for dasatinib is L, which denotes that the therapeutic area of the drug dasatinib is antineoplastic and immunomodulating. Then, it was further inferred that the target ABL1 might be bound to exert antineoplastic and immunomodulating functions.\n\nThe verification result showed that, in the TPT network, 40 targets were identified to be targeted by approved drugs to exert therapeutic effects on the nervous system, among which 30 targets (~75%) are located in module 4, seven in module 5, and only two in module 6 and module 7, respectively. This indicates that the targets in module 4 contribute most to the nervous system, which is consistent with the contribution-scoring result; in total, 54 targets were identified to be targeted by approved drugs to exert antineoplastic and immunomodulating activity. Among these, 34 targets (~65%) are located in module 7, 15 (~25%) in module 5, two in module 1 and module 4, respectively, and only one in module 8. This indicates that the targets in module 7 contribute most to the immune system, which is consistent with the contribution-scoring result.\n\nThe verification results can also be found in Fig. 4. (Please refer to Supplementary Table S5 for detailed information of the targets with relevant approved drugs.) The chi-square (\u03c72) test (p-value < 0.001) of the results further indicates the significant association between network modules and diseases in terms of the targets of marketed drugs and the consistency in the main modules between predicted functions and drug indications in the real world.\n\nTo understand which network module contributes most to the therapeutic effects of YPF decoction, the CS of each module toward relevant diseases of YPF was selected for the following analysis. The relevant diseases of YPF decoction are immune system disease16,42\u201344, autoimmune diseases16,45,46, infectious diseases16,45,46, respiratory diseases20,46\u201348, and cancer49,50, according to the information retrieved from the publications, which is listed in Table 2. (The term \u201crelevant diseases\u201d refers to the diseases that are affected by YPF, while the term \u201cirrelevant diseases\u201d denotes those diseases that are relevant to the enriched pathways of YPF targets but have not been reported to be affected by YPF). The ratio of the CS of modules 1\u20138 to relevant diseases of YPF is presented in Fig. 5, which indicates that targets in module 7 contribute most to immune system diseases, infectious diseases, autoimmune diseases, and cancer; respiratory diseases are mainly contributed to by targets in module 6 and module 7. From a general perspective, YPF decoction might interfere with the targets in module 7 with a higher possibility of exerting therapeutic activity.\n\nYPF decoction is a classic formula with immune-regulatory effects, and module 7 showed the highest potential for curing its relevant disorders compared to other modules. Thus, the 199 targets (nodes) were considered to be the potential therapeutic targets of YPF decoction. Please refer to Supplementary Table S6 for more detailed information about the targets.\n\nAlthough YPF decoction is less known to exhibit anti-neoplastic activity directly in traditional applications, modern research has shown its potential in the treatment of idiopathic sweating of unknown cause in end-stage cancer patients14 and Lewis lung cancer in vitro50. There is extensive evidence showing a close relationship between inflammation and cancer51\u201354; that is, chronic inflammation contributes to cancer. Thus, the anti-neoplastic activity of YPF decoction might mainly occur via the regulation of the immune system.\n\nThe above identification and CS of modules combined with statistical analysis were carried out to determine the therapeutic targets module that was highly associated with the therapeutic activity of YPF decoction. The following centrality analysis was conducted to evaluate the importance of the targets (nodes) within the therapeutic targets module from the perspective of the topological analysis of the TPT network. Four centrality indicators, i.e., degree centrality, closeness centrality, betweenness centrality, and eigenvector centrality, were used to measure the importance of the targets (nodes) from the different perspectives55\u201357. Then, an integrated indicator, namely target importance (TI), was calculated accordingly. Next, the top 10% therapeutic targets by TI were selected and recommended for further pharmacology study in the context of the mechanism illustration of YPF decoction. From a holistic perspective, YPF might interfere with targets in module 7 in a synergistic way, some of which (with higher centrality), as illustrated in Table 3, can be considered to be the most potential therapeutic targets of YPF. Moreover, the compounds relevant to these targets according to the SEA prediction can be recommended as potential active ingredients in YPF decoction in Table 3.\n\nPrevious studies have shown that YPF potentially attenuates allergic inflammation via the regulation of NF-kappa B activation42. Thus, it was inferred that YPF might also be relevant to NFKB1 according to the results of this study. Moreover, the top 10% potential therapeutic targets have been reported as a pleiotropic locus that is associated with cancer and a critical factor for acute inflammation associated with asthma, such as PRKCA58,59, EGFR60, AKT161, RAC162,63, RHAO64,65, HDAC166. In the activation by GC, NR3C1 can activate MAPK8 (a seed gene) and several MAPK family members, including MAPK3, which could trigger GAB1 to interfere with asthma disease67; PRKACA shares a close relationship with cardiovascular disease and cancer68; ADCY5 has been found to play a critical role in sensory neuropeptide release and neurogenic inflammation and it is critical in the inflammatory process69,70; CAMK2A71 is a calcium signaling molecule involved in cell growth and stress-signals integration, and it has been reported to play a tumor-supportive role in osteosarcomas; PLCG2 is an enzyme responsible for ligand-mediated signaling in cells of the hematopoietic system, and it plays a key role in the regulation of immune responses72, CREB173,74 and CAMK2B75 are also important for the regulation of immune responses; HRAS and NRAS, which belong to the p21 RAS subfamily of small GTPases, regulates cell proliferation, cytoskeletal organization, and other signaling networks, and they are among the most frequent targets of activating mutations activations in cancer76.\n\nMoreover, six of these top-ranking targets have been reported to be targeted by approved drugs: EGFR, HDAC1, MAPK3, NFKB1, PRKCA, and RXRA; except for NFKB1, the others are targeted to exert antineoplastic or immunoregulating effects. The drugs cetuximab, gefitinib, afatinib, olmutinib, and brigatinib act on EGFR, and they have been used in cancer therapy; vorinostat and romidepsin act on HDA1, and they are used in primary cutaneous T-cell lymphoma; arsenic trioxide acts on MAPK3, and it has been used to treat acute promyelocytic leukemia; midostaurin acts on PRKCA to treat gastrointestinal stromal tumors; and RXRA is targeted by alitretinoin and bexarotene with the indication of Kaposi\u2019s sarcoma skin lesions and primary cutaneous T-cell lymphoma, respectively.\n\nAll these previous studies provided validation for our novel TPT network-based study to some extent when using YPF as an example. As a result, targets with the highest centrality in this module are recommended as potential therapeutic targets of YPF decoction. Moreover, among them, there are eight most-important potential therapeutic targets, i.e., PRKCA, EGFR, NFKB1, AKT, CALM1, HDAC1, CREB1, and CAMK2B, which are identified by the relevance to YPF\u2019s compounds with Tc value higher than the threshold of SEA method.\n\nThe compounds that were predicted to bind to the top-ranking targets (potential therapeutic targets) by SEA are presented in Table 3. Thus, these compounds were recommended as the potential active ingredients of YPF decoction. Among them, the compounds with a Tc value greater than the threshold of SEA are mainly flavonoids, including oroxylin A, psoralen, quercetin, tectochrysin, wogonin, chrysin, and isorhamnetin. This result is consistent with a previous report that the flavonoid in YPF shares immunomodulatory effects9,42.\n\nYPF decoction is composed of Astragali Radix (Huang qi in Chinese, AR), Atractylodis Macrocephalae Rhizoma (Bai zhu in Chinese, AMR), and Saposhnikoviae Radix (Fang feng in Chinese, SR). First, the compound information of AR, AMR, and SR were collected from chemical databases, including the traditional Chinese medicines integrated database (TCMID, http://www.megabionet.org/tcmid/, which contains information from the TCM@Taiwan, traditional Chinese medicine information database (TCM-ID), herbal ingredients\u2019 targets (HIT; accessed in May 2016) database, traditional Chinese medicine systems pharmacology (TCMSP; http://lsp.nwsuaf.edu.cn/tcmsp.php; accessed in May 2016) database, the cardiovascular disease herbal database (CVDHD, http://pkuxxj.pku.edu.cn/CVDHD/; accessed in May 2016), and the Chinese Academy of Sciences chemistry database (http://www.organchem.csdb.cn/scdb/; accessed in May 2016). Literature mining also supplemented the information from these databases. The common amino acids and compounds with high molecular weight, such as polysaccharides, were not included in this study. The names of compounds were standardised through SciFinder (https://scifinder.cas.org) according to the Chemical Abstracts Service (CAS) number. Additionally, these compounds\u2019 PubChem CIDs were obtained from PubChem (https://pubchem.ncbi.nlm.nih.gov/) based on chemical names or structures.\n\nThe protein targets of compounds from YPF decoction were predicted by similarity ensemble approach (SEA: http://sea.bkslab.org/)25, which is a chemical similarity searching-based prediction method recognised worldwide for its accuracy77,78. Though the SEA method is capable of accounting only ~2,800 potential active proteins as alternative binding targets, the scale is consistent with the recent recognition of the druggable genome (~3000)79\u201381. In addition, the limitation of a chemical similarity searching-based prediction method, including the SEA, would be that the prediction is based on the two-dimensional (2D) structure (SMILE information) of compounds, which might produce the same potential targets of the isomeric compounds. Herein, it is not enough to predict solely using SEA or any other chemical similarity searching-based prediction method, when isomeric compound domains in the research. The NP-based study of YPF decoction involved 13 pairs of isomeric compounds in 352 compounds, which would interfere with the result slightly, from a holistic perspective.\n\nThen, enrichment analysis is used to acquire target-pathway interactions which are essential for the further network construction and analysis. The targets were further enriched to KEGG pathways to create the targets\u2013pathways relationship using the online tool STRING82 (http://string-db.org/). The enriched KEGG pathways with false rate discovery (FDR) < 0.01 were used in the subsequent research. The Kyoto Encyclopedia of Genes and Genomes26 (KEGG; http://www.genome.jp/kegg/pathway.html) was used to identify the diseases with which each pathway might be involved, the disease category information was used to represent the disease.\n\nThe diseases that are affected by YPF decoction were retrieved from previous research. First, publications about the topic of YPF were extracted from the Web of Science, and the topic keywords were set as \u201cyupingfeng\u201d, \u201cYu-Ping-Feng\u201d, or \u201cgyokuheifusan\u201d (the Japanese name of YPF decoction). Second, the relevant diseases\u2019 information was identified, where available. Then, the diseases were classified according to the KEGG database.\n\nFrom a perspective of topology, the pathway-based associations between targets by enrichment analysis may be described as a network. A familiar representation is obtained by letting N be a set of nodes representing targets, and E be a set of edges where elements of E are unordered pairs of distinct nodes ni, nj representing a pathway-based link between a target pair {ni, nj}. The two sets together are called a simple network G = (N, E). Specifically speaking, a TPT network was established on the one-mode targets\u2013targets interaction, which was transferred by Pajek software83 from the two-mode \u201ctargets\u2013pathways\u201d relationship; then, the TPT network was visualised and analysed by Gephi software84. In the TPT network, the nodes refer to protein targets, and each set of two nodes is connected by an edge, which indicates that they are both involved in at least one of the same pathways.\n\nNext, the Louvain algorithm for module identification incorporated in Gephi32 was adopted to explore the modularity structure of the TPT network. Since the targets in a module are connected by the same pathways or a functionally similar pathway, it was hypothesised that each module would exert a kind of specific function, and different modules would have effects on different diseases. Herein, an evaluation algorithm, named the contribution scoring algorithm, was established to weigh the contribution of each network module to various diseases and, further, to illustrate the TPT network.\n\nOn the basis of an existing algorithm for measuring the associated intensity of individual elements between interactive sets85,86, an indicator measuring the intensity of associating a specific network module with a specific disease, named a \u201ccontribution score (CS)\u201d was established in this study by integrating the modularity partition of the TPT network, the targets\u2013pathways interactions, and the pathways\u2013diseases interactions. In this algorithm, the higher the value (contribution score), the greater the contribution made by the investigated module for a particular disease. Then, the targets in the module with a significant high value toward relevant diseases affected by YPF were considered to be its potential therapeutic targets.\n\nFigure 6 presents a diagram for illustrating the contribution scoring algorithm, where M refers to a set of modules, mi (i = 1, \u2026, I); P refers to a set of pathways, pw (w = 1, \u2026, W); and D refers to a set of diseases, dj (j = 1, \u2026, J). In the TPT network, if uiw modules are connected by pw, each relevant mi contributes \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{1}{{u}_{iw}}$$\\end{document}1uiw to pw, namely the contribution of mi to pw, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{p}_{w}}=\\frac{1}{{u}_{iw}}$$\\end{document}Cmipw=1uiw 85,86. If vwj pathways are relevant to dj, each relevant pw contributes \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{1}{{v}_{wj}}$$\\end{document}1vwj to dj, namely the contribution of pw to dj, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{p}_{w}{d}_{j}}=\\frac{1}{{v}_{wj}}$$\\end{document}Cpwdj=1vwj 85,86.\n\nThe contribution scoring algorithm is defined as follows:1\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{d}_{j}}=\\sum _{{p}_{w}\\in {X}_{ij}}{C}_{{m}_{i}{p}_{w}}{C}_{{p}_{w}{d}_{j}}$$\\end{document}Cmidj=\u2211pw\u2208XijCmipwCpwdjwhere Xij is a subset of P and refers to the pathways that are relevant to mi and dj simultaneously, and where \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{d}_{j}}$$\\end{document}Cmidj refers to the CS of mi to dj, which is the sum of the contribution of mi to dj through all its relevant pw in Xij. The value of \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{d}_{j}}$$\\end{document}Cmidj varies from 0 to 1: the higher the value, the greater the contribution mi might make to dj; and all the modules contribute 1 to a particular disease.\n\nBelow, an example is given to demonstrate the application of the contribution scoring algorithm. The Fig. 7(a) represents a TPT network with modules identified, and the Fig. 7(b) represents a pipeline which was abstracted from Fig. 7(a).\n\nThe TPT network was divided into three modules: module 1 (m1), module 2 (m2), and module 3 (m3). Since p1 and p2 connected the protein targets from only one module, m1, the contribution of m1 to p1 or p2 could be calculated as2\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{p}_{w}}=\\frac{1}{{u}_{iw}}=1,\\,(i=1;\\,w=1,2)$$\\end{document}Cmipw=1uiw=1,(i=1;w=1,2)\n\nAs p3 and p4 were contributed to by the protein targets from m1 and m2, and from m2 and m3, separately, the contribution of m1 or m2 to m3, and from m1 or m3 to m4, could be calculated as3\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{p}_{w}}=\\frac{1}{{u}_{iw}}=\\frac{1}{2},\\,(i=1,2;\\,w=3,\\,OR\\,i=1,3;\\,w=4)$$\\end{document}Cmipw=1uiw=12,(i=1,2;w=3,ORi=1,3;w=4)and since all three modules were related to p5, the contribution of m1, m2, or m3 to p5 could be calculated as4\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{i}{p}_{w}}=\\frac{1}{{u}_{iw}}=\\frac{1}{3},(i=1,2,3;w=5)$$\\end{document}Cmipw=1uiw=13,(i=1,2,3;w=5)\n\nIt was assumed that d1 was relevant to five pathways (p1 \u2212 p5) in the TPT network, herein, \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${v}_{wj}=5,$$\\end{document}vwj=5,\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$(w=1,\\,2,\\,3,\\,4,\\,5;\\,j=1)$$\\end{document}(w=1,2,3,4,5;j=1), and that each pathway contributed \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$\\frac{1}{5}$$\\end{document}15 to d1, namely:5\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{p}_{w}{d}_{j}}=\\frac{1}{{v}_{wj}}=\\frac{1}{5},(w=1,\\,2,\\,3,\\,4,\\,5;\\,j=1)$$\\end{document}Cpwdj=1vwj=15,(w=1,2,3,4,5;j=1)\n\nUltimately, according to equation (1), the result of6\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{1}{d}_{1}}=\\sum _{{p}_{w}\\in {X}_{11}}{C}_{{m}_{1}{p}_{w}}{C}_{{p}_{w}{d}_{1}}=\\frac{2}{3},{X}_{11}=\\{{p}_{1},{p}_{2},{p}_{3},{p}_{4},{p}_{5}\\},$$\\end{document}Cm1d1=\u2211pw\u2208X11Cm1pwCpwd1=23,X11={p1,p2,p3,p4,p5},7\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{2}{d}_{1}}=\\sum _{{p}_{w}\\in {X}_{21}}{C}_{{m}_{2}{p}_{w}}{C}_{{p}_{w}{d}_{1}}=\\frac{1}{6},{X}_{21}=\\{{p}_{3},{p}_{5}\\},$$\\end{document}Cm2d1=\u2211pw\u2208X21Cm2pwCpwd1=16,X21={p3,p5},8\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{3}{d}_{1}}=\\sum _{{p}_{w}\\in {X}_{31}}{C}_{{m}_{3}{p}_{w}}{C}_{{p}_{w}{d}_{1}}=\\frac{1}{6},{X}_{31}=\\{{p}_{4},{p}_{5}\\}$$\\end{document}Cm3d1=\u2211pw\u2208X31Cm3pwCpwd1=16,X31={p4,p5}could be calculated: \\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$${C}_{{m}_{1}{d}_{1}}$$\\end{document}Cm1d1 shared the highest value, indicating that the targets in m1 contributed the most to d1 in the TPT network. That is, the targets in m1 might exert the most potential therapeutic proclivity toward d1 compared with the targets in other modules. Additionally, the total contribution of the three modules to d1 was 1.\n\nThe CS, which reflected the contribution of each target module to relevant diseases, could be calculated from the established contribution scoring algorithm. To validate the hypothesis that different modules would have effects on different diseases, the association between network modules and therapeutic diseases was examined by chi-square (\u03c72) test. The verification of the contribution scoring algorithm based on the information of targets and approved drugs was also conducted by chi-square (\u03c72) test.\n\nAn integrated indicator, namely target importance (TI), was calculated accordingly as the equation below.9\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$T{I}_{i}=\\frac{1}{4}(\\frac{D{C}_{i}}{ma{x}_{(DC)}}+\\frac{B{C}_{i}}{ma{x}_{(BC)}}+\\frac{C{C}_{i}}{ma{x}_{(CC)}}+\\frac{E{C}_{i}}{ma{x}_{(EC)}})$$\\end{document}TIi=14(DCimax(DC)+BCimax(BC)+CCimax(CC)+ECimax(EC))where TIi denotes the importance of target i, DCi, BCi, and CCi, and ECi denotes the degree, betweenness, closeness, and eigenvector centrality of target i, respectively; meanwhile, max(DC), max(BC), max(CC), and max(EC) denote the maximum degree, betweenness, closeness, and eigenvector centrality in the therapeutic target module. The value of TIi varied from 0 to 1, and the higher the value shared by a target, the more important the target was in the network from the topological perspective.\n\nThe source data for analysis in this work are available in PubChem [https://pubchem.ncbi.nlm.nih.gov/], SEA [http://sea.bkslab.org/], KEGG [http://www.genome.jp/kegg/pathway.html]. Drugbank [https://www.drugbank.ca/], Drug Central [http://drugcentral.org/]. The datasets generated during and/or analysed during the current study are available from the corresponding author on reasonable request.\n\nA novel NP-based method that could help discover the core mechanisms of herbal formulas from complicated information and interactive relationships was presented in this study. YPF decoction was investigated by using the NP-based method, which integrated the \u201cmulti-targets\u2013multi-pathways\u2013multi-diseases\u201d relationship into a TPT network and a contribution scoring algorithm. The modules in the TPT network with a similar function, especially coinciding with the already known application of YPF decoction, were inferred from the finding that the protein targets in module 7 were highly associated with the underlying mechanism of YPF decoction, especially those with highest centrality as presented in Table 3. Additionally, some of these targets have been reported to be relevant to the therapeutic activity that YPF might exert. Herein, the network-based method provided an easier and more reliable strategy for uncovering the potential therapeutic targets of YPF.\n\nIn short, the proposed TPT network combined with the contribution scoring algorithm could be widely applied in the analysis of traditional medicines/formulas with robust effects in clinical care. And, importantly, the most therapeutically related modules coinciding with their clinical applications have a high chance of being associated with potential mechanisms worthy of further experimental investigation."}