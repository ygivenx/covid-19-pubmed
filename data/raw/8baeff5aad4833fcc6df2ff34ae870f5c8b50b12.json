{"title": "Physica A Complex network model of the Treatise on Cold Damage Disorders", "body": "The Treatise on Cold Damage Disorders (Shan-han Lun) written by Zhang Zhong-jing is an ancient Chinese medical treatise, which describes the treatment of cold damage, its variants, and related complications [1] [2] [3] [4] . This treatise suggests that diseases caused by cold or wind stroke invade the body through the pores in the skin. In recent decades, the effectiveness of many herbal formulae from Shang-han Lun has been validated in molecular biology studies and they have been used widely as complementary medical therapies. For example, the integrated use of formulae from the treatise with modern medicine has proved effective in treating severe acute respiratory syndrome [5] . A study of Sinisan from the treatise demonstrated its therapeutic effect on chronic restraint stress [6] . The benefit of a Wumei pill treatment for typhoid ascariasis was also confirmed [7] . Xiao-chai-hu-tang was studied [8, 9] for the treatment of liver injury and chronic pancreatitis. Clinical practice data for Shang-han Lun formula prescriptions in Taiwan were also analyzed [10] .\n\nHowever, the underlying principles of this treatise are not understood clearly. Thus, quantitative analyses of the symptoms and their corresponding herbal prescriptions could help practitioners to find the treatment codes that are hidden inside this treatise. There are 381 sections in the treatise, where syndromes and prescriptions are described in most sections. For example, in section 13, a group of symptoms comprising headache, stiff neck, chills, fever, and floating pulse constitute one syndrome. A group of compatible herbs called the Gui-zhi formula, which contains Ramulus Cinnamomi, peony root, prepared licorice root, fresh ginger, and Chinese dates, are prescribed for this syndrome. It is obvious that there are two types of entities (symptoms and formulae) and three types of relationships (treatment relationships between syndromes and formulas, syndrome relationships between symptoms, and compatibility relationships between herbs) in this treatise. Analyzing these entities and their relationships may provide us with a new way of exploring this treatise.\n\nComplex networks are a powerful tools for understanding the complex relationships among units, where they have been used to explore complex relationships in the diagnosis of syndromes and knowledge discovery for determining the compatibility of drugs [11] [12] [13] [14] [15] . In general, herbs or symptoms are regarded as nodes. Edges are defined as relationships between nodes, such as compatibility relationships between herbs, co-occurrence relationships between symptoms, or more complex relationships obtained by data mining methods [16] . Constructing homogeneous Traditional Chinese Medicine (TCM) networks containing one type of node is a popular approach. However, in [17] , a heterogeneous TCM network was studied with multiple types of nodes, including herbs, biomolecules, and syndrome. Our study was inspired by [17] , but our approach differs from their method because we used a multi-subnet composited complex network model (MCCN), which is a generalized complex network model for describing different types of entities and multiple types of relationships between the entities [18, 19] , to describe syndrome relationships between symptoms, compatibility relationships between herbs, and treatment relationships between syndromes and formulas. We investigated the topological characteristics of a composited network with multiple types of nodes and edges based on the degree of given relationships and the clustering coefficients of given relationships.\n\nAnother interesting subject is six-channel transmission. In this treatise, the progress of a disease is classified as Tai-yang, Yang-ming, Shao-yang, Tai-yin, Shao-yin, or Jue-yin, which represent six different developmental stages of a disease. The three yang channels are located in the exterior parts of the body, whereas the three yin channels are found in the interior parts. Cold or wind stroke invasion will damage the three yang channels first. If the disease progresses or it is mistreated, the disease's symptoms will develop throughout the interior yin channels. For example, a sick man may have syndromes in the Tai-yang channel, such as headache, stiff neck, chills, fever, and a floating pulse, so the Guizhi formula may be prescribed. However, if the man is mistreated and he has Yang-ming syndromes, such as constipation, perspiration with fear of heat but no fear of cold and huge pulse, then this means that the disease has progressed to the Yang-ming stage. The mechanism of six-channel transmission is rather complex, so we tried to identify symptoms that imply the movement of a pathogen among the six channels. By dynamic reorganization of the MCCN, we obtained six channel subnets (Tai-Yang, Yang-Ming, Shao-Yang, Tai-Yin, Shao-Yin, and Jue-Yin). After determining the strengths of the relationships between the subnets, we analyzed the relationships among the six channel subnets to find symptoms that implied the movement or transformation of pathogens.\n\nThe remainder of this paper is organized as follows. Section 2 introduces the MCCN model and the MCCN measures. Section 3 describes the data source used in this study and its preprocessing. In Section 4, we present the MCCN model of Shang-han Lun and the results of the analysis. We give our conclusions in Section 5.\n\nMCCN [18, 19] is a generalized complex network model for describing a complex system that involves multiple types of entities and relationships. The classic complex network for describing one type of entity and their single type of relationship is a special case of the MCCN. The dynamic reorganization of an MCCN provides two ways of analyzing networks: compounding (combining subnets into a ''bigger' one) and reducing (obtaining a ''smaller' network from a ''bigger'' one).\n\nIn Fig. 1 , there are six entities and each is regarded as a node, which can be homogeneous or heterogeneous. There are three types of relationships between nodes. Subnet G 1 has relationships between v 1 , v 2 , v 3 , v 4 , v 5 , and v 6 . The second relationships between nodes v 1 , v 2 , v 4 , v 5 , and v 6 are illustrated in subnet G 2 . The third relationships among nodes v 1 , v 2 , v 4 , and v 6 are shown in subnet G 3 . Given a compounding mapping, a composited network G will be generated. The compounding mapping indicates how the nodes and edges in G are generated. In Fig. 1(d) , the nodes of G are assigned as the union set of the nodes of G i and G j , and the edges in G are also the union set of the edges of G i and G j . The weight of an edge in G indicates the number of subnets to which the edge belongs. The weight of an edge indicates a compounding relationship between nodes. When the weight equals 1, this means that there is only one type of relationship between the nodes. Given a reducing mapping, such as an edge weight of 3, a reducing network G \u2032 will be obtained, as shown in Fig. 1 (e). Each pair of nodes in G \u2032 has three types of relationships. Next, we define the MCCN measures used for quantifying different types of relationships in the composited network. These measures were inspired by classical and frequently used measures, such as the degree and clustering coefficient. However, we aimed to describe different types of relationships among nodes, so we propose degree and clustering \n\nwhere R i is one type of relationship between nodes and the amount of relationship types is n;\n\nThe mapping F gives each link an n-tuple to denote all of the relationship types of its two nodes. Let r i = \u2205 denote that there is no relationship R i between the nodes.\n\na hl (r i ) = 0 indicates that there is no relationship r i between nodes v h and v l , whereas a hl (i) = 1 indicates that there is a relationship r i between them.\n\nThe degree of a node v \u2208 V according to the given\n\nIn Fig. 1(d) , the given relationship have weights = 1, 2, 3, and the degree of node v 1 is 5.\n\nv h measures the clustering coefficient of\n\nprobability that two randomly drawn nodes linking node v h with the relationship r i also link with the relationship r j .\n\nIn Fig. 1(d) , given r i with a relationship weight of 3 and r j with a relationship weight of 1, then the clustering coefficient of node v 1 is 1.\n\nIf two subnets are compounded, the compounding mapping indicates the nodes in the two subnets that should be linked. In [18, 19] , these nodes are referred to as marginal nodes and the edges between marginal nodes are called outer edges. If the marginal nodes have a large degree, this means that information or energy will propagate widely and rapidly. The strength of an outer link is defined as follows:\n\nwhere \u27e8v h , v l \u27e9 is an outer edge and v h , v l are marginal nodes, while V 1 and V 2 are the node sets of two subnets.\n\nDefinition 6 (Strength of the Relationships for Subnets). Based on the strength of the outer links, sl r i r j G 1 ,G 2 is defined as the strength of the subnets, as follows:\n\nis the strength of the outer links \u27e8v h , v l \u27e9, and V 1 and V 2 are the node sets of the two subnets.\n\nThe empirical data used in this study came from the version published by People's Medical Publishing House of China in 2005 [4] . This version was compiled by Wang Shu-he, who was an imperial physician during the western Jin dynasty, and it was organized by the contemporary scholars, Qian Chao-chen and Hao Wan-shan. The treatise has 381 sections, where Tai yang is described from sections 1 to 178, Yang-ming from 179 to 262, Shao-yang from 263 to 272, Tai-yin from 273 to 280, Shao-yin from 281 to 325, and Jue-yin from 326 to 381.\n\nIn some sections, only general symptoms are given (referred to as Type I in this study). For example, general symptoms of Tai-yang disease, headache, stiff neck, chills, fever, and floating pulse are given in section 1. In some other sections, both symptoms and herbal prescription are given (Type II). For example, in section 12, the Tai-yang Zhong Feng syndrome includes readily perspires, aversion to wind, nasal discharge, and retching. The Gui-zhi formula is prescribed, which contains the herbal drugs cinnamon twig, peony root, prepared licorice root, fresh ginger, and Chinese dates. In some sections, there are no symptoms or prescriptions (Type III), such as section 9. We only used the Type I and Type II sections. For each Type II section, if general symptoms were given in a Type I section, then general symptoms were included. For example, in section 12, the symptoms include Tai-yang general symptoms and specific symptoms, such as headache, stiff neck, chills, fever, floating pulse, readily perspires, aversion to wind, nasal discharge, and retching.\n\nFor each section, symptoms were regarded as nodes and they were linked with each other because they constitute a syndrome. Let the relationships r s1 , r s2 , r s3 , r s4 , r s5 , and r s6 indicate syndromes belonging to the Tai-yang, Yang-ming, Shaoyang, Tai-yin, Shao-yin, and Jue-yin channels, respectively. Then, a syndrome subnet G s was constructed, where the numbers of nodes and edges were 372 and 1832, respectively.\n\nThe degrees and clustering coefficients of the symptom nodes were calculated. Given the relationships r s1 , r s2 , r s3 , r s4 , r s5 , and r s6 , the degree of the nodes in G s was the number of all its neighbors according to Definition 3. The degree distribution of subnet G s is shown in Fig. 2 , which can be fitted by P(k) = 89.228k \u22121.106 (R-squared = 0.765). Thus, some symptoms occur in most syndromes. The nodes with the highest degree in the top 10 comprised fever, floating pulse, chills, headache, stiff neck, hard stool, sweat, difficulty urinating, readily perspires, and astriction. These symptoms all belong to Tai-yang disease. The former four symptoms are general symptoms of Tai-yang disease. In fact, Tai-yang disease is usually regarded as the initial stage of exogenous diseases, which can lead to the other five channel diseases. Therefore, the power-law distribution of G s reflects the important role of Tai-yang disease in this treatise.\n\nWe calculated the clustering coefficients of the nodes, where the six channel relationships were not considered and they were regarded as one type of relationship. Fig. 3 shows the distribution of the degree k and the average clustering coefficient c, which can be fitted by c(k) = 0.833-0.009k (R-squared = 0.600). Six channel diseases feature different symptoms. Thus, symptoms that belonged to the same channel were densely linked, whereas those belonging to different channels were sparsely linked. Therefore, nodes belonging to the same channel had a higher cluster coefficient, whereas nodes with higher k and smaller c values belonged to different channels. For example, fever belonged to Tai-yang, Yang-ming, Shao-yin, and Jue-yin; therefore, the degree of the fever node was high but its clustering coefficient was small because the symptoms of these four types of channel diseases didn't occurred simultaneously. The clustering coefficients of nodes with the highest degree are shown in Table 1 . We found that a high degree indicated a low clustering coefficient, and vice versa. Moreover, a higher degree indicated that a node belonged to more channel. For example, fever had the maximum degree and it belonged to three channels; therefore, its clustering coefficient was small. \n\nThe herb subnet was constructed where each link denoted that two herbal drugs belonged to the same formula. The edges indicated compatible relationships between herbs. There were 93 nodes and 561 edges, and there was only one type of relationship on the herb subnet.\n\nThe distribution of the degree is shown in Fig. 4 , which indicates that some herbs had a high degree. Table 2 shows the nodes with the highest degree in the top 10. It is interesting that most of the herbs listed in Table 2 are harmonizing herbs, such as fried licorice root, fresh ginger, and jujube. Harmonizing herbs are usually employed to regulate or balance certain relationships in a herbal formula. They are included in many prescriptions, so their degrees are high and their clustering coefficients are small. Fig. 5 shows the negative correlation between the degree and average clustering coefficient in the herb subnet. Table 3 illustrates some typical herbal drugs. The first two herbal drugs have a high degree and low clustering coefficient, whereas the latter two have a low degree and large clustering coefficient. As mentioned above, although harmonizing herbs are used most frequently (thereby leading to a high degree), they are employed as adjuvant and guide herbs, and not as an effective treatment for symptoms. By contrast, herbs such as Schisandra chinensis and Rhizoma Anemarrhenae are prescribed rarely (thereby leading to a low degree), so they are only included in a small number of prescriptions (thereby leading to a high clustering coefficient) and they are special treatments for some symptoms.\n\nThe syndromes subnet and herb subnet were compounded according to the marginal nodes and outer edges. The outer edges were generated between the symptoms and herbs that belonged to the same section in Shang-han Lun, where the outer edges denoted treatment relationships between symptoms and herbs. For example, the blue dotted circle is the syndrome subnet and the red dotted circle is the herb subnet in Fig. 6 . In one section, the herb v 1 is prescribed for symptoms v 2 , v 3 , and v 4 . Therefore, v 1 , v 2 , v 3 , and v 4 were marginal nodes and we generated three outer edges (green lines) between them. The outer edges between node v 1 and v 2 , v 1 and v 3 , and v 1 and v 4 indicate treatment relationships. Given the treatment relationships and syndrome relationships, we calculated the clustering coefficient for herb nodes according to Definition 4. When one herb node with this measure reached 1, this showed that neighboring symptom nodes were linked with each other. Thus, this herb was regarded as a special treatment for these symptoms. The clustering coefficients of the herb nodes were calculated according to the syndrome relationships and compatibility relationships. Table 4 shows the herb nodes with a clustering coefficient of 1.\n\nThe effects and indications of the herbs in Table 4 matched with the corresponding syndromes. For example, Wu mei is the main ingredient of black plum pill. The effects of black plum are astringent in the lung and bowels, thereby promoting the production of body fluid, alleviating colic caused by ascariasis, and arresting bleeding. In [6] , the biomodular mechanism of black plum in chronic ulcerative colitis was confirmed. The effects of pepper tree peel are the same as black plum. Tian men dong is an ingredient in Ephedra formula and Cimicifuga decoction, which is prescribed for the Jue-yin channel. In this stage, an exterior pathogen enters the interior and inhibits the normal circulation of yang-qi (more details of yang-qi can be found in [20] ). The pulse is then deep and slow, so the patient will feel cold. Invasion of the lungs by phlegm-heat leads to throat inflammation and sputum with bloody pus. Tian men dong can clear heat away from the lungs, as well as nourishing yin and moistening dryness. Therefore, tian men dong is a good choice for treating throat inflammation and sputum with bloody pus. The effects of ting li zi include removing heat from the lung and relieving asthma, inducing diuresis, and subduing swelling. Pain in the chest is mainly due to pathogenic heat congealing pathogenic water in the chest, so ting li zi is prescribed for pain in the chest. Table 4 Herb nodes where the clustering coefficient with treatment and syndrome relationships equaled 1.\n\nSymptom neighbors (constitute syndrome)\n\nBlack plum (wu mei); Pepper tree peel (shu jiao)\n\nMedical history of vomiting of ascaris; the patient feels restless and abdominal pain occasionally; the patient will be nauseous, with vomiting and restlessness after eating.\n\nThroat inflammation; sputum with bloody pus; coldness in extremities; the pulse is deep and slow. Lepidium seed (ting li zi)\n\nPain in chest and the pain will be aggravated by moving the head. Croton seed (ba dou) Fulminant fullness of abdomen and distending pain; constipation; ascites and throat inflammation. Peking Euphorbia root (da ji)\n\nStuffiness; hardness and fullness in the chest; a referred pain below the costal margin; shortness of breath; headache; diarrhea; nausea and slight perspiration. Inula flower (xuan fu hua)\n\nStuffy and blocked sensations in epigastrium; continuous belching; nausea or vomiting. Rice paper pith (tong cao) Coldness in the extremities; a thread-like and feeble pulse.\n\nNumbers of nodes and edges in the six channel subnets. \n\nDiseases can be classified into six channels, where these six channels present during different stages in the development of cold disease. Pathogens move among these six channels, which leads to disease transformation. It is considered that there are two type of movements: from the exterior to the interior, where the movement sequence is Tai-yang, Yang-ming, Shaoyang, Tai-yin, Shao-yin, and Jue-yin; whereas the other involves movements among pairs of channels, including from the exterior to the interior and from the interior to the exterior.\n\nThe six channel subnets were reduced from the syndrome subnet, where the channel subnets were compounded according to their different movement patterns. The strengths of the outer edges were calculated to find symptoms that implied pathogen movements and transformation. The strengths of the channel subnets were also calculated to identify two channels that were linked more closely.\n\nGiven the reduced relationships of r s1 , r s2 , r s3 , r s4 , r s5 , and r s6 , the six channel subnets were obtained from the syndrome subnet. Table 5 shows the numbers of nodes and edges in these six channel subnets.\n\nIf there were common nodes in pairs of the channel subnets, we considered that the common nodes were marginal nodes and linked them. There were no common nodes between Shao-yang and Tai-yin, Tai-yin and Shao-yin, Tai-yang and Jue-yin, Yang-ming and Shao-yang, Shao-yang and Shao-yin, and Shao-yang and Jue-yin. Table 6 shows the composited networks, which indicates that Tai-yang and Yang-ming were related most closely with each other. The strongest outer links suggested the transformation of a pathogen from one channel to another.\n\nThe perception and application of the six channels transmission process is focused mainly on a single specific disease. For example, many diseases such as kidney disease [21] , diabetes mellitus [22] , gastrosis [23] , and Parkinson's disease [24] have been treated successfully according to the six channels transmission model. However, the six channels model has been developed and given new meaning during the process of self-perception. At present, there is no uniform understanding of the six channels. In this study, based on original data from Shan-han Lun, we studied the relationships among the six channels by network topological analysis. We found that some symptoms linked two of the six channels more closely. These findings could provide insights into the original thought of Zhang Zhong-jing and help therapists to achieve a deeper understanding of this treatise.\n\nThe Treatise on Cold Damage Disorder (Shan-han Lun) is an ancient Chinese medical treatise, which is still used widely as a practical instruction manual. Thus, quantitatively exploring the underlying principles of this treatise is meaningful and interesting. In this study, we analyzed the symptoms, prescriptions, herbs, and their relationships in this treatise based on a MCCN, which is a generalized complex network model for describing multiple types of entities and the different types of relationships among them. This model allows subnet compounding to obtain a ''large'' complex network with multiple types of relationships as well as reducing to ''small'' complex networks with special types of relationships. We found that the MCCN method was effective for describing and analyzing two types of entities (symptoms and herbs) and three types of relationships (syndrome relationships among symptoms, compatibility relationships among herbal drugs, and treatment relationship between symptoms and herbal drugs).\n\nWe constructed two subnets that described syndrome relationships among symptoms and compatibility relationship among herbs. Based on subnet compounding using the MCCN, a composited network was obtained by compounding the two subnets, which included treatment relationships between symptoms and herbs. MCCN measures were defined for quantifying different types of relationships in the composited network. We proposed degree and clustering coefficients according to the given relationships. The power-law distribution of the syndrome subnet reflected the important role of Tai-yang disease in this treatise. The nodes in the herb subnet with high degrees and low clustering coefficients were harmonizing herbs. The nodes in the herb subnet with symptom neighbors that connected with others were specific herbs for treating a syndrome.\n\nIn addition, six channel subnets (Tai-yang, Yang-ming, Shao-yang, Tai-yin, Shao-yin, Jue-yin) were obtained by reducing the subnets in the model. By defining the strengths of the relationships between the outer edges and subnets to measure the closeness between subnets, we analyzed the relationships among the six channels subnets, which showed that the Tai-yang channel and Yang-ming channel had the strongest relationship. Moreover, symptoms that suggested the movements and transformation of pathogens were found, which could help to prevent disease."}