{"title": "Generality of the Final Size Formula for an Epidemic of a Newly Invading Infectious Disease", "body": "Whenever a serious infectious disease emerges or re-emerges in a human population, a matter of immediate interest is the likely magnitude of the outbreak. This is often called the expected final size of the epidemic (Bailey, 1975; Anderson and Watsons, 1980; Anderson and May, 1991; Andersson and Britton, 2000; Diekmann and Heesterbeek, 2000) , which we denote Z. Of course, if the emergent pathogen becomes endemic in the population then there will never really be a \"final\" size, but in that case the matter at issue is the likely magnitude of the first major wave of cases.\n\nTo our knowledge, a formal, mathematical argument leading to an estimate of an epidemic's expected final size Z was first published in the landmark 1927 paper by Kermack and McKendrick (1927) . The formula for Z that Kermack and McKendrick obtained [Eq. (5) below] depends only on the basic reproduction number, R 0 (the expected number of secondary cases caused by a typical primary case in a fully susceptible population). However, without further analysis, it is unclear to what extent this formula depends on the particular assumptions that Kermack and McKendrick made in constructing their model, and hence whether it bears a strong relationship to the final size in realistic situations.\n\nOne implicit assumption of the Kermack and McKendrick (1927) analysis is that infectious periods are exponentially distributed. Anderson and Watsons (1980) showed that the final size formula remains valid if infectious periods follow a Gamma distribution. In Section 1.3 of their book, Diekmann and Heesterbeek (2000) generalized this statement to cover an arbitrary distribution of infectious periods.\n\nAnother key assumption of the Kermack and McKendrick (1927) analysis is that the host population is homogeneously mixed. It is well known that if this assumption is dropped then the final size will not necessarily be given by the standard formula. In particular, the existence of a core group, as for sexually transmitted diseases, gives rise to a different formula for the final size (Anderson and May, 1991; Diekmann and Heesterbeek, 2000) .\n\nIn this paper, we explore the generality of the standard Kermack-McKendrick final size formula (5). We begin with a pedagogical review of the main results that have been obtained previously, adding model structure in steps. We then proceed to generalize these results in three new directions, showing that the standard formula remains valid (i) regardless of the number of distinct infectious stages, (ii) if the mean contact rate is itself arbitrarily distributed and (iii) for a large class of spatially heterogeneous contact structures. We conclude that the Kermack-McKendrick formula (5) applies in great generality, making it an extremely useful relationship in practice.\n\nThe standard SIR model (Anderson and May, 1991; Diekmann and Heesterbeek, 2000; Brauer and Castillo-Chavez, 2001 ) is represented by a system of three ordinary differential equations,\n\nHere, S, I, and R denote the proportions of the population that are susceptible, infectious and recovered, respectively. Recovered individuals are assumed to be immune to reinfection. Since S + I + R = 1, one of the three equations is redundant. The two parameters in the model are the transmission rate (\u03b2) and the recovery rate (\u03b3 ). The mean infectious period is T = 1/\u03b3 . The basic reproduction number is R 0 = \u03b2T. The proportion of the population that is infected can increase, and hence an epidemic can occur, if and only if R 0 > 1. In Eqs.\n\n(1), recruitment of new susceptibles through birth or immigration is ignored, as is loss of individuals through mortality or emmigration. This approximation is reasonable provided the timescale of the epidemic is much shorter than the timescale over which demographic turnover occurs.\n\nNo recruitment ensures that the disease will eventually burn out, i.e., I(\u221e) = 0. To see formally that we must have I(\u221e) = 0, note that the positive orthant is invariant so all solutions of Eqs. (1) lie in the non-negative, bounded set defined by S, I, R \u2265 0 and S + I + R = 1. Observing that\n\nwe see that S + I is decreasing whenever I > 0. However, S + I is bounded below by 0; hence it has a limit. Moreover, Eq.\n\n(2) implies that d dt (S + I) is bounded because I is bounded. Hence lim t\u2192\u221e d dt (S + I) = 0, so Eq. (2) yields I(\u221e) = 0. This model (1) is sufficiently simple that an exact solution can be obtained for the phase portrait. Forming dI/dS and integrating yields\n\nAn epidemic ends when no infectives remain. Consequently, we can find the final size Z by setting I = 0 in Eq. (3) and solving for Z = S(0) \u2212 S. This yields the implicit relation\n\n(an explicit form is given in Appendix A). The general formula (4) applies regardless of the proportions of the population that are susceptible and infective initially. A less than fully susceptible population must be taken into account if some individuals have been vaccinated or retain immunity from previous exposures. However, in the important special case where a new pathogen enters a fully susceptible population, we have both I(0) 1 and S(0) \u223c 1. In the limit I(0) \u2192 0, S(0) \u2192 1,\n\nwhich is the usual final size formula.\n\nThe practical utility of the final size formula would appear to be limited by the fact that it is derived from the overly simplistic standard SIR model. In the remainder of this paper we show that, in fact, the formula is valid under very general circumstances. We generalize the model in several steps, in order to explain the ideas clearly and to avoid exposing the reader to a notational burden at the outset.\n\nThe standard SIR model ignores any delay between the time an individual is infected and the onset of infectiousness. This latent period is often substantial compared with the infectious period (Anderson and May, 1991) . In addition, some pathogens (notably HIV) give rise to a sequence of distinct stages of infection, each yielding a different transmission rate (Redfield et al., 1986; Seligmann et al., 1987) .\n\nIt is common to incorporate latency by including an \"exposed\" class (E), yielding an SEIR model (Schwartz and Smith, 1983; Earn et al., 2000a) . However, noting that the exposed stage can be regarded as an infectious stage during which the transmission rate happens to be zero, we lose no generality by restricting attention to multiple infectious stage models, which we refer to as SI n R models if there are n infectious stages. Generalizing the SIR model (1) to include multiple infectious stages, the equations for an SI n R ar\u0117\n\nwhere I i is the density of individuals in the ith infectious stage, \u03b2 i is the transmission rate for contact with individuals in this stage, and 1 \u03b3i is the mean duration of this stage.\n\nThe sum of Eqs. (6) is zero, implying that S + n i=1 I i + R is invariant (and hence that Eq. (6d) is superfluous, as in the basic SIR model). To see that the final size is well-defined in this model, we generalize the argument given for the simple SIR model in Section 2. Let J k = S + k i=1 I i . Then d dt J k = \u2212\u03b3 k I k , so I k > 0 implies J k is decreasing and lim t\u2192\u221e d dt J k = 0. Hence I k (\u221e) = 0 for all k.\n\nBefore a new disease is introduced into a population, everyone is susceptible, i.e., S = 1, I 1 = \u00b7 \u00b7 \u00b7 = I n = 0 and R = 0, which is known as the disease free equilibrium (DFE). The stability of the DFE determines whether the new disease can cause an epidemic. Hyman et al. (1999) proved that the quantity\n\ndetermines the stability of the DFE, i.e., the DFE is locally stable if R 0 < 1 and unstable if R 0 > 1. Note R 0 as defined by (7) is the sum of the products of the transmission rate and mean duration in each infectious stage, i.e., it is the basic reproduction number for this model. We now proceed to show that Eqs. (6) yield the same final size formula as (5). Anderson and Watsons (1980) established this for the special case in which each stage has the same transmission rate and duration (\u03b2 i = \u03b2 and \u03b3 i = \u03b3 for all i). Their method can easily be generalized to arbitrary \u03b2 i and \u03b3 i as follows:\n\nLet G k = n i=k+1 I i + R, k = 1, . . . , n \u2212 1 and G n = R. Then Eqs. (6c) and (6d) imply d dt G k = \u03b3 k I k for each k = 1, . . . , n. Consequently, Eq. (6a) implies that the function\n\nis a constant of the motion. For a newly invading disease, S(0) \u2192 1, I k (0) \u2192 0 and\n\nRecalling that Z = R(\u221e) = 1 \u2212 S(\u221e), and Eq. (7), the final size formula Eq. (5) immediately follows.\n\nConsideration of a special case of the model in the previous section allows us to infer that the distribution of stage durations in any infectious stage need not be exponentially distributed. The final size formula (5) holds true if the stage durations follow a Gamma distribution, which has probability density\n\nHere, the shape parameter k is a positive integer and the scale parameter \u03c6 > 0. The mean is k/\u03c6 and the variance is k/\u03c6 2 . This family of distributions includes the exponential distribution (k = 1), nearly normal distributions (k large) and the Delta distribution, which yields a fixed duration (k \u2192 \u221e).\n\nThe term \u2212\u03b3 I in Eq. (1b) for the simple SIR model implies that the durations of infectious periods are exponentially distributed with mean 1/\u03b3 (Brauer and Castillo-Chavez, 2001) . Since the sum of exponentially distributed random variables is Gamma distributed, a standard trick (Anderson and Watsons, 1980; Lloyd, 2001a,b) enables us to replace an exponential distribution with mean 1/\u03b3 by a Gamma distribution g k,k\u03b3 (which also has mean 1/\u03b3 ). The trick is to replace a single infectious stage with k identical exponentially distributed substages of mean duration 1/(k\u03b3 ). The model then has precisely the form the SI n R model (6), but with the sequence of infectious stages being mathematical artefacts rather than biologically meaningful.\n\nSince this substage trick can be applied equally well to any infectious stage, Anderson and Watson's (1980) conclusion that the final size in an SIR model with Gamma distributed infectious periods is given by the usual formula (5) now generalizes to an arbitrary number of stages, each with Gamma distributed durations.\n\nAlthough expressed differently, in their original paper Kermack and McKendrick (1927) studied a particular limit of the Gamma distributed multiple stage model described in the previous section.\n\nSuppose we have a sequence of n infectious stages, each with the same, fixed stage duration \u03c4 . Thus, this is the limit k \u2192 \u221e in the Gamma distribution (10), with \u03c6 = 1/\u03c4 . During stage i, the transmission rate is \u03b2 i (i = 1, . . . , n). If we now let the number of infectious stages increase (n \u2192 \u221e) and the length of each stage decrease (\u03c4 \u2192 0), keeping the total infectious period (T = n\u03c4 ) constant, then we arrive at a model in which the transmission rate (\u03b2) varies continuously through the infectious period. In such a model, an individual's infectivity depends on his/her stage-age, i.e., the amount of time since initial infection.\n\nUsing a stage-age SIR formulation, Kermack and McKendrick (1927) derived the final size formula (5) and showed that its form is independent of how the transmission rate depends on stage-age.\n\nWe have seen that the final size formula (5) is the same if stage durations are distributed according to any member of the family of the Gamma distributions (10). This suggests that any distribution of stage durations will yield the same final size.\n\nUnlike the situation for Gamma distributed infectious periods, with an arbitrary distribution the time-evolution of the infectious class can no longer be expressed using ordinary differential equations (ODEs). Instead, we must construct a system of integro-differential equations (Feng and Thieme, 2000) . Let U(t) be the rate at which individuals become infectious (enter class I) at time t \u2265 0, i.e.,\n\nThe equation for the susceptible class is the same as in the standard SIR model,\n\nWe also define U(t) for t < 0 since this will allow us to specify the initial conditions. For t < 0, U(t) is the rate at which individuals who were still infectious at the initial time (time 0) became infectious at time t. Hence, the number of infectious individuals at time t = 0 is\n\nLet f (t) be the probability density of the infectious period (so, for the special case of a Gamma distribution, f (t) is given by g k,\u03c6 (t) in Eq. 10). For an individual who becomes infectious at time \u03c4 \u2265 0, the probability density that s/he recovers (leaves the I class) at time t > \u03c4 is\n\nHowever, for individuals who became infectious at time \u03c4 < 0, the probability density to leave class I at time t must be conditioned by still being infectious at time 0,\n\nHence, the rate of change of the number of infectious individuals at time t is\n\nThose who leave class I enter class R, hence\n\nIn Appendix B, we show that if the infectious period is exponentially distributed then Eqs. (11) reduce to the the standard SIR model (1). As in the standard SIR model (1), the population size is invariant (S + I + R = 1), S \u2265 0, and S(\u221e) exists. Establishing that I(\u221e) = 0 (so the disease will burn out regardless of the infectious period distribution) requires a little more work. Since f (t) and l(\u03c4, t) are probability densities, \u221e 0 f (t) dt = \u221e 0 l(\u03c4, t) dt = 1; consequently, switching the order of integrations, we find\n\nNext, integrating from 0 to \u221e on both sides of Eq. (11f), we have I(\u221e) = 0.\n\nTo relate the final size in the present model to the usual formula (5), we need an expression for the basic reproduction number R 0 . Feng and Thieme (2000) have\n\nWe now divide Eq. (11b) by S and integrate, yielding\n\nTherefore, the usual final size formula (5) will follow if \u221e 0 I(t) dt = T Z. This is plausible, intuitively, since the integral \u221e 0 I(t) dt sums all infectious individuals, weighted by the time they are infectious; this must also equal the mean infectious period T times the number of individuals infected over the course of the entire epidemic (the final size Z). More rigorously, in Appendix B we prove Lemma 6.1. For the model specified by Eqs. (11), in the limit (11). If the initial number of infectious individuals is small (I(0) \u2192 0), then the final size of the epidemic (Z) is given by the classical formula (5). In this formula, the basic reproduction number is R 0 = \u03b2T, where T is the mean infectious period.\n\nWith modest additional effort, we can generalize Theorem 6.1 to the multiple stage SI n R model, i.e., the usual final size formula (5) is still valid if there are multiple infectious stages and the durations of each stage are arbitrarily distributed. Recall that latent stages can be considered infectious stages with zero transmission rate, so we do not make any explicit reference to latency. As in all the situations considered above, we assume that vital dynamics (births and deaths) can be ignored and that recovery entails lifelong immunity.\n\nSuppose the ith infectious stage has duration distribution with probability density f i (t) and mean T i . Thus, in the special case that durations in each stage follow Gamma distributions (10), we have f i (t) = g ki \u03c6i (t) and\n\nThe the rate of change of the susceptible class is given by Eq. (6a), as when all stage durations are exponentially distributed. Similar to Section 6, the equation for each infectious stage can be writte\u1e45\n\nwhere U i (t) is the number of individuals entering class I i at time t, and\n\nThe initial conditions are specified by\n\nIndividuals who leave the last infectious stage recover (into class R), henc\u0117\n\nWhen the infectious periods and the latent period are exponentially distributed, i.e., f i (t) = \u03b3 i e \u2212\u03b3i t , the technique introduced in Appendix B can be applied to show that the model (13) is indeed the standard multiple-stage SIR model. In their analysis of the SI n R model with arbitrarily distributed stage durations (13), Feng and Thieme (2000) have shown that the basic reproduction number is\n\nand that the disease free equilibrium is unstable if and only if R 0 > 1.\n\nSimilar to previous sections, we find that S + i I i + R = 1 is invariant, S \u2265 0, and S(\u221e) exists. Integrating Eq. (13a) from 0 to t and and switching the order of integrations, we have I(t) \u2265 0; similarly, integrating from 0 to \u221e, we have I(\u221e) = 0. Thus, the disease will also eventually burn out.\n\nTheorem 7.1. Consider the multiple stage SI n R epidemic model with arbitrarily distributed stage durations, specified by Eqs. (13) . If the initial number of infectious individuals is suffciently small, i.e., in the limit i I i (0) \u2192 0, the final size Z is given by the unique solution of Eq. (5), or explicitly by Eq. (A.2) , in which R 0 is given by Eq. (14) .\n\nProof. To prove this, we divide by S on both sides of (6a) and integrate with respect to time,\n\nUsing Lemma 6.1, Eq. (15) becomes\n\nSuppose I i (0) = i 1. Switching the order of integration,\n\nAlso, integrating Eq. (13d) and switching the order of integrations, we have\n\ni.e., summed over all time, the number of individuals who enter the (i + 1)th stage is the same as the number who enter the ith stage. We then integrate Eq. (6a). From the definition of U 1 (t) in Eq. (13c), we have\n\nfor all i = 1, . . . , n. Notice that the final size Z = S(0) \u2212 S(\u221e), so Eq. (16) becomes\n\nDuring the epidemic of severe acute respiratory syndrome (SARS) in 2003 (Poutanen et al., 2003; Low and McGeer, 2003) , one aspect of observed transmission that received a great deal of attention was the existence of super-spreaders (WHO SARS Update 27, 2003), i.e., individuals who infect many more people than the average (e.g., at least an order of magnitude greater than R 0 ). In this section, we prove that the existence of the type of super-spreaders that occurred during the SARS outbreak in 2003 has no effect on the final size formula.\n\nOne mechanism for the generation of super-spreaders is that the infectious period distribution could be bimodal, such that a small proportion of individuals are infectious much longer than average. This situation is already covered by Theorem 7.1, which deals with arbitrary distributions of stage durations.\n\nIn this section, we consider a different type of generalization of the SIR model. In all of the models we have considered thus far, it has been assumed implicitly that all infectious individuals have the same transmission rate. If some individuals actually have a much higher than average transmission rate then they will be super-spreaders. This could arise, for example, because of individual variation in viral load (reflecting variation in immune response) or as the result of chance occurence of environmental circumstances that promote disease spread (as apparently occurred during the SARS epidemic (WHO SARS Update 33, 2003)). Whatever the origin, we focus here on variation in transmission rate that is manifested only after an individual is infected. In the following sections we consider the effects of intrinsic variation in contact rates among individuals, which results from inhomogeneous contact network structure in the host population.\n\nWe now proceed to develop and analyze an SIR model with a distribution of transmission rates and show that the usual final size formula (5) applies. Extension of our results to a multiple stage SI n R model is straightfoward and similar to the way we generalized our results for the SIR with arbitrary infectious period distribution to an SI n R model with arbitrary stage duration distributions.\n\nLet I(\u03b2, t) be the distribution (at time t) of infectious individuals that have transmission rate \u03b2. Note that we assume implicitly that a given individual retains the same transmission rate throughout his/her infectious period, and hence that this transmission rate is determined as soon as infection occurs. Let q(\u03b2) be the probability that a newly infectious individual has transmission rate \u03b2. Thus, the mean transmission rate is\n\nThe rate of change of the proportion of the population that is susceptible i\u1e61\n\nUpon infection, individuals leave the susceptible class S and enter the infectious class I, a proportion q(\u03b2) of them having a transmission rate \u03b2. Upon recovery, they leave the infectious class at rate \u03b3 . Thus,\n\nIn order to ensure that the model is well posed, we must establish that if I(\u03b2, 0) > 0 then I(\u03b2, t) > 0 for all time. Suppose this is not true. Then there exists\u03b2 and T such that \u221e 0 I(\u03b2, T) d\u03b2 > 0, I(\u03b2, t) > 0 for t < T, but I(\u03b2, T) = 0. Substituting these conditions into Eq. (21b), we obtain\u0130(\u03b2, T) > 0. But this contradicts the hypothesis that I(\u03b2, t) decreases from I(\u03b2, 0) > 0 to I(\u03b2, T) = 0. Hence I(\u03b2, t) > 0 for all t \u2265 0.\n\nWe now check that the disease will always burn out in this model, as expected.\n\nwhich is strictly negative. Hence, S + I tot is decreasing and bounded below by zero. Hence lim t\u2192\u221e d dt (S + I tot ) = 0, i.e., I tot (\u221e) = 0. For the model specified by Eqs. (21), the basic reproduction number is\n\nIn Appendix B,we prove that the disease free equilibrium (DFE) is unstable if and only if R 0 > 1. To find the final size, we divide by S on both sides of (21a) and integrate,\n\nSubstituting Eq. (21a) in Eq. (21b) we can writ\u0117\n\nIntegrating this we obtain\n\nSince we have established that I(\u03b2, \u221e) = 0, we can write\n\nSubstituting (25) into (24) and using (23), we obtain\n\nHence, since the final size Z = S(0) \u2212 S(\u221e), we have It is possible to generalize this theorem for an SI n R model with arbitrarily distributed stage durations and arbitrarily distributed transmission rates in each stage. We do not go through the details because no new ideas are required. With Theorems 7.1 and 8.1 in hand, the extra effort required for the generalization is merely one of keeping track of notation.\n\nIn all of the models that we have discussed so far, we have assumed that the population is homogeneously mixed. In the remainder of this paper, we explore the significance of heterogeneous mixing for the final size formula. In the present section we identify an important class of spatially structured models for which the standard formula (5) remains valid.\n\nA simple but important example of heterogenous mixing occurs if the population is divided into a number of spatially isolated patches (e.g., cities), often called a metapopulation (Hanski and Gilpin, 1997) . In ecological models, coupling among patches in a metapopulation usually occurs as a result of migration (Earn et al., 2000b) . In the present context, inter-patch coupling occurs because individuals travel temporarily from their home patch to other patches. On such journeys, susceptible individuals might contact infectious individuals and become infected, and infectious individuals might contact susceptibles and infect them. If we restrict attention to a single infectious stage with exponentially distributed infectious period then the model is specified as follows.\n\nHere, S i , I i , and R i (i = 1, . . . , n) are the proportions of the population in patch i that are susceptible, infectious recovered, respectively. Summing Eqs. (26), we see that S i (t) + I i (t) + R i (t) = 1 is invariant in all patches. We denote by N i the number of individuals in patch i, so the total population size is N = i N i . It is also convenient to use B = (\u03b2 i j ) to denote the n \u00d7 n transmission matrix. Similar to our analysis of other models in previous sections, it is straightforward to prove that S i (\u221e), R i (\u221e), I i (\u221e) exist, that S i (\u221e) + R i (\u221e) = 1 and that I i (\u221e) = 0. Since \u03b2 i j \u2265 0, the dominant eigenvalue \u03bb of B is real and positive (Horn and Johnson, 1985) . If we linearize the model (26) at the disease free equilibrium (DFE) (S i = 1, I i = 0, R i = 0), we see that the stability of the DFE is determined by \u03bb. If \u03bb/\u03b3 > 1, then the DFE is unstable, otherwise it is stable. Thus, the threshold for exponential growth of cases (an epidemic) is determined by the value of R 0 = \u03bb/\u03b3 , which can be interpreted as the basic reproduction number (van den Driessche and Watmough, 2002) .\n\nThe final size in patch i is Z i = S i (0) \u2212 S i (\u221e). We can obtain a system of n coupled algebraic equations for the Z i if we divide by S i on both sides of Eq. (26a) and integrate from 0 to \u221e. These algebraic equations contain \u221e 0 I i dt, which can be eliminated by integrating Eq. (26c) and noting that Z i = R i (\u221e) \u2212 R i (0). In the limit I i (0) \u2192 0, S i (0) \u2192 1, we obtain\n\nThese equations form a special case of a more general final size formula discussed by Diekmann and Heesterbeek (2000) (exercises 6.17 and 6.19). In their solution to exercise 6.19, Diekmann and Heesterbeek (2000) sketch an argument that implies that if R 0 > 1 then there is a unique non-trivial (i.e., non-zero) solution to Eqs. (27). The final size for the whole metapopulation, Z, is not in general the simple average of the Z i 's in Eq. (27). Rather, each Z i must be weighted by the population size N i of patch i, i.e.,\n\nConsequently, there will always be particular values of the N i that make Z in Eq. (28) equal to the solution of the standard formula (5). However, since population sizes are given a priori, the problem of interest is to find necessary and sufficient conditions on the transmission matrix (B) that ensure that the sum in Eq. (28) is equal to the final size obtained from the standard formula (5), regardless of the values of the N i . In Eq. (28), Z will have no dependence on the patch population sizes if and and only if\n\nGiven this, Eq. (27) implies\n\ni.e., the transmission rate is the same in all patches. If, on the other hand, we start with Eq. (30) as an assumption, then inserting Eq. (29) in Eq. (27) Restricting attention to situations in which the transmission rate is the same in every patch may seem to be an extremely stringent constraint. In fact, this is often the situation of interest. For example, individuals who normally reside in Boston, Philadelphia or New York can expect to contact similar numbers of people each day, even though the New York metropolitan area has a population that is several times larger than the other two. More generally, if patches represent large cities in a given country, then it is reasonable to expect that the number of contacts an individual has will not depend strongly on the size of the city.\n\nGiven Eq. (30), we can write\n\nwhere P i j is the probability, for an individual in patch i, that a given contact is with an individual in patch j, and \u03b2 is the transmission rate (the product of the number of contacts per unit time and the probability that a contact between a susceptible and an infectious individual leads to transmission). Note that since the rows of the matrix P are probability distributions, it follows that n j=1 P i j = 1, i = 1, . . . , n,\n\ni.e., P is a stochastic matrix (Horn and Johnson, 1985) . For convenience, we make the mild assumption that P i j > 0 for all i and j, i.e., for any pair of patches, there is a non-zero probability that residents of the two patches will come into contact. It then follows that if the final size Z is positive then the final size Z i is strictly positive in every patch. To see this, note that if Z i = 0 for some i then Eq. (27) \n\nSince P i j > 0 implies \u03b2 i j > 0, Eq. (33) implies Z j = 0 for all j.\n\nSince P is a positive, stochastic matrix, its largest eigenvalue is 1 (Horn and Johnson, 1985) . Consequently, the largest eigenvalue of B = \u03b2 P is \u03b2 and the basic reproduction number is R 0 = \u03b2 \u03b3 . Therefore, we have Theorem 9.1. Consider the multi-patch SIR epidemic model specified by Eqs. (26) . Suppose the transmission rate in each patch is the same, i.e., n j=1 \u03b2 i j = \u03b2, for each i. Then, in the limit that the initial proportion of individuals that are infectious is small, i.e., I i (0) \u2192 0 for each i, the final size Z of an epidemic is given implicitly by Eq. (5), or explicitly by Eq. (A.2) , where R 0 = \u03b2 \u03b3 .\n\nAt this point, it will come as no surprise that with some effort in keeping track of notation, Theorem 9.1 can be generalized to a multi-patch SI n R model with arbitrarily distributed stage durations and arbitrarily distributed transmission rates. \n\nEquations (26), which specify the spatially heterogeneous model we analyzed in the previous section, can be interpretted as representing other types of social heterogeneities, which are known to yield different final size formulae (Gart, 1968; Dwyer et al., 2000; Diekmann and Heesterbeek, 2000; Andreasen, 2003) . In this section, we briefly discuss two other interpretations, which lead to a transmision matrix that is not proportional to a stochastic matrix and will not yield the usual final size formula (5).\n\nRather than specifying heterogeneities of transmission resulting from spatial structure, as in the previous section, suppose that heterogeneities arise from age-structured mixing patterns. One possible formulation is to categorize the population by discrete age cohorts, which is typically motivated by mixing patterns of children in schools. If we consider a time-scale short enough that transfer from one cohort to the next can be ignored, then the standard \"realistic agestructured model\" (Schenzle, 1984) reduces to Eqs. (26) , where the transmission matrix B now refers to contact patterns among different age cohorts. As in the case of the spatial patch interpretation, it might be reasonable to assume that there is a stochastic matrix P such that\n\nwhere the interpretation is that individuals in cohort i have a proportion P i j of their contacts with individuals in cohort j, and \u03b2 i is the transmission rate for individuals in cohort i. Unlike the spatial interpretation, however, it would be hard to justify taking \u03b2 i to be the same for each i. In particular, young children tend to come into much closer contact with their classmates than teenagers or adults do with members of their cohorts. As a result, Theorem 9.1 will not apply and the final size will not be given by the usual formula (5).\n\nIn Section 8 where we discussed super-spreaders, we specifically excluded the types of super-spreaders that occur for sexually transmitted diseases, namely individuals who always have a higher rate of contact with others, regardless of whether they happen to be infected. When such \"core groups\" (Yorke and Hethcote, 1984; Anderson et al., 1986) exist, Eqs. (26) can still be used, with the interpretation that the stratification of the population is by social group rather than spatial region or age cohort. Like the age-structured situation, we can safely assume that Eq. (34) holds but not that \u03b2 i is the same for every i as in Eq. (30). Indeed, a large difference in \u03b2 i is precisely what defines the core groups. Again, we have a situation where the usual final size formula will not apply. Core groups are well known to have a critical role in the transmission dynamics of sexually transmitted diseases, so it is not surprising that they will affect the final size of epidemics.\n\nThe well-known formula (5) for the expected final size of an epidemic is valid in remarkably general circumstances. Previous work (e.g., Kermack and McKendrick (1927) ; Anderson and Watsons (1980) ; Diekmann and Heesterbeek (2000) ) established that the formula is valid in an SIR model with an arbitrarily distributed infectious period (Theorem 6.1). Here we have shown, in addition, that the standard formula (5) is invariant to the number of latent and infectious stages of disease (Theorem 7.1), the distributions of transmission rates within stages (Theorem 8.1), and even to common spatial contact heterogeneities (Theorem 9.1).\n\nThe invariance of the final size formula has important practical implications. Typically, the time at which one wishes to estimate the expected final size of an epidemic is long before enough information has been gathered to estimate the distributions of latent and infectious periods or other epidemiological details. Our theorems provide rigorous support for estimates of the expected magnitude of epidemics based solely on estimates of the basic reproduction number R 0 , which is the only parameter that appears in the final size formula (5).\n\nIt should be noted that the final size formula refers only to the ensemble average size of an epidemic for a disease with a given R 0 . Different stochastic realizations of the same process will lead to different final sizes and our analysis says nothing about the variance or higher moments of the final size distribution. Kurtz (1980) proved that in the limit that the population size goes to infinity, the ensemble mean of the stochastic SIR model with arbitrarily distributed infectious period converges to the solutions of the integro-differential equation model specified in our Eqs. (11). Hence, the standard final size formula gives the mean final size of the stochastic SIR model. However, it is difficult to deduce the distribution of the final size, and this remains an open problem for stochastic SIR models with arbitrarily distributed infectious periods. For stochastic SEIR models with Gamma distributed latent and infectious periods, Anderson and Watsons (1980) derived a normal approximation to the final size distribution that is valid in the limit of large population size.\n\nIf there is little variation in the length of the latent period, and the infectious period is short, the stochastic SEIR model can be approximated by a chain binomial model (Bailey, 1975) , which is a discrete time Markov chain. The time step for this chain is equal to the fixed-length latent period, since the infectious period is presumed infinitesimal (all contacts occur instantaneously at the end of the latent period). For such models, the only parameter is the probability q that a contact between an infectious individual and a susceptible individual leads to infection. With the assumption that q = 1 \u2212 e \u2212R0 , Von Bahr and Martin-Lof (1980) and Scalia-Tomba (1985) showed that final size distribution for the traditional chain binomial model is asymptotically normal in the limit of large population size. Scalia-Tomba (1986) and Andersson (1999) studied more general chain binomial models (with heterogeneous contact structures equivalent to those we discussed in Sections 9 and 10) and found asymptotic final size distributions. Their results imply that if q = 1 \u2212 e \u2212R0 then the ensemble mean final size in these chain binomial models is the solution of our Eqs. (27).\n\nWe emphasized two circumstances under which the usual final size formula will not apply. One was the case of age-structured heterogeneity of transmission; while this would influence the final size, it is unlikely that we would be able to parameterize the age-structured contact patterns sufficiently well to improve on the final size estimate generated with the assumption of homogeneous mixing. The other case we discussed was the existence of social core groups, which are extremely important in the epidemiological dynamics of sexually transmitted diseases; in this case, some estimate of the difference in transmission rates in different social groups would likely be needed to obtain a useful estimate of the final size.\n\nIn computing the final size, we have always assumed that there are no temporal changes in the transmission rate \u03b2. Temporal variations in \u03b2 could result from intrinsic seasonality of contact rates, imposition of control measures, or behavioral change in response to epidemic alerts. Small seasonal variations in \u03b2 cause only small perturbations to the final size formula, and substantial seasonality is generally associated with school-age children (London and Yorke, 1973) who form a small fraction of the susceptible pool when a new infection enters a population. Infection control measures, such as those adopted during the 2003 SARS epidemic (Lipsitch et al., 2003; Wallinga and Teunis, 2004) , could have a dramatic effect on the final size; in this case, rather than R 0 , the reproduction number that is relevant for the final size formula must be calculated after sustainable precautionary measures have been put into place. Individual behavioral change could alter the transmission rate through time-dependence (\u03b2 = \u03b2(t), as in the case of imposed control measures) or through density-dependence (\u03b2 = \u03b2(I), with \u03b2 decreasing as I increases, which would arise if people tend to be more careful when they are aware of more cases). In either case, the standard final size formula might yield a poor approximation of the true final size.\n\nAll of our analysis is predicated on the assumption that vital dynamics (births and deaths), and more generally any source of new susceptible individuals, can be ignored. This approximation is not valid in circumstances where infectious periods are substantial compared with life expectancy or where immunity decays rapidly. It will, however, typically be relevant whenever a new respiratory pathogen emerges, as in the case of the SARS outbreak in 2003 (Donnelly et al., 2003) or the emergence of a new subtype of influenza (Earn et al., 2002) . We are interested in growth or decay of I(\u03b2, ), which is determined only by Eq. (D.1b). Defining X(t) = \u221e 0 \u03b2 I(\u03b2, t) d\u03b2, multiplying both sides of Eq. (D.1b) by \u03b2, and integrating with respect to \u03b2, we find\n\nOn the other hand, recall that I(t) = \u221e 0 I(\u03b2, t) dt (the total number of infectious individuals at time t). Therefore, integrating Eq. (B.2b) with respect to \u03b2, noting that q(\u03b2) is a probability density function so The origin of this system of two ordinary differential equations is locally stable if and only if \u221e 0 \u03b2q(\u03b2) d\u03b2 \u2212 \u03b3 < 0 or, equivalently, R 0 < 1. Thus, the DFE is stable if R 0 < 1 and unstable if R 0 > 1. We can expand model (21) to include multiple stages. Using the same techniques, we find that the conclusion that the epidemic threshold is given by R 0 = 1 remains valid."}