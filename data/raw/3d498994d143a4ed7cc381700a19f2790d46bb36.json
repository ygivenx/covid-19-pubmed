{"title": "Vorpal: A novel RNA virus feature- 1 extraction algorithm demonstrated 2 through interpretable genotype-to- 3 phenotype linear models 4 5", "body": "MRIGlobal -425 Volker Blvd., Kansas City, MO, USA 10 SUMMARY 11\n\nIn the analysis of genomic sequence data, so-called \"alignment free\" approaches are often 12 selected for their relative speed compared to alignment-based approaches, especially in the 13 application of distance comparisons and taxonomic classification 1,2,3,4 . These methods are 14 typically reliant on excising K-length substrings of the input sequence, called K-mers 5 . In 15 the context of machine learning, K-mer based feature vectors have been used in 16 applications ranging from amplicon sequencing classification to predictive modeling for 17 antimicrobial resistance genes 6,7,8 . This can be seen as an analogy of the \"bag-of-words\" 18 model successfully employed in natural language processing and computer vision for 19 document and image classification 9, 10 . Feature extraction techniques from natural language 20 processing have previously been analogized to genomics data 11 ; however, the \"bag-of-21\n\nwords\" approach is brittle in the RNA virus space due to the high intersequence variance 22 and the exact matching requirement of K-mers. To reconcile the simplicity of \"bag-of-23\n\nwords\" methods with the complications presented by the intrinsic variance of RNA virus 24 space, a method to resolve the fragility of extracted K-mers in a way that faithfully reflects 25 an underlying biological phenomenon was devised. Our algorithm, Vorpal, allows the 26 construction of interpretable linear models with clustered, representative 'degenerate' K-27 mers as the input vector and, through regularization, sparse predictors of binary 28 phenotypes as the output. Here, we demonstrate the utility of Vorpal by identifying 29 nucleotide-level genomic motif predictors for binary phenotypes in three separate RNA 30 virus clades; human pathogen vs. non-human pathogen in Orthocoronavirinae, 31 hemorrhagic fever causing vs. non-hemorrhagic fever causing in Ebolavirus, and human-32 host vs. non-human host in Influenza A. The capacity of this approach for in silico 33\n\nidentification of hypotheses which can be validated by direct experimentation, as well as 34 identification of genomic targets for preemptive biosurveillance of emerging viruses, is 35 discussed. The code is available for download at https://github.com/mriglobal/vorpal. 36 37\n\nIn the quasispecies model, the virus organism is represented by the \"cloud\" of genotypes that can 39 be maintained by the virus within the allowable fitness parameters 12 . In the method proposed 40 here, the frame of reference for the quasispecies \"cloud\" is reduced to the level of K-length 41 motifs. In order to estimate the connectedness of these K-mers across the input assemblies, a 42 distance matrix between all of the unique K-mers observed across the designated virus genome 43 assemblies is established using hamming distance. Hierarchical clustering is then performed on 44 the resulting distance matrix using an average linkage function, corresponding to the ultrametric 45 assumption used in Unweighted Pair Group Method with Arithmetic Mean (UPGMA) 46 phylogenies, and flat clusters are extracted using a hyperparameter for the distance cutoff of 47 cluster membership. The constituents of these clusters are then aligned and their positional 48 variants represented using the International Union of Pure and Applied Chemistry (IUPAC) 49 nucleic acid notation with degenerate base symbols. These degenerate motifs are mapped back to 50 their respective assemblies. This approach facilitates interpretation of model features in a 51 functional profiling and hypothesis generating context. To demonstrate the effectiveness of this 52 new feature extraction technique, genotype-to-phenotype linear models were trained on various 53 RNA virus groups. A description of the Python implementation of the algorithm is detailed in 54\n\nMethods and the code is available for download at https://github.com/mriglobal/vorpal, along 55\n\nwith persistent versions of the models described here-in. A simplified example of the 56 agglomerative clustering step is depicted in Figure 1 this motif in the same reading frame but it has returned to the spike protein as QDGVNK. This 130 motif serves as a signal for human pathogenicity whose importance is based at least partially on 131 its translation, though the domain itself can appear in completely different protein products. It 132 was also recognized that another positive predictor in the model was a motif related to this one, 133 KGATGTTGTTARWCAAY, offset by a single nucleotide. This related motif sometimes co-134 occurred at the same position as the one mentioned above, and other times appears at a different 135 position in the genome, which suggests this is part of a larger, repetitive motif. 136 This is summarized in \n\nEbolavirus 148\n\nThe model for the genus Ebolavirus was specified for a phenotype corresponding to human-149 hemorrhagic-fever causing, i.e. the African Ebolavirus constituents, and non-human-150 hemorrhagic-fever causing, i.e. Reston ebolavirus (EBOV). The recently discovered Bombali 151 EBOV, was excluded due to its ambiguity as a human pathogen 15 . 152\n\nThe Ebola model demonstrates the utility of the assumption in the Vorpal algorithm that the 153 feature vector contains information about the frequency of genomic motifs. The preservation of 154 repeated motifs in the 5' untranslated region (UTR), especially of those in the overlapping UTRs 155\n\nin the Ebola genome, are the predictors of primary importance in differentiating the phenotypes. 156\n\nThese repeating motifs, or \"motif blocks\", and their corresponding coefficients in the model, are 157 summarized in Table 3 and visualized in Figure 3 . These motifs in the 5' UTRs, specifically in 158 the leading sequence of the L protein, have been previously established as being functionally 159 important to growth kinetics in cell culture 16 . The presence and location of this motif across the 160\n\nReston and African constituents of the Ebola genus forms an obvious distinguishing factor. The 161 contiguous block of overlapping motifs identified in The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.28.969782 doi: bioRxiv preprint Examination of the constituent K-mers of these motifs demonstrated that the allowance of the 225 negative predictor to map to the TTA leucine codon introduced, almost exclusively, swine 226\n\nisolates. The conservation of the CTA leucine codon in the human-isolate predictor is 227 noteworthy because this codon is one of the rare leucine codons in the human genome, with a 228 relative frequency of 7%. Alternatively, the TTA codon being more predictive for swine isolates 229 is notable because while TTA also only has a 7% relative abundance in humans, its abundance in 230 pigs is 6% while the CTA codon is less rare (13% relative abundance) 19 . This mammalian 231 adaptation separates it almost entirely from any avian examples and there appears to be a fitness 232 gradient. When it appears in mammals, there is a higher incidence of the uncommon leucine 233 codon at this location. Table 4B , and this relationship between motif 242 mapping frequency following a codon rarity gradient in mammals, and the inverse in birds, is 243 visualized in Figure 4 . that the TTA codon for leucine plays in increasing the probability of a Swine isolate classification 249\n\nfor the H1 subtype. Arrows indicating the increase or decrease in total number of motif 250 mappings point in a direction along the relative host codon frequency gradient where 251 rightwards movement indicates optimization towards the lower frequency rank for the 252 corresponding amino acid. also induced non-functional proteins, hypothesized to be related to glycosylation disruption 23 . 280\n\nThe fidelity of conformational change in mammalian isolates to these rare codon identities is 281 extremely high. The oscillation between these conformational states is suggestive of another 282 dimension of interpretation that these logistic regression models offer, outside of the examination 283 of the genomic motifs themselves. 284 285\n\nOther Dimensions of Interpretation\n\nThe fragility of the phenotype for the Influenza A model resulted in a model with higher 287 complexity than the other RNA viruses studied. However, this provides another avenue for 288 model analysis. Logistic regression classifiers offer not only an output label, but also a 289 probability assignment to the corresponding label. Thus, additional information can be encoded 290 in this output. Figure 5 presents a graphical representation of the distribution of these class 291 probabilities for the training sets for the segments described. \n\nThe highest coefficient predictor in the model for Influenza A segment 1, which codes for the 303 PB2 polymerase gene, is a motif which represents a mammalian amino acid substitution 304 experimentally observed in a mouse model 24 . This mammalian adaptation was identified as 305 relevant to the temperature sensitivity of the polymerase in H5N1. The reversion of the avian 306 conformation containing the glutamic acid residue, to the mammalian conformation containing 307 offers another angle for interpretation, especially in regards to identifying possible spill-over or 353\n\nre-assortment events and is depicted in Figure 6 . Neighbors in the local embedding are often 354 temporally and geographically proximal, in addition to sharing host isolate membership. 355\n\nComingling Table 6A . Close inspection of region (B) identifies linkage of human-conformation 366 H1N1 isolates from humans in Sichuan, China with those from pandas believed to have 367 been infected by direct human contact at a conservation center in the same locale.\n\nRegion B corresponds with data in Table 6B . Note: Axes in t-SNE plots have no intrinsic 369 meaning except to represent pair-wise distances between points.\n\nYear \n\nInspection of the embedded space makes it possible to identify candidate events, even if the 380 model has not made a classification error. Examples of these are summarized in Figure 7 and 381 Table 7A and 7B where Influenza A segment 1 (PB2) sequences are embedded into a two-382 dimensional field. Further experimentation may also help develop models that incorporate a 383 velocity to the conformational changes of host-predictor motifs and estimate temporal distance 384 from a prospective zoonotic event, in a segment-specific manner. 385 these viruses. However, it is possible to imagine these functional profiles leading to a more 438 deterministic understanding of function with which to build a predictive frame work. 439\n\nNonetheless, improvements in data structure and metadata association may yield better abilities 440\n\nto estimate the probability of future events. Certain observations seen in the models thus far may 441 themselves be predictive of the respective phenotype before it is observed, rather than an effect 442 of it already having occurred. The primary example of this is the predictor identified in the 443 Orthocoronavirinae model. As described in the Methods section, certain assumptions were built 444 into labeling for the human-pathogen phenotype that incorporated theories about the zoonotic 445 provenance of SARS and Middle East Respiratory Syndrome-related (MERS) from civets and 446 camels respectively. Observing human-pathogen predictors occurring in SARS and MERS 447 viruses from non-human hosts could suggest the ability to predict the potential of a virus as a 448\n\nhuman pathogen in advance of a spill-over event. This is observed in the data. The 449\n\nAKRATGKTGTTAATMAA motif appears in all five of the civet SARS assemblies in the 450 dataset. In the case of the camel isolates, the motif KGATGTTGTTARWCAAY, which is also 451 related to the one mentioned above, is another high coefficient predictor for human pathogenicity 452 and it appears in 231 of the 232 Camel-MERS instances in the training set. This motif also 453 appears in the emerging 2019-nCoV as noted in Table 2.  454  455 As for the obstacles for predictive efforts, there are many opportunities for improvements in the 456 collection and annotation of viral genomic data. In Table 1 Genbank records for the Influenza A training set members for \"passage\" annotations revealed 464 that 42.3% of the instances in that set contained such annotations for cell passage. In contrast, the 465 Influenza A test set members, which represents more recently generated data, only contained 466 \"passage\" annotations in 29.0% of those records. 467 468\n\nLastly, we hope that this analysis demonstrates that the utility of a Global Virome Project is not 469\n\nambiguous. Controversy about the value of such a project has been described 29 and this thinking 470 has been reflected in policymakers' decision to end funding to USAID Predict. If recent 471 estimates of mammalian viral diversity hold true 30 , then marginal increases in monitoring 472 infrastructure combined with new and developing analysis methods, such as Vorpal, might 473 finally deliver the long sought preemptive strategies for emergent diseases, and enable us to 474 more effectively battle those from which we are already suffering. 475 476\n\nThe use of this algorithm for genotype-to-phenotype models is just one of the potential 478 applications. Automated molecular assay design and degenerate-motif based phylogenetics are 479 examples of the downstream uses already being investigated. The ability to make use of the 480 . CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.28.969782 doi: bioRxiv preprint latent data that is accumulating in databases, as well as novel surveillance data, is made more 481 tangible with this algorithm. Well-curated and richly annotated metadata promises to allow 482 machine learning and other data science techniques to unleash a torrent of discovery in genomics 483 at large. The mantra we are positing for the infectious and emergent diseases surveillance 484 community is \"More data, Better data, Metadata.\" The techniques to unlock the potential of 485 data-driven genomic science are gathering momentum. The Vorpal algorithm for feature extraction was developed using the libraries and versions 560 delineated in the requirements.txt document located on the Github. The Vorpal feature 561 extraction algorithm has 3 steps, each corresponding to a script that becomes the Vorpal 562 workflow. 563\n\n1. kmercountouter_sparse.py 564 a. Input: 565\n\ni. a reference genome in FASTA format 566\n\nii. a folder containing complete assemblies for the viral group of interest 567\n\niii. a parameter for K-mer size 568 iv. a percent variance argument for filtering out assemblies that are divergent 569 from the reference genome in terms of length 570 . CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the \n\nWrapper scripts for reproducing the models with the parameters described below are also 603 provided as binary_vorpal_model.py and binary_vorpal_model_ElasticNet.py. 604 605\n\nAll models were built around binary output variables using a logistic regression classifier. The 607 models were regularized using either \u21131 or ElasticNet methods, using the liblinear 31 \n\nAll of the input parameters for feature extraction and the rationale behind the use and tuning of 619 each parameter, and their relation to the corresponding model discussed above is provided here. 620 621\n\nThe first parameter, K length, can be a variable input, but in the development of these methods 623\n\nwas fixed at 17. The decision to set the k-length at 17 had many facets. The first is that the 624 feature space should be large enough, that the introduction of degenerate positions does not 625 cause a complete collapse of feature structures. Evaluation of optimal K length for specific tasks 626 has been performed in many contexts. For phylogenetic representations of viruses, an optimal 627 range of 9 to 13 has been proposed 35 , for the optimal uniqueness ratio in plant genomes a K 628 length of 20 has been identified 36 , and in phenetic analysis of bacteria a K length of 31 has been 629 demonstrated to yield the best balance between sensitivity and specificity in intra-and 630\n\ninterspecies distance analysis 4 . However, defining a subspace that lends itself to genotype-to-631 phenotype model interpretability should have the following desiderata: 632\n\n1. K-size motifs should map to mostly unique genomic loci. In other words, sparsity in the 633 weights vector is influenced by sparsity in the input vector. 634\n\n2. K-size should be small enough, that the feature space inflation is not catastrophic to 635 memory constraints. 636 \n\nApplying a filter to the K-mers that are allowed to proceed to the clustering step has two 699 purposes. The first is to denoise the data by removing low abundance features that could be the 700 result of error or other transient sources of variance. The removal of these K-mers is achieved 701 through a parameter specified at the clustering stage, the K-mer quantile. Singletons, or K-mer 702 that are unique to a single instance, are always removed no matter the quantile specified. It was 703 The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.28.969782 doi: bioRxiv preprint discovered that allowing the singletons to form motifs through agglomerative clustering 704\n\nintroduced instability into the model parameter estimation (data not shown). Contribution to 705 frequency is determined not by cumulative sum of count across every instance but rather 706 frequency of presence across the sample instances. This is identical to the way the \"TopN\" score 707 is calculated for K-mers in PriMux primer design software 37 . Using a K-mer frequency filter 708 selects for a conserved variance signal. This is a reasonable heuristic to introduce, especially for 709 predictive models, where these high-frequency K-mer derived motifs are the those with the 710 presumed highest probability of appearing in a novel example of a related organism in nature. 711\n\nThe second function of this feature extraction parameter, made reference to above, is as a 712 dimensionality reduction technique to make K-mer clustering more tractable in the current 713 algorithm implementation, given limitations in computational resources. Memory constraints 714 during the tree building step represents the primary bottleneck with the scipy implementation of 715 the nearest-neighbors chain algorithm for average linkage using ( F ) memory 38,39 . 716\n\nThe user specifies an average number of degenerate bases to apply when flat clustering. This 717 number is then divided by the K length specified to estimate the corresponding hamming 718 distance to provide as the max distance for flat clustering. After flat clusters are grouped into 719 alignments and a degenerate motif of the alignment is generated by collapsing each position in 720 the K length alignment into the IUPAC symbol matching the bases seen at that position. 721\n\nThis clustering of K-mers, and subsequent representation as degenerate motifs, is another layer 722 of dimensionality reduction similar to lemmatization of words in a Natural Language Processing 723 (NLP) feature extraction technique 40 . Much of this approach could be described as modifications 724 of equivalent NLP feature extraction and modeling strategies. It should be noted however, that 725 data preparation techniques such as term frequency-inverse document frequency (tf-idv), were 726 considered inappropriate to apply in this circumstance for multiple reasons. First, \"document\" 727 length was invariant in the sense that complete assemblies were the only instances allowed in the 728 training data, and differences in genome sizes within the taxonomies considered were considered 729 irrelevant. Second, document terms, in this case K-mer motifs, that follow a frequency pattern 730 similar to the word \"the\" in the English language are not present. Additionally, for this reason, 731 the data was not normalized, however to improve convergence speed this could be a future 732 improvement. 733 734\n\nPhenotype labels for the different organisms modeled were applied using a variety of strategies 736 with some specific assumptions introduced for labeling of the Orthocoronavirinae group. In the 737 cases of Ebolavirus and Coronavirus, taxonomy was used as a guide for phenotype labels, where 738 knowledge about the phenotype of interest was usually easily delineated along taxonomic 739 boundaries. For Influenza A, the World Health Organization nomenclature for Influenza strain 740 identification, which is encoded in the FASTA header, was parsed for labeling of human 741 isolate 41 . For those FASTA headers which contained malformed strain identifiers, an ambiguous 742 labeling was applied and removed from the training set. 743 744\n\nThe following explicit assumptions were applied when labeling viral instances for the human 745 pathogen phenotype in the Orthocoronavirinae model. First, since most transmissions of Middle 746\n\nEast Respiratory Syndrome-related (MERS) betacoronavirus to humans have been zoonic events 747 traced to dromedary camels, all camel isolates for MERS coronavirus were labeled in the 748 positive class corresponding to human pathogen. Likewise, in the cases for Severe Acute 749 . CC-BY-NC-ND 4.0 International license author/funder. It is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.02.28.969782 doi: bioRxiv preprint"}