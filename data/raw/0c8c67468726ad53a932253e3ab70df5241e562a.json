{"title": "Weighted multifractal cross-correlation analysis based on Shannon entropy", "body": "Sequences in complex systems generally exhibit fluctuations on a wide range of time scales of the data, where the distinct fluctuations follow a scaling relation over several orders of magnitude. Such scaling laws provide a description of the data and the complex system by fractal scaling exponents. Nevertheless, many records do not present a simple monofractal scaling behavior and different parts of the series require different scaling exponents. In even more complicated cases, such different scaling behavior can be observed for many interwoven fractal subsets of the time series, where a multitude of scaling exponents is required for a full characterization of the scaling behavior in the same range of time scales and a multifractal analysis must be applied. In order to observe the fractals and multifractals in time series, algorithms have been developed one by another [1, 2] .\n\nSince detrended fluctuation analysis (DFA) has been proposed by Peng et al. [3] to detect the long-range power-law correlations in DNA sequences, it has been successfully applied to diverse fields [4] [5] [6] [7] [8] [9] [10] [11] . Then Podobnik and Stanley [12] generalized DFA and introduced the detrended cross-correlation analysis (DCCA) for two non-stationary time series, which has aroused increasing interest in analysis of long-range cross-correlation and multifractality [1, [13] [14] [15] [16] [17] [18] [19] [20] [21] [22] [23] [24] [25] . Specifically, the analysis is based on the bivariate Hurst exponent h xy estimation, which is related to an asymptotic power-law decay of the cross-correlation function. A power-law cross-correlated process has the cross-correlation function C xy (k) \u221d k 2hxy\u22122 for k \u2192 +\u221e and the cross-power spectrum | f xy (s)| \u221d s 1\u22122hxy for s \u2192 0+. h xy = 0.5 is characteristic for the absence of power-law cross-correlation, while processes with h xy > 0.5 are cross-persistent and h xy < 0.5 indicates the anti-persistent cross-correlation of the data [2, 12, 25] . Basis of these, the cross-correlation coefficient (\u03c3 DCCA ) was introduced with the objective of quantifying the level of cross-correlation between nonstationary time series [26] [27] [28] . In the DFA-DCCA-\u03c3 DCCA line, Kristoufek [29] has recently introduced the DFA framework to estimate regression parameters at different scales and under potential non-stationarity and power-law correlations. Alternatively, the detrending moving-average (DMA) method can also be used for fractal or multifractal analysis, found that the backward multifractal detrending moving average (MFDMA) algorithm outperforms the multifractal detrended fluctuation analysis (MFDFA) [30] [31] [32] [33] . As an alternative to \u03c3 DCCA , based on the detrending moving-average cross-correlation analysis (DMCA), the DMCA coefficient \u03c1 DMCA was proposed as well [17, 34] . To investigate the multifractal features of two cross-correlated non-stationary series, several methods have been proposed for this purpose. Zhou [14] further proposed multifractal detrended cross-correlation analysis (MFDCCA) as a generation of DCCA. Jiang and Zhou [35] developed a class of MFDCCA algorithms based on DMA, called MFXDMA whose performances are comparative to MFDCCA's. Moreover, a new method for the detection of long-range crosscorrelations and multifractality based on scaling of qth order covariances, multifractal height cross-correlation analysis (MF-HXA), was proposed by Kristoufek [18] . Meanwhile, statistical moments function or partition function has been widely applied to analyze the multifractal features of financial time series [36] [37] [38] [39] [40] . Based on this approach, Jiang and Zhou [38] investigated the multifractal characteristics in intraday minutely data for four stock market indexes within individual trading days and found the so-called multifractality is merely an illusion. Dissimilarly, when they performed the partition function approach on the 1-min volatility of two indexes and 1139 stocks in the Chinese stock markets, multifractal nature is significant [39] . Extending that from one dimension to two dimensions, Wang et al. [40] introduced the multifractal cross-correlation analysis based on statistical moments (MFSMXA) as an application of the joint multifractal measures [41] , finding that MFSMXA has comparative performance with MFXDMA and sometimes perform slightly better than MFDCCA. By far, multifractal analysis has been employed successfully in various provinces, such as human nature [42] [43] [44] , financial time series [45] [46] [47] , river flow [48] and traffic signals [49] , etc.\n\nHowever, there are limitations in these algorithms and the common one is that they ignored the difference of the measurement in each segment that contributes to the final fluctuation functions unequally theoretically. While in other academic fields, weighting function is selected for improvement, such as Shannon entropy [50] [51] [52] [53] , variance or energy [54] , and so on [55] . Inspired by their work, basis of MFSMXA, we propose in this paper a weighted method based on Shannon entropy (W-MFSMXA) to analyze the multifractal cross-correlation between two series. Results show that W-MFSMXA is comparable to and in some extent better than MFSMXA.\n\nThe remainder of this paper is organized as follows. In Section 2, the methodologies of MFSMXA and W-MFSMXA are introduced. In Section 3, we test the effectiveness of the W-MFSMXA algorithms with three types of artificial time series: twocomponent ARFIMA stochastic processes, binomial multifractal model and the NBVP time series. Performances are also compared with these in MFSMXA. Application to financial time series is presented in Section 4. At last, Section 5 gives the conclusions and appendix exhibits charts of the finite-size effect for the binomial multifractal model.\n\nThe MFSMXA method [40] consists of four steps. Consider two time series {X(i)} and {Y(i)} of the same length N, where i = 1, 2, . . . , N.\n\nStep 1: Divide each series into N s = int(N/s) non-overlapping segments of equal length s. For a given segment size s, the elements in the vth segment can be described as:\n\nwhere v = 1, 2, . . . , N s and i = 1, 2, . . . , s.\n\nStep 2: For each segment, we define a quantity u as follows,\n\nwhere [(v \u2212 1)s + 1, vs] is the vth segment. The measure \u03bc in each segment is constructed as follows,\n\nStep 3: Calculate the statistical moments function F XY (q, s)\n\nStep 4: Determine scaling behavior of cross statistical moment functions by analyzing log-log plots of F XY (q, s) versus s for each value of q. We expect it to scale as\n\nwhere the exponent \u03c4 XY (q) is a scaling exponent function, regarded as a characteristic function of the fractal behavior. Note that \u03c4 XY (0) = \u22121. For q = 2, the method is used to detect the long-range cross-correlations between series, which we call it cross-correlation analysis based on statistical moments (SMXA). When {X(i)} = {Y (i)}, the above method reduces to the multifractal analysis for separate series (MFSMA) [36] [37] [38] [39] .\n\nIn light of the relationship of two sets of multifractal scaling exponents, there is an analytic form between \u03c4 XY (q) and the generalized bivariate Hurst exponent h XY (q):\n\nwhere D f is the fractal dimension of the geometric support of the multifractal measure and D f = 1 for time series analysis [1] . If q dependence of the scaling exponent \u03c4 (q) is nonlinear, there is multifractality in the signal. The singularity strength \u03bb and its spectrum f(\u03bb) related to \u03c4 (q) through a Legendre transform [56] can be defined as,\n\nIf the singularity width \u03bb = \u03bb max \u2212 \u03bb min gets close to zero, the series has practically no multifractality. Otherwise, there is a multifratcal nature in the series. According to Ref. [18] , for time series in a standard way,\n\nand\n\nFurther, the left part of Eq. (9) can be rewritten through the definition of covariance:\n\nand combining Eqs. (6) and (8), the first part of the right side of Eq. (10) implies\n\ni.e,\n\nNow consider a new scaling exponent \u03b7(q) and relationship\n\nholds, which is identical with \u03b1(q) = h XX (q)+h YY (q) 2 in Ref. [18] . Otherwise, it does not establish unless covariances do not scale with s. Thus, the importance of long-range cross-correlations and multifractality resides in the scaling of covariances between |\u03bc X (v, s)| q/2 and |\u03bc Y (v, s)| q/2 regarding varying s and q. As a consequence, there are two types of cross-multifractality: (i) crossmultifractality caused by multifractality of the separate series, and (ii) cross-multifractality by scaling of covariances between |\u03bc X (v, s)| q/2 and |\u03bc Y (v, s)| q/2 .\n\nIt can be noted that in the MFSMXA, the product \u03bc X \u03bc Y of each segment in both sequences contributes to the final function F XY (q, s) equally, but it is rational to make F XY (q, s) be proportional to \u03bc X \u03bc Y in a simplest view. And to a certain extent, the measure \u03bc is kind of frequency or probability. To improve that, we propose a modification of current MFSMXA, called weighted MFSMXA method based on Shannon entropy (W-MFSMXA), to take into account that not all measurements contribute equally when constructing the statistical moments function and to save as much information as possible carried by the series. Specifically, the motivation behind this is to weight proportionally segments with distinct measurements \u03bc but the same final F XY (q, s). [57] to be the weight factor makes sure that \u03bc with higher value is assigned more weights. Furthermore, Shannon entropy as a complexity (or regularity or orderliness) measure quantifies the information richness of \u03bc in series and this novel information-based approach has been successfully employed in literary authorship disputes [50] , SARS coronavirus [51] , biologic signals [52] and financial time series analysis [53] .\n\nTherefore, we replace the statistical moments function in step 3 in MFSMXA method with a weighted statistical moments function, which is calculated as follows:\n\nwhere the weighting function \u03c9(v, s) is selected to be the sum of Shannon entropy for the vth segment of series {x(i)} and {y(i)} [50] [51] [52] [53] :\n\nand Z is a normalization factor such that Ns\n\nThen, same as MFSMXA in the step 4, we expect F\n\nIt reduces to the long-range cross-correlation analysis in a weighted way for q = 2 (W-SMXA) and the multifractal analysis for individual series when {X(i)}={Y(i)} (W-MFSMA). Note that \u03c4 (\u03c9) XY (0) = 0.\n\nIn this section, we use three types of artificial time series, the two-exponent ARFIMA processes [58] , binomial multifractal model [56] and the NBVP time series [59] , to test the effectiveness of this new procedure and make comparison between two methods. The latter two have been proved the existence of cross-multifractality.\n\nThe power-law autocorrelations in stochastic variables can be modeled by the fractionally autoregressive integrated movingaverage process (ARFIMA) process [60] :\n\nwhere t \u223c N(0, 1), d \u2208 (0, 0.5) is a memory parameter related to Hurst exponent as h xx = 0.5 + d [12] , and a n (d) are the weights defined by a n (d) = d (n \u2212 d)/( (1 \u2212 d) (n + 1)), where denotes the Gamma function and n is the time scale.\n\nThe two-component ARFIMA stochastic processes can be defined by two variables x t and y t [58] : \n\nThe\n\nwhere t , \u03bd t \u223c N(0, 1), a n (d 1 ) and a n (d 2 ) are the weights defined in Eq. (19) through the scaling parameters d 1 and d 2 (0 < d 1, 2 < 0.5), and W is a free parameter controlling the coupling strength between x t and y t (0.5 \u2264 W \u2264 1). When W = 1, the process in Eq. (20) reduces to two decoupled ARFIMA processes defined in Eq. (19) , and consequently the long-range cross-correlations between x t and y t vanish while both x t and y t remain long-range power-law auto-correlated. Additionally, the mixed-correlated ARFIMA process (MC-ARFIMA) has been proposed as a good alternative to the two-component ARFIMA process with analytically solved asymptotic properties [61] . In our simulations, W = 0.8 and parameters (d 1 , d 2 ) are set as \n\nUsing the binomial multifractal model (BMF) [56] , we construct several binomial multifractal series {x(i)} with the length of N = 2 nmax . The kth number in series is defined as\n\nwhere 0 < p x < 0.5 is a parameter, n(k) is the number of digits equal to 1 in the binary representation of index k. For example, n(14) = 3, since 14 corresponds to binary 1110. Series generated by this model has known analytic multifractal properties. The scaling exponent \u03c4 (q) has an analytic form [62] :\n\nsatisfying Eq. (14) [35, 40] .\n\nIn this paper, we generated series with length of 2 16 (1) \n\n0.8307 and 0.8316 respectively while {x(i)} & {z(i)} significantly correlated with the coefficient of 0.4709. It derives from the fact that these sequences are constructed according to the same rules despite variations of parameters [35] . Besides, BMF has been successfully implemented in multifractal analysis and the cross-multifractality between two series is significant [14, 18, 35, 40] . Nevertheless, cross-persistence in BMF is mainly due to the persistence of the separate processes and the fact that the series are correlated [18] . Moreover, what's intriguing is that the procedure after being weighted did not change the structure of the statistical moments function, which is particularly evident in Fig. 2c . It is noteworthy that F (\u03c9) xy (q, s) in W-MFSMXA is more synchronous with F xy (q + 1, s) in MFSMXA apparently when q is non-negative and especially when q equals zero in W-MFSMXA while one in MFSMXA.\n\nAnalogous phenomena turn up when plotting the scaling exponent function \u03c4 xy (q) versus the moment order q in Fig. 3a . Obviously, \u03c4 (\u03c9) xy (q) are nonlinear and upwards convex, which indicates the multifractal nature between two time series. What's more, \u03c4 (\u03c9) xy (q) and \u03c4 xy (q) are almost parallel to each other. When shifting the figure of \u03c4 (\u03c9) xy (q) to right with unit 1, \u03c4 (\u03c9) xy (q) and \u03c4 xy (q) coincide pretty well (not shown here), which is identical with F (\u03c9) xy (q, s) closer to F xy (q + 1, s xz (q, s) and F (\u03c9) yz (q, s). As the scaling exponent function for q in W-MFSMXA is synchronous with that in MFSMXA for q + 1, then we assume \u03c4 (\u03c9) xy (q) = \u03c4 xy (q + 1) and theoretically when {x(i)\n\nln2 . Note the difference of the q index is 1 rather than the step-length. The singularity spectrum f(\u03bb) of the theoretical analysis in Eq. (23) is displayed in Fig. 3c . Numerical results are significantly in line with their theoretical values. Fig. 3d shows the singularity spectra between two series and they basically accord with the averages of theoretical values on the basis of Eq. (23) .\n\nIt is worthwhile to note that short length N of the investigated series or small scale s often results in a spurious detection of multifractal behavior from a monofractal model [19] . To evaluate the finite-size effect [25] Fig. 11 . Results of \u03c4 (\u03c9) xy (q) between two time series in W-MFSMXA are plotted in Fig. 12 . Yet again, nine pairs of data used here for cross-multifractal analysis are significantly correlated (see Table 2 ). It is clear to see that \u03c4 (\u03c9) xy ( In order not to seem rigmarole, we only illustrate the results of one pair of experimental data in following experiments.\n\nIn fact, from the log-log plot, the function \u03c4 (\u03c9) XY (q) in Eq. (18) can be defined as follows [44, 63, 64] :\n\nso can be the Eq. (5). Combining Eqs. (5), (18) and (24), we can get a new equation:\n\nwhere a(q) is the exponent of the best power law fit for F The a(q) with respect to q for series {x(i)} and {y(i)} is depicted in Fig. 4a . In Fig. 3a , \u03c4 (\u03c9) xy (q) and \u03c4 xy (q) increase with the increasing orders q and \u03c4 (\u03c9) xy (q) > \u03c4 xy (q) for all values of q. Thus, for \u22125 < q < 0, \u03c4 xy (q) < \u03c4 (\u03c9) xy (q) < 0 then 0 < a(q) < 1; for 1 < q < 5, 0 < \u03c4 xy (q) < \u03c4 (\u03c9) xy (q) then a(q) > 1; otherwise, \u03c4 (\u03c9) xy (q) > 0 and \u22121 < \u03c4 xy (q) < 0, then a(q) < 0. Since the a(q) functions diverges at q = 1, a(1) is removed for better illustrations as well in the following experiments. Then, the graph of a(q) with respect to q can be approximately viewed as a centrosymmetric hyperbola. For q \u2192 \u00b15, a(q) approximates to 1, demonstrating two methods are practically consistent, while differences are apparent for relatively smaller orders q. Actually, for higher orders q > 5 or q < \u22125, a(q) \u2192 1 establishes as well. However, a(q) = 1 holds for all q, consequently delay between W-MFSMXA and MFSMXA is substantial. As we can see in Fig. 4b , the profiles of \u03c4 (\u03c9) xy (q) and \u03c4 xy (q) after multiplying corresponding a(q) are coincident, confirming the Eq. (25).\n\nDeriving from the classical continuous BVP oscillator, a two-dimensional map by using the forward Euler discrete scheme can be written as: x n+1 = x n + \u03b4 y n \u2212 1 3\n\nx 3\n\nn + x n + \u03bc , y n+1 = y n + \u03b4\u03c1(a \u2212 x n \u2212 by n) , (26) where 0 < \u03c1 1, 0 < a < 1, 0 < b < 1, \u03bc is a stimulus intensity and 0 < \u03b4 < 1 is the step size. Given a set of variables and initial values x 0 and y 0 , we can get time series {x(i)} and {y(i)}.\n\nFirst, we generate two more complex BVP series with the length of N = 10 4 , which are called NBVP time series, whose initial value \u03bc is a random variable, satisfying \u03bc \u223c Norm(0.2, 1) and other initial values are constant values, with \u03b4 = 0.1, \u03c1 = 0.001, b = 0.5, a = 0.2, x 0 = 0 and y 0 = 0.01, where the cross-correlation relationship is found to be multifractal by Xue et al. [59] . To our knowledge, no analytic expression has been generated for this model. Series analyzed here are with a given preparation as in Section 3.1, then we apply MFSMXA and W-MFSMXA algorithms to the NBVP series to examine the validity of the assumption about delay in Section 3.2. Results are shown in Fig. 5 . Singularity widths in this case are \u03bb = 0.5242 and \u03bb (\u03c9) = 0.5294, which are insignificantly deviated. Same as the previous part, except for the position and several discrepant points, the multifractal structure of the series remains unchanged. \u03c4 (\u03c9) xy (q) and \u03c4 xy (q) after multiplying correspond a(q) are nearly coincident and the hyperbolic characteristics of a(q) with respect to q is more obvious. In other words, the \u03c4 xy (q) measurements in both method are apparently different for relatively smaller q but more accordant for higher q while never equal. Proposition about the delay is further verified. It can be seen in Fig. 5d , the scaling of covariances \u03b7(q) \u2212 1 is higher than the average of scaling of separate processes for negative moment orders q, the deviations are nevertheless not significant for higher positive q. In contrast, \u03b7(q) \u2212 1 basically coincides with \u03c4 xy (q), implying that the cross-multifractality of series is mainly caused by the scaling of covariances between |\u03bc X (v, s)| q/2 and |\u03bc Y (v, s)| q/2 as the construction of the NBVP mixes the long memory of the separate processes.\n\nIn order to prove the applicability of the proposed W-MFSMXA method in real world data, we then apply this method to financial time series to analyze their cross-multifractality. Here, we perform two US stock indices: the Dow Jones Industrial Average (DJI) and the National Association of Securities Dealers Automated Quotations (NAS). The original data were obtained from yahoo finance (http://finance.yahoo.com) from Jan. 2, 1997 to Dec. 29, 2014. To make sure of the synchronization of the time series, we exclude the asynchronous data and then reconnect the remaining parts of the original series. In so doing, the resulting length is 4526. The data we analyze in this paper are defined as the absolute logarithmic returns, this is, r t = |log(x t ) \u2212 log(x t\u22121 )|, where x t denote the closing price for a stock index on day t. The daily absolute returns for the two stock indices are shown in Fig. 6 . Profiles of two series are very similar to each other.\n\nLet x denotes DJI series and y denotes NAS throughout this section. Fig. 7a depicts the statistical moments function F xy (q, s) as a function of scale s in log-log plots for q from \u22123 to 3 with the step-length of 1 by W-MFSMXA and MFSMXA methods. Excellent power laws are also observed for both algorithms. Same as before, F (\u03c9) xy (q, s) in W-MFSMXA is more similar to F xy (q + 1, s) in MFSMXA, which is conformed when plotting the scaling exponent function \u03c4 (q) versus the moment order q in Fig. 7b . The scaling exponent ratio a(q) is plotted in Fig. 7c and clearly approximates a hyperbola. The nonlinearity of \u03c4 (q) demonstrates the existence of but weak multifractality in the absolute logarithmic daily returns series. Besides, in Fig. 7d , \u03c4 xy (q) are practically consisitent with the averages of \u03c4 xx (q) and \u03c4 yy (q) while the scaling of covariances \u03b7(q) \u2212 1 is obviously the lowest, indicating that the cross-multifractality in series is mainly dominated by the multifractality of separate series.\n\nTo give a more systemic statistical test on these returns series, we adopt the following bootstrapping approach to get the possibility that the empirical multifractality could be spurious [38, 39] . We reshuffle each series 1000 times to remove any potential temporal correlation, then carry out the W-MFSMXA procedure for the surrogate data as for the original data. A very strict null hypothesis is imposed to investigate whether the singularity spectrum f(\u03bb) is wider than those produced by chance. The null hypothesis is the following:\n\nThe associated probability of false alarm for multifractality is defined by\n\nwhere n is the number of shufflings and #[ \u03bb \u03bb rnd ] counts the number of \u03bb whose value is not greater than \u03bb rnd . As n \u2192 \u221e, it is clear that the estimated bootstrap p-value will tend to the ideal bootstrap p-value. Under the conventional significance level of 0.01, the multifractal phenomenon is statistically significant if and only if p \u2264 0.01. When p > 0.01, the null hypothesis cannot be rejected.\n\nResults of the statistical test are presented in Fig. 8 . A remarkable deviation of the singularity spectrum f(\u03bb) of the original data from f rnd (\u03bb rnd ) of the surrogate data is clear to see in Fig. 8b . Hence, we can infer that cross-multifractality in series is destroyed by the shuffling procedure as a consequence of the eliminated long memory in the separate returns series. Further, we find p = 0 using the significance level of 0.01, which is a significant evidence for the presence of cross-multifractality in the investigated DJI and NAS data. Comparing the scaling exponent ratio a(q) in Figs. 4a, 5 c and 7 c, it can be found the similar hyperbolic feature of a(q). Moreover, the statistical moments functions as well as the scaling exponents in W-MFSMXA are almost exactly the same as those in MFSMXA if taking no account of their phases or positions.\n\nIn this paper, we have proposed a modified MFSMXA method called weighted MFSMXA method based on Shannon entropy (W-MFSMXA). To test the robustness of this new procedure and compare to the heuristic MFSMXA, we first employed three types of artificial time series: the two-exponent ARFIMA processes with monofractal feature, the binomial multifractal model (BMF) and the NBVP time series, which have been proved the existence of multifractal properties. However, unlike BMF, crossmultifractality in NBVP is mainly caused by the scaling of covariances rather than the correlated separate processes. Long-range cross-correlation analysis of the two-component ARFIMA stochastic processes by W-MFSMXA uncovered the fractal nature in these power-law cross-correlated series. Results of multifractal analyses show that the statistical moments function versus scale s for q in W-MFSMXA is more similar to that in MFSMXA for q + 1. The scaling exponents obtained by two methods are almost parallel to each other. What's more, differences of the corresponding singularity widths captured by two algorithms do not deviate significantly from zero. Thus, it is rational to believe that the multifractal structure of series has not been changed by the weighting procedure without considering their positions. Basis of these, we generated analytic formulas of the BMF model for W-MFSMXA. Theoretical analysis and finite-size effect test verified the good performances of W-MFSMXA. Specifically, numerical results are well in line with the theoretical values and W-MFSMXA outperforms MFSMXA for analysis of series with relatively shorter length. Meanwhile, we generated the scaling exponent ratio a(q), whose profile is approximately a centrosymmetric hyperbola, to describe the relation between W-MFSMXA and MFSMXA. Scaling exponent estimators in both methods are more consistent for relatively higher orders q while never equal, indicating the delay in MFSMXA compared to W-MFSMXA.\n\nAt last, we applied W-MFSMXA to the absolute logarithmic returns of two US stock market indices: the Dow Jones Industrial Average (DJI) and the National Association of Securities Dealers Automated Quotations (NAS). The results obtained are same with those obtained for artificial time series. Besides, weak cross-multifractal nature is found in the returns series and their cross-multifractality is mainly due to the multifractality of separate series. Further, we compared outcomes of the original and shuffled series. Statistical test proved that cross-multifractality in the investigated DJI and NAS data is destroyed by the shuffling procedure as a consequence of the removed long memory in separate returns series.\n\nIn general, all these illustrations make we believe that the proposed W-MFSMXA method not only will not change the multifractal structure of series but contains more significant information of series compared to the previous MFSMXA method for the introduced weighting function. In some extent, it's comparable to and better than MFSMXA. Though there is no criterion for Shannon entropy as the weight factor as the best choice, it did exhibit elegant performances as we can see in the text. This goes nevertheless beyond the scope of current work.\n\nTo evaluate the finite-size effect of BMF series, plots of the scaling exponent \u03c4 (q) in MFSM(X)A and the proposed W-MFSM(X)A are exhibited in this appendix. Series investigated here are generated from the process in 14) and (23) ."}