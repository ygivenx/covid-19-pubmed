{"title": "Warehouse capacity sharing via transshipment for an integrated two-echelon supply chain", "body": "Warehouse capacity has been an important consideration that managers need to take into account to make optimal decisions in many industries. On one hand, extending warehouse capacity usually involves a long-run investment that is a strategic decision. Such investment would require a certain or predictable increment in demand for a long period. On the other hand, many supply chains have some certain peak time of demand in a short period due to short-term sales promotions or emergencies. Therefore, it would not be economical for those managers to invest for higher warehouse capacities which cannot be fully utilized in the long run. Moreover, it is usually not easy to rent warehouses for a short time, such as one month. There exist many studies on inventory system with tight warehouse capacity (refer to Wang et al., 2012; Fiestras-Janeiro et al., 2015) , and delayed replenishment is considered as a solution to the single buyer case (refer to Lee and Wang, 2008; Yi and Sarker, 2013) . For multi-buyer cases, we show that transshipment between warehouses of buyers could be an efficient approach to improving the supply chain performance. The following examples in China motivate our research.\n\nChinese on-line business companies conduct sales promotions under several periods in each year, such as the first week in October, the second week in November, and the month corresponding to spring festival, which are related to new or conventional festivals in China. Because demands during those periods are much higher than those at other time, warehouse capacities at many retailers are not sufficient. However, it is not easy for them to expand their warehouse capacities. First, building new warehouses may fail to be beneficial because each peak time may last for two or three weeks. Second, warehouse owners prefer long-term contracts (longer than one year) that make leasing warehouse capacity for a short time usually unavailable in China. Although some retailers may sell multiple types of products, it is still difficult for them to smooth out the utilization of the warehouses by scheduling the arrival of products because the demands are much higher than the warehouse capacities. In this case, the companies replenish products to retailers simultaneously in every cycle, and transship products between them to fully utilize warehouse capacities during the demand peaks which can reduce the ordering and replenishment costs.\n\nThe second example is from the medicine supply chains during the Severe Acute Respiratory Syndromes (SARS) disaster in China in 2003. The SARS lasted for about half a year when citizens generated high and specific demand for some Chinese traditional medicines. Because this demand was caused by emergency, supply chains could not extend warehouse capacities of retailers to satisfy the high demand. Therefore, transshipment between retailers was implemented to increase the utilization ratio of warehouse capacities of supply chains. In addition, the suppliers replenished retailers simultaneously in every cycle, to satisfy the constraints for long-distance transportation, including limited number of trucks and drivers.\n\nIn an integrated inventory system, the vendor can arbitrarily move the products from one buyer to another, which is known as transshipment between buyers. Transshipment can also be achieved under the vendor managed inventory (VMI) system, in which the vendor has the authority to conduct transshipment between buyers. The advantage of transshipment is twofold. First, under uncertain demands, transshipment between buyers can improve the customer service level, and it is popular in many industries, such as automobile and consumer goods (refer to Anupindi et al., 2001) . In this case, transshipments transpire between a buyer with excess inventory and another with excess demand. To the best of our knowledge, most of existing studies on transshipment are motivated by this consideration. Second, under the transshipment policy, the vendor may improve the utilization ratio of the buyers' warehouse capacities by keeping products that exceed one buyer's warehouse capacity at other buyers' warehouses for a time. In this way, the vendor can move those products to that buyer at appropriate time points and benefit from this type of warehouse capacity sharing strategy. The above two examples reveal that this strategy has been implemented in the real world to improve the supply chain performance under some short-term selling seasons.\n\nIn this paper, we study a continuous review inventory model under integrated control and transshipment between buyers who have limited warehouse capacity. The vendor simultaneously replenishes buyer inventories by using ordinary deliveries with relatively long lead times; however, in a relatively short time, inventories can be moved from one buyer to another when inventory levels prompt buyers to reorder. Fig. 1 illustrates a supply chain model with transshipment between buyers.\n\nIn this paper, we propose a nonlinear programming model for a supply chain with warehouse capacity constraints under transshipment policies. We attempt to address the following three questions:\n\n(a) Can warehouse capacity sharing with lateral transshipment (TRAN) lead to a lower channel-wide average cost than the integrated inventory model without transshipment (INT)? (b) If it can, what is the reason for this advantage and how do channel parameters affect it? (c) How do the fix transshipment costs affect the performance of the TRAN model?\n\nBecause the three research questions have been addressed rarely, we explain the contribution of our study to the existing literature by revealing the advantages of the TRAN model and the necessity for considering fixed transshipment costs during decision making. In addition, with respect to methodology, we develop an efficient algorithm to find the channel-wide optimal solution under any assignment of buyers for transshipment. For the algorithm, we propose an optimal transshipment policy on the basis of which we can obtain the channel-wide optimal order quantity and the transshipment quantities between buyers by using the Karush-Kuhn-Tucker (KKT) condition. This paper is organized as follows. We review the related literature in Section 2 and propose a TRAN model in Section 3. Section 4 describes an algorithm that can be used to obtain the optimal solution when the assignment of buyers for the transshipment is given. The GA that accounts for the fixed transshipment cost is proposed in Section 5. A numerical example is discussed in Section 6, and we provide concluding remarks in Section 7.\n\nA large body of literature is devoted to integrated inventory models with a single vendor and multiple buyers. Woo et al. (2001) studied an integrated inventory model for a single vendor and multiple buyers based on ordering cost reduction. In that model, the vendor orders raw materials and produces identical products for one cycle. Ordering costs can be reduced along with expenditure cost, and all of the buyers use the same replenishment cycle length. Zhang et al. (2007) extended the above model by considering that buyers can have different cycle lengths. Zavanella and Zanoni (2009) studied a VMI model by considering that buyers may receive the orders in different shipments. Darwish and Odah (2010) studied a VMI model with a single vendor and multiple buyers. In their model, the vendor orders and obtains the products at the beginning of each cycle, which is divided into several identical sub-cycles. All of the buyers share the same sub-cycle, and in each subcycle, the buyers obtain the amount of product to satisfy their demand. In that paper, they also considered a penalty cost for stock that exceeds buyers' warehouse capacity. Hariga et al. (2014) extended the above VMI model by considering a variable replenishment cycle. Sadeghi et al. (2014) studied a bi-objective inventory model for a three-stage supply chain with multiple retailers. In that model, the vendor has one replenishment frequency for all of the retailers. Mateen et al. (2015) analyzed a single vendor and multi-buyer inventory model and each buyer has an upper limit stock. Moreover, replenishment exceeding the limit generates a penalty cost in that model.\n\nBy considering delivery lead time, Prasertwattana and Chiadamrong (2004) analyzed the optimal purchasing and inventory policy in a supply chain with a single manufacturer and multiple buyers under periodic review. They developed a genetic algorithm (GA) to find the appropriate ordering and inventory levels of the manufacturer and the buyers. Hsu and Lee (2009) studied an integrated inventory system with a single manufacturer and multiple buyers in which each buyer has the same lead time, which can be reduced with a crashing cost. Taleizadeh et al. (2012) proposed a multiple products, single vendor, and multiple buyers' inventory problem. In each cycle, the vendor sends products to the buyers in n shipments, and lead time is assumed to vary linearly with respect to the lot size. Moreover, the vendor's warehouse capacity and buyers' budgets are considered in that model. Jha and Shanker (2013) studied a system wherein the buyers have the same length of sub-cycle but different lead times. In that model, the length of lead time can also be reduced with a crashing cost. All of the cited studies did not offer an account of transshipment between buyers.\n\nMany studies have focused on the lateral transshipment between buyers. One motivation of considering transshipment is to improve the channel performance under demand uncertainty (e.g., Lee, 1987; Axs\u00e4ter, 1990; Herer and Rashit, 1999; Rudi et al., 2001; Xu et al., 2003) . Shao et al. (2011) studied the incentives for transshipment in a supply chain with decentralized buyers. They showed that the manufacturer prefers a high transshipment price while the buyers prefer a low one. Chen et al. (2012) studied transshipment in the newsvendor problem wherein each selling season is divided into two phases: two retailers order at the beginning of the first phase, and one can obtain transshipped products from the other retailer at the beginning of the second phase. Noham and Tzur (2014) discussed a multi-item transshipment problem by considering the fixed cost of transshipment. Dan et al. (2016) proposed a two-period model with two retailers and a single supplier. The retailers can implement preventive transshipment at the beginning of the second period to rebalance their inventories. Lee and Park (2016) analyzed the inventory and transshipment policy for a supply chain with two retailers and a single supplier who has a random supply capacity. Zhao et al. (2016) studied the transshipment problem in an online-to-offline supply chain. In that dual channel, transshipment is conducted between the retailer and the manufacturer's direct channel to pool the inventory risk. These studies focused on the transshipment in the newsboy problem. In addition, Torabi et al. (2015) considered an inventory transshipment problem of an e-retailing channel in which products can be transshipped among retailers after the uncertain demand is revealed.\n\nThere exist several studies on transshipment by considering warehouse or production capacities. Kawamura et al. (2006) analyzed the case of a Brazilian sugar supply chain which consists of multiple products, production plants, and capacitated transshipment points. A linear programming model is developed for the problem and it is solved by a software package. Drechsel and Kimms (2011) discussed the cooperative lot sizing problem with transshipment among multiple independent players. Moreover, the cost sharing among those players is considered from the game theoretical aspect. Shen et al. (2011) developed a Lagrangian relaxation approach for crude oil transportation network by considering multi-mode inventory routing problem incorporated with transshipments. Coelho et al. (2012) combined the inventory-routing problem with transshipment and considered the inventory capacities of retailers. Ahmadi et al. (2016) analyzed the location and inventory problem in a three-stage supply chain with transshipment. Refer to Paterson et al. (2011) for a detailed survey of the studies on lateral transshipments.\n\nWe can see that the continuous review inventory model combining the warehouse capacity constraints and transshipment policies has rarely been studied in previous research. Table 1 shows a comparison of our paper to other relevant papers which considered either transshipment or upper stock limit.\n\nThe following notation is used to develop the TRAN model: m number of buyers D i product demand (consumption) rate of buyer i W i warehouse capacity of buyer i A v order cost of the vendor h v unit holding cost of the vendor A i fixed cost of sending products to buyer i h b unit holding cost of each buyer (we assume that the buyers have the same unit holding cost) c b unit holding cost of the products delivered from the vendor to each buyer during the lead time (we assume that the buyers have the same unit holding cost during the lead time) f i fixed cost of transshipping products from buyer i to other buyers in one sub-cycle L i lead time of buyer i E set of buyers whose order quantity is greater than the warehouse capacity u upper bound on the number of buyers in set E TC v total cost per cycle for the vendor AC v average cost for the vendor TC i total cost per cycle for buyer i AC i average cost for buyer i AC nt average channel-wide cost without transshipment AC nf average channel-wide cost obtained from Algorithm 2 AC f average channel-wide cost obtained from the GA r i reorder point of buyer i without transshipment s ij transshipment cost from buyer i to buyer j per unit product ij T i cycle time of buyer i M set of buyers, M = {1, 2, . . . , m} H i set of buyers receiving transshipped products from buyer i = 1, 2, . . . , m P i set of buyers transshipping products to buyer i = 1, 2, . . . , m Z big number Decision variables:\n\nQ order quantity of the vendor n number of shipments from the vendor to a buyer in one cycle T cycle time of the vendor q i number of products sent to buyer i in each shipment without transshipment option r 0 i reorder point of buyer i under transshipment Dq ij amount of products delivered from buyer i to buyer j in one transshipment x i 1, if f i occurs; 0, otherwise\n\nConsider an integrated supply chain with a single vendor and multiple buyers under lateral transshipment strategy. The vendor is geographically far away from the buyers who are relatively geographically close to each other. The vendor orders and obtains the products at the beginning of each cycle, which is divided into several identical sub-cycles. The replenishment quantity of buyer i is equal to the demand during the sub-cycle (i.e., T i ), and T 1 = T 2 =, \u00c1 \u00c1 \u00c1 ,=T m . After receiving products from the supplier, the vendor sends the products to the buyers simultaneously with lead time L i for buyer i in each sub-cycle. We consider L i values to be exogenously specified parameters. Because we focus on the lateral transshipment under warehouse capacity constraints, we assume that each buyer has a certain product demand (consumption) rate which is a usual assumption in inventory literature (refer to Darwish and Odah, 2010; Hariga et al., 2014; Mateen et al., 2015) . The order-quantity, reorder-point (Q, r) continuous review ordering policies are used at the buyers, each of whom has an inventory capacity. Preventive transshipment between buyers under centralized control occurs when the inventory levels reach the reorder points. Because the buyers are located in one region, we assume that the lead times of transshipments are negligible. We also assume that s ij = s ji and s ij < s ik + s kj , i, j, k = 1, 2, . . . , m and ijk.\n\nBecause T 1 = T 2 =, . . . ,=T m , we know that q 1 /D 1 = q 2 /D 2 =, . . . ,=q m /D m . Without transshipment, the quantity of products sent to buyer i in each shipment satisfies\n\nThe vendor's order quantity is determined by\n\nwhere D \u00bc P m i\u00bc1 D i . Let R i be the quantity of products delivered to buyer i with ordinary delivery in each sub-cycle when lateral transshipments between buyers are allowed. Then, we have\n\nIn addition, r i = D i L i . Therefore, the reorder point under transshipment is r 0 Fig. 2 shows the inventory levels of a single vendor and three buyers, in which Buyer 1 transships Dq 13 to Buyer 3 and Buyer 2 is not involved in transshipment in any sub-cycle. I v represents the inventory level of the vendor and I i represents the inventory level of buyer i, i = 1, 2, 3. Compared with the inventory level without transshipment, Buyer 1 receives more products in an ordinary delivery while Buyer 3 receives fewer products. Moreover, upon transshipment, the inventory level of Buyer 1 immediately decreases, as the red lines show.\n\nFrom Eq.\n\n(1), we see that the total quantity of products sent to buyers satisfies P m i\u00bc1 q i \u00bc Dq 1 =D 1 . The length of each subcycle at each buyer is equal to q 1 /D 1 . The total cost per cycle of the vendor is\n\nThe total cost per cycle of buyer i satisfies:\n\nFrom Eqs. (4) and (5), we can obtain the average cost per unit time of the vendor and buyer i as follows:\n\nThe decision framework of the supply chain within the TRAN model (P1) is\n\nn > 0; integer \u00f014\u00de\n\nThis problem is a mixed 0-1 nonlinear programming problem with m(m \u00c0 1) + 2 decision variables. The objective function, i.e., Eq. (8), is used to minimize the channel-wide average cost per unit time. Constraints (9) guarantee that the inventory level of each buyer cannot exceed the warehouse capacity before the transshipment. Constraints (10) illustrate that the inventory levels cannot be negative. Constraints (11) guarantee that the number of products received by each buyer during each sub-cycle is greater than the reorder point. Constraints (12) ensure that the number of products delivered in transshipment cannot be a negative value. Constraints (13) present the condition stating that if buyer i transships its inventory to others, then x i = 1, i = 1, 2, . . . , m. It means that x i = 1 is a necessary condition for P m j\u00bc1;j-i Dq ij > 0. Under the TRAN model, transshipment between buyers is implemented allowing each buyer's order to arrive at multiple time points. As a consequence, the total quantity of the products that some buyers can obtain during one sub-cycle can be greater than their warehouse capacities. In addition, the utilization ratio of the warehouse capacities of some buyers is increased. Because warehouse capacity can be shared, the channel-wide optimal replenishment solution can be achieved. \n\nP1 is a nonlinear programming model that is difficult to solve. In this section, we discuss the optimal transshipment policy and propose an algorithm to simplify P1. Let Dq \u2044 ij be the optimal Dq ij in P1, i, j = 1, 2, . . . , m.\n\nTheorem 1. For any pair of {q 1 , n}, the optimal transshipment solution of P1 should satisfy\n\nProof. For a pair of {q 1 , n}, consider a feasible transshipment solution of P1 with 0 < Dq ij < Dq jk and x i = x j = 1. Consider a transshipment solution with Dq 0 ij , i, j = 1, 2, . . . , m, ij. Let Dq 0 ij = 0, Dq 0 ik = Dq ik + Dq ij , Dq 0 jk = Dq jk \u00c0 Dq ij , and the transshipment quantities between other buyers remain as the original solution (see Fig. 3 ).\n\nIn this case, only AC i , AC j , and AC k are influenced and the difference between the average costs under these two transshipment solutions is D 1 (s ij + s jk -s ik )Dq ij /q 1 . Under Dq 0 ij , Dq 0 ik , and Dq 0 jk , the inventory levels of each buyer when the products from the vendor arrive and when the transshipments occur are, respectively, the same as the levels under Dq ij , Dq ik , and Dq jk . These conditions mean that the new solution satisfies Constraints (9)-(15) and is feasible for P1. Because s ij + s jk -s ik > 0, the average cost of the supply chain per unit time under Dq 0 ij , Dq 0 ik , and Dq 0 jk is lower than the cost under Dq ij , Dq ik , and Dq jk . Using the same approach, we can obtain the same results in the case in which 0 < Dq kj < Dq ij . Consequently, the optimal transshipment solution should satisfy Eq. (16). h Theorem 1 illustrates that, there exists an optimal transshipment solution in which the vendor cannot simultaneously transship products to one buyer and move the recipient buyer's inventory to other buyers. Therefore, under the optimal transshipment solution, H i and P i should not be nonempty at the same time. Theorem 1 also indicates that Dq \u2044 ij \u00c2 Dq \u2044 ji = 0, i, j = 1, 2, . . . , m, and ij. If we assume that s ij s ik + s kj , i, j, k = 1, 2, . . . , m and ijk, then three buyers may be located on the same line. In these cases, it is possible to obtain optimal solutions that satisfies Dq \u2044 ij \u00c2 Dq \u2044 jk -0 and Theorem 1 only captures a specific optimal solution.\n\nLet DAC ij (Dq ij |q 1 ) be the part of AC i + AC j , which is influenced by Dq ij . From Eq. (7) and Theorem 1, we obtain\n\nTheorem 2. For any pair of {q 1 , n}, in the optimal transshipment solution of P1, Dq \u2044 ij = 0 when 0 q i W i and 0 q j W j .\n\nProof. For a pair of {q 1 , n}, without loss of generality, suppose an original transshipment solution in which Dq 12 > 0, DAC 12 (Dq 12 |q 1 ) > 0, x 1 = 1, 0 q 1 W 1 , and 0 q 2 W 2 . From Theorem 1, we can infer that Dq 2i = 0 and Dq j1 = 0, for all i, j = 3, 4, . . . , m. The relevant constraints of P1 can be written as Fig. 3 . The transshipment quantities among buyers i, j, and k.\n\nConsider a transshipment solution with Dq 0 ij , i, j = 1, 2, . . . , m, ij. Let Dq 0 12 = 0 and other transshipment quantities remain as the original solution. Because 0 q 1 W 1 and 0 q 2 W 2 , Constraints (18)-(23) can be transformed to Constraints (24)-(29) under the solution with Dq 0 12 = 0.\n\nTherefore, by setting Dq 0 12 = 0, we obtain a new solution feasible for P1 from the original solution. The difference between the average costs under these two transshipment solutions is determined by\n\nBecause DAC 12 (Dq 12 |q 1 ) > 0, the solution with Dq 0 12 = 0 leads to a lower average cost. Therefore, we can always find a feasible transshipment solution with Dq 0 12 = 0, which leads to a lower average cost than Dq 12 > 0. h From Theorem 2 we can infer that inventories should not be transshipped from buyer i to buyer j when q i and q j are no greater than W i and W j , respectively, for all i, j = 1, 2, . . . , m, and ij.\n\nTo satisfy the warehouse capacity constraint for buyer k with q k > W k , we have P i2M Dq ik > 0 and P j2M Dq kj \u00bc 0. It means that if q k > W k , buyer k must obtain transshipped inventory from others. Based on Theorems 1 and 2, we propose an approach to obtain the optimal transshipment solution. For a pair of {q 1 , n}, let E denote the set of all buyers with q k > W k . Without loss of generality, we assume that\n\nIf q i+1 > W i+1 , then q i > W i because q i /D i = q i+1 /D i+1 . Obviously, q m should not be greater than W m , and Buyers 1 to i + 1 need to receive products transshipped from other buyers when q i+1 > W i+1 , i = 1, 2, . . . , m \u00c0 2. If x 2 = x 3 = . . . = x m = 0, then Buyer 1 cannot obtain any transshipped inventory from other buyers and q 1 should be no greater than W 1 . Moreover, we have q i W i , for all i = 1, 2, . . . ,m. In this case, E is empty and there is no transshipment.\n\nLemma 1. Under {x 1 , x 2 , . . . , x m } with x 2 + x 3 + . . . +x m -0, there exists an upper bound, u, on the number of buyers in E and u is equal to the largest k that satisfies W k D k 6 min i\u00bc1;2;...;k\n\nMoreover, the minimum value of u is 1.\n\nProof. From Constraints (9) and (10), we obtain q i W i + r i , i = 1, 2, . . . , m. From Inequality (33), suppose that buyer u + 1 has W u\u00fe1 D u\u00fe1 > min i\u00bc1;2;...;u\u00fe1\n\nIf buyer u + 1 is in E, then we have q u+1 ! W u+1 . Moreover, we can obtain q j /D j ! W u+1 /D u+1 because q j = D j q u+1 /D u+1 . Considering Inequality (34), we can obtain q j > W j + r j , which does not satisfy q j W j + r j . In this case, there is no feasible solution.\n\nWhen the number of buyers in E is equal to u, the minimum q 1 is D 1 W u /D u . The minimum total order quantity of buyers in E and other buyers (e.g., buyer i) with x i = 1 can be obtained as\n\nDu . Inequality (33) guarantees that this minimum value cannot exceed the total warehouse capacity of those buyers. For any buyer in E, in which the number of buyers is 0, 1, 2, . . . , or u, a feasible solution that satisfies Constraints (9)-(15) can be found if Inequalities (32) and (34) are maintained. Suppose that buyer u + 1 has\n\nIf buyer u + 1 is in E, then the minimum total order quantity of buyers in E and other buyers (e.g., buyer i) with x i = 1 exceeds the total warehouse capacity of those buyers, which cannot lead to any feasible solution. Therefore, there exists an upper bound equal to the largest k that satisfies Inequalities (32) and (33).\n\nBecause W 1 /D 1 < (W 1 + r 1 )/D 1 and x 2 + x 3 + . . . + x m -0, the minimum value of u is 1. h\n\nIf the number of buyers in E is no greater than u, we define E as feasible; therefore, all of feasible Es are \u00a3, {1}, {1, 2}, . . . , {1, 2, . . . , u}. It is easy to show that the number of feasible Es does not exceed m; i.e., u m \u00c0 1. Buyers in a feasible E obtain transshipped products that do not exceed their warehouse capacities. From Theorem 2, we can see that the value of u is influenced by {x 1 , x 2 , . . . , x m }. Theorem 3 explains the range of q 1 under {x 1 , x 2 , . . . , x m } and a feasible E.\n\nTheorem 3. For {x 1 ,x 2 ,. . .,x m } and a feasible E:\n\n(iii) If E={1, 2, . . . , j} with j < u, q 1 should satisfy\n\nProof.\n\n(i) E = {1, 2, . . . , u}. Because q u > W u and q u = D u q 1 /D 1 , we get q 1 > W u D 1 /D u . To satisfy the total inventory capacity constraint of the buyers involved in transshipment, we obtain\n\nThen, we can infer that\n\nBecause u is the upper bound, q u+1 W u+1 . We obtain q 1 D u+1 /D 1 W u+1 . From the proof of Lemma 1, we get q i W i + r i , i = 1, 2, . . . , u. Therefore, q 1 D 1 min i=1,2,. . .,u [(W i + r i )/D i ]. Then, we can show that q 1 should satisfy Inequality (35). (ii) E is \u00a3. In this case, q i W i , i = 1, 2, . . . , m. Therefore, q 1 D 1 min i=1,2,. . .,m (W i /D i ) = W 1 . (iii) E = {1, 2, . . . , j} with j < u. Because q j > W j and q j = D j q 1 /D 1 , we get q 1 > W j D 1 /D j . Because q j+1 W j+1 and q j+1 = D j+1 q 1 /D 1 , we obtain q 1 W j+1 D 1 /D j+1 . h\n\nTheorem 3 shows that upper and lower bounds on q 1 characterize a feasible E. Let g ij (q 1 ) represent the unit cost of transshipment that is equal to (\n\nTheorem 4. To determine the optimal transshipment solution for buyers not in E, the vendor should not transship products from buyer i to buyer j if buyer k with g kj (q 1 ) < g ij (q 1 ) has unused warehouse capacity.\n\nProof. Without loss of generality, suppose that Buyer 1 is in E, Buyers 2 and 3 are not in E, and g 21 (q 1 ) < g 31 (q 1 ). Consider a transshipment solution in which Dq 21 > 0, Dq 31 > 0, and W 2 \u00c0 q 2 \u00c0 Dq 21 > 0. Let Dq 0 21 = Dq 21 + min(W 2 -q 2 \u00c0 Dq 21 , Dq 31 ) and Dq 0 31 = Dq 31 -min(W 2 -q 2 -Dq 21 , Dq 31 ). It follows that X m i\u00bc1 AC i \u00c0 X m i\u00bc1 AC 0 i \u00bc \u00bdg 31 \u00f0q 1 \u00de \u00c0 g 21 \u00f0q 1 \u00de min\u00f0W 2 \u00c0 q 2 \u00c0 Dq 21 ; Dq 31 \u00de \u00f0 40\u00de\n\nBecause g 21 (q 1 ) < g 31 (q 1 ), we can infer that the average cost under {Dq 0 21 , Dq 0 31 } is less than the cost under {Dq 21 , Dq 31 }. It can be shown that Constraints (18) For a feasible E, we can simplify P1 with Theorems 1 through 4. Because the numbers of feasible E are limited, we can obtain the optimal solution of P1 by testing all cases of a feasible E. Each E tells which buyers need to receive products from transshipment. However, which buyers transship products to those buyers in the E is still unknown. Based on the above theorems, we develop an algorithm to obtain the optimal solution of P1 for {x 1 , x 2 , . . . , x m }. Let W i AL and r i AL be artificial variables in Algorithm 1, i = 1, 2, . . . ,m. Let TO be the list of buyers who is able to transship products to others and let TI be the list of buyers who need to receive products via transshipments. Denote the list containing all pairs (i, j) with i 2 TO and j 2 TI as A, and denote the list containing all ranges of q 1 as B.\n\nAlgorithm 1 (The optimal solution can be implemented as follows:).\n\nStep 1. Calculate the cases of feasible E based on Constraints (32)-(34) and set Dq ij = 0 for all i, j = 1, 2, . . . , m. Mark E that are feasible so they remain to be untested.\n\nStep 2. Make Lists TO, TI, A, and B empty. For the untested E containing the smallest number of buyers, assign buyers (e.g., buyer i) with x i = 1 not in E to List TO and assign buyers in the same untested E to List TI.\n\nStep 3. Put all of the pairs (i, j) with i 2 TO and j 2 TI in List A. Sort the pairs of buyers in List A in ascending order according to g ij (q 1 ).\n\nStep 4. Obtain the range of q 1 based on Theorem 3 and put the resulting range in List B.\n\nStep 5. Set W i AL = W i and r i AL = r i , i = 1, 2, . . . , m.\n\nStep 6. Consider the next pair of buyers in List A. Suppose that the buyer from List TO in this pair is buyer f, and the other buyer in the same pair is buyer e.\n\nStep 6.1. Consider the next range of q 1 in List B. If W f AL = \u00c01 or W e AL = \u00c01, go to Step 6.3. Otherwise, determine the value of Dq fe :\n\nStep 6.2. If Dq fe = W f AL -D f q 1 /D 1 in the current range of q 1 , update W e AL by adding Dq fe and set W f AL = \u00c01 for this range. If Dq fe = D e q 1 /D 1 -W e AL in the current range of q 1 , update W f AL by subtracting Dq fe and set W e AL = \u00c01 for this range. Otherwise, divide this range into two ranges by inserting q 1 that satisfies\n\nand put these two ranges as untested in List B.\n\nStep 6.3. If all of ranges in List B have been tested, go to Step 6.4. Otherwise, go to Step 6.1.\n\nStep 6.4. If all of the pairs in List A have been calculated, go to Step 7. Otherwise, go to Step 6.\n\nStep 7. Obtain the optimal q 1 under the current E by using the KKT conditions. Mark this E as ''tested\".\n\nStep 8. If all cases of feasible E are tested, return the optimal q 1 among all the q 1 obtained under different E and the algorithm stops. Otherwise, return to Step 2.\n\nFor a feasible E, {1, 2, . . . , p}, we can obtain a list of ranges of q 1 (List B). For each range in List B, we obtain Dq ij as a function of q 1 , i.e., Dq ij (q 1 ) from the algorithm, which is a continuous function of q 1 in the range. Consider {x 1 , x 2 , . . . , x m } and a range, [q 1 l , q 1 u ], in List B. We can obtain\n\nsubject to q l 1 6 q 1 6 q u\n\nIt is clear that q 1 and Dq ij (q 1 ) obtained from the algorithm satisfy Constraints (9)-(14). We can get the KKT conditions for the range, [q 1 l , q 1 u ], as follows:\n\nFrom Eq. (47), we get\n\nCase 1. k 1 -0 and k 2 -0. From Eqs. (48) and (49), we see that q 1 = q 1 l and q 1 = q 1 u , which cannot hold.\n\nCase 2. k 1 -0 and k 2 = 0. From Eq. (48), we get q 1 = q 1 l . Based on Eqs. (46) and (51), it follows that\n\nThis solution is a KKT point only when k 1 ! 0. Case 3. k 1 = 0 and k 2 -0. In this case, q 1 = q 1 u leads to\n\nThis solution is a KKT point only when k 2 ! 0. Case 4. k 1 = 0 and k 2 = 0. In this case, q 1 should satisfy\n\nThis solution is a KKT point only when q 1 satisfies Constraint (37). As the algorithm shows, for {x 1 , x 2 , . . . , x m }, we can obtain the optimal solution for E by comparing the objective functions under the ranges in List B. Then, we can obtain the optimal solution of P1 by comparing the objective functions of every feasible E. Note that the value of n obtained from Eq. (51) may not be an integer. In this case, we check the largest integer that is less than n and the smallest integer that is greater than n. When the fixed cost of transshipment is negligible, the above Theorems and algorithm can be simplified by setting x 1 = x 2 =, . . . ,x m = 1. Obviously, this is a special case of the TRAN model.\n\nAs discussed in Section 4, Algorithm 1 can only obtain the optimal solution of P1 for a given {x 1 , x 2 , . . . , x m }. In this section, we propose a GA for this problem. In the GA, each chromosome determines a {x 1 , x 2 , . . . , x m }. Then, we use Algorithm 1 to obtain the optimal solution under the {x 1 , x 2 , . . . , x m }. Fig. 4 illustrates the proposed GA procedure.\n\nTo execute the GA, a chromosome is coded with m genes. The value of x i is considered as the ''allele\" to recall the specific language involved in the GA. The ith gene of the chromosome can be either 0 or 1; i.e., the value of x i . Fig. 5 is an example that illustrates seven buyers. Only Buyers 3, 5, and 6 can transship products to other buyers. This representation of a chromosome is not a complete solution. We can obtain the optimal solution under a {x 1 , x 2 , . . . , x m } by using the proposed algorithm, so we obtain a complete solution through a specific chromosome developed in the GA. In this paper, we feature an input minimiza-tion problem and use Eq. (55) to measure the fitness value of chromosome w, w = 1, 2, . . . , P, in which P is the population size of the GA.\n\nFitness w \u00bc the channel \u00c0 wide cost in chromosome w \u00f055\u00de\n\nEq. (55) shows that the fitness value of one chromosome is the channel-wide cost determined by it. Therefore, the best chromosome has the smallest fitness value. We select chromosomes for crossover with the popular roulette wheel approach (Goldberg, 1989) , in which the selection probability of each chromosome is positively associated with its fitness value. For two chromosomes selected from the population (F1 and F2), we generate two new chromosomes (O1 and O2) by using crossover and mutation mechanisms. The two-point crossover with possibility P c which has been widely used in GAs is used in this paper. Then, we implement a two-step mutation mechanism for each new chromosome obtained from the crossover. We omit the details of crossover and mutation; readers can refer to Feng et al. (2015) for details. Fig. 6 shows an example of crossover and mutation for the case with 10 buyers.\n\nFor a chromosome, we can obtain the optimal solution of P1. If x i = 1 in the chromosome and Dq ij = 0 in the optimal solution for all j in the corresponding E, then we can improve the chromosome by setting x i = 0. Using this strategy, we find that the optimal solution remains and the fitness value is decreased by D 1 f i /q 1 . If the maximum number of generations is reached, then the stopping criterion is invoked. Otherwise, we create a new generation.\n\nAs shown in Section 1, some of researchers who have studied transshipment did not consider the fixed transshipment cost; that is, they assumed that f 1 = f 2 =, . . . ,=f m = 0. In this case, the algorithm may not obtain the optimal solution if the fixed transshipment costs exist. Algorithm 2 is proposed to get the solution when existing fixed transshipment costs are ignored in the decision making. We can reveal the impact of fixed transshipment cost consideration by comparing the results obtained from Algorithm 2 and the GA.\n\nFor [q 1 l , q 1 u ], we rewrite Eq. (43) as\n\nThen, Eqs. (52)-(54) can be rewritten as\n\nHowever, the real objective value should include the total fixed transshipment cost under the solution. We may obtain this final objective value by adding D 1 f i /q 1 if P m j\u00bc1;j-i Dq ij \u00f0q 1 \u00de -0 for all i = 1, 2, . . . , m. Algorithm 2.\n\nStep 1. Set x 1 = x 1 = x 2 =, . . . ,= x m = 1.\n\nStep 2. Obtain the solution based on Algorithm 1 by replacing Eqs. (52)-(54) for the KKT conditions with Eqs. (57)-(59), respectively. Calculate the inventory and variable transshipment cost.\n\nStep 3. Calculate the total fixed cost of transshipment at buyer i, i = 1, 2, . . . , m: the cost is equal to D 1 f i /q 1 if P m j\u00bc1;j-i Dq ij \u00f0q 1 \u00de -0; the cost is 0, otherwise.\n\nStep 4. Obtain the total cost by adding the total fixed cost of transshipment to the cost obtained at Step 2 of this algorithm.\n\nIn this experiment, we considered 10 buyers. A v = $500; h v = $1.6; and h b = $12.3. For simplicity, we assumed c b = h b . Because r i = D i L i , we randomly generated r i instead of L i . We also randomly generated five instances. In each instance, other parameters followed uniform distributions as presented in Table 2 .\n\nThe TRAN model was coded in LINGO version 16.0, and the GA was coded in JAVA. The experiments were conducted on a PC with Intel Core 2.3 GHz and 4 GB RAM. We obtained the appropriate settings for the GA parameters through pilot experiments. The population size, maximum generation number, Pc, Pm1, and Pm2 are set as 100, 100, 0.7, 0.20, and 0.05, respectively. Table 3 illustrates the comparison of the solutions obtained from LINGO and the GA. For most instances, the GA can obtain optimal solutions. In the two instances in which the GA solutions were worse than those of LINGO, the optimality gaps were small. Moreover, we found that the LINGO computation time increased significantly with problem size. When m was >40, LINGO required >24 h to solve the problem, but the GA obtained solutions within acceptable timeframes.\n\nTo show the impact of transshipment policy on the channel-wide cost, we compare the INT model and the TRAN model. The INT model is a special of the TRAN model with x 1 = x 2 =, . . . ,=x m = 0. We can obtain the optimal solution of the INT model with Algorithm 1 by setting a single feasible E which is empty. In addition, because the fixed transshipment cost has rarely been considered in existing studies, we compare our GA with Algorithm 2. In Algorithm 2, all of the buyers who are not in E can transship products to the buyers in E. For a solution obtained from this algorithm, only the fixed transshipment costs of the buyers who conduct transshipment are added to the channel-wide cost; this approach is based on the chromosome improvement mechanism in the GA. Let Gap I = (AC nt \u00c0 AC nf )/AC nt \u00c2 100%, Gap II = (AC nt \u00c0 AC f )/AC nt \u00c2 100%, and Gap III = (AC nf \u00c0 AC f )/AC nf \u00c2 100%. The comparisons are summarized in Table 4 . For each problem size, we ran Algorithm 2 and the GA on 10 instances.\n\nFrom Table 4 , we can see that the TRAN model can lead to a lower channel-wide cost than the INT model. Because Gap II is greater than Gap I, we can infer that this cost saving can be reduced if the fixed transshipment cost is not considered in the optimal solution algorithm. The influence of fixed transshipment cost is created by two circumstances. First, if we do not consider this fixed cost, then we may obtain a solution in which buyer i transships few products to buyer j while other buyers (e.g., buyer k) not in E also still transship products to buyer j. Although the unit transshipment cost, s ij , is lower than s kj , transshipping a small number of products cannot compensate for the fixed cost of involving three buyers in the transshipment. Second, there exist cases in which s ij is lower than s kj while f i is greater than f k . Under these conditions the transshipment cost may not be minimized if we decide the transshipment solution based on s ij and s kj without considering f i and f k . Therefore, we find a trade-off exists between the fixed cost and the transportation cost in the transshipment. Moreover, the gaps are larger for large problems because more buyers could be involved in transshipment, which increases Gaps I and II. Because many buyers characterize large problems, a wide solution space is created that affects the optimal GA solution, which increases Gap III.\n\nTo analyze the impact of parameters on the performances of these models and algorithms, we conducted sensitivity analysis of h v , h b , f i , and W i for the cases with m = 10. For each value of h v and h b , we randomly generated 30 instances by using the parameter distributions in Table 2. Tables 5 and 6 show the comparison of the INT model, Algorithm 2, and the GA under different h b and h v values, respectively. Gaps I to III decrease when h b is increased from $8 to $16, respectively. When h v is Note: The instances wherein the GA fails to obtain the optimal solution appear in bold. increased from $1 to $5, however, the variation tendencies of Gaps I to III are more complex. As Tables 7 and 8 show, we investigate into an instance as an example to discuss the reason for this difference. The GA can yield good transshipment solutions under a q 1 that represents a relatively low transshipment cost (including transportation and fixed costs). Therefore, the GA may lead to solutions with a larger optimal q 1 than Algorithm 2 (see Tables  7 and 8) . When h b is increasing, a smaller q 1 may be preferable when each buyer's order quantity in one sub-cycle is decreasing. In this case, the optimal n is an affine transformation of q 1 . Hence, the optimal n is increasing with h b . Although the channel-wide costs under the models and algorithms are all increasing with h b , Gap III is decreasing. In addition, the decreasing rates of Gap III when h b is increased from $12 to $16 are greater than the rates when h b is increased from $8 to $10. In the latter cases, the optimal q 1 values from Algorithm 2 and from the GA are both 90. When h b is increased from $8 to $10, the absolute values of AC nf \u00c0 AC f are the same. Gap III is decreased only because AC nf is increasing when h b is increased from $8 to $10. When h b is equal to $12, $14, and $16, the optimal q 1 obtained from Algorithm 2 is decreased to 75 while the optimal q 1 from the GA is still 90. In these cases, the increment of AC f is higher than the increment of AC nf when h b is increased. Therefore, the absolute values of AC nf \u00c0 AC f are decreasing. Considering that AC nf is increasing with h b , the decreasing rates of Gap III when h b is increased from $12 to $16 could be greater than the one when h b is increased from $8 to $10.\n\nEq. (51) explains that the optimal n is decreasing with h v and q 1 . When h v is increasing, a larger q 1 and smaller n may be preferable when the vendor's total order quantity in one cycle (i.e., nDq 1 /D 1 ) is also decreasing. For the same q 1 and different h v , the optimal n may vary. When h v is sufficiently large, however, Eqs. (57) and (58) can also be used to obtain the optimal q 1 . Therefore, Algorithm 2 obtained the same q 1 with the GA when h v = $2, $3, $4, and $5. In these cases, the value for AC nf \u00c0AC f remains unchanged while AC nf is increasing. In this case, Gap III decreases when h v is increased from $2 to $5. Moreover, q 1 = 89, which is greater than the value of q 1 obtained from Algorithm 2 when h v = $1. Because a larger q 1 implies more transshipments, the value of AC nf \u00c0 AC f when h v = $2 is greater than when h v = $1. As a consequence, Gap III may increase when h v increases from $1 to $2.\n\nLet F be the uniform distribution of f i , i = 1 ,2, 3, . . . ,10. We conducted experiments under different mean values and standard deviations of F to see the impact of the fixed transshipment cost. For each type of F, we randomly generated 30 instances for which other stochastic parameters follow the uniform distributions presented in Table 2 . Table 9 shows the average channel-wide cost of the 30 instances under F with different mean values and with the same standard deviation. We can see that when the mean value of F is increased, the fixed cost of transshipment is higher, and the cost saving from transshipment is lower; thus Gaps I and II are decreased respectively. However, Gap III is larger in those cases. These findings mean that when the fixed cost of transshipment is higher, the assignment of buyers for transshipment plays a more important role in reducing the channel-wide cost. Table 10 shows the average channel-wide cost of the 30 instances under different standard deviations of F with the same mean value. We can see that when the standard deviation F is increased, the improvements of the two algorithms are more significant, because more buyers have lower fixed transshipment costs. The channel-wide cost can be reduced more significantly if the buyers with a lower fixed cost are involved in the transshipment. Because the GA can attempt more assignments of buyers for the transshipment, Gap III is larger in those cases. Table 7 The solutions under different h b for an instance. Let Y be the uniform distribution of W i , i = 1, 2, 3, . . . , 10. We conducted experiments under different mean values of Y to see the impact of the warehouse capacities. For each type of Y, we randomly generated 30 instances for which other stochastic parameters follow the uniform distributions in Table 2. Table 11 shows the average channel-wide cost of 30 instances under different mean values and with the same standard deviation. We can see that when the mean value is increased, the improvements of the two algorithms are less significant, because the buyers can obtain more products from ordinary deliver, which mitigates the essentiality of lateral transshipment.\n\nWe developed several theorems to indicate the optimal transshipment solution and found that for {q 1 , n}:\n\n(i) Buyers should not simultaneously transship products to others and receive transshipped products from others.\n\n(ii) Buyer i should not transship products to buyer j if 0 q i W i and 0 q j W j .\n\n(iii) Buyer i should not transship products to buyer j if buyer k with g kj (q 1 ) < g ij (q 1 ) has unused warehouse capacity.\n\nBased on the above findings, an optimal solution algorithm that alleviate the complexity of the TRAN model is be developed. From this study, we can see that the average channel-wide cost can be saved by using the TRAN model under which the transshipment allows the order to arrive at various times. As a consequence, some buyers can obtain more products than their warehouses can accommodate. In addition, the utilization ratio of the warehouse capacities of some buyers is increased. When warehouse capacity is shared among buyers, the channel-wide optimal replenishment solution can be achieved. The numerical experiment shows the advantage of the TRAN model. The advantage can be more significant when the number of buyers is increased.\n\nMoreover, when existing fixed transshipment costs are ignored during decision making, the solution can deviate from the optimal solution, and this outcome has a negative impact on the performance of lateral transshipments. The experimental results demonstrate that the fixed transshipment costs should be considered in the model and algorithm design. Sensitivity analyses show how this impact is influenced by other parameters. From the results, we can see that h v has a positive impact on the advantage of the TRAN model, while h b has a negative impact on it. This advantage is negatively associated with the warehouse capacities of buyers.\n\nIn this article, we developed our model based on several assumptions that can be reconsidered in future work. First, we assumed that product consumption rates of buyers are known, and we focused on how supply chains benefit from transshipment as result of increased warehouse capacity. Considering the advantage of transshipment in increasing customer service level when the consumption rates are uncertain can be a fruitful direction. Second, we considered absolute constraints on the warehouse capacities of buyers. This model can be extended by considering penalty costs for exceeding upper bounds of inventory levels under our tight capacity constraints, which would make our model more applicable in general. Third, we studied an integrated channel and focused solely on reducing the channel-wide cost. It would be interesting to study the performances of members in a decentralized channel under a warehouse-sharing policy."}